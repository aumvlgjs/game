require=function t(e,n,i){function a(o,r){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!r&&c)return c(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return a(n?n:t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({AnimationManager:[function(t,e,n){"use strict";cc._RFpush(e,"05d0cX/ID1MBrBkuPmoWa3f","AnimationManager");var i,a=t("Utils");i={fillRadial:function(){function t(t,n){var i=t.width,a=t.height,s=n.x,o=n.y;return Math.max(e(s,o),e(s,a-o),e(i-s,o),e(i-s,a-o))}function e(t,e){return Math.sqrt(t*t+e*e)}var n=10;return function(e,i,s){function o(){r&&(clearInterval(r),r=null),e.removeChild(u),u&&u.isValid&&u.destroy()}if(s=s||{},!e||!i||s.duration<=0)return null;var r,c=t(e,i),h=2*c,u=new cc.Node,l=u.addComponent(cc.Mask),d=new cc.Node,m=d.addComponent(cc.Mask),p=new cc.Node,g=p.addComponent(cc.Sprite),f=c*n/(1e3*s.duration),_=2*f;return cc.loader.loadRes("textures/SingleColor",cc.SpriteFrame,function(t,e){if(!t)try{g.spriteFrame=e}catch(n){}}),m.type=cc.Mask.Type.ELLIPSE,d.parent=u,d.setContentSize(0,0),d.setPosition(i.x-e.width/2,i.y-e.height/2),p.color=s.color||cc.Color.BLACK,p.opacity=s.opacity>=0?s.opacity:80,p.parent=d,l.type=cc.Mask.Type.RECT,u.parent=e,u.setContentSize(e.getContentSize()),u.setSiblingIndex(0),r=setInterval(function(){return!d||!d.isValid||d.width>=h?(s.isStopManually||o(),void(a.Type.isFunction(s.finishCallback)&&s.finishCallback())):(d.setContentSize(d.width+_,d.height+_),void p.setContentSize(d.getContentSize()))},n),o}}()},e.exports=i,cc._RFpop()},{Utils:"Utils"}],AudioList:[function(t,e,n){"use strict";cc._RFpush(e,"66143+rqKFME6TICos7r1qJ","AudioList"),cc.Class({"extends":cc.Component,properties:{audioList:{"default":[],url:cc.AudioClip}},onLoad:function(){}}),cc._RFpop()},{}],AudioManager:[function(t,e,n){"use strict";function i(t){return function(e){s.Array.trimLeft(this.audioIdList,l);var n=this.playEffect(t,e);return n&&this.audioIdList.push(n),n}}cc._RFpush(e,"888082CC+lA4ImHMGQUYgdE","AudioManager");var a,s=t("Utils"),o=t("EventDispatcher"),r="res/raw-assets/audio/",c={BACKGROUND_MUSIC:r+"BackgroundMusic.mp3",BAI_CHON:r+"BaiChon.mp3",BAI_BAY:r+"BaiBay.mp3",BAI_CHIA:r+"BaiChia.mp3",BALL_RUN:r+"BallRun.mp3",CHICKEN_WIN:r+"ChickenWin.mp3",CHIP_BAY:r+"ChipBay.mp3",COIN_DROP:r+"CoinDrop.mp3",DANH_BAI:r+"DanhBai.mp3",LOST:r+"Lost.mp3",MINIPOKER:r+"MiniPoker.mp3",CHICKEN_ROW:r+"ChickenRow.mp3",PHOM_PICK_CARD:r+"PhomPickCard.mp3",PHOM_TAI_LUOT:r+"PhomTaiLuot.mp3",PLAYER_JOIN_ROOM:r+"PlayerJoinRoom.mp3",PLAYER_LEAVE_ROOM:r+"PlayerLeaveRoom.mp3",READY:r+"Ready.mp3",THANG_TRANG:r+"ThangTrang.mp3",TURN_START:r+"TurnStart.mp3",VONG_QUAY:r+"VongQuay.mp3",WIN:r+"Win.mp3",LOSE:r+"Lose.mp3",XOC:r+"Xoc.mp3",BALL_DROP:r+"BallDrop.mp3",BUTTON_CLICK:r+"ButtonClick.mp3",ERROR:r+"Error.mp3"},h="__bg_music_volume__",u="__effect_volume__",l=20,d=3,m={eventDispatcher:o.create(),isMusicPlaying:!1,backgroundMusicId:null,effectsVolume:1,musicVolume:1},p={CHANGE_EFFECTS_VOLUME:"change_effects_volume"};cc.audioEngine.setMaxAudioInstance(d),a=s.Class({$$constructor:function(t){t=t||{},s.Type.isFunction(t.effectPlayableFn)&&(this.effectPlayableFn=t.effectPlayableFn),this.audioIdList=[],m.eventDispatcher.addEventListener(p.CHANGE_EFFECTS_VOLUME,this._onChangeEffectsVolume,this)},destroy:function(){var t=this;this.audioIdList.forEach(function(e){t.stopEffect(e)}),this.audioIdList=[],m.eventDispatcher.removeEventListener(p.CHANGE_EFFECTS_VOLUME,this._onChangeEffectsVolume,this)},playMusic:function(){this.stopMusic(),m.backgroundMusicId=cc.audioEngine.play(c.BACKGROUND_MUSIC,!0,m.musicVolume),cc.audioEngine.setVolume(m.backgroundMusicId,m.musicVolume),m.isMusicPlaying=!0},pauseMusic:function(){cc.audioEngine.pause(m.backgroundMusicId),m.isMusicPlaying=!1},resumeMusic:function(){null!==m.backgroundMusicId&&cc.audioEngine.resume(m.backgroundMusicId)},stopMusic:function(){cc.audioEngine.stop(m.backgroundMusicId),m.backgroundMusicId=null,m.isMusicPlaying=!1},isMusicPlaying:function(){return m.isMusicPlaying},getMusicVolume:function(){var t=parseInt(this._getSetting(h));return t>=0?t:1},setMusicVolume:function(t){m.musicVolume=t,cc.audioEngine.setVolume(m.backgroundMusicId,m.musicVolume),this._saveSetting(h,t)},getEffectsVolume:function(){var t=parseInt(this._getSetting(u));return t>=0?t:1},setEffectsVolume:function(t){m.effectsVolume=t,m.eventDispatcher.dispatchEvent(p.CHANGE_EFFECTS_VOLUME),this._saveSetting(u,t)},playEffect:function(t,e){if(!this.effectPlayableFn||this.effectPlayableFn()){var n=cc.audioEngine.play(t,e,m.effectsVolume);return cc.audioEngine.setVolume(n,m.effectsVolume),n}},stopEffect:function(t){t&&cc.audioEngine.stop(t)},playBaiBay:i(c.BAI_BAY),playBaiChon:i(c.BAI_CHON),playBaiChia:i(c.BAI_CHIA),playBallDrop:i(c.BALL_DROP),playChickenWin:i(c.CHICKEN_WIN),playChipBay:i(c.CHIP_BAY),playCoinDrop:i(c.COIN_DROP),playDanhBai:i(c.DANH_BAI),playLost:i(c.LOST),playMiniPoker:i(c.MINIPOKER),playChickenRow:i(c.CHICKEN_ROW),playPhomPickCard:i(c.PHOM_PICK_CARD),playPhomTaiLuot:i(c.PHOM_TAI_LUOT),playPlayerJoinRoom:i(c.PLAYER_JOIN_ROOM),playPlayerLeaveRoom:i(c.PLAYER_LEAVE_ROOM),playReady:i(c.READY),playThangTrang:i(c.THANG_TRANG),playTurnStart:i(c.TURN_START),playVongQuay:i(c.VONG_QUAY),playWin:i(c.WIN),playXoc:i(c.XOC),playBallRun:i(c.BALL_RUN),playLose:i(c.LOSE),playButtonClick:i(c.BUTTON_CLICK),playError:i(c.ERROR),_saveSetting:function(t,e){cc.sys.localStorage.setItem(t,e)},_getSetting:function(t){return cc.sys.localStorage.getItem(t)},_onChangeEffectsVolume:function(){this.audioIdList.forEach(function(t){cc.audioEngine.setVolume(t,m.effectsVolume)})}}),cc.game.on(cc.game.EVENT_HIDE,function(){a.instance.resumeMusic()}),a.instance=new a,a.instance.setMusicVolume(a.instance.getMusicVolume()),a.instance.setEffectsVolume(a.instance.getEffectsVolume()),e.exports=a,cc._RFpop()},{EventDispatcher:"EventDispatcher",Utils:"Utils"}],AuthUser:[function(t,e,n){"use strict";cc._RFpush(e,"4ed87oXbFtPMZEsuH6c8gT6","AuthUser");var i=t("EventDispatcher"),a=t("CommonConstant"),s=t("EventDispatcherConstant"),o={updateInfo:function(t){cc.js.mixin(this,t)}};i.addEventListener(s.PROFILE.UPDATE_MONEY,function(t){t&&t.username===o.username&&(o.currencies[t.currency].balance=t.money)}),i.addEventListener(s.PROFILE.UPDATE_EXP,function(t){t&&t.username===o.username&&(o.experience=o.experience||0,o.experience+=t.exp)}),i.addEventListener(a.PushMessageType.UPDATE_USER_INFO.EVENT,function(t){t&&t.content&&(o.updateInfo(JSON.parse(t.content)),i.dispatchEvent(s.PROFILE.UPDATE_UNREAD_MESS_COUNT))}),e.exports=o,cc._RFpop()},{CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant"}],BaseGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"2fd10Yzj6FL/6HQIbpYmqVi","BaseGameManager");var i,a=t("NetworkManager"),s=t("EventDispatcher"),o=t("SmartFoxConstant"),r=t("UiManager"),c=t("Utils"),h=t("AuthUser"),u=t("EventDispatcherConstant"),l=t("GameManagerConstant"),d=t("TinhNangManager"),m=t("Player"),p={UPDATE_USER_MONEY:"game_manager.private.profile.update_money",UPDATE_USER_EXP:"game_manager.private.profile.update_exp"};i=c.Class({$$constructor:function(t,e){this.DELAYED_COMMANDS=[o.Command.MESSAGE.ID,o.Command.PLAY.ID,o.Command.FINISH_GAME.ID,o.Command.DEAL_CARD.ID,o.Command.TURN.ID,o.Command.WAITING_DEAL_CARD.ID],this.gameCmd=t.CONFIG.CMD,this.roomId=e,this.logEnabled=t.CONFIG.LOG,this.gameId=t.CONFIG.ID,this.visibleSlots=t.CONFIG.VISIBLE_SLOTS,this.warningMessageDuration=t.CONFIG.WARNING_MESSAGE_DURATION,this.fee=0,this._saveMatchId(0),this.eventDispatchers={globalCmd:s.create(!0),anyCmd:s.createStackEventDispatcher(t.CONFIG.MAX_COMMANDS_PER_MATCH||50),playCmd:s.create(!0),local:s.create(!0),_private:s.create(!0)},this._reinitPlayersInfo(),this._reinitBettingInfo(),t.CONFIG.ALONE&&this._addCurrentUserToPlayers(),this._onExtensionHandlerBinding=this._onExtensionHandler.bind(this),a.SmartFox.addExtensionHandler(this.gameCmd,this._onExtensionHandlerBinding),this.eventDispatchers.anyCmd.addEventListener(o.Command.MESSAGE.ID,this._onMessage,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.KICK_PLAYER.ID,this._onKickPlayer,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAYER_ADDED.ID,this._onPlayerAdded,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAYER_REMOVED.ID,this._onPlayerRemoved,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.WAITING_PLAYER_ADDED.ID,this._onWaitingPlayerAdded,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.WAITING_PLAYER_REMOVED.ID,this._onWaitingPlayerRemoved,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.REG_QUIT_GAME.ID,this._onRegisterQuitGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.DEREG_QUIT_GAME.ID,this._onDeregisterQuitGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_GAME.ID,this._onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.REFRESH_GAME.ID,this._onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_USER_INFO.ID,this._onUpdateUserInfo,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAY.ID,this._onPlay,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.NEW_MATCH.ID,this._onNewMatch,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.REQUEST_BANKER.ID,this._onSetBanker,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.BANKER_RESIGN.ID,this._onRemoveBanker,this),t.CONFIG.BUY_MONEY?this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_PRIVATE_USER_MONEY.ID,this._onUpdateUserPrivateMoney,this):(this.eventDispatchers._private.addEventListener(p.UPDATE_USER_MONEY,this._onUpdateUserMoney,this),s.addEventListener(u.PROFILE.UPDATE_MONEY,this._onUpdateUserMoney,this)),this.log("[BaseGameManager] GameCMD: "+this.gameCmd+", RoomID: "+this.roomId)},startGame:function(){},destroy:function(){this._clearEventDispatchers(),this._reinitPlayersInfo(),this._reinitBettingInfo(),a.SmartFox.removeExtensionHandler(this.gameCmd,this._onExtensionHandlerBinding)},isCurrentPlayer:function(t){var e=null;return c.Type.isObject(t)&&(e=t.username||t.userName),e||(e=t),!(!e||!this.current.player||this.current.player.data.username!==e)},disableEventDispatchersCache:function(){this.eventDispatchers.local.disableCache(),this.eventDispatchers.globalCmd.disableCache(),this.eventDispatchers.playCmd.disableCache(),this.eventDispatchers._private.disableCache()},isNewMatch:function(t){return t=this._parseMatchId(t),t>=0&&this.matchInfo.matchId>=0&&this.matchInfo.matchId!==t},addPlayerFromData:function(t){this._onPlayerAdded({player:t})},removePlayerByUsername:function(t){if(t){var e={player:{username:t}};this._onPlayerRemoved(e)||this._onWaitingPlayerRemoved(e)}},openHelpModal:function(){var t=this;r.openModalByName("HelpModal",function(e){var n=e.getComponent("GameHelpModal"),i=e.getComponentInChildren(cc.ScrollView);i&&i.scrollToTop(),n.init(t.gameId)})},fetchInitialGameData:function(){this.requestRefreshGame()},_clearEventDispatchers:function(){this.eventDispatchers.local.clear(),this.eventDispatchers.globalCmd.clear(),this.eventDispatchers.anyCmd.clear(),this.eventDispatchers.playCmd.clear(),this.eventDispatchers._private.clear()},_reinitPlayersInfo:function(){this.current={},this.players={},this.waitingPlayers={}},_reinitBettingInfo:function(){this.bettingInfo={}},_addCurrentUserToPlayers:function(){this._onPlayerAdded({player:{userName:h.username}})},_parseMatchId:function(t){try{return parseInt(t)}catch(e){}},_saveMatchId:function(t){this.matchInfo={matchId:t,time:Date.now()}},send:function(t){this.log("["+this.gameCmd+", "+this.roomId+"] [send]",t),a.SmartFox.sendExtensionRequest(this.gameCmd,t,this.roomId)},requestRefreshGame:function(){this.send({command:a.SmartFox.type["byte"](o.Command.REFRESH_GAME.ID)})},sendRequestBanker:function(){this.send({command:a.SmartFox.type["byte"](o.Command.REQUEST_BANKER.ID)})},registerQuitGame:function(){this.send({command:a.SmartFox.type["byte"](o.Command.REG_QUIT_GAME.ID)})},deregisterQuitGame:function(){this.send({command:a.SmartFox.type["byte"](o.Command.DEREG_QUIT_GAME.ID)})},sendChatMessage:function(t){a.SmartFox.sendPublicMessageRequest(t,this.roomId)},leaveRoom:function(){a.SmartFox.leaveRoom(this.roomId)},_onExtensionHandler:function(t){var e=t.sourceRoom,n=t.params||{},i=n.command;if(c.Type.isDefined(i))if(e===this.roomId){"timeForAnimation"in n&&c.Object.replaceProperty(n,"timeForAnimation","time"),"userName"in n&&c.Object.replaceProperty(n,"userName","username");var a=n.allData&&n.allData.players,s=n.allData&&n.allData.waitingPlayers;a&&this._updatePlayersData(a,this.players),s&&this._updatePlayersData(s,this.waitingPlayers),this.DELAYED_COMMANDS.indexOf(i)===-1?(this.eventDispatchers.anyCmd.dispatchEvent(i,n),this.log("["+this.gameCmd+", "+this.roomId+"] [receive] [exec]",n)):(this.eventDispatchers.anyCmd.pushEvent(i,n),this.log("["+this.gameCmd+", "+this.roomId+"] [receive] [stack]",n))}else e||(this.eventDispatchers.globalCmd.dispatchEvent(i,n),this.log("["+this.gameCmd+", "+this.roomId+"] [receive] [global]",n))},_onNewMatch:function(t){var e=this._parseMatchId(t&&t.matchId);e>=0&&(this._saveMatchId(e),c.Game.isFocus()||this.eventDispatchers.local.dispatchEvent(l.Event.NEW_MATCH_LOST_FOCUS))},_onPlay:function(t){var e=t.action;c.Type.isDefined(e)&&this.eventDispatchers.playCmd.dispatchEvent(e,t)},_onMessage:function(t){r.openWarningMessage(t&&t.content,this.warningMessageDuration)},_onKickPlayer:function(t){if(this.isCurrentPlayer(t.username)){var e=t.reasonId;e!==o.KickReason.NOT_ENOUGH_MONEY&&e!==o.KickReason.NOT_ENOUGH_MONEY_TOBE_BANKER||!d.choPhep("nt")?r.openModal(t.msg):r.openConfirmModal(t.msg,{isPersistent:!0,oke_fn:function(){r.openNapXienModal()}})}},_onPlayerAdded:function(t){var e=this._addPlayerToCollection(t.player,this.players);return!!e&&(this.eventDispatchers.local.dispatchEvent(l.Event.PLAYER_ADDED,e),!0)},_onPlayerRemoved:function(t){var e=this._removePlayerFromCollection(t.player,this.players);return!!e&&(this.eventDispatchers.local.dispatchEvent(l.Event.PLAYER_REMOVED,e),!0)},_onWaitingPlayerAdded:function(t){var e=this._addPlayerToCollection(t.player,this.waitingPlayers);return!!e&&(this.eventDispatchers.local.dispatchEvent(l.Event.WAITING_PLAYER_ADDED,e),!0)},_onWaitingPlayerRemoved:function(t){var e=this._removePlayerFromCollection(t.player,this.waitingPlayers);return!!e&&(this.eventDispatchers.local.dispatchEvent(l.Event.WAITING_PLAYER_REMOVED,e),!0)},_addPlayerToCollection:function(t,e){if(e&&t){"userName"in t&&c.Object.replaceProperty(t,"userName","username"),"slotIndex"in t&&c.Object.replaceProperty(t,"slotIndex","slot"),cc.sys.isBrowser&&"https:"===location.protocol&&t.avatar&&(t.avatar=t.avatar.replace(/^http:/,"https:"));var n=e[t.username];return n?n.update(t):(n=new m(t),t.username===h.username&&(this.current.player=n),e[t.username]=n),n}return null},_removePlayerFromCollection:function(t,e){if(e&&t){"userName"in t&&c.Object.replaceProperty(t,"userName","username");var n=e[t.username];return delete e[t.username],n}return null},_onSetBanker:function(t){t&&t.bankerInfo&&(this.isCurrentPlayer(t.bankerInfo)&&(this.isMaster=!0),t.bankerInfo&&(t.bankerInfo.slot=this.visibleSlots,this.addPlayerFromData(t.bankerInfo)))},_onRemoveBanker:function(t){this.removePlayerByUsername(t.player)},_onRegisterQuitGame:function(t){this.isCurrentPlayer(t.username)&&(this.current.player.data.isRegisteredToQuitGame=!0,this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_REGISTER_QUIT_GAME_STATUS))},_onDeregisterQuitGame:function(t){this.isCurrentPlayer(t.username)&&(this.current.player.data.isRegisteredToQuitGame=!1,this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_REGISTER_QUIT_GAME_STATUS))},_onUpdateGame:function(t){var e,n,i,a,s=t.players||t.allData&&t.allData.players,o=t.waitingPlayers||t.allData&&t.allData.waitingPlayers,r=t.bettingValues||t.data&&t.data.bettingValues;if(!t.bettingValues||c.Type.isArray(r)?(e=t.betting||t.data&&t.data.betting,n=t.currency||t.data&&t.data.currency,this.bettingInfo={betting:e,bettingValues:r,currency:n},this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_BETTING_VALUES)):c.Type.isObject(r)&&(this.bettingInfo=r,this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_BETTING_VALUES)),t.banker&&t.banker.userName&&(t.banker.slot=this.visibleSlots,h.username===t.banker.userName?(this.isMaster=!0,this.addPlayerFromData(t.banker)):i=t.banker),s){for(a=0;a<s.length;a+=1)if(h.username===(s[a].username||s[a].userName)){this._onPlayerAdded({player:s[a]});break}for(a=0;a<s.length;a+=1)h.username!==(s[a].username||s[a].userName)&&this._onPlayerAdded({player:s[a]})}if(o)for(a=0;a<o.length;a+=1)this._onWaitingPlayerAdded({player:o[a]});i&&this.addPlayerFromData(i),this.fee=t.fee||t.data&&t.data.fee||0},_onUpdateUserInfo:function(t){if(t){var e,n,i;h.username===t.username?(e=s,n=u.PROFILE.UPDATE_MONEY,i=u.PROFILE.UPDATE_EXP):(e=this.eventDispatchers._private,n=p.UPDATE_USER_MONEY,i=p.UPDATE_USER_EXP),"money"===t.field?e.dispatchEvent(n,{username:t.username,currency:t.currency,money:t.value}):"expChange"===t.field&&e.dispatchEvent(i,{username:t.username,exp:t.value})}},_onUpdateUserMoney:function(t){this._onUpdateUserMoneyByType(t,l.Event.UPDATE_USER_MONEY)},_onUpdateUserPrivateMoney:function(t){this._onUpdateUserMoneyByType(t,null)},_onUpdateUserMoneyByType:function(t,e){t&&(this._updateUserMoneyInCollectionByType(t,this.players,e)||this._updateUserMoneyInCollectionByType(t,this.waitingPlayers,e))},_updateUserMoneyInCollectionByType:function(t,e,n){if(e&&t){var i=e[t.username];return i&&i.data&&i.data.currency===t.currency&&i.setMoney(t.money),n&&this.eventDispatchers.local.dispatchEvent(n,t),!0}return!1},_updatePlayersData:function(t,e){var n,i,a,s,o=e===this.players,r=o?this._onPlayerAdded.bind(this):this._onWaitingPlayerAdded.bind(this),u=o?this._onPlayerRemoved.bind(this):this._onWaitingPlayerRemoved.bind(this),l=Object.getOwnPropertyNames(e),d=[];for(s=0;s<t.length;s+=1)i=t[s],"userName"in i&&c.Object.replaceProperty(i,"userName","username"),d.push(i.username);for(n=c.Set.compare(l,d),s=0;s<n.diff12.length;s+=1)u({player:c.Object.findObject(t,"username",n.diff12[s])});for(s=0;s<n.diff21.length;s+=1)h.username===n.diff21[s]&&r({player:c.Object.findObject(t,"username",n.diff21[s])});for(s=0;s<n.diff21.length;s+=1)h.username!==n.diff21[s]&&r({player:c.Object.findObject(t,"username",n.diff21[s])});for(s=0;s<t.length;s+=1)i=t[s],n.same.indexOf(i.username)>-1&&(a=e[i.username],a&&a.update(i))}}),["info","log","warn","error"].forEach(function(t){i.prototype[t]=function(t){return function(){this.logEnabled&&cc[t].apply(cc,["["+c.Date.currentTime()+"]"].concat(Array.prototype.slice.call(arguments)))}}(t)}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameManagerConstant:"GameManagerConstant",NetworkManager:"NetworkManager",Player:"Player",SmartFoxConstant:"SmartFoxConstant",TinhNangManager:"TinhNangManager",UiManager:"UiManager",Utils:"Utils"}],BaseGameOptionModal:[function(t,e,n){"use strict";cc._RFpush(e,"8e9e4hy8edJFbuxkhAlSUXk","BaseGameOptionModal");var i=t("GameManager"),a=t("Utils");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},init:function(t,e,n){this.gameId=t,this.gameConfigs=e,this.delayEnterGameFn=n},enterGame:function(){var t=this;t.gameId&&t.gameConfigs&&(a.Type.isFunction(t.delayEnterGameFn)?t.delayEnterGameFn(t.gameConfigs,function(t,e){return function(){i.enterGame(t,e)}}(t.gameId,t.gameConfigs)):i.enterGame(t.gameId,t.gameConfigs)),t.node.destroy()}}),cc._RFpop()},{GameManager:"GameManager",Utils:"Utils"}],BaseGameplay:[function(t,e,n){"use strict";cc._RFpush(e,"372e5/sReBP/oiaUHqBzNrX","BaseGameplay");var i=t("GameManager"),a=t("AudioManager"),s=t("GameConstant"),o=t("CommonConstant"),r=t("Utils");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){if(!this.gameCmd)throw'"gameCmd" must be specified in "properties"';try{if(this.gameRuntimeConfigs=i.getGameRuntimeConfigs(this.gameCmd),!this.gameRuntimeConfigs)throw"Game runtime configs of game whose gameCmd "+this.gameCmd+" could not be found";if(this.gameManager=this.gameRuntimeConfigs.gameManager,!this.gameManager)throw"Game manager of game whose gameCmd "+this.gameCmd+" could not be found";this.audioManager=new a({effectPlayableFn:function(){return this.node.active}.bind(this)}),this._timeoutList=[],this._timeoutMap={},this._intervalList=[],this._intervalMap={},this.$onLoadScene(),this.gameManager.disableEventDispatchersCache(),cc.game.on(cc.game.EVENT_SHOW,this.$onFocus,this),cc.game.on(cc.game.EVENT_HIDE,this.$onLostFocus,this)}catch(t){cc.error(t);var e=s.findByCmd(this.gameCmd);e&&!e.IS_MINIGAME&&r.Director.loadScene(o.Scene.HALL,function(){i.scheduleRecheckJoinedRooms(1e3)})}},onDestroy:function(){var t;if(this.gameManager&&(this.gameManager.destroy(),this.$onDestroyScene()),this.audioManager&&this.audioManager.destroy(),this._timeoutList&&this._timeoutList.forEach(function(t){clearTimeout(t)}),this._intervalList&&this._intervalList.forEach(function(t){clearInterval(t)}),this._timeoutMap)for(t in this._timeoutMap)clearTimeout(this._timeoutMap[t]);if(this._intervalMap)for(t in this._intervalMap)clearInterval(this._intervalMap[t]);cc.game.off(cc.game.EVENT_SHOW,this.$onFocus,this),cc.game.off(cc.game.EVENT_HIDE,this.$onLostFocus,this)},update:function(t){var e=Date.now(),n=this.gameManager,i=e-1e3*t,a=n&&n.matchInfo&&n.matchInfo.time;n&&(n.eventDispatchers.anyCmd.dispatchEvents(function(t){if(t&&t.eventName&&t.obj&&t.time>=0)return(!n.isNewMatch(t.obj.matchId)||!(i>=a)&&i<=t.time&&t.time<=a)&&(r.Type.isObject(t.obj)&&(t.obj.__execInfo__={dt:e-t.time}),!0)}),this.$onUpdate(t))},$onLoadScene:function(){this.$onLoad()},$onLoad:function(){},$onDestroyScene:function(){this.$onDestroy()},$onDestroy:function(){},$onUpdate:function(){},$onFocus:function(){},$onLostFocus:function(){},addTimeout:function(t,e){if(r.Type.isUndefined(e))this._timeoutList.push(t);else{if(!t)throw"Key must be specified";clearTimeout(this._timeoutMap[t]),this._timeoutMap[t]=e}},addInterval:function(t,e){if(r.Type.isUndefined(e))this._intervalList.push(t);else{if(!t)throw"Key must be specified";clearInterval(this._intervalMap[t]),this._intervalMap[t]=e}}}),cc._RFpop()},{AudioManager:"AudioManager",CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManager:"GameManager",Utils:"Utils"}],BaseMainGameplay:[function(t,e,n){"use strict";cc._RFpush(e,"d6eaewGSaBAHY1VZPN9iOAD","BaseMainGameplay");var i=t("PlayerUI"),a=t("Utils"),s=t("BaseGameplay"),o=t("GameManagerConstant"),r=t("TopPanelInGame");cc.Class({"extends":s,properties:{playerNodeList:{"default":[],type:i},playerSoloNodeList:{"default":[],type:i},fixedMainUserPosition:!1,reservedLastPosition:!1},$onLoadScene:function(){var t,e,n=this.gameRuntimeConfigs.game,i=this;if(n&&n.isSolo&&2===this.playerSoloNodeList.length){for(t=a.Set.compare(this.playerNodeList,this.playerSoloNodeList),e=0;e<t.diff12.length;e+=1)t.diff12[e].node.active=!1;this.playerNodeList=this.playerSoloNodeList}for(e=0;e<this.playerNodeList.length;e+=1)this.playerNodeList[e].removePlayer();if(this.mainUserPositionIndex=-1,this._mainUserPositionIndex=-1,this.gameManager.eventDispatchers.local.addEventListener(o.Event.PLAYER_ADDED,this._onPlayerAdded,this),this.gameManager.eventDispatchers.local.addEventListener(o.Event.PLAYER_REMOVED,this._onPlayerRemoved,this),this.topPanelInGameData={},this.$onLoad(),this.topPanelInGame=this.node.getComponentInChildren(r),this.topPanelInGame)this.topPanelInGame.init(this);else{var s=n&&n.CONFIG&&n.CONFIG.TOP_PANEL_IN_GAME;s&&s.ENABLE&&cc.loader.loadRes("games/ui/TopPanelInGame",function(t,e){var n=cc.instantiate(e);i.node.addChild(n),i.topPanelInGame=n.getComponent(r),i.topPanelInGame.init(i)})}cc.loader.loadRes("games/ui/RunningMessageInGame",function(t,e){var n=cc.instantiate(e);i.node.addChild(n),n.setSiblingIndex(0)})},$onLoad:function(){},findPlayerNodeByName:function(t){var e,n,i;for(i=0;i<this.playerNodeList.length;i+=1)if(e=this.playerNodeList[i],n=e.player,t&&t===(n&&n.data&&n.data.username))return e;return null},findPlayerNodeByIndex:function(t){return this.fixedMainUserPosition&&this.mainUserPositionIndex>=0&&(this.reservedLastPosition&&t===this.playerNodeList.length-1||(t-=this.reservedLastPosition&&this._mainUserPositionIndex>=0?this._mainUserPositionIndex:this.mainUserPositionIndex,t<0&&(t+=this.playerNodeList.length,this.reservedLastPosition&&(t-=1)))),this.playerNodeList[t]},_onPlayerAdded:function(t){if(t&&t.data){if(this.fixedMainUserPosition)if(t.isMe())this.mainUserPositionIndex=t.data.slot,this._mainUserPositionIndex<0&&(this._mainUserPositionIndex=this.mainUserPositionIndex);else if(this.mainUserPositionIndex<0)throw"Must set position for main user first";this.audioManager.playPlayerJoinRoom();var e=this.findPlayerNodeByIndex(t.data.slot);e&&e.player!==t&&(this._executeMethod("onPrePlayerAdded",e,t),e.setPlayer(t),this._executeMethod("onPostPlayerAdded",e))}},_onPlayerRemoved:function(t){if(t&&t.data){var e=this.findPlayerNodeByName(t.data.username);e&&e.player===t&&(this.audioManager.playPlayerLeaveRoom(),this._executeMethod("onPrePlayerRemoved",e),e.removePlayer(),this._executeMethod("onPostPlayerRemoved",e,t))}},_executeMethod:function(t){var e,n=this[t];if(a.Type.isFunction(n)){e=Array.prototype.slice.call(arguments),e.shift();try{n.apply(this,e)}catch(i){cc.error(i)}}}}),cc._RFpop()},{BaseGameplay:"BaseGameplay",GameManagerConstant:"GameManagerConstant",PlayerUI:"PlayerUI",TopPanelInGame:"TopPanelInGame",Utils:"Utils"}],BaseMinigameGameplay:[function(t,e,n){"use strict";cc._RFpush(e,"f7e23bB7jBLq6eEJr2XTQJL","BaseMinigameGameplay");var i=t("CommonConstant"),a=t("BaseGameplay");cc.Class({"extends":a,properties:{},start:function(){this.node.zIndex=i.ZINDEX.MINIGAME_PREFAB},$onLoadScene:function(){this.$onLoad()},$onLoad:function(){}}),cc._RFpop()},{BaseGameplay:"BaseGameplay",CommonConstant:"CommonConstant"}],BauCuaBuyPot:[function(t,e,n){"use strict";cc._RFpush(e,"29621TkbvxGOa+Mp2J+IRpW","BauCuaBuyPot");var i=t("BaseMainGameplay");cc.Class({"extends":cc.Component,properties:{itemSprite:cc.Sprite,moneyBuy:cc.Label,sceneScript:i},onLoad:function(){this.pot=0},setDataPot:function(t,e,n){this.itemSprite.spriteFrame=t,this.moneyBuy.string=e,this.pot=n},onClickBuyPot:function(){}}),cc._RFpop()},{BaseMainGameplay:"BaseMainGameplay"}],BauCuaConstant:[function(t,e,n){"use strict";cc._RFpush(e,"d7f0bUA5bZFOYS2i1lFbr5I","BauCuaConstant");var i=t("Utils");e.exports={Action:{BETTING:1,CANCEL_BET:2,TURN_MASTER:3,MASTER_SELL_POT:10,BUY_POT:11,CHANGE_STATE:5,UPDATE_POTS:9,PING:10},GameState:{NONE:0,EFFECT:1,PLAYER_BETTING:2,MASTER_CANEL_BET:3,FINISH:4,FINALIZING:5},ChipColor:{BLUE:{ID:0,NAME:"blue"},PURPLE:{ID:1,NAME:"purple"},GREEN:{ID:2,NAME:"green"},RED:{ID:3,NAME:"red"},findById:function(t){return t=parseInt(t,10),i.Object.findObject(this,"ID",t)}},Event:{CHANGE_STATE:"in_game.bau_cua.change_state",EFFECT_STATE:"in_game.bau_cua.change_state.effect",PLAYER_BETTING_STATE:"in_game.bau_cua.change_state.player_betting",UPDATE_POTS:"in_game.bau_cua.update_pots",BETTING_SUCCESS:"in_game.bau_cua.betting_success",SHAKE_BOW_DICE:"in_game.bau_cua.shake",CANCEL_BET:"in_game.bau_cua.cancel_bet",FINISH:"in_game.bau_cua.finish",SELECT_CHIP:"in_game.bau_cua.select_chip",ADD_LIST_BETTING:"in_game.bau_cua.add_list_betting",ADD_BANKER:"in_game.bau_cua.add_banker",SET_RATIO:"in_game.bau_cua.set_ratio",BETTING_UPDATEGAME:"in_game.bau_cua.betting_updategame",MASTER_CANEL_BET:"in_game.bau_cua.master_cancel_bet",MASTER_SELL_POT:"in_game.bau_cua.master_sell_pot"}},cc._RFpop()},{Utils:"Utils"}],BauCuaGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"ab5f8us87VN35j7NOLi3gK/","BauCuaGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("BauCuaConstant"),r=t("NetworkManager"),i=t("BauCuaGameManager"),c=t("Utils"),h=t("AuthUser");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.currentBet=[0,0,0,0,0,0],this.history=[],this.isMaster=!1,this.bettingList=[],this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.REFRESH_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BETTING,this.onBettingSuccess,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_STATE,this.onChangeState,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CANCEL_BET,this.onCancelBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.MASTER_SELL_POT,this.bankerBuyPot,this)},sellBetCancelBet:function(t){this.isMaster&&this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.MASTER_SELL_POT),pot:r.SmartFox.type["byte"](t)})},sendBuyPot:function(t){this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.BUY_POT),pot:r.SmartFox.type["byte"](t)})},sendBet:function(t,e){!this.isMaster&&e>0&&this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.BETTING),userName:r.SmartFox.type.utfString(h.username),pot:r.SmartFox.type["byte"](t),money:r.SmartFox.type["long"](e)})},sendReBet:function(){for(var t=0;t<this.history.length;t+=1)this.sendBet(t,this.history[t])},sendDoubleBet:function(){for(var t=0;t<this.currentBet.length;t+=1)this.currentBet[t]>0&&this.sendBet(t,this.currentBet[t])},sendCancelBet:function(){for(var t=0;t<this.currentBet.length;t+=1)this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.CANCEL_BET),userName:r.SmartFox.type.utfString(h.username),pot:r.SmartFox.type["byte"](t)})},bankerBuyPot:function(t){this.isMaster||this.eventDispatchers.local.dispatchEvent(o.Event.MASTER_SELL_POT,t)},countDowTime:function(t){return this._formatTime((t-Date.now())/1e3)},onFinishGame:function(t){this._setGameState(o.GameState.FINALIZING),this.eventDispatchers.local.dispatchEvent(o.Event.FINISH,t),this.history=this.currentBet,this.currentBet=[0,0,0,0,0,0]},onUpdateGame:function(t){this.bettingList=t.bettingValues,this._updateListBetting(t.bettingValues),this._updateRatio(t.potInfo),this.onChangeState(t),this.gameState!==o.GameState.FINISH&&this._bettingUpdateGame(t.pots)},_bettingUpdateGame:function(t){for(var e=0;e<t.length;e+=1)this.eventDispatchers.local.dispatchEvent(o.Event.BETTING_UPDATEGAME,t[e])},onBettingSuccess:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.BETTING_SUCCESS,t),this.isCurrentPlayer(t.username)&&(this.currentBet[t.pot]=this.currentBet[t.pot]+t.money)},onCancelBetting:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.CANCEL_BET,t),this.isCurrentPlayer(t.username)&&(this.currentBet=[0,0,0,0,0,0])},onChangeState:function(t){switch(this.warn("State "+t.gameState),this._setGameState(t.gameState),t.gameState){case o.GameState.EFFECT:this.onEfectShake(t);break;case o.GameState.PLAYER_BETTING:this.onPlayerBetting(t);break;case o.GameState.MASTER_CANEL_BET:this.eventDispatchers.local.dispatchEvent(o.Event.MASTER_CANEL_BET,t)}},_setGameState:function(t){this.gameState!==t&&(this.gameState=t,this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_STATE))},onPlayerBetting:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.PLAYER_BETTING_STATE,t)},onEfectShake:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.SHAKE_BOW_DICE,t)},_updateRatio:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.SET_RATIO,t)},_updateListBetting:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.ADD_LIST_BETTING,t);
},_formatTime:function(t){if(t>=0){t=Math.floor(t);var e=Math.floor(t/60),n=t%60;return c.Number.fillZero(e,2)+":"+c.Number.fillZero(n,2)}return"00:00"}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",BauCuaConstant:"BauCuaConstant",BauCuaGameManager:"BauCuaGameManager",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],Boot:[function(t,e,n){"use strict";cc._RFpush(e,"2c81brkjrlACYFnwAkW+KVL","Boot");var i=t("Url"),a=t("Utils"),s=t("SysConfig"),o=t("IplayHttp"),r=t("CommonConstant"),c=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{cpEditBox:cc.EditBox,httpHostEditBox:cc.EditBox,httpPortEditBox:cc.EditBox,usernameEditBox:cc.EditBox,passwordEditBox:cc.EditBox},onLoad:function(){this.cpEditBox.string=s.CP,this.httpHostEditBox.string=s.IplayHttp.HOST,this.httpPortEditBox.string=s.IplayHttp.PORT,this.usernameEditBox.string=a.Cookie.get(s.CookieName.USERNAME)||"test1",this.passwordEditBox.string="123456"},startGame:function(){var t=s.IplayHttp;s.CP=this.cpEditBox.string,t.HOST=this.httpHostEditBox.string,t.PORT=this.httpPortEditBox.string,o.init(t.HOST,t.PORT,t.PROTOCOL,t.AUTH_USER,t.AUTH_PASS),c.Http.fetch("POST",i.Http.USER_LOGIN,{username:this.usernameEditBox.string,password:this.passwordEditBox.string,devtoken:"devtoken",game:s.GAME,platform:s.PLATFORM}).success(function(t){a.Cookie.set(s.CookieName.USERNAME,t.data.username,365,"/"),a.Cookie.set(s.CookieName.ACCESSTOKEN,t.data.accesstoken,365,"/"),a.Director.loadScene(r.Scene.SPLASH)})}}),cc._RFpop()},{CommonConstant:"CommonConstant",IplayHttp:"IplayHttp",NetworkManager:"NetworkManager",SysConfig:"SysConfig",Url:"Url",Utils:"Utils"}],BottomPanelOutGame:[function(t,e,n){"use strict";cc._RFpush(e,"0d1b7R8NTtDT6gNW9SoNfsN","BottomPanelOutGame");var i=t("UiManager");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},openNapXien:function(){i.openNapXienModal()},openTopUsers:function(){i.openTopUsersModal()},openDoiThuong:function(){i.openPopupDoiThuong()},openDaiLy:function(){i.openPopupDaiLy()},openKiemXu:function(){i.openPopupKiemXu()},openSettings:function(){i.openPopupSettings()}}),cc._RFpop()},{UiManager:"UiManager"}],ButtonMaterial:[function(t,e,n){"use strict";cc._RFpush(e,"28531Td8pdP0p4+dj4uFpr3","ButtonMaterial");var i=t("Utils"),a=t("AnimationManager");cc.Class({"extends":cc.Component,properties:{duration:.1,color:cc.Color.WHITE,opacity:80},onLoad:function(){this.stopFn=null,this.isTouching=!1,this.isAnimating=!1,this.onFinishAnimationBinding=this.onFinishAnimation.bind(this),this.node&&(this.node.on(cc.Node.EventType.TOUCH_START,function(t){this.stopAnimation();var e=this.getComponent(cc.Button);if(e&&e.interactable){this.isTouching=!0,this.isAnimating=!0;var n=t.currentTarget.convertToNodeSpace(t.getLocation());this.stopFn=a.fillRadial(this.node,n,{duration:this.duration,isStopManually:!0,finishCallback:this.onFinishAnimationBinding,color:this.color,opacity:this.opacity})}},this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchUp,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchUp,this))},stopAnimation:function(){i.Type.isFunction(this.stopFn)&&(this.stopFn(),this.stopFn=null)},onFinishAnimation:function(){this.isTouching||this.stopAnimation(),this.isAnimating=!0},onTouchUp:function(){this.isTouching=!1,this.isAnimating||this.stopAnimation()}}),cc._RFpop()},{AnimationManager:"AnimationManager",Utils:"Utils"}],ButtonScaler:[function(t,e,n){"use strict";cc._RFpush(e,"f14eaDGTDNCIbsb8sAR5Yh+","ButtonScaler"),cc.Class({"extends":cc.Component,properties:{pressedScale:1.1,transDuration:.1},onLoad:function(){function t(){var t=this.getComponent(cc.Button);t&&t.interactable&&n.scaleDownAction&&(this.stopAllActions(),this.runAction(n.scaleDownAction))}function e(){var t=this.getComponent(cc.Button);t&&t.interactable&&n.scaleDownAction&&(this.stopAllActions(),this.runAction(n.scaleUpAction))}var n=this;n.initScale=this.node.scale,n.button=n.getComponent(cc.Button),n.scaleDownAction=cc.scaleTo(n.transDuration,n.pressedScale),n.pressedScale<1&&(n.scaleDownAction=cc.sequence([cc.scaleTo(.02,1.1),n.scaleDownAction])),n.scaleUpAction=cc.scaleTo(n.transDuration,n.initScale),this.node.on(cc.Node.EventType.TOUCH_START,t,this.node),this.node.on(cc.Node.EventType.TOUCH_END,e,this.node),this.node.on(cc.Node.EventType.TOUCH_CANCEL,e,this.node)}}),cc._RFpop()},{}],CardLayoutMauBinh:[function(t,e,n){"use strict";cc._RFpush(e,"2d0f3ucz2BOZZ8n+/b5peEZ","CardLayoutMauBinh");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{imgThuaSapHam:cc.Node,imgThangTrang:cc.Node,lblThangTrang:cc.Label,layoutCard:cc.Node,cardPrefab:cc.Prefab,layoutCardList:{"default":[],type:cc.Node}},onLoad:function(){this._initFirstTime()},createEffectSwapCard:function(){var t=this,e=i.Number.random(0,2),n=i.Number.random(0,2),a=i.Number.random(0,2===e?2:4),s=i.Number.random(0,2===n?2:4);if(e!==n||a!==s){var o=this.layoutCardList[e],r=this.layoutCardList[n];o.getComponent(cc.Layout).enabled=!1,r.getComponent(cc.Layout).enabled=!1,o.parent.getComponent(cc.Layout).enabled=!1;var c=o.children[a],h=r.children[s],u=c.position,l=h.position;if(c&&h){c.zIndex=50,h.zIndex=50;var d=c.parent.convertToWorldSpaceAR(u),m=h.parent.convertToWorldSpaceAR(l);c.runAction(cc.moveTo(.4,c.parent.convertToNodeSpace(m))),h.runAction(cc.sequence(cc.moveTo(.4,h.parent.convertToNodeSpace(d)),cc.callFunc(function(){t.resetPosition()})))}else cc.log("ERROR")}},resetPosition:function(){this._initFirstTime(),this.layoutCard.getComponent(cc.Layout).enabled=!0;for(var t=0,e=0;e<this.layoutCardList.length;e+=1){var n=this.layoutCardList[e];n.getComponent(cc.Layout).enabled=!0;for(var i=0;i<n.children.length;i+=1){var a=n.children[i];a.stopAllActions(),a.position=this.cardPositionList2[t],a.zIndex=i,t+=1}}},reset:function(){this.showBinhLung(!1),this.showAllLayout(),this.resetPosition(),this.foldAllCard(),this.layoutCard.active=!1,this.imgThuaSapHam.active=!1,this.imgThangTrang.active=!1},foldAllCard:function(){for(var t=0;t<this.layoutCardList.length;t+=1)for(var e=this.layoutCardList[t].getComponentsInChildren("CardUI"),n=0;n<e.length;n+=1)e[n].node.stopAllActions(),e[n].node.scale=1,e[n].fold()},showAllLayout:function(){this.layoutCard.active=!0,this.resetPosition();for(var t=0;t<this.layoutCardList.length;t+=1)this.layoutCardList[t].active=!0},showBinhLung:function(t){this._initFirstTime();for(var e=0;e<this.layoutCardList.length;e+=1)for(var n=this.layoutCardList[e],i=0;i<n.children.length;i+=1){var a=n.children[i];a.getComponent("CardUI").showTransparentBlackNode(t)}},getCardPositionList:function(){var t,e,n;for(this.cardPositionList=[],t=0;t<this.layoutCardList.length;t+=1)for(n=this.layoutCardList[t],e=0;e<n.children.length;e+=1){var i=n.children[e],a=i.parent.convertToWorldSpaceAR(i.position);this.cardPositionList.push(a)}return this.cardPositionList},_initFirstTime:function(){if(!this.isInitFirstTime){this.isInitFirstTime=!0,this.node.parent.x>0?(this.layoutCardList[2].x=90,this.node.x=-208,this.imgThangTrang.x=13):(this.node.x=228,this.layoutCardList[2].x=3,this.imgThangTrang.x=-51);var t,e,n,i=0;for(this.cardPositionList2=[],t=0;t<this.layoutCardList.length;t+=1)for(n=this.layoutCardList[t],e=0;e<n.children.length;e+=1){var a=n.children[e];this.cardPositionList2.push(a.position)}for(t=0;t<this.layoutCardList.length;t+=1)n=this.layoutCardList[t],n.removeAllChildren();for(t=0;t<this.layoutCardList.length;t+=1){n=this.layoutCardList[t];var s=2===t?3:5;for(e=0;e<s;e+=1){var o=cc.instantiate(this.cardPrefab);o.setAnchorPoint(.5,.5),o.position=this.cardPositionList2[t],n.addChild(o),i+=1}}this.reset()}}}),cc._RFpop()},{Utils:"Utils"}],CardRank:[function(t,e,n){"use strict";cc._RFpush(e,"20ca1oZOGNLLYrX5YmOdB6I","CardRank");var i=t("Utils");e.exports=i.Class({$$static:i.Object.toConstant({ACE:{ID:0,NAME:"A"},TWO:{ID:1,NAME:"2"},THREE:{ID:2,NAME:"3"},FOUR:{ID:3,NAME:"4"},FIVE:{ID:4,NAME:"5"},SIX:{ID:5,NAME:"6"},SEVEN:{ID:6,NAME:"7"},EIGHT:{ID:7,NAME:"8"},NINE:{ID:8,NAME:"9"},TEN:{ID:9,NAME:"10"},JACK:{ID:10,NAME:"J"},QUEEN:{ID:11,NAME:"Q"},KING:{ID:12,NAME:"K"},findById:function(t){return i.Object.findObject(this,"ID",t)}})}),cc._RFpop()},{Utils:"Utils"}],CardSuit:[function(t,e,n){"use strict";cc._RFpush(e,"65d64rM68RBn7QpNCp5wQu2","CardSuit");var i=t("Utils");e.exports=i.Class({$$static:i.Object.toConstant({SPADE:{ID:0,NAME:"♠"},CLUB:{ID:1,NAME:"♣"},DIAMOND:{ID:2,NAME:"♦"},HEART:{ID:3,NAME:"♥"},findById:function(t){return i.Object.findObject(this,"ID",t)}})}),cc._RFpop()},{Utils:"Utils"}],CardUIPhom:[function(t,e,n){"use strict";cc._RFpush(e,"d981cP0mfxNmIJsBFsyrT8V","CardUIPhom");var i=t("CardUI");cc.Class({"extends":i,properties:{hoverAnNode:cc.Node},onLoad:function(){var t=this;this.isTouched=!1,this.posYFirst=t.node.y,this.hoverAnNode.active=!1,this.DELTA_Y_TOUCHED=70,this.TIME_MOVE_TOUCHED=.1,t.index=t.node.getSiblingIndex(),this.node.on(cc.Node.EventType.TOUCH_START,function(){this.time=Date.now()}),this.interactable=!1,this.canMove=!1,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(this.time-Date.now()<-100&&t.interactable&&t.canMove){t.isMoved=!0,t.node.setSiblingIndex(t.node.parent.childrenCount+1);var n=t.node.parent.convertToNodeSpace(e.getLocation());t.node.x=n.x,t.node.parent.getComponent(cc.Layout).enabled=!1}}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.interactable&&!t.isMoved&&t.onButtonTouch(),t.onEndOrCancelTouch()}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.onEndOrCancelTouch()}),this.node.on("check_chosen_card",function(){})},onEndOrCancelTouch:function(){this.interactable&&this.isMoved&&(this.node.parent.getComponent(cc.Layout).enabled=!0,this.index=Math.round(this.node.x/(this.node.parent.width/this.node.parent.childrenCount)),this.index=this.index>=0?this.index:0,this.node.setSiblingIndex(this.index),this.isMoved=!1,this.time=Date.now())},onButtonTouch:function(t){var e,n=this,i=0;i=t?0:n.TIME_MOVE_TOUCHED,n.node.stopAllActions(),e=this.isTouched?cc.sequence(cc.callFunc(function(){n.isTouched=!0,n.interactable=!1,n.node.setPosition(n.node.x,n.posYFirst+n.DELTA_Y_TOUCHED)}),cc.moveTo(i,0,n.posYFirst),cc.callFunc(function(){n.isTouched=!1,n.interactable=!0,n.node.parent.emit("check_chosen_card")})):cc.sequence(cc.callFunc(function(){n.isTouched=!1,n.node.setPosition(n.node.x,n.posYFirst),n.interactable=!1}),cc.moveTo(i,0,n.posYFirst+n.DELTA_Y_TOUCHED),cc.callFunc(function(){n.isTouched=!0,n.interactable=!0,n.node.parent.emit("check_chosen_card")})),n.node.runAction(e)},setMoveCardUpDown:function(t){var e=this;e.node.stopAllActions(),t?(e.node.setPosition(e.node.x,e.posYFirst),e.node.runAction(cc.moveTo(e.TIME_MOVE_TOUCHED,0,e.posYFirst+e.DELTA_Y_TOUCHED))):(e.node.setPosition(e.node.x,e.posYFirst+e.DELTA_Y_TOUCHED),e.node.runAction(cc.moveTo(e.TIME_MOVE_TOUCHED,0,e.posYFirst)))}}),cc._RFpop()},{CardUI:"CardUI"}],CardUI:[function(t,e,n){"use strict";cc._RFpush(e,"ba14cEhi+RMFo1nKiA0rpMk","CardUI");var i=t("CardRank"),a=t("CardSuit");cc.Class({"extends":cc.Component,properties:{foldNode:cc.Node,unfoldNode:cc.Node,transparentBlackNode:cc.Node,rankLabel:cc.Label,smallSuitImageSprite:cc.Sprite,bigSuitImageSprite:cc.Sprite,bigFaceImageSprite:cc.Sprite,redColor:cc.Color,blackColor:cc.Color,smallSuiteSpriteFrames:{"default":[],type:cc.SpriteFrame},bigSuiteSpriteFrames:{"default":[],type:cc.SpriteFrame},redFaceSpriteFrames:{"default":[],type:cc.SpriteFrame},blackFaceSpriteFrames:{"default":[],type:cc.SpriteFrame}},onLoad:function(){},setCard:function(t){if(this.card=t,t){var e=t.rank,n=t.suit,a=this._isRedCard(t);this.foldNode.active=!1,this.unfoldNode.active=!0,this.rankLabel.string=e.NAME,this.rankLabel.node.color=a?this.redColor:this.blackColor,this.smallSuitImageSprite.spriteFrame=this.smallSuiteSpriteFrames[n.ID],this._isFaceCard(t)?(this.bigSuitImageSprite.node.active=!1,this.bigFaceImageSprite.node.active=!0,this.bigFaceImageSprite.spriteFrame=(a?this.redFaceSpriteFrames:this.blackFaceSpriteFrames)[e.ID-i.JACK.ID]):(this.bigFaceImageSprite.node.active=!1,this.bigSuitImageSprite.node.active=!0,this.bigSuitImageSprite.spriteFrame=this.bigSuiteSpriteFrames[n.ID])}else this.fold()},fold:function(){this.card=null,this.foldNode.active=!0,this.unfoldNode.active=!1},showTransparentBlackNode:function(t){this.transparentBlackNode&&(this.transparentBlackNode.active=t)},_isFaceCard:function(t){var e=t.rank;return e===i.JACK||e===i.QUEEN||e===i.KING},_isRedCard:function(t){var e=t.suit;return e===a.DIAMOND||e===a.HEART},getCard:function(){return this.card},getCardId:function(){return this.card.getId()}}),cc._RFpop()},{CardRank:"CardRank",CardSuit:"CardSuit"}],Card:[function(t,e,n){"use strict";cc._RFpush(e,"dfe3bnW6HtCboi8iPv9kwuU","Card");var i=t("Utils"),a=t("CardRank"),s=t("CardSuit");e.exports=i.Class({$$constructor:function(t,e){this.rank=t,this.suit=e},$$static:{fromId:function(t){var e=Math.floor(t/4),n=t%4,i=a.findById(e),o=s.findById(n);return new this(i,o)}},getId:function(){return 4*this.rank.ID+this.suit.ID},toString:function(){return this.rank.NAME+this.suit.NAME}}),cc._RFpop()},{CardRank:"CardRank",CardSuit:"CardSuit",Utils:"Utils"}],Carousel:[function(t,e,n){"use strict";cc._RFpush(e,"8d86ekUO5hHraDfR+oYg6L+","Carousel"),cc.Class({"extends":cc.Component,properties:{items:{"default":[],visible:!1},autoSlideTime:5,selectEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){var t=this;this.slideTime=0,this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var n=e.getLocation(),i=e.getPreviousLocation();e.stopPropagation(),t._slide(Math.sign(i.x-n.x))})},addItem:function(t,e){var n=this,i=this.node.getChildByName("Contents");this.items.push(t),t.width=i.width,t.height=i.height,e&&(this.currentItem=t,t.x=t.y=0,i.addChild(t)),t.on(cc.Node.EventType.TOUCH_END,function(t){n.slideTime>.3&&n.selectEvents.forEach(function(e){e.emit([t.currentTarget])})},t)},clearAllTimes:function(){this.items=[],this.slideTime=0,this.currentItem=null},_slide:function(t){var e,n=this,i=.5,a=this.currentItem,s=this._getItem(t),o=this.node.getChildByName("Contents");this.isSliding||a&&s&&a!==s&&(n.slideTime=0,n.isSliding=!0,a.stopAllActions(),e=cc.p(-Math.sign(t)*(o.width+a.width+10)/2,0),a.runAction(cc.sequence([cc.moveTo(i,e).easing(cc.easeOut(3)),cc.callFunc(function(){a.removeFromParent(!1)})])),setTimeout(function(){cc.isValid(s)&&(s.stopAllActions(),n.currentItem=s,o.addChild(s),s.x=Math.sign(t)*(o.width+s.width+10)/2,s.y=0,s.runAction(cc.sequence([cc.moveTo(i,cc.p(0,0)).easing(cc.easeOut(3)),cc.callFunc(function(){n.isSliding=!1})])))},i/2))},_getItem:function(t){var e=this.items.indexOf(this.currentItem);return e+t>=this.items.length?this.items[0]:e+t<0?this.items[this.items.length-1]:this.items[e+t]},nextSlide:function(){this._slide(1)},prevSlide:function(){this._slide(-1)},update:function(t){this.slideTime>this.autoSlideTime?(this.slideTime=0,this.nextSlide()):this.slideTime+=t}}),cc._RFpop()},{}],ChangeSpriteAnimation:[function(t,e,n){"use strict";cc._RFpush(e,"d0e3aYsMrtLxqREl76H32Eu","ChangeSpriteAnimation"),cc.Class({"extends":cc.Component,properties:{listSprites:{"default":[],type:cc.Sprite}},onLoad:function(){}}),cc._RFpop()},{}],ChiMauBinh:[function(t,e,n){"use strict";cc._RFpush(e,"e8340j/G3NLr7NWT2Ov8cEe","ChiMauBinh");var i=t("Utils"),a=t("MauBinhConstant");e.exports=i.Class({$$constructor:function(t){this.cards=t.slice(0),this.chi=a.Chi.NONE,this.cardsChi=[],this.cardsInChi=[];for(var e=0;e<3;e+=1)this.cardsChi.push(this.cards.slice(5*e,5*e+(e>=2?3:5))),this.cardsInChi.push(0);this.result=[a.Chi.NONE,a.Chi.NONE,a.Chi.NONE],this._calculateResult()},getResult:function(){return this.result},getCardsNotInChi:function(){var t,e,n=[],a=[],s=[];for(t=0;t<3;t+=1)for(e=0;e<this.cardsChi[t].length;e+=1)this._congQuanAt(this.cardsChi[t][e]),a.push(this.cardsChi[t][e]);for(t=0;t<3;t+=1)for(e=0;e<this.cardsInChi[t].length;e+=1)this._congQuanAt(this.cardsInChi[t][e]),s.push(this.cardsInChi[t][e]);for(t=0;t<a.length;t+=1){var o=!0;for(e=0;e<s.length;e+=1)if(a[t]===s[e]){o=!1;break}o&&i.Array.pushUnique(n,a[t])}return n},isChiThung:function(t){for(var e=this.cardsChi[t],n=e[0]%4,i=1;i<e.length;i+=1)if(n!==e[i]%4)return!1;return this.cardsInChi[t]=e,!0},isChiSanh:function(t){var e=this.cardsChi[t];this.sortCard(e);for(var n=e[0],i=1;i<e.length;i+=1)if(this.getSubRank(n,e[i])!==i)return!1;return this.cardsInChi[t]=e,!0},isChiSanhAt:function(t){var e=this.cardsChi[t];this._congQuanAt(e),this.sortCard(e);for(var n=e[0],i=1;i<e.length;i+=1)if(this.getSubRank(n,e[i])!==i)return!1;return this.cardsInChi[t]=e,!0},isSanhRong:function(){var t=this.cards.slice(0);this.sortCard(t);for(var e=t[0],n=1;n<t.length;n+=1)if(this.getSubRank(e,t[n])!==n)return!1;return!0},isThangTrang:function(){return this.result[0]===a.Chi.LUC_PHE_BON||this.result[0]===a.Chi.BA_CAI_SANH||this.result[0]===a.Chi.BA_CAI_THUNG||this.result[0]===a.Chi.SANH_RONG},isBinhLung:function(){if(this.isThangTrang())return!1;var t=this.result[0].ID<this.result[1].ID||this.result[0].ID<this.result[2].ID||this.result[1].ID<this.result[2].ID;return t||(t=this._tinhBinhLungChiGiongNhau()),t},_congQuanAt:function(t){for(var e=0;e<t.length;e+=1)t[e]<=3&&(t[e]+=52)},_tinhBinhLungChiGiongNhau:function(){for(var t=!1,e=0;e<2;e+=1)for(var n=e+1;n<3&&(t||this.result[e].ID!==this.result[n].ID||!(t=this._tinhBinhLung2ChiGiongNhau(e,n)));n+=1);return t},_tinhBinhLung2ChiGiongNhau:function(t,e){var n=this.cardsInChi[t],i=this.cardsInChi[e],s=!1;if(this.result[t]===a.Chi.CU_LU){var o,r;r=this._getMaxChiCuLu(n),o=this._getMaxChiCuLu(i),r=Math.floor(r/4),o=Math.floor(o/4),s=r<o}else this.result[t]===a.Chi.MAU_THAU?(n=this.cardsChi[t],i=this.cardsChi[e],s=this._tinhBinhLungSoSanhLoaiTruQuanGiongNhau(n,i)):this.result[t]===a.Chi.DOI||this.result[t]===a.Chi.THU?s=this._tinhBinhLungSoSanhLoaiTruQuanGiongNhauChiDOITHU(t,e,this.result[t]):(n=this.cardsInChi[t],i=this.cardsInChi[e],s=this._tinhBinhLungSoSanhLoaiTruQuanGiongNhau(n,i));return s},_tinhBinhLungSoSanhLoaiTruQuanGiongNhau:function(t,e){for(var n,i,a=[],s=[],o=0;;){n=this.getMaxOfArray(t,a),i=this.getMaxOfArray(e,s);var r=Math.floor(n/4),c=Math.floor(i/4);if(r===c&&r!==-1&&(a.push(n),s.push(i)),r!==c||a.length>=t.length||s.length>=e.length||o>=5)break;o+=1}var h=Math.floor(n/4)<Math.floor(i/4);return h},_tinhBinhLungSoSanhLoaiTruQuanGiongNhauChiDOITHU:function(t,e,n){for(var i,s,o,r,c=this.cardsInChi[t],h=this.cardsInChi[e],u=[],l=[],d=0;;){if(o=this.getMaxOfArray(c,u),r=this.getMaxOfArray(h,l),i=Math.floor(o/4),s=Math.floor(r/4),i===s&&i!==-1&&(u.push(o),l.push(r)),i!==s||u.length>=c.length||l.length>=h.length||d>=5)break;d+=1}var m=Math.floor(o/4)<Math.floor(r/4),p=n===a.Chi.DOI?2:4;if(!m&&u.length>=p){for(c=this.cardsChi[t],h=this.cardsChi[e];;){if(o=this.getMaxOfArray(c,u),r=this.getMaxOfArray(h,l),i=Math.floor(o/4),s=Math.floor(r/4),i===s&&i!==-1&&(u.push(o),l.push(r)),i!==s||u.length>=c.length||l.length>=h.length||d>=5)break;d+=1}m=Math.floor(o/4)<Math.floor(r/4)}return m},getMaxOfArray:function(t,e){var n,i,a=[];for(n=0;n<t.length;n+=1){var s=t[n],o=!0;for(i=0;i<e.length;i+=1)if(s===e[i]){o=!1;break}o&&a.push(s)}var r=-1;return a.length>0&&(r=Math.max.apply(null,a)),r},_getMaxChiCuLu:function(t){var e=[],n=[];e.push(t[0]);for(var i=1;i<t.length;i+=1)0===this.getSubRank(e[0],t[i])?e.push(t[i]):n.push(t[i]);var a=3===e.length?e[0]:n[0];return a},_calculateResult:function(){var t,e,n=this.isSanhRong();if(n){for(t=0;t<3;t+=1)this.result[t]=a.Chi.SANH_RONG;return this.result}for(t=0;t<3;t+=1){var i=a.Chi.NONE,s=this.isChiThung(t),o=this.isChiSanh(t);o||(o=this.isChiSanhAt(t)),i=s&&o?a.Chi.THUNG_PHA_SANH:s?a.Chi.THUNG:o?a.Chi.SANH:this._calculateTuQuyCuLuThuDoi(t),i===a.Chi.NONE&&(i=a.Chi.MAU_THAU),this.result[t]=i}var r=a.Chi.NONE;if(this.result[0]===this.result[1]&&this.result[0]===a.Chi.THU&&this.result[2]===a.Chi.DOI){var c=this.getCardsNotInChi();for(t=0;t<c.length-1;t+=1)for(e=t+1;e<c.length;e+=1)if(0===this.getSubRank(c[t],c[e])){r=a.Chi.LUC_PHE_BON;break}}if((this.result[0]!==this.result[1]||this.result[0]!==a.Chi.THUNG||this.result[2]!==a.Chi.THUNG_PHA_SANH&&this.result[2]!==a.Chi.THUNG)&&(this.result[0]!==this.result[2]||this.result[0]!==a.Chi.THUNG||this.result[1]!==a.Chi.THUNG_PHA_SANH&&this.result[1]!==a.Chi.THUNG)&&(this.result[1]!==this.result[2]||this.result[1]!==a.Chi.THUNG||this.result[0]!==a.Chi.THUNG_PHA_SANH&&this.result[0]!==a.Chi.THUNG)||(r=a.Chi.BA_CAI_THUNG),(this.result[0]!==this.result[1]||this.result[0]!==a.Chi.SANH||this.result[2]!==a.Chi.THUNG_PHA_SANH&&this.result[2]!==a.Chi.SANH)&&(this.result[0]!==this.result[2]||this.result[0]!==a.Chi.SANH||this.result[1]!==a.Chi.THUNG_PHA_SANH&&this.result[1]!==a.Chi.SANH)&&(this.result[1]!==this.result[2]||this.result[1]!==a.Chi.SANH||this.result[0]!==a.Chi.THUNG_PHA_SANH&&this.result[0]!==a.Chi.SANH)||(r=a.Chi.BA_CAI_SANH),r!==a.Chi.NONE){for(t=0;t<3;t+=1)this.result[t]=r;return this.result}return this.result[2]!==a.Chi.SANH&&this.result[2]!==a.Chi.THUNG&&this.result[2]!==a.Chi.THUNG_PHA_SANH||(this.result[2]=a.Chi.MAU_THAU,this.cardsInChi[2]=[]),this.result},_calculateTuQuyCuLuThuDoi:function(t){var e=this.getCountEqualsRank(this.cardsChi[t]),n=a.Chi.NONE;switch(e.count){case 0:break;case 1:n=a.Chi.DOI;break;case 2:n=a.Chi.THU;break;case 3:n=a.Chi.SAM;break;case 4:n=a.Chi.CU_LU;break;case 6:n=a.Chi.TU_QUY}return this.cardsInChi[t]=e.cards,n},getCountEqualsRank:function(t){for(var e=0,n=[],a=0;a<t.length-1;a+=1)for(var s=a+1;s<t.length;s+=1)0===this.getSubRank(t[a],t[s])&&(e+=1,i.Array.pushUnique(n,t[a]),i.Array.pushUnique(n,t[s]));return e<=0&&(n=[]),{count:e,cards:n}},getSubRank:function(t,e){var n=Math.abs(Math.floor(t/4)-Math.floor(e/4));return n},sortCard:function(t){for(var e=0;e<t.length-1;e+=1)for(var n=e+1;n<t.length;n+=1)if(t[e]>t[n]){var i=t[e];t[e]=t[n],t[n]=i}}}),cc._RFpop()},{MauBinhConstant:"MauBinhConstant",Utils:"Utils"}],Chip:[function(t,e,n){"use strict";cc._RFpush(e,"4a4d5MPTJBGaZLnYP27NldE","Chip");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{money:0,moneyLabel:cc.Label,activeSprite:cc.Sprite,redChipSpriteFrame:cc.SpriteFrame,greenChipSpriteFrame:cc.SpriteFrame,blueChipSpriteFrame:cc.SpriteFrame,purpleChipSpriteFrame:cc.SpriteFrame},onLoad:function(){},init:function(t,e){this.money=t,this.moneyLabel.string=i.Number.abbreviate(t),e=e||"blue";var n=this.node.getComponent(cc.Sprite);n.spriteFrame=this[e+"ChipSpriteFrame"]},activeSelectChip:function(t){if(this.activeSprite.node.active=t,t){var e=cc.rotateBy(10,360);this.activeSprite.node.runAction(cc.repeatForever(e))}}}),cc._RFpop()},{Utils:"Utils"}],Collapse:[function(t,e,n){"use strict";cc._RFpush(e,"1ccc90t7WlCE7AcqK0dpTHT","Collapse"),cc.Class({"extends":cc.Component,properties:{isShow:!1,targetNode:cc.Node,toggleOnEvents:{"default":[],type:cc.Component.EventHandler},toggleOffEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(){t.toggle()})},toggle:function(){this.isShow=!this.isShow,this.isShow?(this.targetNode.parent.height+=this.targetNode.height,this.targetNode.runAction(cc.scaleTo(.2,1,1))):(this.targetNode.parent.height-=this.targetNode.height,this.targetNode.runAction(cc.scaleTo(.2,1,0))),this.dispatchEvents()},dispatchEvents:function(){this.isShow?this.toggleOnEvents.forEach(function(t){t.emit()}):this.toggleOffEvents.forEach(function(t){t.emit()})}}),cc._RFpop()},{}],ColumnHaiTac:[function(t,e,n){"use strict";cc._RFpush(e,"43343E+YGdLFLSymAca/0af","ColumnHaiTac");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{ItemHaiTacPrefab:cc.Prefab},onLoad:function(){void 0!==this.type&&this.type!==-1||(this.type=0),this.itemList=[],this.node.removeAllChildren();for(var t=0;t<25;t+=1){var e=cc.instantiate(this.ItemHaiTacPrefab),n=i.Number.random(0,6);e.getComponent("ItemHaiTac").setType(this.type,n),this.node.addChild(e),this.itemList.push(e.getComponent("ItemHaiTac"))}}}),cc._RFpop()},{Utils:"Utils"}],ColumnHoaQua:[function(t,e,n){"use strict";cc._RFpush(e,"aebe934YSNEA4/GPDkFeTe1","ColumnHoaQua");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{ItemHoaQuaPrefab:cc.Prefab},onLoad:function(){void 0!==this.type&&this.type!==-1||(this.type=0),this.itemList=[],this.node.removeAllChildren();for(var t=0;t<25;t+=1){var e=cc.instantiate(this.ItemHoaQuaPrefab),n=i.Number.random(0,6);e.getComponent("ItemHoaQua").setType(this.type,n),this.node.addChild(e),this.itemList.push(e.getComponent("ItemHoaQua"))}}}),cc._RFpop()},{Utils:"Utils"}],ColumnInfoMiniPoker:[function(t,e,n){"use strict";cc._RFpush(e,"1a9d5yhIz9Lbb7qtMrPqH+i","ColumnInfoMiniPoker");var i=t("CardUI"),a=t("Card"),s=t("CardRank"),o=t("CardSuit");cc.Class({"extends":cc.Component,properties:{index:0,cardPrefab:{"default":null,type:cc.Prefab},cardFinish:{"default":[],type:cc.Node}},onLoad:function(){this.isReady=!1,this.count=20,this.cardTemp=[],this.cardFirst=0,this.node.y=-94,this.isUpdateCardFinish=!1,this._initFirstCard()},start:function(){this._initDefaultCard()},_initFirstCard:function(){this.node.removeAllChildren();var t=this.randomFromTo(0,11),e=this.randomFromTo(0,3),n=new a(s.findById(t),o.findById(e));this._insertCard(n,!1,!1)},_initDefaultCard:function(){this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){for(var t=0;t<this.count;t+=1){var e=this.randomFromTo(0,11),n=this.randomFromTo(0,3);t===this.count-1&&(e=2*this.index);var i=new a(s.findById(e),o.findById(n));this._insertCard(i,t===this.count-1,0===t)}this.isReady=!0}.bind(this))))},_insertCard:function(t,e,n){var a=cc.instantiate(this.cardPrefab);a.scale=.73,a.position=cc.v2(0,0);var s=a.getComponent(i);s.setCard(t),this.node.addChild(a),e&&this.cardFinish.push(a),n&&(this.cardFirst=a)},updateCardFirst:function(){if(this.cardFirst&&this.cardFinish.length>0&&this.isUpdateCardFinish){var t=this.cardFinish[this.cardFinish.length-1].getComponent(i);this.cardFirst.getComponent(i).setCard(t.card)}},updateCardFinish:function(t){for(var e=0;e<this.cardFinish.length;e+=1){var n=this.cardFinish[e].getComponent(i);n.setCard(t)}this.isUpdateCardFinish=!0},randomFromTo:function(t,e){return Math.floor(Math.random()*(e-t+1))}}),cc._RFpop()},{Card:"Card",CardRank:"CardRank",CardSuit:"CardSuit",CardUI:"CardUI"}],ColumnInfoSlotTayDuKy:[function(t,e,n){"use strict";cc._RFpush(e,"d27aetYW0BLurtLEzbD3dQ9","ColumnInfoSlotTayDuKy"),cc.Class({"extends":cc.Component,properties:{index:0,itemPrefab:{"default":null,type:cc.Prefab},itemFinish:{"default":[],type:cc.Node},itemSprite:{"default":[],type:cc.SpriteFrame}},onLoad:function(){this.isReady=!1,this.count=30,this.itemTemp=[],this.itemFirst=0,this.node.y=-165,this.isUpdateItemFinish=!1,this._initFirstItem()},start:function(){this._initDefaultItem()},_initFirstItem:function(){this.node.removeAllChildren();var t=this.randomFromTo(0,6);this._insertItem(t,!1,!1)},_initDefaultItem:function(){this.node.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){for(var t=0;t<this.count;t+=1){var e=this.randomFromTo(0,6);t===this.count-1&&(e=2*this.index),this._insertItem(e,t===this.count-1,0===t)}this.isReady=!0}.bind(this))))},_insertItem:function(t,e,n){var i=cc.instantiate(this.itemPrefab);i.position=cc.v2(0,0);var a=i.getComponent(cc.Sprite);a.spriteFrame=this.itemSprite[t],this.node.addChild(i),e&&this.itemFinish.push(i),n&&(this.itemFirst=i)},randomFromTo:function(t,e){return Math.floor(Math.random()*(e-t+1))}}),cc._RFpop()},{}],ColumnMyNhan:[function(t,e,n){"use strict";cc._RFpush(e,"79d53b75HFIIZCniGQpHoR+","ColumnMyNhan");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{itemMyNhanPrefab:cc.Prefab},onLoad:function(){void 0!==this.type&&this.type!==-1||(this.type=0),this.itemList=[],this.node.removeAllChildren();for(var t=0;t<25;t+=1){var e=cc.instantiate(this.itemMyNhanPrefab),n=i.Number.random(0,6);e.getComponent("ItemMyNhan").setType(this.type,n),this.node.addChild(e),this.itemList.push(e.getComponent("ItemMyNhan"))}}}),cc._RFpop()},{Utils:"Utils"}],CommonConstant:[function(t,e,n){"use strict";cc._RFpush(e,"6743e6G6KBPpKG+bVp9W/MM","CommonConstant");var i=t("Utils");e.exports={Scene:{HALL:"Hall",LOBBY:"Lobby",SPLASH:"Splash",PROFILE:"Profile"},CurrencyType:{Ip:{ID:0,NAME:"IP",DISPLAY_NAME:"Vgold",CHIP_NAME:"V",CHIP_COLOR:new cc.Color(255,241,0),REGEX:/\b(pi|ip)\b/gi},Xu:{ID:1,NAME:"XU",DISPLAY_NAME:"Xu",CHIP_NAME:"Xu",CHIP_COLOR:new cc.Color(238,238,238),REGEX:/\bxu\b/gi},findById:function(t){return i.Object.findObject(this,"ID",t)},findByName:function(t){return i.Object.findObject(this,"NAME",t)},normalize:function(t,e){return e=e||i.String.CaseType.NONE,[this.Ip,this.Xu].forEach(function(n){var a=i.String.changeCase(n.DISPLAY_NAME,e);t=t.replace(n.REGEX,a)}),t}},PushMessageType:{MESSAGE:{ID:0,EVENT:"push_message.temporary_message"},POPUP:{ID:1,EVENT:"push_message.popup"},RUNNING:{ID:2,EVENT:"push_message.running"},TAT_TN:{ID:3,EVENT:"push_message.tat_tn"},UPDATE_USER_INFO:{ID:4,EVENT:"push_message.update_user_info"},findById:function(t){return i.Object.findObject(this,"ID",t)}},ZINDEX:{MINIGAME_QUICK_ICON:1e6,MINIGAME_POPUP:1e6,MINIGAME_PREFAB:1e6,WARNING_MESSAGE:1000001,MODAL:1000002}},cc._RFpop()},{Utils:"Utils"}],ConfirmModal:[function(t,e,n){"use strict";cc._RFpush(e,"42b8aQ6oU9FkqttVpwXGoDR","ConfirmModal"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},okeCallback:function(){},cancelCallback:function(){}}),cc._RFpop()},{}],CurrencyChanger:[function(t,e,n){"use strict";cc._RFpush(e,"1f47eh2Mv1J3Y+MLUN/u5HH","CurrencyChanger");var i=t("CommonConstant"),a=t("Utils");cc.Class({"extends":cc.Component,properties:{"case":{"default":a.String.CaseType.NONE,type:a.String.CaseType}},onLoad:function(){this.formatStr()},formatStr:function(){var t,e=this.node.getComponent(cc.Label);return!!e.string&&(t=i.CurrencyType.normalize(e.string,this["case"]),e.string=t,!0)}}),cc._RFpop()},{CommonConstant:"CommonConstant",Utils:"Utils"}],CurrencyChip:[function(t,e,n){"use strict";cc._RFpush(e,"68261LeWSFIcLifW93vNFdw","CurrencyChip");var i=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{currency:{type:cc.Enum({IP:i.CurrencyType.Ip.ID,XU:i.CurrencyType.Xu.ID}),"default":i.CurrencyType.Ip.ID}},onLoad:function(){var t=this.node.getComponent(cc.Label),e=i.CurrencyType.findById(this.currency);t.string=e.CHIP_NAME,this.node.color=e.CHIP_COLOR}}),cc._RFpop()},{CommonConstant:"CommonConstant"}],DaiLy:[function(t,e,n){"use strict";cc._RFpush(e,"d0b19+YHd5LCplPMDgfb0qs","DaiLy");var i=t("Url"),a=t("Utils"),s=t("TabView"),o=t("AuthUser"),r=t("DropDown"),c=t("UiManager"),h=t("NetworkManager"),u=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{userNameEditBox:cc.EditBox,amountEditBox:cc.EditBox,noteEditBox:cc.EditBox,currencyDropDown:r,daiLyTabView:s,itemDaiLyPrefab:cc.Prefab,daiLyContainerNode:cc.Node,feeLabel:cc.Label,soDuLabel:cc.Label,infoRichText:cc.RichText,itemLichSuPrefab:cc.Prefab,lichSuChuyenPiContainerNode:cc.Node},onLoad:function(){},updateSoDu:function(){var t=this.currencyDropDown.getSelectedItem();this.soDuLabel.string=a.Number.format(o.currencies[t.value].balance)+" "+t.label},loadContentTransfer:function(){var t=this;t.infoRichText.string="",t.feeLabel.string="0%.",t.clearChuyenPiForm(),h.Http.fetch("GET",i.Http.TRANSFER,{username:o.username,accesstoken:o.accesstoken},{cache:1800}).success(function(e){var n=e.data;t.feeLabel.string=100*n.fee+"%",t.infoRichText.string=u.CurrencyType.normalize(n.note),t.currencyDropDown.clearAllItems();for(var i=0;i<n.currencies.length;i+=1)t.currencyDropDown.addItem({value:n.currencies[i],label:u.CurrencyType.findByName(n.currencies[i]).DISPLAY_NAME},0===i);t.updateSoDu()})},clearChuyenPiForm:function(){this.amountEditBox.string="",this.noteEditBox.string=""},chuyenPi:function(t){var e=this,n=parseInt(this.amountEditBox.string),a=this.currencyDropDown.getSelectedItem();return this.userNameEditBox.string&&this.noteEditBox.string?n?void(a&&h.Http.fetch("POST",i.Http.TRANSFER,{from_user:o.username,accesstoken:o.accesstoken,to_user:this.userNameEditBox.string,
amount:this.amountEditBox.string,note:this.noteEditBox.string,currency:a.value}).success(function(){c.openModal("Xin chúc mừng, bạn đã chuyển tiền thành công."),e.daiLyTabView.activeByName("LichSu"),e.clearChuyenPiForm()}).setWaitingButton(t.target)):c.openModal("Xin vui lòng nhập số tiền hợp lệ."):c.openModal("Xin vui lòng nhập đầy đủ thông tin.")},getLichSuChuyenPi:function(){var t=this;h.Http.fetch("GET",i.Http.TRANSFER_LOG,{username:o.username,accesstoken:o.accesstoken}).success(function(e){var n,i,s,o,r,c,h,l=e.data.items;for(t.lichSuChuyenPiContainerNode.removeAllChildren(),i=0;i<l.length;i+=1)n=cc.instantiate(t.itemLichSuPrefab),s=l[i].created_time.replace(" ","\n"),h=u.CurrencyType.findByName(l[i].currency).DISPLAY_NAME,o=a.Number.format(l[i].amount)+" "+h,c=l[i].note,n.with_acc=r=l[i].with_acc,n.getComponent("RowTable").updateData(s,o,r,c),n.on(cc.Node.EventType.TOUCH_END,function(){t.daiLyTabView.activeByName("ChuyenPi"),t.userNameEditBox.string=this.with_acc}),t.lichSuChuyenPiContainerNode.addChild(n)})},getDaiLyInfo:function(){var t=this;h.Http.fetch("GET",i.Http.DAILY_LIST,{},{cache:1800,delay:500}).success(function(e){var n=e.data;t.daiLyContainerNode.removeAllChildren();for(var i=0;i<n.length;i+=1)t.daiLyContainerNode.addChild(t._initDaiLyNode(n[i]))})},_initDaiLyNode:function(t){var e,n=this,i=cc.instantiate(this.itemDaiLyPrefab);return i.getComponent("RowTable").updateData(t.display_name,t.username,t.mobile,t.address),e=i.getComponent("ItemDaiLy"),e.updateData(t),e.chuyenPi=function(){n.userNameEditBox.string=t.username,n.daiLyTabView.activeByName("ChuyenPi")},i}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",DropDown:"DropDown",NetworkManager:"NetworkManager",TabView:"TabView",UiManager:"UiManager",Url:"Url",Utils:"Utils"}],DoiThe:[function(t,e,n){"use strict";cc._RFpush(e,"3821505thtIJpI/z62uUf8w","DoiThe");var i=t("Url"),a=t("Utils"),s=t("TabView"),o=t("AuthUser"),r=t("DropDown"),c=t("UiManager"),h=t("CommonConstant"),u=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{itemMenhGiaPrefab:cc.Prefab,contentMenhGiaNode:cc.Node,doiTheTabView:s,lichSuDoiTabView:s,loaiTheDropDown:r,menhGiaDropDown:r,giaBanLabel:cc.Label},onLoad:function(){this.getCardsInfo()},getCardsInfo:function(){var t=this;u.Http.fetch("GET",i.Http.DOI_THUONG_GET_CARD_INFO,{},{cache:1800,delay:500}).success(function(e){t.cards=e.data,t.loaiTheDropDown.clearAllItems();for(var n=0;n<t.cards.length;n+=1)t.loaiTheDropDown.addItem(t.cards[n].name,!(n>0));t.updateMenhGia()})},updateMenhGia:function(){var t,e,n,i,s,o,r=this.loaiTheDropDown.getSelectedItem();if(this.cards)for(n=0;n<this.cards.length;n+=1)if(e=this.cards[n],e.name===r){for(this.currentCard=e,this.menhGiaDropDown.clearAllItems(),this.contentMenhGiaNode.removeAllChildren(),i=0;i<e.amounts.length;i+=1)s=e.amounts[i],o=this.getGiaThe(s,e),s=a.Number.format(s)+" VND",this.menhGiaDropDown.addItem(e.amounts[i],!(i>0)),t=cc.instantiate(this.itemMenhGiaPrefab),t.getComponent("RowTable").updateData(s,o),this.contentMenhGiaNode.addChild(t);this.updateGiaDoiThe()}},updateGiaDoiThe:function(){this.currentCard&&(this.giaBanLabel.string="Giá bán: "+this.getGiaThe(this.menhGiaDropDown.getSelectedItem(),this.currentCard))},getGiaThe:function(t,e){var n=t*e.exchange_rate;return a.Number.format(n)+" "+h.CurrencyType.findByName(this.currentCard.currency).DISPLAY_NAME},confirmGetCard:function(t){var e=this;return this.currentCard?void u.Http.fetch("POST",i.Http.DOI_THUONG_GET_CARD,{username:o.username,accesstoken:o.accesstoken,card_type:this.currentCard.name,amount:this.menhGiaDropDown.getSelectedItem()}).success(function(t){var n=t.data;c.openModal("Xin chúc mừng, bạn đã rút thành công thẻ "+n.card_type+" mệnh giá "+n.card_amount+"\nPin: "+n.card_pin+"\nSerial: "+n.card_serial),e.doiTheTabView.activeByName("LichSu"),e.lichSuDoiTabView.activeByName("LsDoiThe")}).setWaitingButton(t.target):c.openModal("Xin vui lòng chọn loại thẻ cào để đổi thưởng.")}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",DropDown:"DropDown",NetworkManager:"NetworkManager",TabView:"TabView",UiManager:"UiManager",Url:"Url",Utils:"Utils"}],DropDown:[function(t,e,n){"use strict";cc._RFpush(e,"88108TZBmtA2aItSoFka06a","DropDown"),cc.Class({"extends":cc.Component,properties:{itemFontSize:20,itemLineHeight:60,selectEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){var t=this;this.itemContainer=this.node.getChildByName("ContentDrop"),this.itemContainer.active=!1,this.node.on(cc.Node.EventType.TOUCH_START,function(){t.openDropDown()})},addItem:function(t,e){var n=this,i=new cc.Node,a=i.addComponent(cc.Label),s=this.node.getChildByName("ContentDrop"),o=t.label?t.label:t;a.string=o,a.fontSize=this.itemFontSize,a.lineHeight=this.itemLineHeight,a.overflow=cc.Label.Overflow.SHRINK,a.verticalAlign=cc.Label.VerticalAlign.CENTER,a.horizontalAlign=cc.Label.HorizontalAlign.CENTER,i.width=s.width,i.height=this.itemLineHeight,e&&(this.getLabel().string=o,this.currentSelected=t),i.on(cc.Node.EventType.TOUCH_START,function(e){var i=n.getLabel();i.string!==o&&(n.getLabel().string=o,n.currentSelected=t,n.selectEvents.forEach(function(e){e.emit([t])}),e.bubbles=!1)}),s.addChild(i)},clearAllItems:function(){this.node.getChildByName("ContentDrop").removeAllChildren(),this.getLabel().string=""},closeDropdown:function(){var t=this.itemContainer;t.active&&t.runAction(cc.sequence([cc.scaleTo(.1,1,0),cc.callFunc(function(){t.active=!1})]))},openDropDown:function(){var t,e=this,n=this.itemContainer;n.active||(n.active=!0,n.runAction(cc.scaleTo(.1,1,1)),t=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(){cc.eventManager.removeListener(t),e.closeDropdown()}}),setTimeout(function(){cc.eventManager.addListener(t,-9e9)}))},getSelectedItem:function(){return this.currentSelected},getLabel:function(){return this.node.getChildByName("LblDrop").getComponent(cc.Label)}}),cc._RFpop()},{}],EffectAvatar:[function(t,e,n){"use strict";cc._RFpush(e,"8121aNQst5JppDFG1lPUfox","EffectAvatar"),cc.Class({"extends":cc.Component,properties:{radius:45,timeRotate:3,particleNode:cc.Node},onLoad:function(){this.run=!1,this.time=0,this.isIncrease=!0},update:function(t){if(this.time>=.01&&!this.run){this.time=0,this.run=!0;var e=this.particleNode.getComponent(cc.ParticleSystem);e&&e.resetSystem()}this.isIncrease&&(this.time+=t/this.timeRotate),this.time>=1&&(this.time=0);var n=this.time<.5?1:-1,i=this.radius*Math.cos(2*Math.PI*this.time),a=n*Math.sqrt(this.radius*this.radius-i*i);this.particleNode.position=cc.v2(i,a)}}),cc._RFpop()},{}],EffectThangTrang:[function(t,e,n){"use strict";cc._RFpush(e,"0c9a42yfl1CQoqG/sbX7QRt","EffectThangTrang");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{imgLeft:cc.Node,imgRight:cc.Node,scaleEffect:1.75,timeDelayEffect:.3,imgEffect:{type:cc.Node,"default":[]}},onLoad:function(){if(this.time=0,this.direction=!1,this.imgLeft&&this.imgRight){this.size=this.node.getContentSize();var t=this.imgRight.getContentSize(),e=this.size.width/2-t.width/2;this.imgLeft.x=-this.size.width/2,this.imgRight.x=this.size.width/2,this.imgLeft.opacity=0,this.imgLeft.runAction(cc.fadeIn(.1));var n=cc.repeatForever(cc.sequence(cc.moveTo(4,cc.v2(e,this.imgLeft.y)),cc.callFunc(function(){this.imgLeft.x=-e,this.imgLeft.opacity=0,this.imgLeft.runAction(cc.fadeIn(.1)),this.imgLeft.runAction(cc.sequence(cc.delayTime(3),cc.fadeOut(.8)))}.bind(this))));this.imgRight.opacity=0,this.imgRight.runAction(cc.fadeIn(.1));var i=cc.repeatForever(cc.sequence(cc.moveTo(4,cc.v2(-e,this.imgRight.y)),cc.callFunc(function(){this.imgRight.x=e,this.imgRight.opacity=0,this.imgRight.runAction(cc.fadeIn(.1)),this.imgRight.runAction(cc.sequence(cc.delayTime(3),cc.fadeOut(.8)))}.bind(this))));if(this.imgLeft.runAction(n),this.imgLeft.runAction(cc.sequence(cc.delayTime(3),cc.fadeOut(.8))),this.imgRight.runAction(i),this.imgRight.runAction(cc.sequence(cc.delayTime(3),cc.fadeOut(.8))),this.imgEffect.length>0)for(var a=0;a<this.imgEffect.length;a+=1)this.imgEffect[a].active=!1}var s=this.node.getComponentInChildren(cc.Label);s&&s.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(this.timeDelayEffect/2,1.03),cc.scaleTo(this.timeDelayEffect/2,1))))},update:function(t){this.time+=t,this.imgEffect.length>0&&this.time>this.timeDelayEffect&&(this.time=0,this.direction=!this.direction,this.spawnEffect(!0),this.spawnEffect(!1))},spawnEffect:function(t){var e=0===i.Number.random(0,1)?1:-1,n=i.Number.random(0,this.imgEffect.length-1),a=this.imgEffect[n],s=cc.instantiate(a);s.active=!0,s.scale=this.scaleEffect,s.position=cc.v2(0,0),s.runAction(cc.sequence(cc.moveTo(1.8,cc.v2(t?-this.size.width/2:this.size.width/2,0)).easing(cc.easeCircleActionOut()),cc.callFunc(function(){s.destroy()}.bind(this)))),s.opacity=0,s.runAction(cc.sequence(cc.fadeTo(.3,200),cc.fadeOut(1))),s.runAction(cc.rotateBy(3,360*e)),this.node.addChild(s)}}),cc._RFpop()},{Utils:"Utils"}],EventDispatcherConstant:[function(t,e,n){"use strict";cc._RFpush(e,"5857djSnRBJPoY5L9abnbQv","EventDispatcherConstant"),e.exports={PROFILE:{UPDATE_INFO:"profile.update_info",UPDATE_AVATAR:"profile.update_avatar",UPDATE_MONEY:"profile.update_money",UPDATE_EXP:"profile.update_exp",UPDATE_UNREAD_MESS_COUNT:"profile.update_unread_mess_count"},AUTH:{LOGIN:"auth.login",LOGOUT:"auth.logout"},TINH_NANG:{NEW:"tinhnang.new"},GAME:{UPDATE_LIST:"game.update_list"}},cc._RFpop()},{}],EventDispatcher:[function(t,e,n){"use strict";cc._RFpush(e,"54450XUcsBEDa+4eG9Ot5J2","EventDispatcher");var i,a,s,o=t("Utils");i=o.Class({$$constructor:function(){this.clear()},clear:function(){this.eventListeners={}},addEventListener:function(t,e,n){if(o.Type.isUndefined(t))throw"Event name must be defined";if(o.Type.isFunction(e)){var i={listener:e,scope:n};return this.eventListeners[t]=this.eventListeners[t]||[],this.eventListeners[t].push(i),i}},removeEventListener:function(t,e,n){o.Type.isFunction(e)&&(this.eventListeners[t]=this.eventListeners[t]||[],o.Array.remove(this.eventListeners[t],{listener:e,scope:n}))},dispatchEvent:function(t,e){var n=this.eventListeners[t]||[];o.Array.forEach(n,function(t){try{this._execute(t,e)}catch(n){cc.error(n)}}.bind(this))},_execute:function(t,e){var n=t.listener,i=t.scope;try{i?n.call(i,e):n(e)}catch(a){cc.error(a)}}}),a=o.Class({$$extends:i,$$constructor:function(t){this.$super.constructor.call(this),this.limit=t||0},clear:function(){this.$super.clear.call(this),this.events=[]},pushEvent:function(t,e){this.limit>0&&o.Array.trimLeft(this.events,this.limit),this.events.push({eventName:t,obj:e,time:Date.now()})},popEvent:function(){return this.events.shift()},dispatchEvents:function(t){var e=this.events.splice(0),n=this;e.forEach(function(e){o.Type.isFunction(t)&&!t(e)||n.dispatchEvent(e.eventName,e.obj)})}}),s=o.Class({$$extends:i,$$constructor:function(t){this.$super.constructor.call(this),this._setCache(t)},clear:function(){this.$super.clear.call(this),this.clearCache()},clearCache:function(){this.cacheEvents=[]},disableCache:function(){this._setCache(!1)},enableCache:function(){this._setCache(!0)},_setCache:function(t){this.cache=t,this.clearCache()},addEventListener:function(t,e,n){var i=this.$super.addEventListener.call(this,t,e,n);i&&this.cache&&this.cacheEvents&&o.Array.forEach(this.cacheEvents,function(e){e&&e.eventName===t&&this._execute(i,e.obj)}.bind(this))},dispatchEvent:function(t,e){this.$super.dispatchEvent.call(this,t,e),this.cache&&this.cacheEvents.push({eventName:t,obj:e})},create:function(t){return new s(t)},createStackEventDispatcher:function(t){return new a(t)}}),e.exports=new s,cc._RFpop()},{Utils:"Utils"}],Event:[function(t,e,n){"use strict";cc._RFpush(e,"26b2ccmaaVO1aC2Bdb8uzg2","Event");var i=t("NetworkManager"),a=t("Url");cc.Class({"extends":cc.Component,properties:{itemEventDetailPrefab:cc.Prefab,eventContainerNode:cc.Node,eventItemPrefab:cc.Prefab,openEventId:{"default":null,visible:!1}},onLoad:function(){this.fetchEventList(),this.itemEventDetailNode=cc.instantiate(this.itemEventDetailPrefab)},fetchEventList:function(){var t=this;i.Http.fetch("GET",a.Http.EVENT_LIST,{},{cache:900,delay:500}).success(function(e){var n=e.data,i=Number.parseInt(t.openEventId);t.eventContainerNode.removeAllChildren();for(var a=0;a<n.length;a+=1)t._initEventNode(n[a]),i===n[a].event_id&&t._openEventItem(n[a])})},_initEventNode:function(t){var e=this,n=cc.instantiate(this.eventItemPrefab);n.getComponent("ItemEvent").updateData(t),this.eventContainerNode.addChild(n),n.on(cc.Node.EventType.TOUCH_END,function(){e._openEventItem(t)})},_openEventItem:function(t){var e=this;e.eventContainerNode.parent.addChild(e.itemEventDetailNode);var n=e.itemEventDetailNode.getComponent("ItemEvent");n.updateData(t),n.closeDetailMessage=function(){e.itemEventDetailNode.runAction(cc.sequence([cc.fadeOut(.1),cc.callFunc(function(){e.itemEventDetailNode.removeFromParent(!1)})]))},e.itemEventDetailNode.runAction(cc.fadeIn(.1))}}),cc._RFpop()},{NetworkManager:"NetworkManager",Url:"Url"}],FacebookInteract:[function(t,e,n){"use strict";cc._RFpush(e,"01da0qZlPNJ2ra45COU1rV6","FacebookInteract");var i=t("Url"),a=t("AuthUser"),s=t("UiManager"),o=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{shareFacebookNoteLabel:cc.Label,inviteFacebookNoteLabel:cc.Label,likeFacebookNode:cc.Node},onLoad:function(){this.loadFacebookSdk()},loadFacebookSdk:function(){var t=this;if(document.getElementById("fb-root"))t.getShareFacebookInfo();else{var e=document.createElement("div"),n=document.createElement("script");e.id="fb-root",n.id="facebook-jssdk",n.src="//connect.facebook.net/en_US/all.js",document.body.appendChild(e),document.body.appendChild(n),window.fbAsyncInit=function(){t.getShareFacebookInfo()}}},getShareFacebookInfo:function(){var t=this;t.shareFacebookInfo||o.Http.fetch("GET",i.Http.SHARE_FACEBOOK,{username:a.username,accesstoken:a.accesstoken},{delay:500}).success(function(e){var n=t.likeFacebookNode.getComponent("FacebookLike");window.FB.init({appId:e.data.app_id,status:!0,cookie:!0,xfbml:!0,frictionlessRequests:!0}),t.shareFacebookInfo=e.data,t.shareFacebookNoteLabel.string=e.data.note,t.inviteFacebookNoteLabel.string=e.data.invite_friend.note,n.initLikeButton(e.data.like_link),n.onDisable()})},confirmShareFacebook:function(t){this.shareFacebookInfo&&window.FB.ui({method:"feed",name:this.shareFacebookInfo.title,link:this.shareFacebookInfo.share_link,picture:this.shareFacebookInfo.image_link,caption:this.shareFacebookInfo.title,description:this.shareFacebookInfo.comment,message:""},function(e){e&&e.post_id&&o.Http.fetch("POST",i.Http.SHARE_FACEBOOK,{username:a.username,accesstoken:a.accesstoken},{}).setWaitingButton(t.target)})},confirmSendInviteFacebook:function(t){this.shareFacebookInfo&&window.FB.ui({method:"apprequests",message:this.shareFacebookInfo.invite_friend.msg},function(e){e&&e.to&&o.Http.fetch("POST",i.Http.INVITE_FACEBOOK,{username:a.username,accesstoken:a.accesstoken,request_id:e.request,recipient_ids:e.to.join(",")},{}).success(function(t){s.openModal(t.msg)}).setWaitingButton(t.target)})}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],FacebookLike:[function(t,e,n){"use strict";cc._RFpush(e,"e2781d+6NZJR6WSNpZEofY1","FacebookLike"),cc.Class({"extends":cc.Component,properties:{btnLike:cc.Node,lblInfo:cc.Node},onLoad:function(){var t=cc.sys.os===cc.sys.OS_ANDROID||cc.sys.os===cc.sys.OS_IOS;this.btnLike.active=t,this.lblInfo.active=t},initLikeButton:function(t){var e,n,i=document.getElementById("FacebookLikeContainer"),a=document.createElement("iframe"),s=document.getElementById("GameDiv"),o=s.getBoundingClientRect(),r=this.node.getBoundingBoxToWorld(),c=s.offsetHeight/cc.winSize.height,h=250,u=80;i||(i=document.createElement("div"),a.src="https://www.facebook.com/plugins/like.php?href="+encodeURIComponent(t)+"&width="+h+"&height="+u+"&layout=standard&action=like&size=large&show_faces=true&share=false",a.style.cssText="border:none; overflow:hidden;",n=this.node.height*c/u*.8,a.style.cssText+="transform-origin: center;transform: scale("+n.toFixed(1)+");",a.width=h,a.height=u,a.scrolling="no",a.frameborder=0,a.allowTransparency=!0,e=s.offsetHeight+o.top-(r.center.y*c+u/2),i.style.cssText="position: absolute;width: 100%;text-align: center;top: "+e+"px;",i.id="FacebookLikeContainer",i.appendChild(a),document.body.appendChild(i))},onEnable:function(){var t=document.getElementById("FacebookLikeContainer");t&&(t.style.display="block")},onDisable:function(){var t=document.getElementById("FacebookLikeContainer");t&&(t.style.display="none")},onLikeClick:function(){}}),cc._RFpop()},{}],GameConstant:[function(t,e,n){"use strict";cc._RFpush(e,"39c9c/r9+VKkY8+M95js1tS","GameConstant");var i=t("Utils"),a={LOBBY:{NAME:"Hall",SCENE:"Lobby"},BA_CAY:{ID:5,NAME:"Ba Cây",CMD:"BaCay",HAS_LOBBY:!0,SCENE:"GameplayBaCay",ICON:"IconGameBaCay",LOG:!1,VISIBLE_SLOTS:7,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},MY_NHAN:{ID:26,NAME:"Mỹ Nhân",CMD:"MyNhan",HAS_LOBBY:!0,IS_SLOT:!0,LOBBY_SCENE:"LobbyMyNhan",SCENE:"GameplayMyNhan",GAME_MANAGER:"MyNhanGameManager",LOG:!1,VISIBLE_SLOTS:1,TOP_PANEL_IN_GAME:{ENABLE:!1,REGISTER_QUIT_GAME:!0,CHAT:!0}},HAI_TAC:{ID:27,NAME:"Hải Tặc",CMD:"HaiTac",HAS_LOBBY:!0,IS_SLOT:!0,LOBBY_SCENE:"LobbyHaiTac",SCENE:"GameplayHaiTac",GAME_MANAGER:"HaiTacGameManager",LOG:!1,VISIBLE_SLOTS:1,TOP_PANEL_IN_GAME:{ENABLE:!1,REGISTER_QUIT_GAME:!0,CHAT:!0}},HOA_QUA:{ID:28,NAME:"Slot 777",CMD:"HoaQua",HAS_LOBBY:!0,IS_SLOT:!0,LOBBY_SCENE:"LobbySlotHoaQua",SCENE:"GameplaySlotHoaQua",GAME_MANAGER:"HoaQuaGameManager",LOG:!1,VISIBLE_SLOTS:1,TOP_PANEL_IN_GAME:{ENABLE:!1,REGISTER_QUIT_GAME:!0,CHAT:!0}},MAU_BINH:{ID:16,NAME:"Mậu Binh",CMD:"MauBinh",HAS_LOBBY:!0,SCENE:"GameplayMauBinh",GAME_MANAGER:"MauBinhGameManager",ICON:"IconGameMauBinh",LOG:!1,BUY_MONEY:!0,VISIBLE_SLOTS:4,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},MINI_POKER:{ID:8,NAME:"MiniPoker",CMD:"MiniPoker",HAS_LOBBY:!1,IS_MINIGAME:!0,MINIGAME_PREFAB:"games/mini_poker/MiniGameMiniPoker",GAME_MANAGER:"MiniPokerGameManager",ICON:"IconGameMiniPoker",LOG:!1,ALONE:!0,VISIBLE_SLOTS:1,MAX_COMMANDS_PER_MATCH:20,WARNING_MESSAGE_DURATION:1},TAY_DU_KY:{ID:24,NAME:"TayDuKy",CMD:"TayDuKy",HAS_LOBBY:!1,IS_MINIGAME:!0,MINIGAME_PREFAB:"games/tay_du_ky/TayDuKySlot",GAME_MANAGER:"TayDuKyGameManager",ICON:"IconGameTayDuKy",LOG:!1,ALONE:!0,VISIBLE_SLOTS:1,MAX_COMMANDS_PER_MATCH:20,WARNING_MESSAGE_DURATION:1},TAM_QUOC:{ID:25,NAME:"TamQuoc",CMD:"TamQuoc",HAS_LOBBY:!1,IS_MINIGAME:!0,MINIGAME_PREFAB:"games/tam_quoc/TamQuocSlot",GAME_MANAGER:"TamQuocGameManager",ICON:"IconGameTamQuoc",LOG:!1,ALONE:!0,VISIBLE_SLOTS:1,MAX_COMMANDS_PER_MATCH:20,WARNING_MESSAGE_DURATION:1},VONG_QUAY:{ID:22,NAME:"Vòng quay may mắn",CMD:"TripleWheel",HAS_LOBBY:!1,IS_MINIGAME:!0,MINIGAME_PREFAB:"games/vong_quay/MiniGameVongquay",GAME_MANAGER:"VongQuayGameManager",ICON:"IconGameVongQuay",LOG:!1,ALONE:!0,VISIBLE_SLOTS:1,MAX_COMMANDS_PER_MATCH:20,WARNING_MESSAGE_DURATION:1,AUTO_JOIN:!0},XO_SO:{ID:12,NAME:"Xổ số",HAS_LOBBY:!1,IS_MINIGAME:!0,MINIGAME_PREFAB:"games/xo_so/MiniGameXoSo",ICON:"IconGameXoSo"},TAI_XIU:{ID:7,NAME:"Tài xỉu",CMD:"TaiXiu",HAS_LOBBY:!1,IS_MINIGAME:!0,MINIGAME_PREFAB:"games/tai_xiu/MiniGameTaiXiu",GAME_MANAGER:"TaiXiuGameManager",ICON:"IconGameTaiXiu",LOG:!1,ALONE:!0,MAX_COMMANDS_PER_MATCH:10,WARNING_MESSAGE_DURATION:1},XITO:{ID:23,NAME:"Xì tố",CMD:"XiTo",HAS_LOBBY:!0,GAME_OPTION_MODAL_PREFAB:"games/xito/XiToOptionModal",SCENE:"GameplayXito",GAME_MANAGER:"XiToGameManager",ICON:"IconGameXiTo",LOG:!1,BUY_MONEY:!0,VISIBLE_SLOTS:5,MAX_COMMANDS_PER_MATCH:100,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},XOC_DIA:{ID:2,NAME:"Xóc đĩa",CMD:"XocDia",HAS_LOBBY:!0,SCENE:"GameplayXocDia",GAME_MANAGER:"XocDiaGameManager",ICON:"IconGameXocDia",LOG:!1,VISIBLE_SLOTS:8,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},BAU_CUA:{ID:3,NAME:"Bầu cua",CMD:"BauCua",HAS_LOBBY:!0,SCENE:"GameplayBauCua",ICON:"IconGameBauCua",GAME_MANAGER:"BauCuaGameManager",LOG:!1,VISIBLE_SLOTS:9,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},SAN_THUONG:{ID:6,NAME:"Săn thưởng",CMD:"ChickenFeed",HAS_LOBBY:!1,SCENE:"GameplaySanThuong",GAME_MANAGER:"SanThuongGameManager",ICON:"IconGameSanThuong",LOG:!1,VISIBLE_SLOTS:1,MAX_COMMANDS_PER_MATCH:20,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!1,CHAT:!1}},ROULTE:{ID:4,NAME:"Roulette",CMD:"Roulette",HAS_LOBBY:!0,SCENE:"GameplayRoulette",GAME_MANAGER:"RouletteGameManager",ICON:"IconGameRoulette",LOG:!1,VISIBLE_SLOTS:8,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},PHOM:{ID:19,NAME:"Phỏm",CMD:"Phom",HAS_LOBBY:!0,GAME_OPTION_MODAL_PREFAB:"games/phom/PhomOptionModal",SCENE:"GameplayPhom",ICON:"IconGamePhom",GAME_MANAGER:"PhomGameManager",LOG:!1,VISIBLE_SLOTS:4,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},LIENG:{ID:21,NAME:"Liêng",CMD:"Lieng",HAS_LOBBY:!0,SCENE:"GameplayLieng",GAME_MANAGER:"LiengGameManager",ICON:"IconGameLieng",LOG:!1,BUY_MONEY:!0,VISIBLE_SLOTS:7,MAX_COMMANDS_PER_MATCH:100,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},POKER:{ID:18,NAME:"Poker",CMD:"Poker",HAS_LOBBY:!0,SCENE:"GameplayPoker",GAME_MANAGER:"PokerGameManager",ICON:"IconGamePoker",LOG:!1,BUY_MONEY:!0,VISIBLE_SLOTS:7,MAX_COMMANDS_PER_MATCH:100,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},TLMN:{ID:1,NAME:"Tiến lên miền nam",CMD:"TLMN",HAS_LOBBY:!0,SCENE:"GameplayTLMN",ICON:"IconGameTLMN",GAME_MANAGER:"TLMNGameManager",LOG:!1,VISIBLE_SLOTS:4,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},TLMNSolo:{ID:15,NAME:"Tiến lên miền nam Solo",CMD:"TLMN",HAS_LOBBY:!0,SCENE:"GameplayTLMN",GAME_MANAGER:"TLMNGameManager",LOG:!1,VISIBLE_SLOTS:4,IS_SOLO:!0,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},SAM:{ID:13,NAME:"Sâm",CMD:"Sam",HAS_LOBBY:!0,SCENE:"GameplaySam",GAME_MANAGER:"SamGameManager",ICON:"IconGameSam",LOG:!1,VISIBLE_SLOTS:4,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},SAMSolo:{ID:14,NAME:"Sâm Solo",CMD:"Sam",HAS_LOBBY:!0,SCENE:"GameplaySam",GAME_MANAGER:"SamGameManager",LOG:!1,VISIBLE_SLOTS:4,IS_SOLO:!0,TOP_PANEL_IN_GAME:{ENABLE:!0,REGISTER_QUIT_GAME:!0,CHAT:!0}},findById:function(t){return i.Object.findObject(this,"ID",t)},findByCmd:function(t){return i.Object.findObject(this,"CMD",t)},isGameScene:function(t){var e=i.Object.findObject(this,"SCENE",t);return!(!e||!e.ID)},loadIconsAtlas:function(t){cc.loader.loadRes("atlats/AtlasIconGame",cc.SpriteAtlas,function(e,n){a.iconsAtlas=n,t&&t()})},getIconSpriteFrame:function(t){if(this.iconsAtlas)return this.iconsAtlas.getSpriteFrame(t)},updateIconsServer:function(t){this.iconsServer=t},getIconServer:function(t){if(this.iconsServer)return this.iconsServer[t]},updateGamePriorities:function(t){this.gamePriorities=t},getGamePriorities:function(){return this.gamePriorities||[]}};e.exports=a,cc._RFpop()},{Utils:"Utils"}],GameHelpModal:[function(t,e,n){"use strict";cc._RFpush(e,"a0ddct0HrpLNbKKd6JX9eKZ","GameHelpModal");var i=t("NetworkManager"),a=t("CommonConstant"),s=t("Modal"),o=t("Url");cc.Class({"extends":s,properties:{content:{"default":null,type:cc.RichText,override:!0}},init:function(t){if(t>=0){var e=this;i.Http.fetch("GET",o.Http.GAME_HELP,{game_id:t},{cache:3600,delay:500}).success(function(t){if(e.isValid){var n=e.node.getComponentInChildren(cc.ScrollView);n&&n.scrollToTop();var i="Chưa có hướng dẫn.";t.data&&(i=t.data.content||i),i&&(i=a.CurrencyType.normalize(i)),e.content.string=i}})}}}),cc._RFpop()},{CommonConstant:"CommonConstant",Modal:"Modal",NetworkManager:"NetworkManager",Url:"Url"}],GameItemDataWrapper:[function(t,e,n){"use strict";cc._RFpush(e,"62c9fDA7+JNuKePpS1xlKgo","GameItemDataWrapper");var i=t("GameManager");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},init:function(t){var e,n;for(n=0;n<t.length;n+=1)e=t[n],e&&(e.isSolo?this.soloGame=e:this.normalGame=e);this.gameGroup=t},selectSoloGame:function(){i.playGame(this.soloGame),this.node.destroy()},selectNormalGame:function(){i.playGame(this.normalGame),this.node.destroy()}}),cc._RFpop()},{GameManager:"GameManager"}],GameItemSlotInGame:[function(t,e,n){"use strict";cc._RFpush(e,"fc1d557yIVMc5lmzPffEaPX","GameItemSlotInGame");var i=t("GameManager"),a=t("Utils"),s=t("NetworkManager"),o=t("HoaQuaConstant"),r=t("MyNhanConstant"),c=t("HaiTacConstant"),h=t("Slot777Constant"),u=t("BaseGameOptionModal"),l=t("AudioManager"),d=t("UiManager");cc.Class({"extends":cc.Component,properties:{txtBetting:cc.Label,button:cc.Button},setData:function(t,e,n){var m=this;m.activeCurrency=null,r.BettingList.push(e.value),o.BettingList.push(e.value),c.BettingList.push(e.value),this.txtBetting.string=a.Number.format(e.value),function(e,n){m.button.node.on(cc.Node.EventType.TOUCH_END,function(){if(h.GameJoining)cc.log("game joining...");else if(r.GameType.type=n,o.GameType.type=n,c.GameType.type=n,h.GameJoining=!0,l.instance.playButtonClick(),t){var a=t.CONFIG.GAME_OPTION_MODAL_PREFAB,p=t.gameId,g={currency:s.SmartFox.type.utfString(m.activeCurrency),isSolo:s.SmartFox.type.bool(t.isSolo),betting:s.SmartFox.type["long"](e.value)};a?(d.openModalByName(a,function(t){t.getComponent(u).init(p,g,function(){})}),h.GameJoining=!1):i.enterGame(p,g)}},m)}(e,n)}}),cc._RFpop()},{AudioManager:"AudioManager",BaseGameOptionModal:"BaseGameOptionModal",GameManager:"GameManager",HaiTacConstant:"HaiTacConstant",HoaQuaConstant:"HoaQuaConstant",MyNhanConstant:"MyNhanConstant",NetworkManager:"NetworkManager",Slot777Constant:"Slot777Constant",UiManager:"UiManager",Utils:"Utils"}],GameItemSlot:[function(t,e,n){"use strict";cc._RFpush(e,"3828cafXkFGF7M6ZOGEgNps","GameItemSlot");var i=t("GameConstant"),a=t("Url"),s=t("Utils"),o=t("CommonConstant"),r=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{spriteFrameList:{"default":[],type:cc.SpriteFrame},txtJarList:{"default":[],type:cc.Label},textColor:cc.Color},onLoad:function(){this.getJar()},init:function(t){this.gameId=t,t===i.MY_NHAN.ID?this.node.getComponent(cc.Sprite).spriteFrame=this.spriteFrameList[0]:t===i.HAI_TAC.ID?this.node.getComponent(cc.Sprite).spriteFrame=this.spriteFrameList[1]:t===i.HOA_QUA.ID&&(this.node.getComponent(cc.Sprite).spriteFrame=this.spriteFrameList[2]),this.getJar()},getJar:function(){var t,e=this;if(!e.gameId)for(t=0;t<e.txtJarList.length;t+=1)e.txtJarList[t].string="0";var n=["100","1000","10000"];r.Http.fetch("GET",a.Http.GET_JAR,{game_id:e.gameId}).success(function(i){var a=i.data;if(void 0!==a[n[0]]&&void 0!==a[n[1]]&&void 0!==a[n[2]])for(t=0;t<e.txtJarList.length;t+=1)e.txtJarList[t].string=s.Number.format(a[n[t]].currencies[o.CurrencyType.Ip.NAME]);else for(t=0;t<e.txtJarList.length;t+=1)e.txtJarList[t].string="0"},{cache:900})}}),cc._RFpop()},{CommonConstant:"CommonConstant",GameConstant:"GameConstant",NetworkManager:"NetworkManager",Url:"Url",Utils:"Utils"}],GameItem:[function(t,e,n){"use strict";cc._RFpush(e,"54ea3R8MTlNxLOCTYvT6p0H","GameItem");var i=t("UrlImage"),a=t("UiManager"),s=t("GameManager"),o=t("GameConstant"),r=t("GameItemDataWrapper"),c=t("EventDispatcher"),h=t("GameManagerConstant");cc.Class({"extends":r,properties:{loadingNode:cc.Node},onLoad:function(){function t(){n&&n.play()}function e(){n&&n.stop()}var n=this.node.getComponent(cc.Animation),i=this;this.loadingAction=cc.sequence(cc.callFunc(function(){i.loadingNode.active=!0}),cc.delayTime(s.JOIN_GAME_TIMEOUT/1e3),cc.callFunc(function(){i.loadingNode.active=!1})),this.node.on(cc.Node.EventType.MOUSE_ENTER,t),this.node.on(cc.Node.EventType.TOUCH_START,t),this.node.on(cc.Node.EventType.MOUSE_LEAVE,e),this.node.on(cc.Node.EventType.TOUCH_CANCEL,e),this.node.on(cc.Node.EventType.TOUCH_END,e),c.addEventListener(h.Event.JOIN_GAME,this.onJoinGame,this),c.addEventListener(h.Event.JOIN_GAME_LOBBY,this.onJoinGame,this)},onDestroy:function(){c.removeEventListener(h.Event.JOIN_GAME,this.onJoinGame,this),c.removeEventListener(h.Event.JOIN_GAME_LOBBY,this.onJoinGame,this)},init:function(t){r.prototype.init.call(this,t);var e,n,a=this.normalGame||this.soloGame,s=this.node.getComponentInChildren(cc.Label),c=this.node.getComponentInChildren(i),h=this.node.getComponentInChildren(cc.Sprite);s&&(s.string=a.name),n=o.getIconServer(a.gameId),n&&c?c.loadImage(n):a.CONFIG&&a.CONFIG.ICON&&h?(e=o.getIconSpriteFrame(a.CONFIG.ICON),h.spriteFrame=e):c&&c.loadImage(a.logo);var u=this.node.getComponent("GameItemSlot");u&&u.init(a.gameId)},click:function(){var t=this;(t.normalGame||t.soloGame)&&(t.normalGame&&t.normalGame.webview_url?(this._startLoading(),a.openWebView(t.normalGame.webview_url,t.normalGame.name,function(){t._stopLoading()})):t.normalGame&&t.normalGame.id<0?(this._startLoading(),a.openModalByName(t.normalGame.CONFIG.MINIGAME_PREFAB,function(){t._stopLoading()})):t.normalGame&&t.soloGame?t.normalGame&&s.isAvailableGame(t.normalGame.gameId)&&t.soloGame&&s.isAvailableGame(t.soloGame.gameId)&&a.openModalByName("games/ui/play_type/PlayTypeOptionModal",function(e){e.getComponent(r).init(t.gameGroup)}):s.playGame(t.normalGame||t.soloGame))},onJoinGame:function(t){var e=this.normalGame||this.soloGame;e&&t&&t.gameCmd===e.CONFIG.CMD&&(t.isJoining?this._startLoading():this._stopLoading())},_startLoading:function(){this.node.runAction(this.loadingAction)},_stopLoading:function(){try{this.node.stopAction(this.loadingAction)}catch(t){}this.loadingNode.active=!1}}),cc._RFpop()},{EventDispatcher:"EventDispatcher",GameConstant:"GameConstant",GameItemDataWrapper:"GameItemDataWrapper",GameManager:"GameManager",GameManagerConstant:"GameManagerConstant",UiManager:"UiManager",UrlImage:"UrlImage"}],GameJarItem:[function(t,e,n){"use strict";cc._RFpush(e,"785d9rwq6ZJSIMS5yZcIlGc","GameJarItem"),cc.Class({"extends":cc.Component,properties:{lblGameName:cc.Label,logo:cc.Sprite,listJar:cc.Node},onLoad:function(){}}),cc._RFpop()},{}],GameManagerConstant:[function(t,e,n){"use strict";cc._RFpush(e,"414b8/R5jZG8r2fpIxZTueN","GameManagerConstant"),e.exports={Event:{JOIN_ROOM:"in_game.base.join_room",JOIN_ROOM_ERROR:"in_game.base.join_room_error",LEAVE_ROOM:"in_game.base.leave_room",JOIN_GAME:"in_game.base.join_game",JOIN_GAME_LOBBY:"in_game.base.join_game_lobby",UPDATE_REGISTER_QUIT_GAME_STATUS:"in_game.base.update_register_quit_game_status",UPDATE_BETTING_VALUES:"in_game.base.update_betting_values",UPDATE_USER_MONEY:"in_game.base.update_user_money",PLAYER_ADDED:"in_game.base.player_added",PLAYER_REMOVED:"in_game.base.player_removed",WAITING_PLAYER_ADDED:"in_game.base.waiting_player_added",WAITING_PLAYER_REMOVED:"in_game.base.waiting_player_removed",NEW_MATCH_LOST_FOCUS:"in_game.base.new_match_lost_focus"}},cc._RFpop()},{}],GameManager:[function(t,e,n){"use strict";cc._RFpush(e,"4aca2AXOWlOJa0RO92OwMGg","GameManager");var i,a=t("Utils"),s=t("GameConstant"),o=t("NetworkManager"),r=t("EventDispatcher"),c=t("EventDispatcherConstant"),h=t("SmartFoxConstant"),u=t("GameManagerConstant"),l=t("TinhNangManager"),d=t("UiManager"),m=t("AudioManager"),p=t("PlatformImplement"),g=t("CommonConstant"),f="games/minigame/MinigameQuickIcon";i={RAW_GAME_LIST:[],GAME_LIST:[],GAME_GROUP_LIST:[],JOIN_GAME_TIMEOUT:1e4,RECHECK_JOINED_ROOMS_INTERVAL:15e3,RECHECK_JOINED_ROOMS_INITIAL_INTERVAL:3e3,MAX_RECHECK_JOINED_ROOMS_TIMES:4,ACTIVE_GAMES:{MINI_GAMES:{},MAIN_GAME:null},JOINING_GAMES:{MINI_GAMES:{},MAIN_GAME:null},_init:function(){this.timeouts=[],r.addEventListener(c.TINH_NANG.NEW,this.onTinhNangNew,this),r.addEventListener(c.AUTH.LOGIN,this.onLogin,this),r.addEventListener(c.AUTH.LOGOUT,this.onLogout,this),r.addEventListener(u.Event.JOIN_ROOM,this.onJoinRoom,this),r.addEventListener(u.Event.JOIN_ROOM_ERROR,this.onJoinRoomError,this),r.addEventListener(u.Event.LEAVE_ROOM,this.onLeaveRoom,this)},onTinhNangNew:function(){this.onUpdateGameList()},onLogin:function(){var t=this;t.getGameList(function(e){t.RAW_GAME_LIST=e&&e.rooms||[],t.onUpdateGameList();var n=cc.director.getScene(),i=n&&n.children&&n.children[0],s=i&&i.getComponent("BaseGameplay");s||a.Director.loadScene(g.Scene.HALL,function(){t._markJoiningMainGame(!0,1e3);
})}),m.instance.isMusicPlaying()||m.instance.playMusic(),this._scheduleRecheckJoinedRoomsTimeoutId=null,this._lastRequestPlayGame=0,this._scheduleRecheckJoinedRooms(!0,this.RECHECK_JOINED_ROOMS_INITIAL_INTERVAL)},onLogout:function(){var t,e,n;for(t in this.ACTIVE_GAMES.MINI_GAMES)e=this.ACTIVE_GAMES.MINI_GAMES[t],n=e&&e.prefab,n&&cc.game.isPersistRootNode(n)&&(n.destroy(),cc.game.removePersistRootNode(n));this.ACTIVE_GAMES={MINI_GAMES:{},MAIN_GAME:null},this.JOINING_GAMES={MINI_GAMES:{},MAIN_GAME:null},this.timeouts.forEach(function(t){clearTimeout(t)}),this.timeouts=[],d.destroyModalByName(f),m.instance.stopMusic(),this._cancelScheduleRecheckJoinedRooms(),o.SmartFox.isReconnecting||(this.RAW_GAME_LIST=[],this.GAME_LIST=[],this.GAME_GROUP_LIST=[],p.returnLoginPage())},onJoinRoom:function(t,e){var n,i,r=this;if(e=e||{},this.isLobby(t))n=this.findGameLobbyByRoomId(t.id),n&&(i=n.CONFIG&&n.CONFIG.LOBBY_SCENE||g.Scene.LOBBY,i&&(this.ACTIVE_GAMES.MAIN_GAME=this._createGameRuntimeConfigs(n,t),a.Director.loadScene(i,function(){r._markJoiningMainGame(!1),r._dispatchJoinGameLobby(n.gameId,!1)},function(){o.SmartFox.leaveRoom(t.id)})));else{var c=this._parseGameId(t.groupId);if(n=this.findGameById(c),n=n||{CONFIG:s.findById(c)||{}}){var h,u=n.CONFIG&&n.CONFIG.GAME_MANAGER&&a.Module.get(n.CONFIG.GAME_MANAGER);if(u)if(h=new u(n,t.id),e.rejoin&&h.fetchInitialGameData(),n.CONFIG.IS_MINIGAME){var l,d=this.ACTIVE_GAMES.MINI_GAMES[c],m=this._createGameRuntimeConfigs(n,t,h);d&&d.autoOpen&&!d.game?cc.js.mixin(d,m):this.ACTIVE_GAMES.MINI_GAMES[c]=m,l=n&&n.CONFIG&&n.CONFIG.MINIGAME_PREFAB,l&&cc.loader.loadRes(l,function(t,e){var n,i=r.ACTIVE_GAMES.MINI_GAMES[c];i.prefab||(n=cc.instantiate(e),n.active=!1,cc.game.addPersistRootNode(n),i.prefab=n,i.autoOpen&&(n.active=!0),r._markJoiningGame(c,!1))})}else i=n.CONFIG&&n.CONFIG.SCENE,i&&(this.ACTIVE_GAMES.MAIN_GAME=this._createGameRuntimeConfigs(n,t,h),a.Director.loadScene(i,function(){r.leaveAllGameLobbies(),r._markJoiningGame(c,!1)},function(){o.SmartFox.leaveRoom(t.id)}))}}},onJoinRoomError:function(){},onLeaveRoom:function(t){if(this.isLobby(t))this.ACTIVE_GAMES.MAIN_GAME&&this.ACTIVE_GAMES.MAIN_GAME.room&&this.ACTIVE_GAMES.MAIN_GAME.room.id===t.id&&(this.ACTIVE_GAMES.MAIN_GAME=null);else{var e=this._parseGameId(t.groupId),n=this.findGameById(e);if(n)if(n.CONFIG.IS_MINIGAME){var i=this.ACTIVE_GAMES.MINI_GAMES[e],s=i&&i.prefab;s&&cc.game.isPersistRootNode(s)&&(s.destroy(),cc.game.removePersistRootNode(s)),delete this.ACTIVE_GAMES.MINI_GAMES[e]}else this.ACTIVE_GAMES.MAIN_GAME&&this.ACTIVE_GAMES.MAIN_GAME.room&&this.ACTIVE_GAMES.MAIN_GAME.room.id===t.id&&(this.ACTIVE_GAMES.MAIN_GAME=null),n.CONFIG&&n.CONFIG.HAS_LOBBY?this.enterGameLobby(e):a.Director.loadScene(g.Scene.HALL)}},onUpdateGameList:function(){var t=[];this.RAW_GAME_LIST.forEach(function(e){e&&a.Type.isDefined(e.gameId)&&l.choPhep(e.gameId)&&t.push(e)}),this.filterGameList(t),this.joinDaemonMiniGames(),this.joinAutoJoinGames(),l.choPhep("cn")?d.openModalByName(f,function(t){cc.game.isPersistRootNode(t)||cc.game.addPersistRootNode(t)}):d.destroyModalByName(f),r.dispatchEvent(c.GAME.UPDATE_LIST)},_parseGameId:function(t){try{t=parseInt(t,10)}catch(e){}return t},_createGameRuntimeConfigs:function(t,e,n){return{game:t,room:e,gameManager:n}},getGameRuntimeConfigs:function(t){if(t){var e,n=this.ACTIVE_GAMES.MAIN_GAME,i=this.ACTIVE_GAMES.MINI_GAMES;if(this._isCorrectGameRuntimeConfigs(n,t))return n;for(e in i)if(n=i[e],this._isCorrectGameRuntimeConfigs(n,t))return n;return null}},_isCorrectGameRuntimeConfigs:function(t,e){return!!(t&&t.game&&t.game.CONFIG&&t.game.CONFIG.CMD===e)},getLobbyGameRuntimeConfigs:function(){var t=this.ACTIVE_GAMES.MAIN_GAME;return t&&!t.gameManager?t:null},markMiniGameAutoOpen:function(t){this.ACTIVE_GAMES.MINI_GAMES[t]={autoOpen:!0}},filterGameList:function(t){var e,n,i,o,r,c,h,u={};for(this.GAME_LIST=[],h=0;h<t.length;h+=1)e=t[h],n=this._parseGameId(e.gameId),i=s.findById(n)||{},e.CONFIG=i,"isSolo"in e||(e.isSolo=!!e.gameCode&&/.+Solo$/.test(e.gameCode)),i.IS_SOLO=e.isSolo,i.IS_MINIGAME=e.isMiniGame,i.NAME=e.name,u[e.scene]=u[e.scene]||[],u[e.scene].push(e);for(c in u)r=[],o=u[c],i=null,o.forEach(function(t){i||a.Object.isEmpty(t.CONFIG)||(i=t.CONFIG)}),o.forEach(function(t){i&&a.Object.isEmpty(t.CONFIG)&&(t.CONFIG=i),this.isAvailableGameToDisplay(t)&&(r.push(t),this.GAME_LIST.push(t))}.bind(this)),u[c]=r;u=a.Object.values(u),u.sort(function(t,e){return this._findMaxGamePriorityInGroup(t)-this._findMaxGamePriorityInGroup(e)}.bind(this)),this.GAME_GROUP_LIST=u},_findMaxGamePriorityInGroup:function(t){var e,n=-1;for(e=0;e<t.length;e+=1)n=Math.max(n,t[e].priority);return n},findGameById:function(t){return a.Object.findObject(this.GAME_LIST,"gameId",t)},findGameLobbyByRoomId:function(t){return a.Object.findObject(this.GAME_LIST,"id",t)},isLobby:function(t){return!(!t||t.groupId!==s.LOBBY.NAME)},isAvailableGame:function(t){var e=this.findGameById(t);return e&&e.CONFIG&&e.CONFIG.CMD&&e.CONFIG.GAME_MANAGER&&a.Module.get(e.CONFIG.GAME_MANAGER)&&l.choPhep(t)},isAvailableGameToDisplay:function(t){return this.isSmartFoxGame(t)||this.isPopupOrWebViewGame(t)},isSmartFoxGame:function(t){return t&&t.CONFIG&&t.CONFIG.CMD&&t.CONFIG.GAME_MANAGER&&a.Module.get(t.CONFIG.GAME_MANAGER)},isPopupOrWebViewGame:function(t){return t&&(t.CONFIG&&t.CONFIG.ID&&!t.CONFIG.CMD||t.webview_url)},_isJoiningMainGame:function(){var t=this.JOINING_GAMES.MAIN_GAME;return t&&t.isJoining},_isJoiningMiniGame:function(t){var e=this.JOINING_GAMES.MINI_GAMES[t];return e&&e.isJoining},_isJoiningGame:function(t){var e=this.findGameById(t);return!(!e||!e.CONFIG)&&(e.CONFIG.IS_MINIGAME?this._isJoiningMiniGame(t):this._isJoiningMainGame())},_markJoiningMainGame:function(t,e){var n=Math.random()+"."+Date.now(),i=this;t?(a.Type.isNumber(e)||(e=i.JOIN_GAME_TIMEOUT),i.JOINING_GAMES.MAIN_GAME={isJoining:t,id:n},i.timeouts.push(setTimeout(function(){var t=i.JOINING_GAMES.MAIN_GAME;t&&t.id===n&&(t.isJoining=!1)},e))):i.timeouts.push(setTimeout(function(){i.JOINING_GAMES.MAIN_GAME={isJoining:t,id:n}},300))},_markJoiningMiniGame:function(t,e,n){var i=Math.random()+"."+Date.now(),s=this;e?(a.Type.isNumber(n)||(n=s.JOIN_GAME_TIMEOUT),s.JOINING_GAMES.MINI_GAMES[t]={isJoining:e,id:i},s.timeouts.push(setTimeout(function(){var e=s.JOINING_GAMES.MINI_GAMES[t];e&&e.id===i&&(e.isJoining=!1)},n))):s.timeouts.push(setTimeout(function(){s.JOINING_GAMES.MINI_GAMES[t]={isJoining:e,id:i}},300))},_markJoiningGame:function(t,e,n){var i=this.findGameById(t);i&&i.CONFIG&&(i.CONFIG.IS_MINIGAME?this._markJoiningMiniGame(t,e,n):this._markJoiningMainGame(e,n),this._dispatchJoinGame(t,e))},_dispatchJoinGameLobby:function(t,e){var n=this.findGameById(t);n&&n.CONFIG&&r.dispatchEvent(u.Event.JOIN_GAME_LOBBY,{gameId:t,gameCmd:n.CONFIG.CMD,isJoining:e})},_dispatchJoinGame:function(t,e){var n=this.findGameById(t);n&&n.CONFIG&&r.dispatchEvent(u.Event.JOIN_GAME,{gameId:t,gameCmd:n.CONFIG.CMD,isJoining:e})},_cancelScheduleRecheckJoinedRooms:function(){this._scheduleRecheckJoinedRoomsTimeoutId&&(clearTimeout(this._scheduleRecheckJoinedRoomsTimeoutId),this._scheduleRecheckJoinedRoomsTimeoutId=null)},scheduleRecheckJoinedRooms:function(t){this._cancelScheduleRecheckJoinedRooms(),this._scheduleRecheckJoinedRooms(!1,t)},_scheduleRecheckJoinedRooms:function(t,e){var n=this;this._scheduleRecheckJoinedRoomsTimeoutId||(t&&(this._lastRequestPlayGame=Date.now()),this._scheduleRecheckJoinedRoomsTimeoutId=setTimeout(function(){n._recheckJoinedRooms()},e||this.RECHECK_JOINED_ROOMS_INTERVAL))},_recheckJoinedRooms:function(){var t,e=a.Director.getCurrentSceneName(),n=o.SmartFox.getJoinedRooms().slice(),i=!1,r=this;for(t=0;t<n.length;t+=1){var c,h,u=n[t];if(c=r.ACTIVE_GAMES.MAIN_GAME,h=c&&c.room,h&&h.id===u.id&&!r.isLobby(u)){i=!0;break}}n.forEach(function(t){var n,a,s,o=r._parseGameId(t.groupId);if(n=r.ACTIVE_GAMES.MAIN_GAME,s=n&&n.room,s&&s.id===t.id){if(n.isSuspending)return;if(r.isLobby(t)){var c=n.game&&n.game.CONFIG&&n.game.CONFIG.LOBBY_SCENE||g.Scene.LOBBY;if(e===c)return;if(i)return}else if(a=r.findGameById(o),a&&a.CONFIG&&a.CONFIG.SCENE&&e===a.CONFIG.SCENE)return}n=r.ACTIVE_GAMES.MINI_GAMES&&r.ACTIVE_GAMES.MINI_GAMES[o],s=n&&n.room,s&&s.id===t.id||r.onJoinRoom(t,{rejoin:!0})}),!i&&s.isGameScene(e)&&a.Director.loadScene(g.Scene.HALL),this._scheduleRecheckJoinedRoomsTimeoutId=null,Date.now()-this._lastRequestPlayGame<this.RECHECK_JOINED_ROOMS_INTERVAL*this.MAX_RECHECK_JOINED_ROOMS_TIMES&&this._scheduleRecheckJoinedRooms()},getGameList:function(t){o.SmartFox.sendGlobalEndpoint({command:o.SmartFox.type["byte"](h.Command.GET_GAME_LIST.ID)},t)},getBettingValues:function(t,e){o.SmartFox.sendGlobalEndpoint({command:o.SmartFox.type["byte"](h.Command.GET_BETTING_VALUES.ID),gameId:o.SmartFox.type["int"](t)},e)},getGameRoomList:function(t,e){o.SmartFox.sendGlobalEndpoint({command:o.SmartFox.type["byte"](h.Command.GET_GAME_ROOM_LIST.ID),gameId:o.SmartFox.type["int"](t)},e)},createGame:function(t,e){if(this.isAvailableGame(t)&&!this._isJoiningGame(t)){this._markJoiningGame(t,!0);var n=this,i=function(i){var s=i&&i.params||{};0===s.result&&n._markJoiningGame(t,!1),a.Type.isFunction(e)&&e()};o.SmartFox.sendGlobalEndpoint({command:o.SmartFox.type["byte"](h.Command.CREATE_GAME.ID),gameId:o.SmartFox.type["int"](t)},i),this._scheduleRecheckJoinedRooms(!0)}},enterGame:function(t,e,n){if(this.isAvailableGame(t)&&!this._isJoiningGame(t)){this._markJoiningGame(t,!0);var i=this,s=function(e){e&&0===e.result&&i._markJoiningGame(t,!1),a.Type.isFunction(n)&&n()};o.SmartFox.sendGlobalEndpoint({command:o.SmartFox.type["byte"](h.Command.ENTER_GAME.ID),gameId:o.SmartFox.type["int"](t),gameConfigs:o.SmartFox.type.sfsObject(e)},s),this._scheduleRecheckJoinedRooms(!0)}},playGame:function(t){if(t&&t.CONFIG){var e=t.CONFIG.ID;if(this._isJoiningGame(e))return;if(t.CONFIG.IS_MINIGAME&&t.CONFIG&&t.CONFIG.CMD){var n=this.getGameRuntimeConfigs(t.CONFIG.CMD),i=n&&n.prefab,a=cc.director.getScene();i?(i.isChildOf(a)||a.addChild(i),i.active=!0):(this.markMiniGameAutoOpen(e),t.isDaemonRoom?this.joinDaemonMiniGame(e):this.createGame(e))}else t.CONFIG&&(t.CONFIG.HAS_LOBBY?this.enterGameLobby(e):this.createGame(e))}},joinDaemonMiniGames:function(){var t,e;for(e=0;e<this.GAME_LIST.length;e+=1)t=this.GAME_LIST[e],this.joinDaemonMiniGame(t.gameId)},joinDaemonMiniGame:function(t){if(this.isAvailableGame(t)&&!this._isJoiningGame(t)){var e=this.findGameById(t),n=this;e.isDaemonRoom&&e.id>0&&this.getGameRoomList(e.gameId,function(e){var i,a=e.rooms||[];a.length>0&&(i=a[0].id,i>0&&!o.SmartFox.isJoinedInRoom(i)&&(n._markJoiningGame(t,!0),o.SmartFox.joinRoom(i),n._scheduleRecheckJoinedRooms(!0)))})}},joinAutoJoinGames:function(){var t=this;t.GAME_LIST.forEach(function(e){var n=e.gameId;if(t.isAvailableGame(n)&&!t._isJoiningGame(n)&&e.CONFIG&&e.CONFIG.AUTO_JOIN)if(e.HAS_LOBBY)t.enterGameLobby(n);else{var i,a,s=o.SmartFox.getJoinedRooms().slice(),r=!1;for(a=0;a<s.length;a+=1)i=s[a],t._parseGameId(i.groupId)===n&&(r=!0);r||t.playGame(e)}})},enterGameLobby:function(t){if(this.isAvailableGame(t)&&!this._isJoiningMainGame()){this._markJoiningMainGame(!0),this._dispatchJoinGameLobby(t,!0);var e=this.findGameById(t);e&&(o.SmartFox.joinRoom(e.id),this._scheduleRecheckJoinedRooms(!0))}},leaveAllGameLobbies:function(){var t=this;o.SmartFox.getJoinedRooms().forEach(function(e){t.isLobby(e)&&o.SmartFox.leaveRoom(e.id)})}},i._init(),e.exports=i,cc._RFpop()},{AudioManager:"AudioManager",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",SmartFoxConstant:"SmartFoxConstant",TinhNangManager:"TinhNangManager",UiManager:"UiManager",Utils:"Utils"}],GameplayBauCua:[function(t,e,n){"use strict";cc._RFpush(e,"b39495VJyZFVZ8ZApY57ySN","GameplayBauCua");var i=t("GameConstant"),a=t("Utils"),s=t("AuthUser"),o=t("BaseMainGameplay"),r=t("BauCuaConstant");cc.Class({"extends":o,properties:{slotInfor:{"default":[],type:cc.Node},banker:cc.Node,chipPrefab:cc.Prefab,bowDice:cc.Node,parentChipBetting:cc.Node,nhiKetQuaList:{"default":[],type:cc.Sprite},spriteFrameKetQua:{"default":[],type:cc.SpriteFrame},timeLabel:cc.Label,timeCountDow:cc.Sprite,resultList:{"default":[],type:cc.Label},bow:cc.Node,stateGameLabel:cc.Label,gridBuyPot:cc.Node,panelBuyPot:cc.Node,itemBuyPot:cc.Prefab,btnX2:cc.Button,btnCancelBet:cc.Button,btnRebet:cc.Button,gameCmd:{"default":i.BAU_CUA.CMD,visible:!1}},$onLoad:function(){this.listChipBetting=[],this._poolChip=new cc.NodePool("Chip"),this.moneyBetSelect=0,this.time=0,this.gameManager.eventDispatchers.local.addEventListener(r.Event.BETTING_SUCCESS,this.onBettingSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.SHAKE_BOW_DICE,this.onShakeBow,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.ADD_LIST_BETTING,this._addChipBetting,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.PLAYER_BETTING_STATE,this._playerBettingState,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.CANCEL_BET,this.onCancelBetting,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.BETTING_UPDATEGAME,this.onBettingUpdate,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.MASTER_CANEL_BET,this.onMasterCencelBet,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.CHANGE_STATE,this.onChangeState,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.MASTER_SELL_POT,this.onMasterSellPot,this),this._disableAllButton()},$onUpdate:function(){if(this._checkOnFocus(),this.gameManager.gameState===r.GameState.PLAYER_BETTING||this.gameManager.gameState===r.GameState.MASTER_CANEL_BET){var t=Math.floor((this.time-Date.now())/1e3);t=t>=0?t:0,this.timeLabel.string=t,t<=0&&(this.timeLabel.node.active=!1,this.timeCountDow.node.active=!1)}},$onDestroy:function(){this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId)},$onFocus:function(){if(this.gameManager.gameState!==r.GameState.FINISH){this.bow.position=cc.v2(0,0);for(var t=0;t<this.slotInfor.length;t+=1){var e=this.slotInfor[t].getComponent("SlotInfor");e.showEfectWin(!1)}}if(this.gameManager.gameState!==r.GameState.EFFECT){var n=this.bowDice.getComponent(cc.Animation);n.stop("Shake"),this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId)}this.gameManager.gameState===r.GameState.EFFECT&&(this.bowDice.position=cc.v2(0,0))},onClickCloseBuyPot:function(){this.panelBuyPot.active=!1},onMasterSellPot:function(t){var e=this;this.panelBuyPot.active||(this.panelBuyPot.active=!0,this.gridBuyPot.removeAllChildren());var n=cc.instantiate(this.itemBuyPot),i=n.getComponent("BauCuaBuyPot");i.setDataPot(this.spriteFrameKetQua[t.pot],t.money,t.pot),n.on(cc.Node.EventType.TOUCH_START,function(){e._selectBuyPot(this.node)},i),this.gridBuyPot.addChild(n)},_selectBuyPot:function(t){var e=t.getComponent("BauCuaBuyPot");this.gameManager.sendBuyPot(e.pot)},openBuyPot:function(){this.panelBuyPot.active=!0},onChangeState:function(){switch(this.gameManager.gameState){case r.GameState.EFFECT:this.stateGameLabel.string="Nhà cái bắt đầu xóc!",this._disableAllButton();break;case r.GameState.PLAYER_BETTING:if(this.stateGameLabel.string="Hãy chọn cửa để đặt!",this.gameManager.history.length>0&&!this.gameManager.isMaster){for(var t=!1,e=0;e<this.gameManager.history.length;e+=1)if(this.gameManager.history[e]>0){t=!0;break}this.btnRebet.interactable=t}this.audioManager.playTurnStart();break;case r.GameState.MASTER_CANEL_BET:this.stateGameLabel.string="Nhà cái bán cược!",this._disableAllButton();break;case r.GameState.FINALIZING:this.stateGameLabel.string="Kết quả!",this._disableAllButton()}},_disableAllButton:function(){this.btnRebet.interactable=!1,this.btnX2.interactable=!1,this.btnCancelBet.interactable=!1},_checkOnFocus:function(){if(this.gameManager.gameState!==r.GameState.FINALIZING){this.bow.position=cc.v2(0,0);for(var t=0;t<this.slotInfor.length;t+=1){var e=this.slotInfor[t].getComponent("SlotInfor");e.showEfectWin(!1)}}if(this.gameManager.gameState!==r.GameState.EFFECT){var n=this.bowDice.getComponent(cc.Animation);n.stop("Shake"),this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId)}else this.bowDice.position=cc.v2(0,0)},_enableNodeWhenLoad:function(t){this.timeCountDow.node.active=t,this.timeLabel.node.active=t},_showTimeState:function(t){var e=this.bowDice.getComponent(cc.Animation);e.stop("Shake",5),this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId),this.bowDice.position=cc.v2(0,0),this._enableNodeWhenLoad(!0);var n=cc.rotateBy(5,360);this.timeCountDow.node.runAction(cc.repeatForever(n)),this.time=Date.now()+t},onMasterCencelBet:function(t){this._showTimeState(t.time),this._activeSellCancelPot(!0)},_activeSellCancelPot:function(t){if(this.gameManager.isMaster&&t)for(var e=0;e<this.slotInfor.length;e+=1){var n=this.slotInfor[e].getComponent("SlotInfor");n.activeSellPotBauCua(t)}else for(var i=0;i<this.slotInfor.length;i+=1){var a=this.slotInfor[i].getComponent("SlotInfor");a.activeSellPotBauCua(!1)}},onBettingUpdate:function(t){this.audioManager.playChipBay();for(var e=0;e<t.info.length;e+=1){var n,i,a,o=this.findPlayerNodeByName(t.info[e].userName),r=0;n=cc.instantiate(this.chipPrefab),o&&(n.parent=o.node.parent,n.position=o.node),i=n.getComponent("Chip"),i.activeSelectChip(!1),i.moneyLabel.node.active=!1,n.scale=cc.v2(.5,.5),i.init(t.info[e].money),i=n.getComponent(cc.Button),i.enabled=!1,n.removeComponent("ButtonScaler"),a=this.slotInfor[t.id].getComponent("SlotInfor"),a.init(),t.info[e].username===s.username&&(r=t.info[e].money),a.setMoneyPot(r,t.info[e].money),a.addPlayerBetToPot(t.info[e].userName,t.info[e].money);var c=cc.moveTo(.5,cc.v2(this.slotInfor[t.id].x,this.slotInfor[t.id].y)).easing(cc.easeOut(2));n.runAction(cc.sequence(c,cc.callFunc(function(){this.destroy()},n)))}},onCancelBetting:function(t){var e=this.slotInfor[t.pot].getComponent("SlotInfor");this._moveChipToPlayer(t.username,this.slotInfor[t.pot]),t.username===s.username&&(this.btnX2.interactable=!1,this.btnCancelBet.interactable=!1),e.removeMoneyPot(t.username)},_bankerPayChip:function(t){for(var e=0;e<t.length;e+=1)Object.keys(this.slotInfor[t[e]].getComponent("SlotInfor").playerBetList).length>0&&this._moveChipToPlayer(this.slotInfor[t[e]],this.banker)},onFinishGame:function(t){var e=this;this.onClickCloseBuyPot();var n=cc.sequence(cc.callFunc(function(){e._activeSellCancelPot(!1)}),cc.callFunc(function(){e._setKetQua(t.dices)}),cc.callFunc(function(){e._openBow()}),cc.delayTime(2),cc.callFunc(function(){e._showSlostWin(t.potWin)}),cc.callFunc(function(){e._bankerPayChip(t.potWin)}),cc.delayTime(1),cc.callFunc(function(){e._payChipToPlayer(t.potWin)}),cc.delayTime(2),cc.callFunc(function(){e._showMoneyFinish(t.players)}),cc.delayTime(2),cc.callFunc(function(){e._moveChipToBanker()}),cc.callFunc(function(){e._showBankerMoneyFinish(t.banker)}),cc.callFunc(function(){e._addResult(t.dices)}),cc.callFunc(function(){e._clearPlayerInPot()}),cc.delayTime(2),cc.callFunc(function(){e._clearEfectFinish()}));this.node.runAction(n)},_payChipToPlayer:function(t){for(var e=0;e<t.length;e+=1){var n=this.slotInfor[t[e]].getComponent("SlotInfor");this._findPlayerWinInSlost(n.playerBetList,t[e])}},_addResult:function(t){for(var e=0;e<t.length;e+=1){if(99===this.resultList[t[e]])for(var n=0;n<this.resultList.length;n+=1)this.resultList[n].string=0;this.resultList[t[e]].string=parseInt(this.resultList[t[e]].string)+1}},_clearEfectFinish:function(){for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].clearEffects()},_moveChipToPlayer:function(t,e,n){var i,s,o;this.audioManager.playChipBay();for(var r=0;r<3;r+=1)if(a.Type.isString(t)?(s=this.findPlayerNodeByName(t),s&&(s=s.node)):s=t,s){i=cc.instantiate(this.chipPrefab),i.parent=s.parent,i.position=e,o=i.getComponent("Chip"),o.activeSelectChip(!1),o.moneyLabel.node.active=!1,i.removeComponent("ButtonScaler"),i.removeComponent(cc.Button),i.scale=cc.v2(.5,.5),o.init(n);var c=cc.moveTo(.5,cc.v2(s.x,s.y)).easing(cc.easeOut(2));i.runAction(cc.sequence(cc.delayTime(.05*r),c,cc.callFunc(function(){this.destroy()},i)))}},_moveChipToBanker:function(){for(var t=this,e=0;e<t.slotInfor.length;e+=1){var n=this.slotInfor[e].getComponent("SlotInfor");n.isWin||n.chipFackeList.length>0&&this._moveChipToPlayer(t.banker,t.slotInfor[e])}},_findPlayerWinInSlost:function(t,e){var n=this,i=n.slotInfor[e].getComponent("SlotInfor");i.destroyChipFacke();for(var a=Object.keys(t),s=0;s<a.length;s+=1)n._moveChipToPlayer(a[s],n.slotInfor[e])},_setKetQua:function(t){for(var e=0;e<t.length;e+=1)this.nhiKetQuaList[e].spriteFrame=this.spriteFrameKetQua[t[e]]},_showSlostWin:function(t){for(var e=0;e<this.slotInfor.length;e+=1){var n=this.slotInfor[e].getComponent("SlotInfor");n.disablePotEfect()}for(var i=0;i<t.length;i+=1){var a=this.slotInfor[t[i]].getComponent("SlotInfor");a.showEfectWin(!0),a.isWin=!0}},_disableEfectSlostWin:function(){for(var t=0;t<this.slotInfor.length;t+=1){var e=this.slotInfor[t].getComponent("SlotInfor");e.showEfectWin(!1),e.isWin=!1}},_showMoneyFinish:function(t){for(var e=0;e<t.length;e+=1){var n=this.findPlayerNodeByName(t[e].userName);n&&(n.setFinishEffect(t[e].moneyExchange),t[e].userName===s.username&&(t[e].moneyExchange>0?this.audioManager.playWin():this.audioManager.playLose()))}},_showBankerMoneyFinish:function(t){if(void 0!==t.userName){var e=this.findPlayerNodeByName(t.userName);e&&(e=e.getComponent("PlayerUI"),e.setFinishEffect(t.moneyExchange))}},_clearPlayerInPot:function(){for(var t=this,e=0;e<t.slotInfor.length;e+=1){var n=t.slotInfor[e].getComponent("SlotInfor");n.playerBetList={},n.totallMoneyLong=0,n.myMoneyLong=0,n.potX=0,n.setMoneyPot(0,0),n.destroyChipFacke()}},onBettingSuccess:function(t){var e,n,i=this,a=this._poolChip.get(),o=this.findPlayerNodeByName(t.username),c=!1,h=!1,u=0;a||(a=cc.instantiate(this.chipPrefab)),o&&(a.parent=o.node.parent,a.position=o.node),e=a.getComponent("Chip"),e.activeSelectChip(!1),a.scale=cc.v2(.5,.5);for(var l=0;l<this.gameManager.bettingList.length;l++)if(this.gameManager.bettingList[l]==t.money){e.init(t.money,r.ChipColor.findById(l).NAME),c=!0;break}c||(e.moneyLabel.node.active=!1,e.init(t.money)),e=a.getComponent(cc.Button),e.enabled=!1,a.removeComponent("ButtonScaler"),n=this.slotInfor[t.pot].getComponent("SlotInfor"),n.init(),t.username===s.username&&(u=t.money,this.btnX2.interactable=!0,this.btnCancelBet.interactable=!0),n.setMoneyPot(u,t.money),n.addPlayerBetToPot(t.username,t.money);for(var d=0;d<this.gameManager.bettingList.length;d++)if(this.gameManager.bettingList[d]==t.money){h=!0;var m=this.slotInfor[t.pot].getChildByName(d.toString()).convertToWorldSpace(cc.v2(0,0)),p=this.node.convertToNodeSpaceAR(m),g=cc.moveTo(.3,p).easing(cc.easeOut(2));a.runAction(cc.sequence(g,cc.callFunc(function(){i._poolChip.put(a),n.caculateChip()},a)))}if(!h){h=!0;var m=this.slotInfor[t.pot].getChildByName("0").convertToWorldSpace(cc.v2(0,0)),p=this.node.convertToNodeSpaceAR(m),g=cc.moveTo(.3,p).easing(cc.easeOut(2));a.runAction(cc.sequence(g,cc.callFunc(function(){i._poolChip.put(a),n.caculateChip()},a)))}this.audioManager.playChipBay()},onShakeBow:function(){this._disableEfectSlostWin();var t=this,e=this.bowDice.getComponent(cc.Animation),n=cc.sequence(cc.callFunc(t._closeBow()),cc.delayTime(1.5),cc.callFunc(function(){e.play("Shake"),t.xocAudioId=t.audioManager.playXoc(!0)},this));this.bow.runAction(n)},clickReBet:function(){this.gameManager.sendReBet()},clickDoubleBet:function(){this.gameManager.sendDoubleBet()},clickCancelBet:function(){this.gameManager.sendCancelBet()},clickRequestBanker:function(){this.gameManager.sendRequestBanker()},_openBow:function(){var t=this;t.timeLabel.node.active=!1,t.timeCountDow.node.active=!1;var e=cc.sequence(cc.scaleTo(.5,2.5,2.5),cc.delayTime(.5),cc.callFunc(function(){var e=cc.moveTo(1,cc.p(-90,0)).easing(cc.easeOut(2));t.bow.runAction(e)}));this.bowDice.runAction(e)},_closeBow:function(){var t=this,e=cc.sequence(cc.scaleTo(.5,1.28,1.28),cc.delayTime(.5),cc.callFunc(function(){var e=cc.moveTo(1,cc.p(0,0)).easing(cc.easeOut(2));t.bow.runAction(e)}));this.bowDice.runAction(e)},_playerBettingState:function(t){this._showTimeState(t.time)},_showTimeCountDow:function(t){this.timeLabel.string=t},_addChipBetting:function(t){var e,n,i=this;this.parentChipBetting.removeAllChildren();for(var a=0;a<t.length;a+=1)e=cc.instantiate(this.chipPrefab),this.listChipBetting.push(e),n=e.getComponent("Chip"),n.init(t[a],r.ChipColor.findById(a).NAME),e.on(cc.Node.EventType.TOUCH_START,function(){this.activeSelectChip(!0),i._selectChip(this.node)},n),this.parentChipBetting.addChild(e);this._selectChip(this.listChipBetting[0])},_removeSelectChip:function(){for(var t=0;t<this.listChipBetting.length;t+=1){var e=this.listChipBetting[t].getComponent("Chip");e.activeSelectChip(!1)}},_selectChip:function(t){this._removeSelectChip();var e=t.getComponent("Chip");e.activeSelectChip(!0),this.moneyBetSelect=e.money}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",BauCuaConstant:"BauCuaConstant",GameConstant:"GameConstant",Utils:"Utils"}],GameplayHaiTac:[function(t,e,n){"use strict";cc._RFpush(e,"607c6Ioa55JDIWhmxVzbpha","GameplayHaiTac");var i=t("ColumnHaiTac"),a=t("NoHu"),s=t("Utils"),o=t("AuthUser"),r=t("TopPanelSlot"),c=t("UiManager"),h=t("TextJumping"),u=t("LineCuaAn"),l=t("HopQuaSlot"),d=t("GameConstant"),m=t("CommonConstant"),p=t("HaiTacConstant"),g=t("GameManagerConstant"),f=t("BaseMainGameplay");cc.Class({"extends":f,properties:{ColumnHaiTacList:{type:i,"default":[]},NoHu:a,freeTurnNode:cc.Node,freeTurnText:cc.Label,datCuaNode:cc.Node,bangThuongNode:cc.Node,HopQuaSlot:l,LineCuaAn:u,txtBetting:cc.Label,txtMoney:cc.Label,txtThang:cc.Label,lblTuQuay:cc.Label,txtAwardFreeTurn:cc.Label,txtAwardLuckyCoffer:cc.Label,particleCoin:cc.ParticleSystem,TopPanel:r,gameCmd:{"default":d.HAI_TAC.CMD,visible:!1}},$onLoad:function(){this.setGameType(p.GameType.type),this._initOnce(),this.replaying=!1,this.countRotate=0,this.countFreeTurn=0,this.countAutoRotateStep=0,this.awards=0,this.moneyExchange=0,this.resetRotatePos=-240,this.resetRotateSpacing=0,this.clickAutoPlayWhenGameFinishing=!1,this.TopPanel.setGamePlay(this),this.HopQuaSlot.gamePlay=this;var t=p.GameType.type===-1?o.currencies[m.CurrencyType.Xu.NAME].balance:o.currencies[m.CurrencyType.Ip.NAME].balance;this.txtMoney.string=s.Number.format(t),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_PREPARE,this.onPrepareGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_UPDATE,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.GET_JAR_SUCCESS,this.onGetJarSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_JAR,this.onUpdateJar,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_USER_INFO,this.onUpdateUser,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.OPEN_COFFER,this.onOpenCoffer,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_AWARD_TYPE,this.onUpdateAwardType,this),this.gameManager.eventDispatchers.local.addEventListener(g.Event.UPDATE_USER_MONEY,this._updateMoney,this),this.gameManager.getJar(),this.gameId=this.gameManager.gameId,this.TopPanel.getButtonHistory().active=!0},$onLostFocus:function(){this.lostForcus=!0},$onFocus:function(){this.lostForcus=!1,this.audioManager.stopEffect(this.audioId),cc.log("# onFocus gameState "+this.gameManager.gameState)},onPrepareGame:function(){this._autoRotate()},onFinishGame:function(t){this.awards=t.awards,this.moneyExchange=t.player.moneyExchange,this.moneyExchange>0&&(this.txtThang.node.getComponent(h).updateText(this.moneyExchange),this.particleCoin.resetSystem(),this.audioManager.playChickenRow()),this.countFreeTurn=t.freeTurnSize,this._showResult()},onUpdateAwardType:function(t){t.itemsInfo&&this.bangThuongNode.getComponent("TableBangThuongHaiTac").setData(t.itemsInfo,p.GameType.type),this.bangThuongNode.active=!0},onOpenCoffer:function(t){if(t.results){this.hasOpenHopQua=!1;for(var e=0;e<t.results.length;e+=1){var n=t.results[e].id;this.HopQuaSlot.openCoffer(n,t.results[e])}}},onUpdateUser:function(t){var e=t.value;e&&"money"===t.field&&this.txtMoney.node.getComponent(h).updateText(e)},onUpdateGame:function(t){t&&(this.txtBetting.node.getComponent(h).updateText(t.betting),this.betting=t.betting),this.datCuaNode.getComponent("TableChonDong").updateMoneyBetting(this.betting)},onUpdateJar:function(t){for(var e=t.extraParams.betting,n=0;n<p.BettingList.length;n+=1)p.BettingList[n]===e&&this.TopPanel.setMoney(n,t.money)},onGetJarSuccess:function(t){for(var e=0;e<p.BettingList.length;e+=1){var n=t.data[""+p.BettingList[e]];if(n){var i=n.currencies.IP;this.TopPanel.setMoney(e,i)}}},onStartGame:function(t){var e=t.result;this._rotate(e)},onPlayClick:function(){this._initOnce(),this.lostForcus||this.audioManager.playButtonClick(),this.HopQuaSlot.node.active=!1;var t=this.betting,e=this.datCuaNode.getComponent("TableChonDong").getPots();if(e.length<1)return c.openWarningMessage("Xin vui lòng chọn dòng cược trước khi quay!",1),void(this.autoPlay&&this.onAutoPlayClick());var n=p.GameType.type===-1?m.CurrencyType.Xu.NAME:m.CurrencyType.Ip.NAME;this.gameManager.gameState===p.GameState.NONE?(this.gameManager.sendStartGame(t,e,n),this.clickAutoPlayWhenGameFinishing=!1):this.clickAutoPlayWhenGameFinishing||(cc.log("Đang quay xin vui lòng chờ lượt quay kết thúc : gameState "+this.gameManager.gameState),c.openWarningMessage("Đang quay xin vui lòng chờ lượt quay kết thúc!",1));var i=o.currencies[m.CurrencyType.Ip.NAME].balance,a=t*e.length;this.autoPlay&&i<a&&(this.onAutoPlayClick(),cc.log("Not enought money => cancel auto play"))},setGameType:function(t){for(var e=0;e<this.ColumnHaiTacList.length;e+=1)this.ColumnHaiTacList[e].type=t},onMenuClick:function(){},onBangThuongClick:function(){this.gameManager.updateAwardType(),this.audioManager.playButtonClick()},onDongClick:function(){this.datCuaNode.active=!0,this.audioManager.playButtonClick()},onAutoPlayClick:function(){this.autoPlay=!this.autoPlay,this.lblTuQuay.string=this.autoPlay?"HỦY\nQUAY":"TỰ\nQUAY",this.autoPlay&&this.gameManager.gameState===p.GameState.NONE?this.onPlayClick():this.clickAutoPlayWhenGameFinishing=this.autoPlay,this.audioManager.playButtonClick()},_autoRotate:function(){if(this.autoPlay){var t=this.lostForcus&&this.gameManager.gameState===p.GameState.NONE;this.countAutoRotateStep>=3||t||this.clickAutoPlayWhenGameFinishing?(this.countAutoRotateStep=0,this.onPlayClick(),t&&cc.log("########## this.lostForcus => autoPlay")):this.countAutoRotateStep+=1}},_stopGamePlay:function(){for(var t=0;t<this.ColumnHaiTacList.length;t+=1){var e=this.ColumnHaiTacList[t].node;e.stopAllActions(),e.y=this.resetRotatePos}},_rotate:function(t){this.lostForcus||(this.audioId=this.audioManager.playVongQuay()),this.countAutoRotateStep=0,this._resetLine(),this.txtThang.string="0",this.awards=0,this.replaying=!1,this.countRotate=0,this.moneyExchange=0,this.gameManager.isFreeTurn=this.countFreeTurn>0;var e,n,i=[],a=0,s=0,o=0,r=this;if(s=this.ColumnHaiTacList[0].itemList.length,void 0!==this.ingnoreFirstTime)for(e=0;e<this.ColumnHaiTacList.length;e+=1)for(var c=0;c<3;c+=1){o=s-1+(c-2),a=this.ColumnHaiTacList[e].itemList[c].type;var h=this.ColumnHaiTacList[e].itemList[o].id;this.ColumnHaiTacList[e].itemList[c].setType(a,h)}for(e=0;e<this.ColumnHaiTacList.length;e+=1)n=this.ColumnHaiTacList[e].node,n.stopAllActions(),n.y=this.resetRotatePos,i.push(.2*e);var u=0,l=0;for(e=0;e<t.length;e+=1){
o=s-1-l;var d=this.ColumnHaiTacList[u].itemList[o];d.setType(d.type,t[e]-1),u+=1,u>=5&&(l+=1,u=0)}for(i=this.shuffle(i),e=0;e<this.ColumnHaiTacList.length;e+=1){n=this.ColumnHaiTacList[e].node;var m=n.getContentSize().height-480-2*this.resetRotateSpacing;this.lostForcus?(n.y=n.y-m,r.countRotate+=1,r.countRotate>=5&&r._showResult()):n.runAction(cc.sequence(cc.delayTime(i[e]),cc.moveTo(4,cc.v2(n.x,n.y-m)).easing(cc.easeQuinticActionOut()),cc.callFunc(function(){r.countRotate+=1,r.countRotate>=5&&(r._showResult(),r.audioManager.stopEffect(r.audioId))})))}this.ingnoreFirstTime=!0},_showFreeTurnRemain:function(){this.freeTurnNode.active=this.countFreeTurn>0,this.freeTurnText.string="BẠN CÒN "+this.countFreeTurn+" LƯỢT QUAY MIỄN PHÍ"},_showResult:function(){0===this.awards||this.countRotate<5||(this.awards.length>0?this._showLineFinish(this.awards):(this._autoRotate(),this._autoRotate(),this._autoRotate(),this._showFreeTurnRemain()))},_showLineFinish:function(t){var e,n=this,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].pot);for(this._resetLine(),e=0;e<i.length;e+=1)e>=i.length-1?n.LineCuaAn.activeLine(i[e]-1,function(){n._autoRotate()}):n.LineCuaAn.activeLine(i[e]-1);if(!this.replaying){var a=0,s=0,o=0;for(e=0;e<this.awards.length;e+=1)"free_turn"===this.awards[e].awardType?a+=this.awards[e].ratio:"lucky_coffer"===this.awards[e].awardType?s+=this.awards[e].ratio:"jar"===this.awards[e].awardType&&(o+=this.awards[e].ratio);this.hasOpenHopQua=!0,this._showFreeTurnRemain(),this._showFreeTurn(a),this._showNoHuAndLuckyCoffer(o,s)}if(!this.autoPlay)for(this.replaying=!0,e=0;e<i.length;e+=1)!function(a,s){n.node.runAction(cc.sequence(cc.delayTime(3+3*e),cc.callFunc(function(){n.LineCuaAn.activeLine(a,function(){s>=i.length-1&&n.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){n._showLineFinish(t)})))})})))}(i[e]-1,e)},_showFreeTurn:function(t){t>0&&(this.txtAwardFreeTurn.node.active=!0,this.txtAwardFreeTurn.string="Bạn nhận được "+t+" lượt quay miễn phí",this.txtAwardFreeTurn.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.txtAwardFreeTurn.node.active=!1}.bind(this)))))},_showLuckyCoffer:function(t){this.HopQuaSlot.setMaxCoffer(t),t>0&&this.hasOpenHopQua?(this.txtAwardLuckyCoffer.node.active=!0,this.txtAwardLuckyCoffer.string="Bạn nhận được "+t+" hộp quà may mắn",this.txtAwardLuckyCoffer.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.txtAwardLuckyCoffer.node.active=!1,this.hasOpenHopQua?this.HopQuaSlot.show(t,function(){this._autoRotate()}.bind(this)):(cc.log("######## hasOpenHopQua false => ko hien thi"),this._autoRotate())}.bind(this))))):this._autoRotate()},_showNoHuAndLuckyCoffer:function(t,e){t>0?this.NoHu.show(function(){this._autoRotate(),this._showLuckyCoffer(e)}.bind(this)):(this._autoRotate(),this._showLuckyCoffer(e))},_resetLine:function(){this.node.stopAllActions(),this.LineCuaAn.resetAllLine(),this.HopQuaSlot.node.stopAllActions(),this.txtAwardLuckyCoffer.node.stopAllActions(),this.txtAwardFreeTurn.node.stopAllActions(),this.HopQuaSlot.node.active=!1,this.txtAwardLuckyCoffer.node.active=!1,this.txtAwardFreeTurn.node.active=!1},_initOnce:function(){void 0===this.betting&&(this.betting=100,this.autoPlay=!1)},_updateMoney:function(t){var e=t.money;e&&(t.currency===m.CurrencyType.Xu.NAME&&p.GameType.type===-1||t.currency===m.CurrencyType.Ip.NAME&&p.GameType.type!==-1)&&this.txtMoney.node.getComponent(h).updateText(e)},shuffle:function(t){for(var e,n,i=t.length;0!==i;)n=Math.floor(Math.random()*i),i-=1,e=t[i],t[i]=t[n],t[n]=e;return t}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",ColumnHaiTac:"ColumnHaiTac",CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",HaiTacConstant:"HaiTacConstant",HopQuaSlot:"HopQuaSlot",LineCuaAn:"LineCuaAn",NoHu:"NoHu",TextJumping:"TextJumping",TopPanelSlot:"TopPanelSlot",UiManager:"UiManager",Utils:"Utils"}],GameplayHoaQua:[function(t,e,n){"use strict";cc._RFpush(e,"3687cNdZ8hDD622zE72UXQE","GameplayHoaQua");var i=t("ColumnHoaQua"),a=t("NoHu"),s=t("Utils"),o=t("AuthUser"),r=t("TopPanelSlot"),c=t("UiManager"),h=t("TextJumping"),u=t("LineCuaAn"),l=t("HopQuaSlot"),d=t("GameConstant"),m=t("CommonConstant"),p=t("HoaQuaConstant"),g=t("GameManagerConstant"),f=t("BaseMainGameplay");cc.Class({"extends":f,properties:{ColumnHoaQuaList:{type:i,"default":[]},NoHu:a,freeTurnNode:cc.Node,freeTurnText:cc.Label,datCuaNode:cc.Node,bangThuongNode:cc.Node,HopQuaSlot:l,LineCuaAn:u,txtBetting:cc.Label,txtMoney:cc.Label,txtThang:cc.Label,lblTuQuay:cc.Label,txtAwardFreeTurn:cc.Label,txtAwardLuckyCoffer:cc.Label,particleCoin:cc.ParticleSystem,TopPanel:r,gameCmd:{"default":d.HOA_QUA.CMD,visible:!1}},$onLoad:function(){this.setGameType(p.GameType.type),this._initOnce(),this.replaying=!1,this.countRotate=0,this.countFreeTurn=0,this.countAutoRotateStep=0,this.awards=0,this.moneyExchange=0,this.resetRotatePos=-240,this.resetRotateSpacing=0,this.clickAutoPlayWhenGameFinishing=!1,this.TopPanel.setGamePlay(this),this.HopQuaSlot.gamePlay=this;var t=p.GameType.type===-1?o.currencies[m.CurrencyType.Xu.NAME].balance:o.currencies[m.CurrencyType.Ip.NAME].balance;this.txtMoney.string=s.Number.format(t),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_PREPARE,this.onPrepareGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_UPDATE,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.GET_JAR_SUCCESS,this.onGetJarSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_JAR,this.onUpdateJar,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_USER_INFO,this.onUpdateUser,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.OPEN_COFFER,this.onOpenCoffer,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_AWARD_TYPE,this.onUpdateAwardType,this),this.gameManager.eventDispatchers.local.addEventListener(g.Event.UPDATE_USER_MONEY,this._updateMoney,this),this.gameManager.getJar(),this.gameId=this.gameManager.gameId,this.TopPanel.getButtonHistory().active=!0},$onLostFocus:function(){this.lostForcus=!0},$onFocus:function(){this.lostForcus=!1,this.audioManager.stopEffect(this.audioId),cc.log("# onFocus gameState "+this.gameManager.gameState)},onPrepareGame:function(){this._autoRotate()},onFinishGame:function(t){this.awards=t.awards,this.moneyExchange=t.player.moneyExchange,this.moneyExchange>0&&(this.txtThang.node.getComponent(h).updateText(this.moneyExchange),this.particleCoin.resetSystem(),this.audioManager.playChickenRow()),this.countFreeTurn=t.freeTurnSize,this._showResult()},onUpdateAwardType:function(t){t.itemsInfo&&this.bangThuongNode.getComponent("TableBangThuongHoaQua").setData(t.itemsInfo,p.GameType.type),this.bangThuongNode.active=!0},onOpenCoffer:function(t){if(t.results){this.hasOpenHopQua=!1;for(var e=0;e<t.results.length;e+=1){var n=t.results[e].id;this.HopQuaSlot.openCoffer(n,t.results[e])}}},onUpdateUser:function(t){var e=t.value;e&&"money"===t.field&&this.txtMoney.node.getComponent(h).updateText(e)},onUpdateGame:function(t){t&&(this.txtBetting.node.getComponent(h).updateText(t.betting),this.betting=t.betting),this.datCuaNode.getComponent("TableChonDong").updateMoneyBetting(this.betting)},onUpdateJar:function(t){for(var e=t.extraParams.betting,n=0;n<p.BettingList.length;n+=1)p.BettingList[n]===e&&this.TopPanel.setMoney(n,t.money)},onGetJarSuccess:function(t){for(var e=0;e<p.BettingList.length;e+=1){var n=t.data[""+p.BettingList[e]];if(n){var i=n.currencies.IP;this.TopPanel.setMoney(e,i)}}},onStartGame:function(t){var e=t.result;this._rotate(e)},onPlayClick:function(){this._initOnce(),this.lostForcus||this.audioManager.playButtonClick(),this.HopQuaSlot.node.active=!1;var t=this.betting,e=this.datCuaNode.getComponent("TableChonDong").getPots();if(e.length<1)return c.openWarningMessage("Xin vui lòng chọn dòng cược trước khi quay!",1),void(this.autoPlay&&this.onAutoPlayClick());var n=p.GameType.type===-1?m.CurrencyType.Xu.NAME:m.CurrencyType.Ip.NAME;this.gameManager.gameState===p.GameState.NONE?(this.gameManager.sendStartGame(t,e,n),this.clickAutoPlayWhenGameFinishing=!1):this.clickAutoPlayWhenGameFinishing||(cc.log("Đang quay xin vui lòng chờ lượt quay kết thúc : gameState "+this.gameManager.gameState),c.openWarningMessage("Đang quay xin vui lòng chờ lượt quay kết thúc!",1));var i=o.currencies[m.CurrencyType.Ip.NAME].balance,a=t*e.length;this.autoPlay&&i<a&&(this.onAutoPlayClick(),cc.log("Not enought money => cancel auto play"))},setGameType:function(t){for(var e=0;e<this.ColumnHoaQuaList.length;e+=1)this.ColumnHoaQuaList[e].type=t},onMenuClick:function(){},onBangThuongClick:function(){this.gameManager.updateAwardType(),this.audioManager.playButtonClick()},onDongClick:function(){this.datCuaNode.active=!0,this.audioManager.playButtonClick()},onAutoPlayClick:function(){this.autoPlay=!this.autoPlay,this.lblTuQuay.string=this.autoPlay?"HỦY\nQUAY":"TỰ\nQUAY",this.autoPlay&&this.gameManager.gameState===p.GameState.NONE?this.onPlayClick():this.clickAutoPlayWhenGameFinishing=this.autoPlay,this.audioManager.playButtonClick()},_autoRotate:function(){if(this.autoPlay){var t=this.lostForcus&&this.gameManager.gameState===p.GameState.NONE;this.countAutoRotateStep>=3||t||this.clickAutoPlayWhenGameFinishing?(this.countAutoRotateStep=0,this.onPlayClick(),t&&cc.log("########## this.lostForcus => autoPlay")):this.countAutoRotateStep+=1}},_stopGamePlay:function(){for(var t=0;t<this.ColumnHoaQuaList.length;t+=1){var e=this.ColumnHoaQuaList[t].node;e.stopAllActions(),e.y=this.resetRotatePos}},_rotate:function(t){this.lostForcus||(this.audioId=this.audioManager.playVongQuay()),this.countAutoRotateStep=0,this._resetLine(),this.txtThang.string="0",this.awards=0,this.replaying=!1,this.countRotate=0,this.moneyExchange=0,this.gameManager.isFreeTurn=this.countFreeTurn>0;var e,n,i=[],a=0,s=0,o=0,r=this;if(s=this.ColumnHoaQuaList[0].itemList.length,void 0!==this.ingnoreFirstTime)for(e=0;e<this.ColumnHoaQuaList.length;e+=1)for(var c=0;c<3;c+=1){o=s-1+(c-2),a=this.ColumnHoaQuaList[e].itemList[c].type;var h=this.ColumnHoaQuaList[e].itemList[o].id;this.ColumnHoaQuaList[e].itemList[c].setType(a,h)}for(e=0;e<this.ColumnHoaQuaList.length;e+=1)n=this.ColumnHoaQuaList[e].node,n.stopAllActions(),n.y=this.resetRotatePos,i.push(.2*e);var u=0,l=0;for(e=0;e<t.length;e+=1){o=s-1-l;var d=this.ColumnHoaQuaList[u].itemList[o];d.setType(d.type,t[e]-1),u+=1,u>=5&&(l+=1,u=0)}for(i=this.shuffle(i),e=0;e<this.ColumnHoaQuaList.length;e+=1){n=this.ColumnHoaQuaList[e].node;var m=n.getContentSize().height-480-2*this.resetRotateSpacing;this.lostForcus?(n.y=n.y-m,r.countRotate+=1,r.countRotate>=5&&r._showResult()):n.runAction(cc.sequence(cc.delayTime(i[e]),cc.moveTo(4,cc.v2(n.x,n.y-m)).easing(cc.easeQuinticActionOut()),cc.callFunc(function(){r.countRotate+=1,r.countRotate>=5&&(r._showResult(),r.audioManager.stopEffect(r.audioId))})))}this.ingnoreFirstTime=!0},_showFreeTurnRemain:function(){this.freeTurnNode.active=this.countFreeTurn>0,this.freeTurnText.string="BẠN CÒN "+this.countFreeTurn+" LƯỢT QUAY MIỄN PHÍ"},_showResult:function(){0===this.awards||this.countRotate<5||(this.awards.length>0?this._showLineFinish(this.awards):(this._autoRotate(),this._autoRotate(),this._autoRotate(),this._showFreeTurnRemain()))},_showLineFinish:function(t){var e,n=this,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].pot);for(this._resetLine(),e=0;e<i.length;e+=1)e>=i.length-1?n.LineCuaAn.activeLine(i[e]-1,function(){n._autoRotate()}):n.LineCuaAn.activeLine(i[e]-1);if(!this.replaying){var a=0,s=0,o=0;for(e=0;e<this.awards.length;e+=1)"free_turn"===this.awards[e].awardType?a+=this.awards[e].ratio:"lucky_coffer"===this.awards[e].awardType?s+=this.awards[e].ratio:"jar"===this.awards[e].awardType&&(o+=this.awards[e].ratio);this.hasOpenHopQua=!0,this._showFreeTurnRemain(),this._showFreeTurn(a),this._showNoHuAndLuckyCoffer(o,s)}if(!this.autoPlay)for(this.replaying=!0,e=0;e<i.length;e+=1)!function(a,s){n.node.runAction(cc.sequence(cc.delayTime(3+3*e),cc.callFunc(function(){n.LineCuaAn.activeLine(a,function(){s>=i.length-1&&n.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){n._showLineFinish(t)})))})})))}(i[e]-1,e)},_showFreeTurn:function(t){t>0&&(this.txtAwardFreeTurn.node.active=!0,this.txtAwardFreeTurn.string="Bạn nhận được "+t+" lượt quay miễn phí",this.txtAwardFreeTurn.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.txtAwardFreeTurn.node.active=!1}.bind(this)))))},_showLuckyCoffer:function(t){this.HopQuaSlot.setMaxCoffer(t),t>0&&this.hasOpenHopQua?(this.txtAwardLuckyCoffer.node.active=!0,this.txtAwardLuckyCoffer.string="Bạn nhận được "+t+" hộp quà may mắn",this.txtAwardLuckyCoffer.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.txtAwardLuckyCoffer.node.active=!1,this.hasOpenHopQua?this.HopQuaSlot.show(t,function(){this._autoRotate()}.bind(this)):(cc.log("######## hasOpenHopQua false => ko hien thi"),this._autoRotate())}.bind(this))))):this._autoRotate()},_showNoHuAndLuckyCoffer:function(t,e){t>0?this.NoHu.show(function(){this._autoRotate(),this._showLuckyCoffer(e)}.bind(this)):(this._autoRotate(),this._showLuckyCoffer(e))},_resetLine:function(){this.node.stopAllActions(),this.LineCuaAn.resetAllLine(),this.HopQuaSlot.node.stopAllActions(),this.txtAwardLuckyCoffer.node.stopAllActions(),this.txtAwardFreeTurn.node.stopAllActions(),this.HopQuaSlot.node.active=!1,this.txtAwardLuckyCoffer.node.active=!1,this.txtAwardFreeTurn.node.active=!1},_initOnce:function(){void 0===this.betting&&(this.betting=100,this.autoPlay=!1)},_updateMoney:function(t){var e=t.money;e&&(t.currency===m.CurrencyType.Xu.NAME&&p.GameType.type===-1||t.currency===m.CurrencyType.Ip.NAME&&p.GameType.type!==-1)&&this.txtMoney.node.getComponent(h).updateText(e)},shuffle:function(t){for(var e,n,i=t.length;0!==i;)n=Math.floor(Math.random()*i),i-=1,e=t[i],t[i]=t[n],t[n]=e;return t}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",ColumnHoaQua:"ColumnHoaQua",CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",HoaQuaConstant:"HoaQuaConstant",HopQuaSlot:"HopQuaSlot",LineCuaAn:"LineCuaAn",NoHu:"NoHu",TextJumping:"TextJumping",TopPanelSlot:"TopPanelSlot",UiManager:"UiManager",Utils:"Utils"}],GameplayLieng:[function(t,e,n){"use strict";cc._RFpush(e,"fa970BMRsFESp03nM/3N81w","GameplayLieng");var i=t("LiengConstant"),a=t("Utils"),s=t("AuthUser"),o=t("Card"),r=t("Slider"),c=t("GameConstant"),h=t("BaseMainGameplay"),u=t("EventDispatcher"),l=t("EventDispatcherConstant");cc.Class({"extends":h,properties:{cardPrefab:cc.Prefab,chipPrefab:cc.Prefab,dealer:cc.Node,totalMoneyCallLabel:cc.Label,countDownTimeLabel:cc.Label,gameStateLabel:cc.Label,bettingSlider:r,chipContainer:cc.Node,currencyPiImage:{"default":[],type:cc.Node},bettingButtonsList:{"default":[],type:cc.Button},chipTemplateList:{"default":[],type:cc.Node},gameCmd:{"default":c.LIENG.CMD,visible:!1}},$onLoad:function(){this.gameManager.eventDispatchers.local.addEventListener(i.Event.START_TIME,this.onShowStartTime,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.USER_BET,this.onBettingSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.CHANGE_STATE,this.onChangeStateGame,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.CHANGE_TURN,this.onChangeTurn,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.DRAW_CARD,this.onDrawCard,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.FINISH_GAME,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.UPDATE_GAME,this.updateInfoGame,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.REFRESH_GAME,this.restartGameWhenNewMatch,this),u.addEventListener(l.PROFILE.UPDATE_INFO,this.onUpdateUserInfo,this),this.playerNodeList[0].node.parent.zIndex=1},$onUpdate:function(){if(this.gameManager&&(this.gameManager.gameState===i.GameState.WAITING_FOR_NEW_GAME||this.gameManager.gameState===i.GameState.FINISH||this.gameManager.gameState===i.GameState.FINALIZING)){var t=Math.floor((this.countDownTime-Date.now())/1e3);t=t>=0?t:0,this.countDownTimeLabel.string=t,0===t&&(this.countDownTimeLabel.node.active=!1,this.gameStateLabel.node.active=!1,this.gameManager.gameState!==i.GameState.FINISH&&this.gameManager.gameState!==i.GameState.FINALIZING||(this.restartGame(),this.gameStateLabel.string="Ván mới sẽ được bắt đầu trong giây lát.",this.gameStateLabel.node.active=!0,this.gameManager.gameState=i.GameState.NONE))}},bettingCall:function(){this.gameManager.bet(i.Action.CALL),this.bettingSlider.node.active=!1,this.audioManager.playButtonClick()},bettingCheck:function(){this.gameManager.bet(i.Action.CHECK),this.bettingSlider.node.active=!1,this.audioManager.playButtonClick()},bettingFold:function(){this.gameManager.bet(i.Action.FOLD),this.bettingSlider.node.active=!1,this.audioManager.playButtonClick()},bettingNormal:function(){this.bettingSlider.node.active?(this.gameManager.bet(i.Action.BET,this.bettingSlider.currentValue),this.bettingSlider.node.active=!1):this.bettingSlider.node.active=!0,this.audioManager.playButtonClick()},onShowStartTime:function(t){this.restartGame(),this.gameStateLabel.string="Chuẩn bị ván mới",this.gameStateLabel.node.active=!0,this.countDownTime=Date.now()+t,this.countDownTimeLabel.string=Math.floor(t/1e3),this.countDownTimeLabel.node.active=!0},onBettingSuccess:function(t){var e=this.findPlayerNodeByName(t.data.userName);e&&e.player&&(e.clearCountDown(),0===e.player.data.money?e.setEffect(this.convertTypeBetting(i.Action.ALL_HAND)):e.setEffect(this.convertTypeBetting(t.action)),t.action===i.Action.FOLD&&(s.username===t.data.userName?e.getComponent("PlayerUIXiTo").currentPlayerFold():e.getComponent("PlayerUIXiTo").fold()),this.onShowBetting(t,e))},onChangeTurn:function(t){var e,n=0;for(this.bettingSlider&&(this.bettingSlider.node.active=!1),this.audioManager.playTurnStart(),n=0;n<this.playerNodeList.length;n+=1){var a=this.playerNodeList[n];if(e=a.player)if(e.data.username===t.data.userName){var o=0;t.__execInfo__&&(o=t.__execInfo__.dt),a.setCountDown(t.data.time-o),a.clearEffects(),this.playerNodeList[0].player.data.username===t.data.userName?this.setCurrentPlayerInTurn(t.data.allowedActions,t.data.minBetting,t.data.maxBetting):this.disableBettingButtons(!0)}else e.data.state===i.PlayerState.ALL_IN&&a.setEffect(this.convertTypeBetting(i.Action.ALL_HAND)),e.data.state===i.PlayerState.FOLDED&&(s.username===e.data.username?a.getComponent("PlayerUIXiTo").currentPlayerFold():a.getComponent("PlayerUIXiTo").fold())}this.onReDrawCard()},onDrawCard:function(){var t,e=0,n=.3,a=.06,s=0,o=20,r=0,h=0;for(this.hideStartTime(),r=0;r<this.playerNodeList.length;r+=1)if(this.playerNodeList[r].player&&this.playerNodeList[r].player.data.handSize>0&&this.playerNodeList[r].player.data.state!==i.PlayerState.OFF_MONEY){var u=this.playerNodeList[r].node.getComponent("PlayerUIXiTo"),l=this.playerNodeList[r].player.data;for(h=u.getNumberActiveChildren();h<l.handSize;h+=1){this.playerNodeList[r].node.zIndex=o,t=cc.instantiate(this.cardPrefab),t.setScale(.5,.5),t.zIndex=o,t.parent=this.dealer,o-=1,e+=1;var d;d=0===r&&this.playerNodeList[r].player.data.state!==i.PlayerState.FOLD?l.cards[h]:this.gameCmd===c.XITO.CMD&&l.handSize<this.gameManager.gameType?l.publicCards[h-(l.handSize-l.publicCards.length)]:null,this.drawCardEffect(t,this.playerNodeList[r],n,a*e,s,d)}}},onFinishGame:function(t){var e=0;t.__execInfo__&&(e=t.__execInfo__.dt),this.onShowFinishTime(t.data.time-e),this.disableBettingButtons(!0),this.gameCmd===c.XITO.CMD?this.bettingPanel.active=!1:this.bettingSlider.node.active=!1;for(var n=0;n<t.data.players.length;n+=1){var o=this.findPlayerNodeByName(t.data.players[n].userName);if(o){if(this.setCallMoneyPlayer(o,!1,0),t.data.players[n].cards)if(this.gameCmd===c.XITO.CMD)o.node.getComponent("PlayerUIXiTo").showAllCards(t.data.players[n].cards,t.data.players[n].bestCards,t.data.players[n].bestCardsType,this.gameCmd,t.data.time/1e3);else{var r="";r="Điểm"===t.data.players[n].typeCards?t.data.players[n].point+" "+t.data.players[n].typeCards:t.data.players[n].typeCards,o.node.getComponent("PlayerUIXiTo").showAllCards(t.data.players[n].cards,t.data.players[n].cards,r,this.gameCmd,t.data.time/1e3)}if(o.player.data.state!==i.PlayerState.FOLD){if(o.setFinishEffect(t.data.players[n].moneyExchange),t.data.players[n].moneyExchange>0){a.Node.destroyAllChildrenInNode(this.chipContainer);var h=this.calculateNumberChipType(t.data.players[n].moneyExchange,this.chipContainer),u=h.parent.convertToWorldSpace(h.position);h.parent=o.node,o.player.data.username!==s.username&&h.setScale(.7);var l=o.node.convertToNodeSpace(u);h.position=l;var d=cc.sequence(cc.delayTime(1.5),cc.moveTo(.3,cc.p(0,0)),cc.removeSelf());d.easing(cc.easeQuadraticActionOut()),h.runAction(d),this.audioManager.playChipBay()}t.data.players[n].userName===s.username&&(t.data.players[n].moneyExchange>0?this.audioManager.playWin():this.audioManager.playLose())}}}},updateInfoGame:function(t){this.coutUpdateGame=1;var e=0;if(t.allData.totalBetting&&(this.calculateNumberChipType(t.allData.totalBetting,this.chipContainer),this.totalMoneyCallLabel.string=a.Number.format(t.allData.totalBetting)),"XU"===this.gameManager.currency)for(e=0;e<this.currencyPiImage.length;e+=1)this.currencyPiImage[e].active=!1;this.initAllBettingButtons();var n,o;for(t.data.gameState!==i.GameState.FINISH&&t.data.gameState!==i.GameState.FINALIZING||(o=0,t.__execInfo__&&(o=t.__execInfo__.dt),this.onShowFinishTime(t.data.time-o)),e=0;e<this.playerNodeList.length;e+=1){var r=this.playerNodeList[e];if(n=r.player){if(t.data.gameState>=i.GameState.ROUND)switch(n.data.state){case i.PlayerState.FOLDED:r.setEffect(this.convertTypeBetting(i.Action.FOLD)),s.username===n.data.username?r.getComponent("PlayerUIXiTo").currentPlayerFold():r.getComponent("PlayerUIXiTo").fold();break;case i.PlayerState.IN_TURN:o=0,t.__execInfo__&&(o=t.__execInfo__.dt),r.setCountDown(t.data.time-o);break;case i.PlayerState.ALL_IN:r.setEffect(this.convertTypeBetting(i.Action.ALL_HAND))}0===e&&(this.gameCmd===c.XITO.CMD?this.setCurrentPlayerInTurn(n.data.allowedActions,n.data.actionMoneyList):this.setCurrentPlayerInTurn(n.data.allowedActions,n.data.minBetting,n.data.maxBetting))}}},initAllBettingButtons:function(){this.allButtonBettings={},this.allButtonBettings[i.Action.BET]=this.bettingButtonsList[0],this.allButtonBettings[i.Action.RAISE]=this.bettingButtonsList[0],this.allButtonBettings[i.Action.CALL]=this.bettingButtonsList[1],this.allButtonBettings[i.Action.CHECK]=this.bettingButtonsList[2],this.allButtonBettings[i.Action.FOLD]=this.bettingButtonsList[3],this.disableBettingButtons(!0)},disableBettingButtons:function(t){for(var e=0;e<this.bettingButtonsList.length;e+=1)this.bettingButtonsList[e].interactable=!t,this.bettingButtonsList[e].node.setScale(1)},onShowBetting:function(t,e){t.data.money>0&&(this.chipEffect(t.data.money,t.allData.totalBetting,e),this.setCallMoneyPlayer(e,!0,t.data.currentBetting),this.audioManager.playCoinDrop()),this.totalMoneyCallLabel.string=a.Number.format(t.allData.totalBetting)},chipEffect:function(t,e,n){this.audioManager.playChipBay();var i=this,s=this.calculateNumberChipType(t,n.node),o=s.parent.convertToWorldSpace(s.position);s.parent=i.chipContainer,i.chipContainer.zIndex=2;var r=i.chipContainer.convertToNodeSpace(o);s.position=r;var c=cc.sequence(cc.delayTime(.5),cc.moveTo(.3,cc.p(0,0)),cc.removeSelf(),cc.callFunc(function(){a.Node.destroyAllChildrenInNode(i.chipContainer),i.calculateNumberChipType(e,i.chipContainer),i.chipContainer.zIndex=0}));c.easing(cc.easeOut(3)),s.runAction(c)},onShowFinishTime:function(t){this.countDownTime=Date.now()+t,this.countDownTimeLabel.string=Math.floor(t/1e3),this.countDownTimeLabel.node.active=!0},hideStartTime:function(){this.gameStateLabel.node.active=!1,this.countDownTimeLabel.node.active=!1},setCurrentPlayerInTurn:function(t,e,n){var i=0;if(t)for(this.disableBettingButtons(!0),i=0;i<t.length;i+=1)this.allButtonBettings[t[i]]&&(this.allButtonBettings[t[i]].interactable=!0);e&&(this.minBetting=e,this.maxBetting=n,this.bettingSlider.setDefaultValue(e,n,0,this.gameManager.bettingInfo.betting))},drawCardEffect:function(t,e,n,i,r,h){var u=e.node.getComponent("PlayerUIXiTo"),l=cc.sequence(cc.delayTime(i),cc.spawn(cc.moveTo(n,cc.p(e.node.x,e.node.y+20)),cc.rotateTo(n,r)),cc.callFunc(function(){if(e.player&&u.getNumberActiveChildren()<e.player.data.handSize){if(e.player.data.username===s.username){var n=u.findCard(h);if(n)return n.node.position=cc.p(0,0),void t.destroy()}var i=u.getNumberActiveChildren(),r=u.cardsHold[i];if(r){if(t.zIndex=r.node.zIndex,t.rotation=r.node.rotation,t.position=r.node.position,t.parent=r.node.parent,t.setSiblingIndex(r.node.getSiblingIndex()),this.gameCmd===c.XITO.CMD){var l=r.getComponent(cc.Button);if(l){var d=t.addComponent(cc.Button);d.clickEvents=l.clickEvents}}if(t){var m=t.getComponent("CardUI");u.cardsHold[i]=m,r.node.destroy(),m.node.active=!0,e.player.data.cards&&(h=e.player.data.cards[i]),a.Type.isNumber(h)&&h>=0&&(m.setCard(o.fromId(h)),m.showTransparentBlackNode(!1)),this.finishDrawCard(m,e)}}}else t.destroy()},this));l.easing(cc.easeQuadraticActionOut()),t.runAction(l)},finishDrawCard:function(t,e){t.node.setScale(.5,.5),t.node.runAction(cc.scaleTo(.3,1)),e&&this.onReDrawCard()},onReDrawCard:function(){for(var t=0;t<this.playerNodeList.length;t+=1)if(this.playerNodeList[t].player){var e=this.playerNodeList[t].node.getComponent("PlayerUIXiTo"),n=this.playerNodeList[t].player.data;this.reDrawCard(n,e,t)}},reDrawCard:function(t,e,n){var a,s=0;if(0===n)for(s=0;s<t.handSize;s+=1)a=e.cardsHold[s].getComponent("CardUI"),a.card&&a.card.getId()!==t.cards[s]&&(a.setCard(o.fromId(t.cards[s])),a.showTransparentBlackNode(!1));else for(s=0;s<t.handSize;s+=1)a=e.cardsHold[s].getComponent("CardUI"),a.fold(),t.cards&&t.cards[s]>0&&a.setCard(o.fromId(t.cards[s]));t.state===i.PlayerState.FOLDED&&(0!==n?e.fold():e.currentPlayerFold())},setCallMoneyPlayer:function(t,e,n){var i=t.getComponent("PlayerUIXiTo");i&&i.callMoneyNode&&i.callMoneyLabel&&(i.callMoneyNode.active=e,i.callMoneyLabel.string=a.Number.format(n))},convertTypeBetting:function(t){switch(t){case i.Action.BET:case i.Action.RAISE:return i.Effect.TO;case i.Action.CALL:return i.Effect.THEO;case i.Action.CHECK:return i.Effect.NHUONG_TO;case i.Action.FOLD:return i.Effect.UP_BO;case i.Action.ALL_HAND:return i.Effect.CHOI_TAT_TAY;case i.Action.BET_1_2:return i.Effect.TO_12;case i.Action.BET_1_4:return i.Effect.TO_14;case i.Action.BET_X2:return i.Effect.TO_X2;case i.Action.ALL_IN:return i.Effect.TO_TAT_CA}},restartGameWhenNewMatch:function(){return 1===this.coutUpdateGame?void(this.coutUpdateGame-=1):(a.Node.destroyAllChildrenInNode(this.dealer),this.dealer.removeAllChildren(),void this.restartGame())},restartGame:function(){a.Node.destroyAllChildrenInNode(this.chipContainer),this.totalMoneyCallLabel.string="0";for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].node.getComponent("PlayerUIXiTo").deactiveAllCards(),this.playerNodeList[t].clearEffects(),this.setCallMoneyPlayer(this.playerNodeList[t],!1,0);this.hideStartTime()},onPrePlayerRemoved:function(t){t.node.getComponent("PlayerUIXiTo").deactiveAllCards(),t.clearEffects(),this.setCallMoneyPlayer(t,!1,0)},onPostPlayerAdded:function(t){t.player&&(t.player.data.state!==i.PlayerState.NONE&&t.player.data.state!==i.PlayerState.OFF_MONEY||t.addEffect(i.Effect.DANG_DOI))},calculateNumberChipType:function(t,e){var n=t.toString().split("").reverse().join(""),i=new cc.Node,a=0,s=0,o=0,r=50;i.parent=e,i.setScale(.6),i.position=cc.p(0,0),i.zIndex=15;for(var c=0;c<n.length;c+=1){var h=parseInt(n[c]);if(h>0){for(var u,l=0;l<h;l+=1){u=cc.instantiate(this.chipTemplateList[c]),u.parent=i,u.position=cc.p(s+a*u.width*.4,o+a*u.height*.8+10*l),u.zIndex=r,u.rotaion=360*Math.random();var d=cc.rotateBy(.1,-350);d.easing(cc.easeQuadraticActionOut()),u.runAction(d)}a+=1,r-=1,a%2===0&&(o-=.4*u.height,s+=.8*u.width,a=0,r=50)}}return i}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",Card:"Card",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameConstant:"GameConstant",LiengConstant:"LiengConstant",Slider:"Slider",Utils:"Utils"}],GameplayMauBinh:[function(t,e,n){"use strict";cc._RFpush(e,"c8cackL/ntIJr3V+PXZGSBC","GameplayMauBinh");var i=t("GameConstant"),a=t("BaseMainGameplay"),s=t("MauBinhConstant"),o=t("SortCardLayoutMauBinh"),r=t("AuthUser");cc.Class({"extends":a,properties:{effectCardNode:cc.Node,lblThongBao:cc.Label,lblKetQua:cc.Label,txtThoigian:cc.Label,btnXepXong:cc.Button,btnSwapChi:cc.Button,btnStartGame:cc.Button,bottomPanel:cc.Node,bgHelp:cc.Node,cardPrefab:cc.Prefab,sortCardLayout:o,gameCmd:{"default":i.MAU_BINH.CMD,visible:!1}},$onLoad:function(){this.time=0,this.startTime=(new Date).getTime(),this.btnXepXong.node.active=!1,this.btnSwapChi.node.active=!1,this.btnStartGame.node.active=!1,this.lblKetQua.node.active=!1,this.lblThongBao.node.active=!1,this.sortCardLayout.setGameParam(this,this.gameManager),this.cardEffectList=[],this.cardEffectMainPlayerList=[],this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_UPDATE_HAND,this.onUpdateHand,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_WATING_PLAYER,this.onGameWatingPlayer,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_PREPARE,this.onGamePrepare,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_ORDER_CARD,this.onGameOrderCard,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_UPDATE,this.onGameUpdate,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_FINISH,this.onGameFinish,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_COMPARE_CHI,this.onCompareChi,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_USER_FINISH_ORDER,this.onUserFinishOrder,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_NOTIFY_THANG_TRANG,this.onNotifyThangTrang,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_NOTIFY_BINH_LUNG,this.onNotifyBinhLung,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_PLAYER_REMOVE,this.onPlayerRemove,this),this.gameManager.eventDispatchers.local.addEventListener(s.Event.GAME_PLAYER_ADD,this.onPlayerAdd,this)},$onFocus:function(){if(this.gameManager)switch(this.gameManager.gameState){case s.GameState.DEALING:break;case s.GameState.ORDER_CARDS:break;case s.GameState.FINISH:break;case s.GameState.COMPARE_1:break;case s.GameState.COMPARE_2:break;case s.GameState.COMPARE_3:}},$onLostFocus:function(){},onPostPlayerAdded:function(t){t&&t.player.data.username===r.username&&t.node.getComponent("PlayerUIMauBinh").setGamePlay(this)},reset:function(){this.bottomPanel.zIndex=0,this.lblThongBao.string="",this.lblKetQua.string="",this.txtThoigian.string="",this.btnXepXong.node.active=!1,this.btnSwapChi.node.active=!1,this.btnStartGame.node.active=!1,this.lblKetQua.node.active=!1,this.bgHelp.active=!1,this.cardEffectList=[],this.effectCardNode.removeAllChildren(),this.sortCardLayout.reset();for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].node.getComponent("PlayerUIMauBinh").reset()},onGameWatingPlayer:function(){this.lblThongBao.string="Đang đợi người chơi khác:",this.txtThoigian.string="",this.lblThongBao.node.active=!0},onGamePrepare:function(t){var e,n=0;if(t.__execInfo__&&(n=t.__execInfo__.dt),this.reset(),this.time=t.allData.time-n,!(this.time<=0)){this.startTime=(new Date).getTime(),
this.lblThongBao.node.active=!0,this.lblThongBao.string="Ván bài mới sẽ bắt đầu sau:";var i=t.allData.players;for(e=0;e<i.length;e+=1)if(i[e].username===r.username&&i[e].isMaster){this.btnStartGame.node.active=!0;break}}},onUpdateHand:function(t){this.mainPlayerCards=t.hand,this.lblThongBao.node.active=!1;var e=t.players;this.createEffectChiaBai(e),this.btnStartGame.node.active=!1},onGameOrderCard:function(t){this.lblThongBao.node.active=!0,this.txtThoigian.string="",this.lblThongBao.string="Trận đấu đang diễn ra.",this.btnStartGame.node.active=!1;var e,n,i,a=t.allData.players,o=!1;for(e=0;e<a.length;e+=1)if(i=this.getPlayerByUserName(a[e].username))if(n=i.getComponent("PlayerUIMauBinh"),n&&a[e].isActive){var c=0;t.__execInfo__&&(c=t.__execInfo__.dt);var h=t.allData.time-c;if(h<=0)return;n.setState(s.PlayerState.IN_TURN,h,a[e].isFinish),a[e].username===r.username&&(this.lblThongBao.node.active=!1,this.btnSwapChi.node.active=!0,this.btnXepXong.node.active=!0,this.sortCardLayout.node.active||(this.sortCardLayout.node.active=!0,this.sortCardLayout.setCards(a[e].cards)),(n.isThangTrang||a[e].isFinish)&&this.onClickFinishOrder()),o=this.sortCardLayout.node.active}else a[e].isActive||n.setState(s.PlayerState.WAITING,0);for(e=0;e<a.length;e+=1)i=this.getPlayerByUserName(a[e].username),i&&(n=i.getComponent("PlayerUIMauBinh"),n&&a[e].isActive&&r.username!==a[e].username&&n.showCardLayout(a[e].isActive,o));this._removeCardEffect()},onCompareChi:function(t,e){this.lblThongBao.node.active=!1,this.btnStartGame.node.active=!1;for(var n=t.allData.players,i=!1,a=0;a<n.length;a+=1)if(n[a].username===r.username&&n[a].isActive){i=!0;break}this.lblKetQua.node.active=!0,this.lblKetQua.node.scale=0,this.lblKetQua.node.stopAllActions(),this.lblKetQua.node.runAction(cc.scaleTo(.5,1)),this.txtThoigian.string="",this.lblThongBao.node.active=!1,t.action===s.Action.COMPARE_CHI_MOT?(i&&(this.btnSwapChi.node.active=!1,this.btnXepXong.node.active&&(this.btnXepXong.node.active=!1,this.hideSortCardLayout())),this.lblKetQua.string="Chi 1"):t.action===s.Action.COMPARE_CHI_HAI?this.lblKetQua.string="Chi 2":t.action===s.Action.COMPARE_CHI_BA&&(this.lblKetQua.string="Chi 3"),i||(this.lblThongBao.string="Trận đấu đang diễn ra.");for(var o=0;o<n.length;o+=1){var c=this.getPlayerByUserName(n[o].username);n[o].isActive&&c&&c.getComponent("PlayerUIMauBinh").compareChi(t.action,t.gameState,n[o],t.actions,e)}},onGameFinish:function(t){this.lblKetQua.node.active=!0,this.lblKetQua.string="Kết quả",this.lblKetQua.node.scale=0,this.lblKetQua.node.stopAllActions(),this.lblKetQua.node.runAction(cc.scaleTo(.5,1)),this.lblThongBao.node.active=!1,this.txtThoigian.string="",this.lblThongBao.string="",this.btnStartGame.node.active=!1;for(var e=t.allData.players,n=0;n<e.length;n+=1){for(var i=0,a=t.result.summary,s=0;s<a.length;s+=1)if(e[n].username===a[s].userName){i=a[s].moneyExchange;break}var o=this.getPlayerByUserName(e[n].username);o&&o.getComponent("PlayerUIMauBinh").setResult(e[n],i)}this.btnSwapChi.node.active=!1,this.btnXepXong.node.active=!1,this.hideSortCardLayout()},onPlayerRemove:function(){for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].player||this.playerNodeList[t].node.getComponent("PlayerUIMauBinh").reset()},onPlayerAdd:function(t){if(this.gameManager.gameState!==s.GameState.WAITING_DEALING){var e=this.getPlayerByUserName(t.player.username),n=e.getComponent("PlayerUIMauBinh");n&&!t.player.isActive&&n.setState(s.PlayerState.WAITING)}},onUserFinishOrder:function(t){var e=this.getPlayerByUserName(t.username);e&&e.getComponent("PlayerUIMauBinh").setState(s.PlayerState.FINISH)},onNotifyThangTrang:function(t){var e=this.getPlayerByUserName(t.username);e&&(e.getComponent("PlayerUIMauBinh").setThangTrang(t),e.getComponent("PlayerUIMauBinh").setState(s.PlayerState.FINISH),this.audioManager.playThangTrang())},onNotifyBinhLung:function(){},getPlayerByUserName:function(t){for(var e=0;e<this.playerNodeList.length;e+=1)if(this.playerNodeList[e].player&&this.playerNodeList[e].player.data.username===t)return this.playerNodeList[e].node;return null},$onUpdate:function(){var t=(new Date).getTime(),e=Math.floor((this.time-(t-this.startTime))/1e3);e<0&&(e=0),this.gameManager.gameState===s.GameState.WAITING_DEALING&&(this.txtThoigian.string=Math.floor(e+1)+" giây")},hideSortCardLayout:function(){this.sortCardLayout.setFinishOrder();for(var t=0;t<this.playerNodeList.length;t+=1)if(this.playerNodeList[t].player){var e=this.playerNodeList[t].player.data.username,n=this.getPlayerByUserName(e).getComponent("PlayerUIMauBinh");n.isActive&&(n.showCardLayout(!0,!1),e===r.username&&n.setOpenAllCards(this.sortCardLayout.getCards()))}},createEffectChiaBai:function(t){this.audioManager.playBaiChia(),this.countCardEffectFinish=0,this.cardEffectMainPlayerList=[];var e=t.length,n=0,i=12,a=13*e,s=[],o=[];for(h=0;h<e;h+=1){var c=this.getPlayerByUserName(t[h].userName);t[h].isActive&&c&&s.push(c.getComponent("PlayerUIMauBinh").cardLayout.getCardPositionList()),o.push(c.getComponent("PlayerUIMauBinh"))}for(var h=0;h<a;h+=1){var u=s[n][i];u=this.effectCardNode.convertToNodeSpaceAR(u);var l=cc.instantiate(this.cardPrefab);l.scale=.4,l.x=0,l.y=0,this.effectCardNode.addChild(l),this.cardEffectList.push(l),0===n&&this.cardEffectMainPlayerList.push(l),l.runAction(cc.sequence(cc.delayTime(.03*(a-h)),cc.moveTo(.2,u).easing(cc.easeCubicActionIn()),cc.callFunc(function(){this.countCardEffectFinish+=1;var e,n=!1;if(this.countCardEffectFinish>=a){for(h=0;h<t.length;h+=1){var i=this.getPlayerByUserName(t[h].userName);t[h].isActive&&t[h].userName===r.username&&i&&(e=i.getComponent("PlayerUIMauBinh"),this.sortCardLayout.setCards(this.mainPlayerCards),this.sortCardLayout.node.active=!0,e.showCardLayout(!1,!0),n=!0)}for(h=0;h<t.length;h+=1){var s=this.getPlayerByUserName(t[h].userName);t[h].isActive&&t[h].userName!==r.username&&s&&(e=s.getComponent("PlayerUIMauBinh"),e.showCardLayout(!0,n))}this._removeCardEffect()}}.bind(this)))),n+=1,n>=s.length&&(n=0,i-=1)}},onClickFinishOrder:function(){if(this.audioManager.playButtonClick(),this.gameManager.gameState===s.GameState.ORDER_CARDS){this.gameManager.sendRequestOrderCard(this.sortCardLayout.getCards(),!0),this.btnSwapChi.node.active=!1,this.btnXepXong.node.active=!1,this.hideSortCardLayout();var t=this.getPlayerByUserName(r.username);t&&t.getComponent("PlayerUIMauBinh").setState(s.PlayerState.FINISH)}},onClickStartGame:function(){this.audioManager.playButtonClick(),this.btnStartGame.node.active=!1,this.gameManager.gameState===s.GameState.WAITING_DEALING&&this.gameManager.sendRequestStartGame()},onClickHelp:function(){this.audioManager.playButtonClick(),this.bgHelp.active=!this.bgHelp.active,this.bottomPanel.zIndex=this.bgHelp.active?10:0,this.topPanelInGame.node.zIndex=this.bgHelp.active?0:10},onCloseHelp:function(){this.audioManager.playButtonClick(),this.bgHelp.active=!1,this.bottomPanel.zIndex=0,this.topPanelInGame.node.zIndex=10},onSwapChiClick:function(){this.audioManager.playButtonClick(),this.sortCardLayout.swapChi()},_removeCardEffect:function(){for(var t=0;t<this.cardEffectList.length;t+=1)this.cardEffectList[t].destroy();this.cardEffectList=[],this.cardEffectMainPlayerList=[]}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",GameConstant:"GameConstant",MauBinhConstant:"MauBinhConstant",SortCardLayoutMauBinh:"SortCardLayoutMauBinh"}],GameplayMiniPoker:[function(t,e,n){"use strict";cc._RFpush(e,"e7533lHLQFFN6DYsIko7b0U","GameplayMiniPoker");var i=t("Card"),a=t("Utils"),s=t("UiManager"),o=t("BaseMinigameGameplay"),r=t("GameConstant"),c=t("CommonConstant"),h=t("ToggleCurrency"),u=t("ItemTextMiniPoker"),l=t("MiniPokerConstant"),d=t("ColumnInfoMiniPoker");cc.Class({"extends":o,properties:{btnMucCuocList:{"default":[],type:cc.Node},layoutCardList:{"default":[],type:d},btnCanGat:cc.Node,thanhCanGat:cc.Node,btnCurrency:cc.Node,lblQuy:cc.Label,textFlyPrefab:cc.Prefab,btnAutoPlay:cc.Node,imgDen1:cc.Node,imgDen2:cc.Node,gameCmd:{"default":r.MINI_POKER.CMD,visible:!1}},$onLoad:function(){this.isLostFocus=!1,this.isTextShowing=!1,this.countEventFinish=0,this.potWin=0,this.autoPlay=!1,this.autoPlayTmp=!1,this.currencyIndex=this.btnCurrency.getComponent(h).index,this.moneyBetList=[100,1e3,1e4],this.quyXuList=[],this.quyPiList=[],this.paramsFinish=0,this.resetButtonMucCuoc(),this.gameManager.eventDispatchers.local.addEventListener(l.Event.TURN_PREPARE,this.onPrepareGame,this),this.gameManager.eventDispatchers.local.addEventListener(l.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(l.Event.TURN_UPDATE,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(l.Event.TURN_FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(l.Event.GET_JAR_SUCCESS,this.onGetMoneyJar,this),this.gameManager.eventDispatchers.local.addEventListener(l.Event.UPDATE_JAR,this.onUpdateMoneyJar,this)},onEnable:function(){this.reset()},$onFocus:function(){this.isLostFocus=!1,this.countEventFinish=-5,this.reset(),this.autoPlay&&this.gameManager.gameState===l.GameState.NONE&&this.onPlayClick()},$onLostFocus:function(){this.isLostFocus=!0},resetButtonMucCuoc:function(){var t;for(t=0;t<this.btnMucCuocList.length;t+=1){var e=this.btnMucCuocList[t].getComponentInChildren(cc.Label);e.string=a.Number.abbreviate(this.moneyBetList[t],3)}for(t=0;t<this.btnMucCuocList.length;t+=1){var n=this.btnMucCuocList[t].getComponent(cc.Sprite);n.enabled=0===t}},onUpdateMoneyJar:function(t){for(var e=t.money,n=t.currency===c.CurrencyType.Ip.NAME,i=0;i<this.moneyBetList.length;i+=1){var a=n?this.moneyBetList[i]:this.moneyBetList[i];a===t.betting&&(n?this.quyPiList[i]=e:this.quyXuList[i]=e)}this._updateMoneyQuy()},onGetMoneyJar:function(t){for(var e=t.data[c.CurrencyType.Ip.NAME],n=t.data[c.CurrencyType.Xu.NAME],i=0;i<this.moneyBetList.length;i+=1)this.quyPiList.push(e[this.moneyBetList[i]].balance),this.quyXuList.push(n[this.moneyBetList[i]].balance),this._updateMoneyQuy()},onPrepareGame:function(){this.autoPlay&&this.onPlayClick()},onStartGame:function(t){this.audioId=this.audioManager.playVongQuay(),this.potWin=t.potWin;for(var e=this,n=0;n<e.layoutCardList.length;n+=1){var i=e.layoutCardList[n];i.updateCardFirst()}var a=3.6,s=cc.sequence(cc.callFunc(function(){for(var t=0;t<e.layoutCardList.length;t+=1){var n=e.layoutCardList[t];if(n){n.node.stopAllActions(),n.node.y=-92;var i=cc.moveTo(a-.6*(e.layoutCardList.length-t),cc.v2(n.node.x,-(n.node.height-92)));n.node.runAction(i)}}}),cc.delayTime(.3),cc.callFunc(function(){e._updateCardFinish(t)}),cc.delayTime(a),cc.callFunc(function(){e._showTextFinishGame()}));this.node.runAction(s),this.node.runAction(cc.sequence(cc.delayTime(a-.4),cc.callFunc(function(){e.audioManager.stopEffect(e.audioId),e.audioId=0})))},onUpdateGame:function(){},onFinishGame:function(t){this.paramsFinish=t,this._showTextFinishGame()},onClickMucCuoc:function(t){if(this.audioManager.playButtonClick(),this.gameManager.gameState!==l.GameState.ROTATE){for(var e=t.target.getComponent(cc.Sprite),n=0;n<this.btnMucCuocList.length;n+=1){var i=this.btnMucCuocList[n].getComponent(cc.Sprite);i.enabled=i===e}this._updateMoneyQuy()}else s.openWarningMessage("Đang quay không thể thay đổi mức cược!",1)},onPlayClick:function(){for(var t=!0,e=0;e<this.layoutCardList.length;e+=1){var n=this.layoutCardList[e];if(!n.isReady){t=!1;break}}if(!t)return void s.openWarningMessage("Xin vui lòng đợi trong giây lát!",1);if(this.gameManager.gameState===l.GameState.NONE){this.countEventFinish=0,this._resetCanGat();var i=cc.v2(0,70),a=cc.v2(0,0);this.btnCanGat.runAction(cc.sequence(cc.moveTo(.4,cc.v2(i.x,i.y-30)).easing(cc.easeCubicActionOut()),cc.delayTime(.2),cc.moveTo(.4,i).easing(cc.easeCubicActionIn()))),this.thanhCanGat.runAction(cc.sequence(cc.moveTo(.4,cc.v2(a.x,a.y-10)).easing(cc.easeCubicActionOut()),cc.delayTime(.2),cc.moveTo(.4,a).easing(cc.easeCubicActionIn()),cc.callFunc(function(){this._resetCanGat()}.bind(this)))),this.imgDen1.opacity=255,this.imgDen2.opacity=0,this.imgDen1.stopAllActions(),this.imgDen2.stopAllActions();var o=cc.repeatForever(cc.sequence(cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2))),r=cc.repeatForever(cc.sequence(cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2)));this.imgDen1.runAction(r),this.imgDen2.runAction(o);var h=this._getMoneySelectIndex(),u=0===this.currencyIndex||void 0===this.currencyIndex,d=u?c.CurrencyType.Ip.NAME:c.CurrencyType.Xu.NAME,m=this.moneyBetList[h];this.gameManager.sendStartGame(d,m)}else s.openWarningMessage("Trò chơi đang diễn ra. Xin vui lòng đợi trong giây lát!",1)},onRankClick:function(){this.audioManager.playButtonClick(),s.openModalByName("games/mini_poker/TopUserMiniPoker")},onHistoryClick:function(){var t=this;this.audioManager.playButtonClick(),s.openModalByName("games/mini_poker/HistoryMiniPoker",function(e){e.getComponent("HistoryTableMiniPoker").init(t.gameManager.historyList)})},onHelpClick:function(){this.audioManager.playButtonClick(),s.openModalByName("games/mini_poker/HelpMiniPoker")},onAutoPlayClick:function(t){this.audioManager.playButtonClick(),this.autoPlay=!this.autoPlay,t.target.getComponentInChildren(cc.Sprite).enabled=this.autoPlay},onCurrencyClick:function(){this.audioManager.playButtonClick(),this.gameManager.gameState!==l.GameState.ROTATE?(this.btnCurrency.getComponent("ToggleCurrency").click(),this.currencyIndex=this.btnCurrency.getComponent(h).index,this.resetButtonMucCuoc(),this._updateMoneyQuy()):s.openWarningMessage("Đang quay không thể thay đổi loại cược!",1)},onCloseClick:function(){this.audioManager.playButtonClick(),this.node.active=!1,this.audioId&&this.audioManager.stopEffect(this.audioId)},reset:function(){for(var t=0;t<this.layoutCardList.length;t+=1){var e=this.layoutCardList[t];e&&(e.node.stopAllActions(),e.node.y=-(e.node.height-92))}this.imgDen2.stopAllActions(),this.imgDen1.stopAllActions(),this.imgDen1.opacity=255,this.imgDen2.opacity=0,this._resetCanGat()},_resetCanGat:function(){this.btnCanGat.stopAllActions(),this.thanhCanGat.stopAllActions(),this.btnCanGat.position=cc.v2(0,70),this.thanhCanGat.position=cc.v2(0,0)},_getMoneySelectIndex:function(){for(var t=0,e=0;e<this.btnMucCuocList.length;e+=1){var n=this.btnMucCuocList[e].getComponent(cc.Sprite);if(n.enabled){t=e;break}}return e},_updateMoneyQuy:function(){void 0===this.currencyIndex&&(this.currencyIndex=0);var t=0===this.currencyIndex;this.lblQuy.string=a.Number.format(t?this.quyPiList[this._getMoneySelectIndex()]:this.quyXuList[this._getMoneySelectIndex()])},_updateCardFinish:function(t){for(var e=0;e<t.result.length;e+=1){var n=i.fromId(t.result[e]);this.layoutCardList[e].updateCardFinish(n)}},_showTextFinishGame:function(){if(this.countEventFinish+=1,!(this.countEventFinish<2||this.isLostFocus||this.isTextShowing)){this.isTextShowing=!0,this.countEventFinish=0,this.imgDen2.stopAllActions(),this.imgDen1.stopAllActions(),this.imgDen1.opacity=255,this.imgDen2.opacity=0;var t=this;if(t.potWin>0){var e=cc.instantiate(t.textFlyPrefab);t.node.addChild(e);var n=e.getComponent(u);n.setColor(cc.Color.YELLOW),n.setText(l.getPotName(t.potWin));var i=cc.sequence(cc.moveBy(2,cc.v2(0,180)).easing(cc.easeQuinticActionOut()),cc.delayTime(1),cc.callFunc(function(){n.node.destroy()}));n.node.runAction(i)}var s=t.gameManager.lastCurrency===c.CurrencyType.Ip.NAME?c.CurrencyType.Ip.DISPLAY_NAME:c.CurrencyType.Xu.DISPLAY_NAME;t.node.runAction(cc.sequence(cc.delayTime(t.potWin>0?.4:0),cc.callFunc(function(){var e=t.paramsFinish.player,n=cc.instantiate(t.textFlyPrefab);t.node.addChild(n);var i=n.getComponent(u);i.setColor(cc.Color.GREEN),i.setText((e.moneyExchange>0?"+":"")+a.Number.format(e.moneyExchange)+" "+s);var o=cc.sequence(cc.moveBy(1.5,cc.v2(0,140)).easing(cc.easeQuinticActionOut()),cc.delayTime(1),cc.callFunc(function(){i.node.destroy(),t.isTextShowing=!1}));i.node.runAction(o)})))}}}),cc._RFpop()},{BaseMinigameGameplay:"BaseMinigameGameplay",Card:"Card",ColumnInfoMiniPoker:"ColumnInfoMiniPoker",CommonConstant:"CommonConstant",GameConstant:"GameConstant",ItemTextMiniPoker:"ItemTextMiniPoker",MiniPokerConstant:"MiniPokerConstant",ToggleCurrency:"ToggleCurrency",UiManager:"UiManager",Utils:"Utils"}],GameplayMyNhan:[function(t,e,n){"use strict";cc._RFpush(e,"d1b9dUrvrxGMJxGBiPvBeJD","GameplayMyNhan");var i=t("ColumnMyNhan"),a=t("NoHu"),s=t("Utils"),o=t("AuthUser"),r=t("TopPanelSlot"),c=t("UiManager"),h=t("TextJumping"),u=t("LineCuaAn"),l=t("HopQuaSlot"),d=t("GameConstant"),m=t("CommonConstant"),p=t("MyNhanConstant"),g=t("GameManagerConstant"),f=t("BaseMainGameplay");cc.Class({"extends":f,properties:{columnMyNhanList:{type:i,"default":[]},noHu:a,freeTurnNode:cc.Node,freeTurnText:cc.Label,datCuaNode:cc.Node,bangThuongNode:cc.Node,HopQuaSlot:l,lineCuaAn:u,txtBetting:cc.Label,txtMoney:cc.Label,txtThang:cc.Label,lblTuQuay:cc.Label,txtAwardFreeTurn:cc.Label,txtAwardLuckyCoffer:cc.Label,particleCoin:cc.ParticleSystem,topPanel:r,gameCmd:{"default":d.MY_NHAN.CMD,visible:!1}},$onLoad:function(){this.setGameType(p.GameType.type),this._initOnce(),this.replaying=!1,this.countRotate=0,this.countFreeTurn=0,this.countAutoRotateStep=0,this.awards=0,this.moneyExchange=0,this.resetRotatePos=-240,this.resetRotateSpacing=2,this.clickAutoPlayWhenGameFinishing=!1,this.topPanel.setGamePlay(this),this.HopQuaSlot.gamePlay=this;var t=p.GameType.type===-1?o.currencies[m.CurrencyType.Xu.NAME].balance:o.currencies[m.CurrencyType.Ip.NAME].balance;this.txtMoney.string=s.Number.format(t),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_PREPARE,this.onPrepareGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_UPDATE,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.TURN_FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.GET_JAR_SUCCESS,this.onGetJarSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_JAR,this.onUpdateJar,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_USER_INFO,this.onUpdateUser,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.OPEN_COFFER,this.onOpenCoffer,this),this.gameManager.eventDispatchers.local.addEventListener(p.Event.UPDATE_AWARD_TYPE,this.onUpdateAwardType,this),this.gameManager.eventDispatchers.local.addEventListener(g.Event.UPDATE_USER_MONEY,this._updateMoney,this),this.gameManager.getJar(),this.gameId=this.gameManager.gameId,this.topPanel.getButtonHistory().active=!0},$onLostFocus:function(){this.lostForcus=!0},$onFocus:function(){this.lostForcus=!1,this.audioManager.stopEffect(this.audioId)},onPrepareGame:function(){this._autoRotate()},onFinishGame:function(t){this.awards=t.awards,this.moneyExchange=t.player.moneyExchange,this.moneyExchange>0&&(this.txtThang.node.getComponent(h).updateText(this.moneyExchange),this.particleCoin.resetSystem(),this.audioManager.playChickenRow()),this.countFreeTurn=t.freeTurnSize,this._showResult()},onUpdateAwardType:function(t){t.itemsInfo&&this.bangThuongNode.getComponent("TableBangThuongMyNhan").setData(t.itemsInfo,p.GameType.type),this.bangThuongNode.active=!0},onOpenCoffer:function(t){if(t.results){this.hasOpenHopQua=!1;for(var e=0;e<t.results.length;e+=1){var n=t.results[e].id;this.HopQuaSlot.openCoffer(n,t.results[e])}}},onUpdateUser:function(t){var e=t.value;e&&"money"===t.field&&this.txtMoney.node.getComponent(h).updateText(e)},onUpdateGame:function(t){t&&(this.txtBetting.node.getComponent(h).updateText(t.betting),this.betting=t.betting),this.datCuaNode.getComponent("TableChonDong").updateMoneyBetting(this.betting)},onUpdateJar:function(t){for(var e=t.extraParams.betting,n=0;n<p.BettingList.length;n+=1)p.BettingList[n]===e&&this.topPanel.setMoney(n,t.money)},onGetJarSuccess:function(t){for(var e=0;e<p.BettingList.length;e+=1){var n=t.data[""+p.BettingList[e]];if(n){var i=n.currencies.IP;this.topPanel.setMoney(e,i)}}},onStartGame:function(t){var e=t.result;this._rotate(e)},onPlayClick:function(){this._initOnce(),this.lostForcus||this.audioManager.playButtonClick(),this.HopQuaSlot.node.active=!1;var t=this.betting,e=this.datCuaNode.getComponent("TableChonDong").getPots();if(e.length<1)return c.openWarningMessage("Xin vui lòng chọn dòng cược trước khi quay!",1),void(this.autoPlay&&this.onAutoPlayClick());var n=p.GameType.type===-1?m.CurrencyType.Xu.NAME:m.CurrencyType.Ip.NAME;this.gameManager.gameState===p.GameState.NONE?(this.gameManager.sendStartGame(t,e,n),this.clickAutoPlayWhenGameFinishing=!1):this.clickAutoPlayWhenGameFinishing||(cc.log("Đang quay xin vui lòng chờ lượt quay kết thúc : gameState "+this.gameManager.gameState),c.openWarningMessage("Đang quay xin vui lòng chờ lượt quay kết thúc!",1));var i=o.currencies[m.CurrencyType.Ip.NAME].balance,a=t*e.length;this.autoPlay&&i<a&&(this.onAutoPlayClick(),cc.log("Not enought money => cancel auto play"))},setGameType:function(t){for(var e=0;e<this.columnMyNhanList.length;e+=1)this.columnMyNhanList[e].type=t},onMenuClick:function(){},onBangThuongClick:function(){this.gameManager.updateAwardType(),this.audioManager.playButtonClick()},onDongClick:function(){this.datCuaNode.active=!0,this.audioManager.playButtonClick()},onAutoPlayClick:function(){this.autoPlay=!this.autoPlay,this.lblTuQuay.string=this.autoPlay?"HỦY\nQUAY":"TỰ\nQUAY",this.autoPlay&&this.gameManager.gameState===p.GameState.NONE?this.onPlayClick():this.clickAutoPlayWhenGameFinishing=this.autoPlay,this.audioManager.playButtonClick()},_updateMoney:function(t){var e=t.money;e&&(t.currency===m.CurrencyType.Xu.NAME&&p.GameType.type===-1||t.currency===m.CurrencyType.Ip.NAME&&p.GameType.type!==-1)&&this.txtMoney.node.getComponent(h).updateText(e)},_autoRotate:function(){if(this.autoPlay){var t=this.lostForcus&&this.gameManager.gameState===p.GameState.NONE;this.countAutoRotateStep>=3||t||this.clickAutoPlayWhenGameFinishing?(this.countAutoRotateStep=0,this.onPlayClick(),t&&cc.log("########## this.lostForcus => autoPlay")):this.countAutoRotateStep+=1}},_stopGamePlay:function(){for(var t=0;t<this.columnMyNhanList.length;t+=1){var e=this.columnMyNhanList[t].node;e.stopAllActions(),e.y=this.resetRotatePos}},_rotate:function(t){cc.log("## Playing "),this.lostForcus||(this.audioId=this.audioManager.playVongQuay()),this.countAutoRotateStep=0,this._resetLine(),this.txtThang.string="0",this.awards=0,this.replaying=!1,this.countRotate=0,this.moneyExchange=0,this.gameManager.isFreeTurn=this.countFreeTurn>0;var e,n,i=[],a=0,s=0,o=0,r=this;if(s=this.columnMyNhanList[0].itemList.length,void 0!==this.ingnoreFirstTime)for(e=0;e<this.columnMyNhanList.length;e+=1)for(var c=0;c<3;c+=1){o=s-1+(c-2),a=this.columnMyNhanList[e].itemList[c].type;var h=this.columnMyNhanList[e].itemList[o].id;this.columnMyNhanList[e].itemList[c].setType(a,h)}for(e=0;e<this.columnMyNhanList.length;e+=1)n=this.columnMyNhanList[e].node,n.stopAllActions(),n.y=this.resetRotatePos,i.push(.2*e);var u=0,l=0;for(e=0;e<t.length;e+=1){o=s-1-l;var d=this.columnMyNhanList[u].itemList[o];d.setType(d.type,t[e]-1),u+=1,u>=5&&(l+=1,u=0)}for(i=this.shuffle(i),e=0;e<this.columnMyNhanList.length;e+=1){n=this.columnMyNhanList[e].node;var m=n.getContentSize().height-480-2*this.resetRotateSpacing;this.lostForcus?(n.y=n.y-m,r.countRotate+=1,r.countRotate>=5&&r._showResult()):n.runAction(cc.sequence(cc.delayTime(i[e]),cc.moveTo(4,cc.v2(n.x,n.y-m)).easing(cc.easeQuinticActionOut()),cc.callFunc(function(){r.countRotate+=1,r.countRotate>=5&&(r._showResult(),r.audioManager.stopEffect(r.audioId))})))}this.ingnoreFirstTime=!0},_showFreeTurnRemain:function(){this.freeTurnNode.active=this.countFreeTurn>0,this.freeTurnText.string="BẠN CÒN "+this.countFreeTurn+" LƯỢT QUAY MIỄN PHÍ"},_showResult:function(){0===this.awards||this.countRotate<5||(this.awards.length>0?this._showLineFinish(this.awards):(this._autoRotate(),this._autoRotate(),this._autoRotate(),this._showFreeTurnRemain()))},_showLineFinish:function(t){var e,n=this,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].pot);for(this._resetLine(),e=0;e<i.length;e+=1)e>=i.length-1?n.lineCuaAn.activeLine(i[e]-1,function(){n._autoRotate()}):n.lineCuaAn.activeLine(i[e]-1);if(!this.replaying){var a=0,s=0,o=0;for(e=0;e<this.awards.length;e+=1)"free_turn"===this.awards[e].awardType?a+=this.awards[e].ratio:"lucky_coffer"===this.awards[e].awardType?s+=this.awards[e].ratio:"jar"===this.awards[e].awardType&&(o+=this.awards[e].ratio);this.hasOpenHopQua=!0,this._showFreeTurnRemain(),this._showFreeTurn(a),this._showNoHuAndLuckyCoffer(o,s)}if(!this.autoPlay)for(this.replaying=!0,e=0;e<i.length;e+=1)!function(a,s){n.node.runAction(cc.sequence(cc.delayTime(3+3*e),cc.callFunc(function(){n.lineCuaAn.activeLine(a,function(){s>=i.length-1&&n.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){n._showLineFinish(t)})))})})))}(i[e]-1,e)},_showFreeTurn:function(t){t>0&&(this.txtAwardFreeTurn.node.active=!0,this.txtAwardFreeTurn.string="Bạn nhận được "+t+" lượt quay miễn phí",this.txtAwardFreeTurn.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.txtAwardFreeTurn.node.active=!1}.bind(this)))))},_showLuckyCoffer:function(t){this.HopQuaSlot.setMaxCoffer(t),t>0&&this.hasOpenHopQua?(this.txtAwardLuckyCoffer.node.active=!0,this.txtAwardLuckyCoffer.string="Bạn nhận được "+t+" hộp quà may mắn",this.txtAwardLuckyCoffer.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.txtAwardLuckyCoffer.node.active=!1,this.hasOpenHopQua?this.HopQuaSlot.show(t,function(){this._autoRotate()}.bind(this)):(cc.log("######## hasOpenHopQua false => ko hien thi"),this._autoRotate())}.bind(this))))):this._autoRotate()},_showNoHuAndLuckyCoffer:function(t,e){t>0?this.noHu.show(function(){this._autoRotate(),this._showLuckyCoffer(e)}.bind(this)):(this._autoRotate(),this._showLuckyCoffer(e))},_resetLine:function(){this.node.stopAllActions(),this.lineCuaAn.resetAllLine(),this.HopQuaSlot.node.stopAllActions(),this.txtAwardLuckyCoffer.node.stopAllActions(),this.txtAwardFreeTurn.node.stopAllActions(),this.HopQuaSlot.node.active=!1,this.txtAwardLuckyCoffer.node.active=!1,this.txtAwardFreeTurn.node.active=!1},_initOnce:function(){void 0===this.betting&&(this.betting=100,this.autoPlay=!1)},shuffle:function(t){for(var e,n,i=t.length;0!==i;)n=Math.floor(Math.random()*i),i-=1,e=t[i],t[i]=t[n],t[n]=e;return t}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",ColumnMyNhan:"ColumnMyNhan",CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",HopQuaSlot:"HopQuaSlot",LineCuaAn:"LineCuaAn",MyNhanConstant:"MyNhanConstant",NoHu:"NoHu",TextJumping:"TextJumping",TopPanelSlot:"TopPanelSlot",UiManager:"UiManager",Utils:"Utils"}],GameplayPhom:[function(t,e,n){"use strict";cc._RFpush(e,"ff1c7uZmm1Ax6Pr327oKOTX","GameplayPhom");var i=t("BaseMainGameplay"),a=t("PhomConstant"),s=t("AuthUser"),o=t("UiManager"),r=t("GameConstant"),c=t("EventDispatcher"),h=t("EventDispatcherConstant");cc.Class({"extends":i,properties:{numNocCardLabel:cc.Label,gameStateLabel:cc.Label,countDownTimeLabel:cc.Label,nocCardNode:cc.Node,arrowNocNode:cc.Node,anBaiButton:cc.Button,bocBaiButton:cc.Button,danhBaiButton:cc.Button,xepBaiButton:cc.Button,haBaiButton:cc.Button,guiBaiButton:cc.Button,uButton:cc.Button,startButton:cc.Button,gameCmd:{"default":r.PHOM.CMD,visible:!1}},$onLoad:function(){this.gameManager.eventDispatchers.local.addEventListener(a.Event.UPDATE_HAND,this.onUpdateHand,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.WAITING_DEAL_CARD,this.onWaitingDealCard,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.UPDATE_GAME,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.FINISH_GAME,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.CHANGE_TURN,this.onChangeTurn,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.DISCARD,this.onDiscardResponse,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.PICK_CARD,this.onPickCardResponse,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TAKE_CARD,this.onTakeCardResponse,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.SHOW_OFF,this.onShowOffResponse,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.AUTO_SHOW_OFF,this.onAutoShowOffResponse,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.SENT_CARD,this.onSentCardResponse,this),c.addEventListener(h.PROFILE.UPDATE_INFO,this.onUpdateUserInfo,this);var t=this;t.myCards=[],this.updatedGame||(this.clearStateGame(),this.clearBeforeChangeTurn()),this.isLoaded=!0;for(var e=0;e<this.playerNodeList.length;e+=1)this.playerNodeList[e].node.on("refresh_game",this.refreshPlayer,this)},$onUpdate:function(){if(this.gameManager){var t;this.gameManager.gameState===a.GameState.WAITING_FOR_NEW_GAME||this.gameManager.gameState===a.GameState.FINISH||this.gameManager.gameState===a.GameState.FINALIZING?(t=Math.floor((this.countDownTime-Date.now())/1e3),t=t>=0?t:0,this.countDownTimeLabel.string=t,0===t&&(this.countDownTimeLabel.node.active=!1,this.gameStateLabel.node.active=!1,this.gameManager.gameState===a.GameState.FINISH&&(this.clearStateGame(),this.gameStateLabel.string="Ván mới sẽ được bắt đầu trong giây lát.",this.gameStateLabel.node.active=!0,this.gameManager.gameState=a.GameState.NONE))):(this.startButton.node.active=!1,this.countDownTimeLabel.node.active=!1,this.gameStateLabel.node.active=!1)}},$onFocus:function(){this.isLostFocus=!0},$onLostFocus:function(){this.isLostFocus=!0},onButtonXepBai:function(){this.audioManager.playButtonClick(),this.curPlayerUI()._isSanhFirst=!this.curPlayerUI()._isSanhFirst,this.curPlayerUI().onXepLaiBai(!0)},onButtonBocBai:function(){this.audioManager.playButtonClick(),this.curPlayerUI().action===a.Action.PICK_CARD&&this.gameManager.requestPickCard()},onButtonDanhBai:function(){if(this.audioManager.playButtonClick(),this.curPlayerUI().action===a.Action.DISCARD){var t=this.curPlayerUI().getCardTouched();1===t.length?this.gameManager.requestDicard(t[0].card):0===t.length?o.openWarningMessage("Bạn cần chọn quân bài để đánh.",1):o.openWarningMessage("Chỉ được chọn 1 quân bài để đánh.",1)}},onButtonAnBai:function(){this.audioManager.playButtonClick(),this.curPlayerUI().action===a.Action.PICK_CARD&&this.gameManager.requestTakeCard()},onButtonHaBai:function(){if(this.audioManager.playButtonClick(),this.curPlayerUI().action===a.Action.SHOW_OFF){for(var t=this.curPlayerUI().getCardTouched(),e=[],n=0;n<t.length;n+=1)e.push(t[n].card.getId());this.gameManager.requestShowOff(e)}},onButtonGuiBai:function(){if(this.audioManager.playButtonClick(),this.curPlayerUI().action===a.Action.SENT_CARD){var t=this.curPlayerUI(),e=t.player.data.inTurnData.sendablePhomList;this.gameManager.requestSentCard(e[0].card,e[0].cards)}},onButtonU:function(){this.audioManager.playButtonClick(),this.gameManager.requestUPhom()},onButtonStart:function(){this.audioManager.playButtonClick(),this.gameManager.sendRequestStartGame(),this.startButton.interactable=!1,this.startButton.node.active=!1},onFinishGame:function(t){this.clearBeforeChangeTurn();var e=0;t.__execInfo__&&(e=t.__execInfo__.dt),this.countDownTime=Date.now()+t.data.time-e;var n,i,o=0,r=!1;if(t.data.result.actions){for(var c=0;c<t.data.result.actions.length;c+=1){var h=t.data.result.actions[c],u=this.findPlayerNodeByName(h.sourcePlayer);if(u){var l=t.data.uDenPlayer&&t.data.uDenPlayer===u.player.data.username;l&&(r=!0),u.player.data.state!==a.PlayerState.WAITING&&u.showRankAndMoneyExchange(-h.moneyExchange,h.action,!1,l)}o+=h.moneyExchange,n=h.action===a.Finish.U}i=this.findPlayerNodeByName(t.data.result.actions[0].targetPlayer),i&&(o-=Math.floor(o*this.gameManager.fee),i.showRankAndMoneyExchange(o,a.Finish.VE_NHAT,n,!1),r&&i.onShowOffCard(i.player.data.phomList),t.data.uType&&("Ù TRÒN"===t.data.uType.toUpperCase()?i.addEffect(a.Effect.U_TRON):"Ù KHÔNG CẠ"===t.data.uType.toUpperCase()&&i.addEffect(a.Effect.U_KHONG_CA))),
i.player.data.username===s.username?n?this.audioManager.playThangTrang():this.audioManager.playWin():this.audioManager.playLose()}if(t.data.result.summary)for(var d=0;d<t.data.result.summary.length;d+=1){var m=t.data.result.summary[d],p=this.findPlayerNodeByName(m.userName);if(p){if(r&&i===p)continue;p.player.data.state!==a.PlayerState.WAITING&&(p.showAllCards(m.hand),n||(p.pointLabel.string=m.point+" Điểm"),p.onRefreshGame(!0))}}},onUpdateGame:function(t){if(this.updatedGame=!0,this.updateInfoGame(t.data),this.clearBeforeChangeTurn(),t.allData.gameState===a.GameState.PGS_WAIT_FOR_DEALING)this.onWaitingDealCard({time:t.data.time,dealer:t.data.dealer});else if(t.allData.gameState===a.GameState.DEALING)this.clearStateGame();else if(t.allData.gameState===a.GameState.PLAYING){var e=t.allData;this.setStateNocCard(0),e.nNocCards&&this.setStateNocCard(e.nNocCards);for(var n,i=0;i<e.players.length;i+=1)if(n=this.getPlayerByUserName(e.players[i].username)){var o=n.getComponent("PlayerUIPhom");if(o.onUpdateGame(),e.players[i].state===a.PlayerState.IN_TURN){var r=0;t.__execInfo__&&(r=t.__execInfo__.dt),o.setCountDown(e.time-r),o.setStateInTurn(e.players[i].inTurnState),e.players[i].username===s.username&&this.setCurrentPlayerInTurn()}else e.players[i].state===a.PlayerState.WAITING&&e.players[i].username===s.username&&this.clearBeforeChangeTurn()}}else t.allData.gameState===a.GameState.FINISH&&(this.clearStateGame(),this.gameStateLabel.string="Ván mới sẽ được bắt đầu trong giây lát.",this.gameStateLabel.node.active=!0)},onUpdateHand:function(t){this.startButton.node.active=!1,this.countDownTimeLabel.node.active=!1,this.gameStateLabel.node.active=!1,this.setStateNocCard(t.nNocCards),this.audioManager.playBaiChia();for(var e,n=0;n<t.players.length;n+=1)if(e=this.getPlayerByUserName(t.players[n].username)){var i=e.getComponent("PlayerUIPhom");e===this.playerNodeList[0].node?i.onUpdateHand(i.player.data.cards,i.player.data.handSize,!0):i.onUpdateHand(null,i.player.data.handSize,!1)}},onWaitingDealCard:function(t){this.gameStateLabel.string="Chuẩn bị ván mới",this.gameStateLabel.node.active=!0;var e=0;t.__execInfo__&&(e=t.__execInfo__.dt),this.countDownTime=Date.now()+t.time-e,this.countDownTimeLabel.string=Math.floor(t.time/1e3),this.countDownTimeLabel.node.active=!0,this.nocCardNode.active=!1,this.arrowNocNode.active=!1,this.numNocCardLabel.string=0;for(var n,i=0;i<this.playerNodeList.length;i+=1)n=this.playerNodeList[i],n&&n.getComponent("PlayerUIPhom").clearAll();t&&(t.dealer===this.curPlayerUI().player.data.username?(this.startButton.node.active=!0,this.startButton.interactable=!0):(this.startButton.node.active=!1,this.startButton.interactable=!1))},onChangeTurn:function(t){this.startButton.node.active=!1,t.allData.nNocCards&&this.setStateNocCard(t.allData.nNocCards),this.audioManager.playTurnStart();var e;this.foundDiscard&&(this.foundDiscard=null);for(var n=0;n<this.playerNodeList.length;n+=1)if(e=this.playerNodeList[n].getComponent("PlayerUIPhom"),e.player){if(e.player.data.username!==t.data.userName)e.clearCountDown(),e.player.data.state!==a.PlayerState.WAITING&&e.clearEffects();else{var i=0;t.__execInfo__&&(i=t.__execInfo__.dt),e.setCountDown(t.data.time-i),e.setStateAction(t.data.action)}e.hideGuiButtons()}this.clearBeforeChangeTurn(),this.curPlayerUI().player.data.state!==a.PlayerState.WAITING&&(this.xepBaiButton.interactable=!0),t.data.userName===this.curPlayerUI().player.data.username&&this.setCurrentPlayerInTurn()},onDiscardResponse:function(t){this.audioManager.playDanhBai(),this.xepBaiButton.interactable=!1,this.danhBaiButton.interactable=!1;var e=this.getPlayerByUserName(t.data.userName);e&&(e.getComponent("PlayerUIPhom").onDiscard([t.data.card]),this.lastPlayer=e.getComponent("PlayerUIPhom"))},onSentCardResponse:function(t){this.audioManager.playPhomPickCard(),this.xepBaiButton.interactable=!1,this.guiBaiButton.interactable=!1;var e,n=this.getPlayerByUserName(t.data.userName);n&&(e=n.getComponent("PlayerUIPhom"));var i=this.getPlayerByUserName(t.data.targetPlayer);if(i)i.getComponent("PlayerUIPhom").onSentCard(t.data.card,t.data.cards,e);else if(this.playerQuit)for(var a=0;a<this.playerQuit.length;a+=1)this.playerQuit[a].username===t.data.targetPlayer&&(i=this.playerQuit[a].slot,i&&i.getComponent("PlayerUIPhom").onSentCard(t.data.card,t.data.cards,e))},onTakeCardResponse:function(t){this.xepBaiButton.interactable=!1,this.anBaiButton.interactable=!1,this.bocBaiButton.interactable=!1,this.audioManager.playPhomPickCard();var e,n=this.getPlayerByUserName(t.data.targetPlayer);if(n){e=n.getComponent("PlayerUIPhom"),e.onTakeCard(t.data.card);var i=t.data.money-Math.floor(t.data.money*this.gameManager.fee);e.showMoneyExchange(i)}var s=this.getPlayerByUserName(t.data.sourcePlayer);if(s){var o=s.getComponent("PlayerUIPhom");o.showMoneyExchange(-t.data.money),o.effectTakenCard(e,t.data.card)}if(t.data.isTaiLuot&&""!==t.data.taiLuotPlayer){var r=this.getPlayerByUserName(t.data.taiLuotPlayer);if(r){var c=r.getComponent("PlayerUIPhom");c.setEffect(a.Effect.TAI_LUOT)}}},onPickCardResponse:function(t){this.xepBaiButton.interactable=!1,this.bocBaiButton.interactable=!1,this.anBaiButton.interactable=!1;var e=this.getPlayerByUserName(t.data.userName);if(e){this.audioManager.playPhomPickCard();var n,i=e.getComponent("PlayerUIPhom");n=i.player.data.pickedCards?i.player.data.pickedCards[i.player.data.pickedCards.length-1]:null,i.onPickCard(n)}},onShowOffResponse:function(t){this.xepBaiButton.interactable=!1,this.showOff(t)},onAutoShowOffResponse:function(t){this.xepBaiButton.interactable=!1,this.showOff(t)},curPlayerUI:function(){return this.playerNodeList[0]},setCurrentPlayerInTurn:function(){var t=this.curPlayerUI().player.data.inTurnData,e=this.curPlayerUI().player.data.inTurnState;switch(e){case a.InTurnState.DISCARD:this.haBaiButton.node.active=!1,this.guiBaiButton.node.active=!1,this.anBaiButton.node.active=!0,this.bocBaiButton.node.active=!0,this.setStateDisCard(),this.curPlayerUI().action=a.Action.DISCARD;break;case a.InTurnState.PICK_OR_TAKE_CARD:this.haBaiButton.node.active=!1,this.guiBaiButton.node.active=!1,this.anBaiButton.node.active=!0,this.bocBaiButton.node.active=!0,this.setStatePickCard(),this.curPlayerUI().action=a.Action.PICK_CARD,t.canTake&&this.setStateTakeCard(t.card);break;case a.InTurnState.SHOW_OFF:this.haBaiButton.node.active=!0,this.guiBaiButton.node.active=!0,this.anBaiButton.node.active=!1,this.bocBaiButton.node.active=!1,this.setStateShowOff(t.phomList),this.curPlayerUI().action=a.Action.SHOW_OFF;break;case a.InTurnState.SEND:this.haBaiButton.node.active=!0,this.guiBaiButton.node.active=!0,this.anBaiButton.node.active=!1,this.bocBaiButton.node.active=!1,this.setStateSentCard(t.sendablePhomList),this.curPlayerUI().action=a.Action.SENT_CARD}t.canU&&this.setStateUPhom()},onRefreshGame:function(t){for(var e,n=0;n<t.allData.players.length;n+=1)e=this.getPlayerByUserName(t.allData.players[n].username),e&&e.getComponent("PlayerUIPhom").onRefreshGame(!1)},refreshPlayer:function(t){for(var e=0;e<this.playerNodeList.length;e+=1)this.playerNodeList[e].player&&this.playerNodeList[e].node.getComponent("PlayerUIPhom").onRefreshGame(!1,t.detail)},getPlayerByUserName:function(t){for(var e=0;e<this.playerNodeList.length;e+=1)if(this.playerNodeList[e].player&&this.playerNodeList[e].player.data.username===t)return this.playerNodeList[e].node;return null},updateInfoGame:function(t){var e=t&&t.acceptUTron?"Luật: Ù Tròn":"Luật: Ù Thường";this.topPanelInGameData.optionLabel=e,this.topPanelInGame&&this.topPanelInGame.setOptionLabel(e)},setStateNocCard:function(t){t>0?(this.nocCardNode.active=!0,this.numNocCardLabel.node.active=!0,this.numNocCardLabel.string=t):(this.nocCardNode.active=!1,this.numNocCardLabel.node.active=!1,this.numNocCardLabel.string="0")},clearStateGame:function(){this.nocCardNode.active=!1,this.arrowNocNode.active=!1,this.numNocCardLabel.string=0,this.startButton.node.active=!1,this.startButton.interactable=!1,this.playerQuit=[];for(var t,e=0;e<this.playerNodeList.length;e+=1)t=this.playerNodeList[e].getComponent("PlayerUIPhom"),t&&t.clearAll()},showOff:function(t){var e=this.getPlayerByUserName(t.data.userName);if(e){this.audioManager.playDanhBai();var n=e.getComponent("PlayerUIPhom");n.onShowOffCard(t.data.phomList)}},setStateDisCard:function(){this.danhBaiButton.interactable=!0,this.xepBaiButton.interactable=!0},setStatePickCard:function(){this.arrowNocNode.active=!1,this.bocBaiButton.interactable=!0},setStateTakeCard:function(t){this.anBaiButton.interactable=!0,this.lastPlayer&&(this.foundDiscard=this.lastPlayer.findCard(t,this.lastPlayer.portCardTrash),this.foundDiscard&&(this.foundDiscard.hoverAnNode.active=!0))},setStateShowOff:function(t){this.haBaiButton.interactable=!0,this.curPlayerUI().setStateCardInShowOff(t)},setStateSentCard:function(t){if(t){this.guiBaiButton.interactable=!0;var e=this.curPlayerUI(),n=t[0].card,i=e.findCard(n,e.cardHold);i&&i.onButtonTouch();for(var a=0,s=0;s<t.length;s+=1)n===t[s].card&&(a+=1);if(a>1)for(var o=0;o<t.length;o+=1){var r=this.getPlayerByUserName(t[o].userName);if(r)r.getComponent("PlayerUIPhom").showGuiButtonInPhoms(n,t[o].cards,this.gameManager);else if(this.playerQuit)for(var c=0;c<this.playerQuit.length;c+=1)this.playerQuit[c].username===t[o].userName&&(r=this.playerQuit[c].slot,r&&r.getComponent("PlayerUIPhom").showGuiButtonInPhoms(n,t[o].cards,this.gameManager))}}},setStateUPhom:function(){this.uButton.interactable=!0,this.uButton.node.active=!0},clearBeforeChangeTurn:function(){this.arrowNocNode.active=!1,this.uButton.node.active=!1,this.setInteractableButtons(!1)},setInteractableButtons:function(t){this.xepBaiButton.interactable=t,this.anBaiButton.interactable=t,this.danhBaiButton.interactable=t,this.bocBaiButton.interactable=t,this.uButton.interactable=t,this.haBaiButton.interactable=t,this.guiBaiButton.interactable=t,this.xepBaiButton.node.setScale(1),this.anBaiButton.node.setScale(1),this.danhBaiButton.node.setScale(1),this.bocBaiButton.node.setScale(1),this.uButton.node.setScale(1),this.haBaiButton.node.setScale(1),this.guiBaiButton.node.setScale(1)},onPrePlayerRemoved:function(t){this.playerQuit&&(this.playerQuit=[]);var e=t.node.getComponent("PlayerUIPhom");e.backCardNode&&(e.backCardNode.active=!1),this.playerQuit&&this.playerQuit.push({username:e.player.data.username,slot:t})},onPostPlayerAdded:function(t){t.player&&t.player.data.state===a.PlayerState.WAITING&&t.addEffect(a.Effect.DANG_DOI)}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameConstant:"GameConstant",PhomConstant:"PhomConstant",UiManager:"UiManager"}],GameplayPoker:[function(t,e,n){"use strict";cc._RFpush(e,"48f37FebZhEirVLQ/3A/RfD","GameplayPoker");var i=t("PokerConstant"),a=t("Utils"),s=t("Card"),o=t("CardUI"),r=t("Slider"),c=t("UiManager"),h=t("GameConstant"),u=t("GameplayLieng");cc.Class({"extends":u,properties:{buyChipSlider:r,autoBuyCheckBox:cc.Node,buyChipPanel:cc.Node,buyChipButton:cc.Node,currentMoney:cc.Label,communityCardsHold:{"default":[],type:o},gameCmd:{"default":h.POKER.CMD,visible:!1,override:!0},autoBuy:!1},$onLoad:function(){u.prototype.$onLoad.call(this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.SHOW_BUY_CHIP,this.showBuyChipPanel,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.HIDE_BUY_CHIP_BUTTON,this.hideBuyChipButton,this),this.gameManager.eventDispatchers.local.addEventListener(i.Event.CUT_OFF_MONEY_POKER,this.showCutOffMoney,this)},buyChip:function(){this.gameManager.buyMoneyJoinTable(this.buyChipSlider.currentValue),this.buyChipPanel.active=!1,this.autoBuyMoney=this.buyChipSlider.currentValue,this.audioManager.playButtonClick()},openBuyChipPanel:function(){this.buyChipPanel.active=!0,this.audioManager.playButtonClick()},closeBuyChipPanel:function(){this.buyChipPanel.active=!1,this.audioManager.playButtonClick()},setAutoBuyMoney:function(){this.autoBuyCheckBox.active=!this.autoBuyCheckBox.active,this.autoBuy=this.autoBuyCheckBox.active,this.audioManager.playButtonClick()},onChangeStateGame:function(t){for(var e=0;e<this.playerNodeList.length;e+=1)this.playerNodeList[e].player&&(this.playerNodeList[e].player.data.state!==i.PlayerState.FOLDED&&this.playerNodeList[e].player.data.state!==i.PlayerState.ALL_IN&&this.playerNodeList[e].player.data.state!==i.PlayerState.NONE&&this.playerNodeList[e].player.data.state!==i.PlayerState.OFF_MONEY&&this.playerNodeList[e].clearEffects(),i.GameStatePoker.PREFLOP!==t.allData.gameState&&this.setCallMoneyPlayer(this.playerNodeList[e],!1,0));this.bettingSlider.node.active=!1,t.allData.communityCards&&t.allData.communityCards.length>0&&this.showCommunityCards(t.allData.communityCards),this.showStateGame(t.allData.gameState)},onChangeTurn:function(t){u.prototype.onChangeTurn.call(this,t),t&&t.length>0&&this.showCommunityCards(t)},updateInfoGame:function(t){u.prototype.updateInfoGame.call(this,t);for(var e=0;e<this.communityCardsHold.length;e+=1){var n=this.communityCardsHold[e];n.fold(),n.node.active=!1}var s=this;this.addTimeout(i.TimeoutId.SHOW_COMMUNITY_CARDS,setTimeout(function(){s.showCommunityCards(t.allData.communityCards)},2e3));var o,r=0;if(t.allData.pots){for(o=0;o<t.allData.pots.length;o+=1)r+=t.allData.pots[o].money;this.totalMoneyCallLabel.string=a.Number.format(r),this.calculateNumberChipType(r,this.chipContainer)}this.showStateGame(t.allData.gameState)},showBuyChipPanel:function(t){this.autoBuy?this.gameManager.buyMoneyJoinTable(this.buyChipSlider.currentValue>t[1]?t[1]:this.buyChipSlider.currentValue):(this.buyChipSlider.setDefaultValue(t[0],t[1],.5,this.gameManager.bettingInfo.betting),this.buyChipPanel.active=!0,this.buyChipButton.active=!0,this.currentMoney.string=a.Number.format(t[2]))},hideBuyChipButton:function(){this.buyChipButton.active=!1},showCutOffMoney:function(t){var e=t.data.userName+" "+t.data.msg+" "+a.Number.format(t.data.money);c.openWarningMessage(e,2)},onShowBetting:function(t,e){var n,i=0;if(t.allData.pots){for(n=0;n<t.allData.pots.length;n+=1)i+=t.allData.pots[n].money;this.totalMoneyCallLabel.string=a.Number.format(i)}t.data.money>0&&(this.chipEffect(t.data.money,i,e),this.setCallMoneyPlayer(e,!0,t.data.currentBetting),this.audioManager.playCoinDrop())},showStateGame:function(t){switch(t){case i.GameStatePoker.PREFLOP:this.gameStateLabel.string="Vòng 1",this.isPlaying=!0;break;case i.GameStatePoker.FLOP:this.gameStateLabel.string="Vòng 2",this.isPlaying=!0;break;case i.GameStatePoker.TURN:this.gameStateLabel.string="Vòng 3",this.isPlaying=!0;break;case i.GameStatePoker.RIVER:this.gameStateLabel.string="Vòng Cuối",this.isPlaying=!0}this.gameStateLabel.node.active=!0},finishDrawCard:function(t,e){var n=t.node.x,i=t.node.y,a=t.node.rotation;e===this.playerNodeList[0]&&(t.node.scaleX=0),e.node.x<=0?t.node.x=n-155:t.node.x=n+155,t.node.rotation=0,t.node.active=!0,t.node.stopAllActions();var s=cc.sequence(cc.spawn(cc.moveTo(.3,cc.p(n,i)),cc.scaleTo(.3,1),cc.rotateTo(.3,a)));t.node.runAction(s)},showCommunityCards:function(t){if(t&&(this.isPlaying||this.gameManager.gameState===i.GameState.DEALING))for(var e=0;e<this.communityCardsHold.length;e+=1){var n=this.communityCardsHold[e];n.node.active||(n.node.active=!0,n.node.stopAllActions(),n.node.runAction(cc.scaleTo(.3,1))),e<t.length&&null===n.card&&(n.setCard(s.fromId(t[e])),n.node.setScale(0,.7),n.node.stopAllActions(),n.node.runAction(cc.scaleTo(.3,1)))}},restartGame:function(){u.prototype.restartGame.call(this);for(var t=0;t<this.communityCardsHold.length;t+=1){var e=this.communityCardsHold[t];e.fold(),e.node.active=!1}}}),cc._RFpop()},{Card:"Card",CardUI:"CardUI",GameConstant:"GameConstant",GameplayLieng:"GameplayLieng",PokerConstant:"PokerConstant",Slider:"Slider",UiManager:"UiManager",Utils:"Utils"}],GameplayRoulette:[function(t,e,n){"use strict";cc._RFpush(e,"54feat3oE1N9pSuBtyqEdPz","GameplayRoulette");var i=t("GameConstant"),a=t("Utils"),s=t("AuthUser"),o=t("BaseMainGameplay"),r=t("RouletteConstant");cc.Class({"extends":o,properties:{resultList:{"default":[],type:cc.Collider},potInfor:{"default":[],type:cc.Node},parentChipBetting:cc.Node,chipPrefab:cc.Prefab,parentVongQuay:cc.Node,vongQuay:cc.Node,resultLabel:cc.Label,vienBi:cc.Node,lblCuaDat:cc.Label,lblTyLe:cc.Label,lblTongDat:cc.Label,lblState:cc.Label,banker:cc.Node,lblTimer:cc.Label,parentVienBi:cc.Node,btnX2:cc.Button,btnCancelBet:cc.Button,btnRebet:cc.Button,gameCmd:{"default":i.ROULTE.CMD,visible:!1}},$onLoad:function(){this.listChipBetting=[],this.moneyBetSelect=0,this.result=0,this.myTotallMoneyBet=0,this._poolChip=new cc.NodePool("Chip"),this.gameManager.eventDispatchers.local.addEventListener(r.Event.ADD_LIST_BETTING,this._addChipBetting,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.BETTING_SUCCESS,this.onBettingSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.ROTATE_VONG_QUAY,this._rotateVongQuay,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.FINISH_GAME,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.CHANGE_STATE,this.onChangeState,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.CANCEL_BET,this.onCancelBetting,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.BETTING_UPDATEGAME,this.onBettingUpdate,this),this._setOnClickPot(),this._disableColiderResult(),this._disableAllButton(),this.lblTongDat.string=0},$onUpdate:function(){if(this.gameManager.gameState===r.GameState.PLAYER_BETTING){this.lblTimer.node.parent.active=!0;var t=Math.floor((this.gameManager.time-Date.now())/1e3);t=t>=0?t:0,this.lblTimer.string=t,t<=0&&(this.lblTimer.node.parent.active=!1)}},$onFocus:function(){this.gameManager.gameState===r.GameState.FINALIZING&&(this.lblTimer.node.parent.active=!1)},onBettingUpdate:function(t){this.audioManager.playChipBay();for(var e=0;e<t.info.length;e+=1){var n,i,a,o=this.findPlayerNodeByName(t.info[e].userName),r=0;n=cc.instantiate(this.chipPrefab),o&&(n.parent=o.node.parent,n.position=o.node),i=n.getComponent("Chip"),i.activeSelectChip(!1),i.moneyLabel.node.active=!1,n.scale=cc.v2(.5,.5),i.init(t.info[e].money),i=n.getComponent(cc.Button),i.enabled=!1,n.removeComponent("ButtonScaler"),a=this.potInfor[t.id].getComponent("RoulettePotInfor"),a.init(),t.info[e].username===s.username&&(r=t.info[e].money),a.setMoneyPot(r,t.info[e].money),a.addPlayerBetToPot(t.info[e].userName,t.info[e].money);var c=cc.moveTo(.5,cc.v2(this.potInfor[t.id].x,this.potInfor[t.id].y)).easing(cc.easeOut(2));n.runAction(cc.sequence(c,cc.callFunc(function(){this.destroy()},n)))}},onCancelBetting:function(t){var e=this.potInfor[t.pot].getComponent("RoulettePotInfor");this._moveChipToPlayer(t.username,this.potInfor[t.pot]),e.removeMoneyPot(t.username),t.username===s.username&&(this.lblTongDat.string="0",this.btnX2.interactable=!1,this.btnCancelBet.interactable=!1)},onChangeState:function(){switch(this.gameManager.gameState){case r.GameState.PLAYER_BETTING:if(this.myTotallMoneyBet=0,this.lblTongDat.string=a.Number.format(this.myTotallMoneyBet),this._clearEfectFinish(),this.lblState.string="Hãy chọn cửa để đặt",this._showPotWin(0,!1),this.gameManager.history.length>0&&!this.gameManager.isMaster){for(var t=!1,e=0;e<this.gameManager.history.length;e+=1)if(this.gameManager.history[e]>0){t=!0;break}this.btnRebet.interactable=t}this.audioManager.playTurnStart();break;case r.GameState.FINALIZING:this.lblState.string="Kết quả",this._disableAllButton()}},_disableAllButton:function(){this.btnRebet.interactable=!1,this.btnX2.interactable=!1,this.btnCancelBet.interactable=!1},onFinishGame:function(t){var e=this,n=cc.sequence(cc.callFunc(function(){e._showPotWin(t.potWin,!0)}),cc.callFunc(function(){e._bankerPayChip(t.potWin)}),cc.delayTime(1),cc.callFunc(function(){e._payChipToPlayer(t.potWin)}),cc.delayTime(2),cc.callFunc(function(){e._showMoneyFinish(t.players)}),cc.delayTime(2),cc.callFunc(function(){e._moveChipToBanker()}),cc.callFunc(function(){e._showBankerMoneyFinish(t.banker)}),cc.callFunc(function(){e._clearPlayerInPot()}),cc.delayTime(2),cc.callFunc(function(){e._clearEfectFinish()}));this.node.runAction(n)},_clearPlayerInPot:function(){for(var t=this,e=0;e<t.potInfor.length;e+=1){var n=t.potInfor[e].getComponent("RoulettePotInfor");n.playerBetList={},n.totallMoneyLong=0,n.myMoneyLong=0,n.setMoneyPot(0,0),n.destroyChipFacke(!0)}},_bankerPayChip:function(t){for(var e=0;e<t.length;e+=1)this.potInfor[t[e]]&&Object.keys(this.potInfor[t[e]].getComponent("RoulettePotInfor").playerBetList).length>0&&this._moveChipToPlayer(this.potInfor[t[e]],this.banker)},_payChipToPlayer:function(t){for(var e=0;e<t.length;e+=1)if(this.potInfor[t[e]]){var n=this.potInfor[t[e]].getComponent("RoulettePotInfor");this._findPlayerWinInSlost(n.playerBetList,t[e])}},_findPlayerWinInSlost:function(t,e){var n=this;if(this.potInfor[e]){var i=n.potInfor[e].getComponent("RoulettePotInfor");i.destroyChipFacke();for(var a=Object.keys(t),s=0;s<a.length;s+=1)n._moveChipToPlayer(a[s],n.potInfor[e])}},_moveChipToBanker:function(){for(var t=this,e=0;e<t.potInfor.length;e+=1)if(this.potInfor[e]){var n=this.potInfor[e].getComponent("RoulettePotInfor");n.isWin||n.chipFackeList.length>0&&this._moveChipToPlayer(t.banker,t.potInfor[e])}},_moveChipToPlayer:function(t,e,n){var i,s,o;this.audioManager.playChipBay();for(var r=0;r<3;r+=1)if(a.Type.isString(t)?(s=this.findPlayerNodeByName(t),s&&(s=s.node)):s=t,s){i=cc.instantiate(this.chipPrefab),i.parent=s.parent,i.position=e,o=i.getComponent("Chip"),o.activeSelectChip(!1),o.moneyLabel.node.active=!1,i.removeComponent("ButtonScaler"),i.removeComponent(cc.Button),i.scale=cc.v2(.5,.5),o.init(n);var c=cc.moveTo(.8,cc.v2(s.x,s.y)).easing(cc.easeOut(2));i.runAction(cc.sequence(cc.delayTime(r-.95*r),c,cc.callFunc(function(){this.destroy()},i)))}},_showMoneyFinish:function(t){for(var e=0;e<t.length;e+=1){var n=this.findPlayerNodeByName(t[e].userName);n&&(n.setFinishEffect(t[e].moneyExchange),t[e].userName===s.username&&(t[e].moneyExchange>0?this.audioManager.playWin():this.audioManager.playLose()))}},_showBankerMoneyFinish:function(t){if(void 0!==t.userName){var e=this.findPlayerNodeByName(t.userName);e&&e.setFinishEffect(t.moneyExchange)}},_clearEfectFinish:function(){for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].clearEffects()},_showPotWin:function(t,e){if(e)for(var n=0;n<t.length;n+=1){var i=this.potInfor[t[n]].getComponent("RoulettePotInfor");i.activeEfectWin(!0),i.isWin=!0}else for(var a=0;a<this.potInfor.length;a+=1){var s=this.potInfor[a].getComponent("RoulettePotInfor");s.activeEfectWin(!1)}},stopVienBi:function(){this.vienBi.parent.stopAllActions(),this.vienBi.parent=this.resultList[this.result].node,this.resultLabel.string=this.result,this.vienBi.position=cc.p(0,0),this.audioManager.stopEffect(this.ballRunAudioId)},_rotateVongQuay:function(t){if(this.result=t.result,this.resultList[t.result].node){this.resultList[t.result].node.active=!0,this._disableAllButton();var e=Date.now()+t.time,n=Math.floor((e-Date.now())/1e3);n>6&&this._openVongQuay(!0,n-2)}},_disableColiderResult:function(){for(var t=0;t<this.resultList.length;t+=1)this.resultList[t].node&&(this.resultList[t].node.active=!1)},_openVongQuay:function(t,e){function n(t){var e=cc.rotateBy(t,-1500).easing(cc.easeOut(3));i.vongQuay.runAction(e);var n=cc.moveBy(5,cc.p(-90,0));i.vienBi.runAction(n);var a=[];a.push(cc.rotateBy(10,4e3).easing(cc.easeOut(2.5)));var s=cc.spawn(a);i.vienBi.parent.runAction(s)}var i=this;if(t){i.ballRunAudioId=this.audioManager.playBallRun(),i.resultLabel.string="";var a=[];a.push(cc.moveTo(1,cc.p(0,0))),a.push(cc.callFunc(n(e))),a.push(cc.delayTime(e)),a.push(cc.callFunc(function(){i._openVongQuay(!1)}));var s=cc.sequence(a);i.parentVongQuay.runAction(s)}else{var o=[];o.push(cc.moveTo(1,cc.v2(0,1e3))),o.push(cc.delayTime(2)),o.push(cc.callFunc(function(){i.vienBi.parent=i.parentVienBi,i.vienBi.position=cc.p(215,0)})),i._disableColiderResult();var r=cc.sequence(o);i.parentVongQuay.runAction(r)}},onBettingSuccess:function(t){var e=this;t.username===s.username&&(this.myTotallMoneyBet+=t.money,this.lblTongDat.string=a.Number.format(this.myTotallMoneyBet));var n,i,o=this._poolChip.get(),c=this.findPlayerNodeByName(t.username),h=!1,u=0;o=cc.instantiate(this.chipPrefab),c&&(o.parent=c.node.parent,o.position=c.node),n=o.getComponent("Chip"),n.activeSelectChip(!1),o.scale=cc.v2(.5,.5);for(var l=0;l<this.gameManager.bettingList.length;l+=1)if(this.gameManager.bettingList[l]===t.money){n.init(t.money,r.ChipColor.findById(l).NAME),h=!0;break}h||(n.moneyLabel.node.active=!1,n.init(t.money)),n=o.getComponent(cc.Button),n.enabled=!1,o.removeComponent("ButtonScaler"),i=this.potInfor[t.pot].getComponent("RoulettePotInfor"),i.init(),t.username===s.username&&(u=t.money,this.btnX2.interactable=!0,this.btnCancelBet.interactable=!0),i.setMoneyPot(u,t.money),i.addPlayerBetToPot(t.username,t.money);var d=cc.moveTo(.5,cc.v2(this.potInfor[t.pot].x,this.potInfor[t.pot].y)).easing(cc.easeOut(2));o.runAction(cc.sequence(d,cc.callFunc(function(){e._poolChip.put(o)},o))),this.audioManager.playChipBay()},_setOnClickPot:function(){for(var t,e=this,n=0;n<e.potInfor.length;n+=1)t=e.potInfor[n],t.on(cc.Node.EventType.TOUCH_START,function(t){e._selectPot(t.target)},t)},_selectPot:function(t){this.gameManager.lstRatio[parseInt(t.name)]?(this.gameManager.sendBet(parseInt(t.name),this.moneyBetSelect),this.lblCuaDat.string=t.name,this.lblTyLe.string=this.gameManager.lstRatio[parseInt(t.name)]):(this.gameManager.sendBet(parseInt(t.parent.parent.name),this.moneyBetSelect),this.lblCuaDat.string=t.parent.parent.name,this.lblTyLe.string=this.gameManager.lstRatio[parseInt(t.parent.parent.name)])},_addChipBetting:function(t){var e,n,i=this;this.parentChipBetting.removeAllChildren();for(var a=0;a<t.length;a+=1)e=cc.instantiate(this.chipPrefab),this.listChipBetting.push(e),n=e.getComponent("Chip"),n.init(t[a],r.ChipColor.findById(a).NAME),e.on(cc.Node.EventType.TOUCH_START,function(){this.activeSelectChip(!0),i._selectChip(this.node)},n),this.parentChipBetting.addChild(e);this._selectChip(this.listChipBetting[0])},_removeSelectChip:function(){for(var t=0;t<this.listChipBetting.length;t+=1){var e=this.listChipBetting[t].getComponent("Chip");e.activeSelectChip(!1)}},_selectChip:function(t){this._removeSelectChip();var e=t.getComponent("Chip");e.activeSelectChip(!0),this.moneyBetSelect=e.money},clickReBet:function(){this.gameManager.sendReBet()},clickDoubleBet:function(){this.gameManager.sendDoubleBet()},clickCancelBet:function(){this.gameManager.sendCancelBet()},clickRequestBanker:function(){this.gameManager.sendRequestBanker()}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",GameConstant:"GameConstant",RouletteConstant:"RouletteConstant",Utils:"Utils"}],GameplaySam:[function(t,e,n){"use strict";cc._RFpush(e,"8600bcCVRBEGLu5TXHWoSM6","GameplaySam");var i=t("GameConstant"),a=t("SamConstant"),s=t("AuthUser"),o=t("GameplayTLMN");cc.Class({"extends":o,properties:{gameCmd:{"default":i.SAM.CMD,visible:!1,override:!0},baoSamButton:cc.Button,boQuaBaoSamButton:cc.Button},$onLoad:function(){o.prototype.$onLoad.call(this),this.MAX_NUMBER_CARDS=10,this.gameManager.eventDispatchers.local.addEventListener(a.Event.WAITING_BAO_SAM,this.onWaitBaoSam,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.PLAYER_BAO_SAM,this.onPlayerBaoSam,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.PLAYER_BAO_MOT,this.onPlayerBaoMot,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.PLAYER_HUY_BAO_SAM,this.onPlayerHuyBaoSam,this)},onButtonBaoSamClick:function(){this.gameManager.sendRequestBaoSam(),this.audioManager.playButtonClick()},onButtonBoQuaBaoSamClick:function(){this.gameManager.sendRequestBoQuaBaoSam(),this.audioManager.playButtonClick()},onWaitBaoSam:function(t){this.count+=1,this.gameStateLabel.string="Thời gian báo Sâm!",this.gameStateLabel.node.active=!0,this.startButton.node.active=!1;var e=0;t.__execInfo__&&(e=t.__execInfo__.dt),this.countDownTime=Date.now()+t.allData.time-e,this.countDownTimeLabel.string=Math.floor(t.allData.time/1e3),this.countDownTimeLabel.node.active=!0,this.curPlayerUI().getComponent("PlayerUITLMN").player.data.handSize>0&&(this.baoSamButton.node.active=!0,this.boQuaBaoSamButton.node.active=!0,this.baoSamButton.node.setScale(1),this.boQuaBaoSamButton.node.setScale(1))},onPlayerBaoSam:function(t){var e=this.findPlayerNodeByName(t);e&&e.getComponent("PlayerUITLMN").addEffect(a.Effect.BAO_SAM)},onPlayerHuyBaoSam:function(){for(var t=0;t<this.playerNodeList.length;t+=1){var e=this.playerNodeList[t].getComponent("PlayerUITLMN");e.player&&e.player.data.isHuyBaoSam&&(e.addEffect(a.Effect.HUY_BAO_SAM),0===t&&(this.baoSamButton.node.active=!1,this.boQuaBaoSamButton.node.active=!1))}},onPlayerBaoMot:function(t){var e=this.findPlayerNodeByName(t);e&&e.getComponent("PlayerUITLMN").addEffect(a.Effect.BAO,!0)},onUpdateGame:function(t){t.allData.gameState===a.GameState.WAITING_FOR_PLAYER&&(this.gameStateLabel.string="Đợi người chơi khác")},onTurn:function(t){this.gameStateLabel.node.active=!1,this.countDownTimeLabel.node.active=!1,this.baoSamButton.node.active=!1,this.boQuaBaoSamButton.node.active=!1,o.prototype.onTurn.call(this,t)},checkDenLang:function(t,e,n){switch(t.data.finishTypeId){case a.ActionFinishType.SAM_THAT_BAI:t.data.loser===e.userName&&n._addEffect(n.effectTemplateNodeList[a.Effect.SAM_THAT_BAI]);break;case a.ActionFinishType.SAM_THANH_CONG:t.data.winner===e.userName&&(n._addEffect(n.effectTemplateNodeList[a.Effect.SAM_THANH_CONG]),e.userName===s.username&&this.audioManager.playThangTrang());break;case a.ActionFinishType.DEN_LANG_THOI_HAI:t.data.loser===e.userName&&n._addEffect(n.effectTemplateNodeList[a.Effect.DEN_LANG])}var i=t.data.result.actions;if(i)for(var o=0;o<i.length;o+=1)i[o].isCong&&i[o].sourcePlayer===e.userName&&n._addEffect(n.effectTemplateNodeList[a.Effect.THUA_CONG]);t.data.denBaoPlayer&&t.data.result.summary.length>2&&t.data.denBaoPlayer===e.userName&&n._addEffect(n.effectTemplateNodeList[a.Effect.DEN_TRANG])},showPlayerWin:function(t){for(var e=0;e<t.data.result.summary.length;e+=1){var n=t.data.result.summary[e],i=this.findPlayerNodeByName(n.userName);i&&i.player.data.state!==a.PlayerState.WAITING&&(i.clearEffects(),i.setFinishEffect(n.moneyExchange))}}}),cc._RFpop()},{AuthUser:"AuthUser",GameConstant:"GameConstant",GameplayTLMN:"GameplayTLMN",SamConstant:"SamConstant"}],GameplaySanThuong:[function(t,e,n){"use strict";cc._RFpush(e,"82ee2m8ZKJOfosLpqtGopaM","GameplaySanThuong");var i=t("GameConstant"),a=t("Utils"),s=t("AuthUser"),o=t("CommonConstant"),r=t("BaseMainGameplay"),c=t("RowInforSanThuong"),h=t("GameManagerConstant"),u=t("UiManager"),l=t("DropDown"),d=t("RulePotSanThuong"),m=t("SanThuongConstant");cc.Class({"extends":r,properties:{potInfor:{"default":[],type:cc.Node},rowInfor:{"default":[],type:c},rulePotSanThuongList:{"default":[],type:d},parentChipBetting:cc.Node,chipPrefab:cc.Prefab,lineResult:{"default":[],type:cc.Node},moneyLableTemp:cc.Label,btnXu:cc.Node,btnPi:cc.Node,moneyResultLabel:cc.Label,totalMoneyBetLabel:cc.Label,moneyGaLabel:cc.Label,btnQuay:cc.Button,btnTuQuay:cc.Button,parentHop:cc.Node,hopPrefab:cc.Prefab,panelDapHop:cc.Node,countOpenHopQuaLabel:cc.Label,itemMaDuThuongPrefab:cc.Prefab,contentMaDuThuong:cc.Node,panelMaDuThuong:cc.Node,countMaDuThuongLabel:cc.Label,resultKetQuaXoSoLabel:cc.Label,nameShowMaDuThuong:cc.Label,dateDropdow:l,numberFree:cc.Node,historyTablePrefab:cc.Prefab,btnHistory:cc.Button,gameCmd:{"default":i.SAN_THUONG.CMD,visible:!1}},$onLoad:function(){this.listChipBetting=[],this.listHopQua=[],this.moneyBetSelect=0,this.currencySelect=o.CurrencyType.Ip.NAME,this.isDoneFinish=!0,this.isDoneEfect=!0,this.autoPlay=!1,this.countFreePlay=0,this.countOpenHopQua=0,this.countLottery=0,this.listMaDuThuong=[],this.currencyMa=o.CurrencyType.Ip.NAME,this.SanThuongAudioId=0,
this.gameManager.eventDispatchers.local.addEventListener(m.Event.ADD_LIST_BETTING,this._addChipBetting,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.CLEAR_FINISH,this.onWaitStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.UPDATE_CHICKEN_JAR,this.onUpdateChickenJar,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.SHOW_PANEL_DAPHOP,this.openPanelDapHop,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.OPEN_HOP,this.openHop,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.SET_RULE,this.onSetRule,this),this.gameManager.eventDispatchers.local.addEventListener(m.Event.CHICKEN_CODE,this.onOpenMaDuThuong,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.UPDATE_USER_MONEY,this._updateMoney,this),this.cleaseLineFinish(),this.btnPi.opacity=255,this.btnXu.opacity=90,this._updateMoney(),this.gameManager.sendGetChickenJar(),this._setOnClickPot()},$onFocus:function(){this.gameManager.gameState!==m.GameState.NONE&&(this.panelMaDuThuong.active=!1,this.countOpenHopQua=0),this.gameManager.gameState!==m.GameState.FINISH,this.gameManager.gameState!==m.GameState.OPEN_HOP&&(this.panelMaDuThuong.active=!1),this.gameManager.gameState===m.GameState.EFFECT&&(this.isDoneEfect=!0)},onOpenMaDuThuong:function(t){var e=0,n=this;this.panelMaDuThuong.active=!0,this.nameShowMaDuThuong.string=s.username,this.listMaDuThuong=t,this.dateDropdow.clearAllItems(),Object.keys(t).sort().reverse().forEach(function(t){n.dateDropdow.addItem(t,!(e>0)),e+=1}),this.updateMaDuThuong()},updateMaDuThuong:function(){var t,e=this.dateDropdow.getSelectedItem();this.listMaDuThuong[e].result?this.resultKetQuaXoSoLabel.string="Kết quả sổ xố: "+this.listMaDuThuong[e].result:this.resultKetQuaXoSoLabel.string="Kết quả sổ xố:",this.listMaDuThuong[e].codes[this.currencyMa]?this.countMaDuThuongLabel.string="SỐ LƯỢNG MÃ: "+this.listMaDuThuong[e].codes[this.currencyMa].length:this.countMaDuThuongLabel.string="SỐ LƯỢNG MÃ: 0",this.contentMaDuThuong.removeAllChildren();for(var n=0;n<this.listMaDuThuong[e].codes[this.currencyMa].length;n+=1)t=cc.instantiate(this.itemMaDuThuongPrefab),t.getChildByName("LblIndex").getComponent(cc.Label).string=n+1,t.getChildByName("LblMa").getComponent(cc.Label).string=this.listMaDuThuong[e].codes[this.currencyMa][n],this.contentMaDuThuong.addChild(t)},_setOnClickPot:function(){for(var t,e=this,n=0;n<e.potInfor.length;n+=1)t=e.potInfor[n],t.on(cc.Node.EventType.TOUCH_START,function(t){e._selectPot(t.target)},t)},_selectPot:function(t){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi cửa đặt.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){var e=t.getComponent("PotInforSanThuong");e.clickPot(),this._showTotalMoneyBet()}else u.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onSetRule:function(t){for(var e=0;e<t.length;e+=1)this.rulePotSanThuongList[t[e].id-1].setRatio(t[e])},_updateMoney:function(){this.btnPi.getComponentInChildren(cc.Label).string=a.Number.format(s.currencies[o.CurrencyType.Ip.NAME].balance),this.btnXu.getComponentInChildren(cc.Label).string=a.Number.format(s.currencies[o.CurrencyType.Xu.NAME].balance)},openHop:function(t){for(var e,n,i=this,a=0;a<t.results.length;a+=1){if(e=this.listHopQua[t.results[a].id].getComponent("HopquaInfor"),n=this.listHopQua[t.results[a].id].getComponent(cc.Animation),n.stop("hopQuaEfect"),this.countOpenHopQua-=1,this.countOpenHopQua<=0){var s=cc.sequence(cc.delayTime(2),cc.callFunc(function(){i.panelDapHop.active=!1}),cc.delayTime(1),cc.callFunc(function(){i._checkDoneFinish()}));i.node.runAction(s)}switch(this.countOpenHopQua>=0&&(this.countOpenHopQuaLabel.string="Bạn còn "+this.countOpenHopQua+" lần mở hộp quà"),t.results[a].awardType){case m.AwardType.NONE:e.openHopQua("Chúc may mắn lần sau");break;case m.AwardType.MONEY:e.openHopQua("Bạn nhận được "+t.results[a].ratio+" lần tiền cược");break;case m.AwardType.FREE_PLAY:e.openHopQua("Bạn nhận được "+t.results[a].ratio+" lượt quay miễn phí"),i.countFreePlay+=t.results[a].ratio;break;case m.AwardType.MA_DU_THUONG:e.openHopQua("Bạn nhận được "+t.results[a].ratio+" mã dự thưởng")}}},openPanelDapHop:function(){this.countOpenHopQua>=0&&(this.panelDapHop.active=!0,this.countOpenHopQuaLabel.string="Bạn còn "+this.countOpenHopQua+" lần mở hộp quà",this.createHopQua(24))},createHopQua:function(t){this.parentHop.removeAllChildren(),this.listHopQua=[];for(var e,n,i,a=this,s=0;s<t;s+=1)e=cc.instantiate(this.hopPrefab),a.listHopQua.push(e),i=e.getComponent("HopquaInfor"),n=e.getComponent(cc.Animation),i.init(s),e.on(cc.Node.EventType.TOUCH_START,function(){a._selectHopQua(this.node)},i),this.parentHop.addChild(e),n.play("hopQuaEfect")},_selectHopQua:function(t){var e=t.getComponent("HopquaInfor");this.gameManager.sendOpentHop(e.id)},onWaitStartGame:function(){this.cleaseLineFinish(),this.isDoneFinish=!0,!a.Game.isFocus()&&this.autoPlay?(this.isDoneEfect=!0,this.onClickQuay()):this._checkDoneFinish()},_checkDoneFinish:function(){for(;this.isDoneEfect&&this.isDoneFinish;){this.autoPlay?this.countOpenHopQua<=0&&!this.panelDapHop.active&&this.onClickQuay():this._checkActiveButton();break}},onUpdateChickenJar:function(){this.currencySelect===o.CurrencyType.Ip.NAME?this.moneyGaLabel.string=a.Number.format(this.gameManager.moneyChickenPi):this.moneyGaLabel.string=a.Number.format(this.gameManager.moneyChickenXu),this._showTotalMoneyBet()},_checkActiveButton:function(){this.isDoneFinish&&this.isDoneEfect?this.autoPlay?this.btnQuay.getComponent(cc.Button).interactable=!1:this.btnQuay.getComponent(cc.Button).interactable=!0:this.btnQuay.getComponent(cc.Button).interactable=!1},onFinishGame:function(t){var e=this,n=[];n.push(cc.delayTime(5)),n.push(cc.callFunc(function(){a.Game.isFocus()&&(e._showLineFinish(t.awards),e.moneyResultLabel.string=a.Number.format(t.player.moneyExchange),e._updateMoney()),e.btnHistory.node.active=!0})),e.node.runAction(cc.sequence(n))},_showLineFinish:function(t){function e(){return function(){i.isDoneEfect=!0,i._checkDoneFinish()}}function n(t,e,n,a){return function(){a?(i.lineResult[t-1].active=!0,i._calculateTypeAward(e,n),i._showGemFinishLine(t),i.audioManager.playChickenRow()):i.lineResult[t-1].active=!1}}var i=this;this.audioManager.stopEffect(this.SanThuongAudioId);var a=[];if(t.length>0)for(var s=0;s<t.length;s+=1)a.push(cc.delayTime(1)),a.push(cc.callFunc(n(t[s].pot,t[s].ratio,t[s].awardType,!0))),a.push(cc.delayTime(1)),a.push(cc.callFunc(n(t[s].pot,t[s].ratio,t[s].awardType,!1))),s===t.length-1&&(a.push(cc.delayTime(2)),a.push(cc.callFunc(e())));else a.push(cc.callFunc(e()));var o=cc.sequence(a);o&&i.node.runAction(o)},_calculateTypeAward:function(t,e){var n=this;switch(e){case m.AwardType.MONEY:n._showTextAwardType(n.moneyBetSelect*t);break;case m.AwardType.FREE_PLAY:n._showTextAwardType(t+" lần quay miễn phí"),n.countFreePlay+=t,n.numberFree.active=!0,n.numberFree.getComponentInChildren(cc.Label).string=n.countFreePlay;break;case m.AwardType.HOPQUA:n._showTextAwardType(t+" hộp quà"),n.countOpenHopQua+=t;break;case m.AwardType.MA_DU_THUONG:n._showTextAwardType(t+" mã dự thưởng"),n.countLottery+=t}},_showTextAwardType:function(t){function e(e,i){return function(){a.Type.isNumber(t)?n.moneyLableTemp.string=a.Number.format(t):n.moneyLableTemp.string=t,n.moneyLableTemp.node.active=i;var e=n.moneyLableTemp.node.getComponent(cc.Animation);i?e.play("MoveMoneyReceive"):e.stop("MoveMoneyReceive")}}var n=this,i=[];i.push(cc.callFunc(e(t,!0))),i.push(cc.delayTime(1)),i.push(cc.callFunc(e(0,!1)));var s=cc.sequence(i);n.node.runAction(s)},_showTotalMoneyBet:function(){this.totalMoneyBetLabel.string=a.Number.format(this.moneyBetSelect*this._getPotSelect().length),this._getPotSelect().length>0?this.isDoneFinish&&this.isDoneEfect&&(this.btnQuay.getComponent(cc.Button).interactable=!0,this.btnTuQuay.getComponent(cc.Button).interactable=!0):(this.btnQuay.getComponent(cc.Button).interactable=!1,this.btnTuQuay.getComponent(cc.Button).interactable=!1)},cleaseLineFinish:function(){for(var t=0;t<this.lineResult.length;t+=1)this.lineResult[t].active=!1;this.moneyResultLabel.string=0},_showGemFinishLine:function(t){var e=[];switch(t){case 1:e=[1,1,1,1,1];break;case 2:e=[2,2,2,2,2];break;case 3:e=[0,0,0,0,0];break;case 4:e=[1,1,2,1,1];break;case 5:e=[1,1,0,1,1];break;case 6:e=[2,2,1,2,2];break;case 7:e=[0,0,1,0,0];break;case 8:e=[2,0,2,0,2];break;case 9:e=[0,2,0,2,0];break;case 10:e=[1,2,0,2,1];break;case 11:e=[0,1,2,1,0];break;case 12:e=[2,1,0,1,2];break;case 13:e=[1,0,1,2,1];break;case 14:e=[1,2,1,0,1];break;case 15:e=[0,1,1,1,0];break;case 16:e=[2,1,1,1,2];break;case 17:e=[1,0,0,0,1];break;case 18:e=[1,2,2,2,1];break;case 19:e=[0,0,1,2,2];break;case 20:e=[2,2,1,0,0]}this._activeGem(e)},_activeGem:function(t){function e(t,e){return function(){if(t&&""!==t.name){var n=t.getChildByName("ImgTrung");e?n&&(n.active=!0,t.getComponent(cc.Animation).play()):n&&(t.getChildByName("ImgTrung").active=!1,t.getComponent(cc.Animation).stop())}}}for(var n=this,i=0;i<this.rowInfor.length;i+=1){var a=this.rowInfor[i].gemTemp[t[i]];if(a){var s=cc.sequence(cc.callFunc(e(a,!0)),cc.delayTime(1),cc.callFunc(e(a,!1)));n.node.runAction(s)}}},onStartGame:function(t){if(a.Game.isFocus()){var e=this;e.node.stopAllActions(),this.cleaseLineFinish(),e.isDoneFinish=!1,e.isDoneEfect=!1,e._checkActiveButton(),e.panelDapHop.active=!1,e.countOpenHopQua=0,e.countFreePlay=Math.max(e.countFreePlay-1,0),e.countFreePlay>0?(e.numberFree.active=!0,e.numberFree.getComponentInChildren(cc.Label).string=e.countFreePlay):e.numberFree.active=!1;var n=cc.sequence(cc.callFunc(function(){e._removeGemFinish(),e._addChipFinish(t);for(var n=0;n<e.rowInfor.length;n+=1)e.rowInfor[n].node.y=-160}),cc.delayTime(.3),cc.callFunc(function(){for(var t=0;t<e.rowInfor.length;t+=1){var n=cc.sequence(cc.moveTo(7-.3*t,cc.v2(e.rowInfor[t].node.x,-(e.rowInfor[t].node.height-160)))).easing(cc.easeInOut(2));e.rowInfor[t].node.runAction(n)}}));n.easing(cc.easeQuadraticActionOut()),this.node.runAction(n),this._updateMoney(),this.SanThuongAudioId=this.audioManager.playVongQuay()}},_addChipFinish:function(t){var e=t;e.reverse();for(var n=0;n<e.length;n+=1)switch(n){case 0:case 5:case 10:this._initGemFinish(4,t[n]);break;case 1:case 6:case 11:this._initGemFinish(3,t[n]);break;case 2:case 7:case 12:this._initGemFinish(2,t[n]);break;case 3:case 8:case 13:this._initGemFinish(1,t[n]);break;case 4:case 9:case 14:this._initGemFinish(0,t[n])}},_initGemFinish:function(t,e){var n=this.rowInfor[t].getComponent("RowInforSanThuong");n.initGemFinish(e-1)},_removeGemFinish:function(){for(var t=0;t<this.rowInfor.length;t+=1)this.rowInfor[t].destroyGemTemp()},onClickDongLe:function(){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi cửa đặt.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){this.onClickHuy();for(var t=0;t<this.potInfor.length;t+=2){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!0)}this._showTotalMoneyBet()}else u.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickDongChan:function(){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi cửa đặt.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){this.onClickHuy();for(var t=1;t<this.potInfor.length;t+=2){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!0)}this._showTotalMoneyBet()}else u.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickTatCa:function(){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi cửa đặt.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){for(var t=0;t<this.potInfor.length;t+=1){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!0)}this._showTotalMoneyBet()}else u.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickHuy:function(){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi cửa đặt.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){for(var t=0;t<this.potInfor.length;t+=1){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!1)}this._showTotalMoneyBet()}else u.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickQuay:function(){this._getPotSelect().length>0?this.isDoneEfect&&this.isDoneFinish&&this.gameManager.sendStartGame(this.autoPlay,this.moneyBetSelect,this._getPotSelect(),this.currencySelect):u.openWarningMessage("Bạn phải chọn cửa đặt trước khi quay.")},onClickTuQuay:function(){var t=this.btnTuQuay.getComponentInChildren(cc.Label);this.autoPlay?(t.string="TỰ QUAY",this.autoPlay=!1):(t.string="HỦY",this.autoPlay=!0,this.isDoneEfect&&this.isDoneFinish&&this.onClickQuay())},onClickXu:function(){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi loại tiền.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){if(this.currencySelect===o.CurrencyType.Ip.NAME){this.currencySelect=o.CurrencyType.Xu.NAME,this._addChipBetting(this.gameManager.lstXuBetting),this.btnPi.opacity=150,this.btnXu.opacity=255,this.onUpdateChickenJar();var t=this.btnTuQuay.getComponentInChildren(cc.Label);t.string="TỰ QUAY",this.autoPlay=!1}}else u.openWarningMessage("Đang quay không thể thay đổi loại tiền.")},onClickPi:function(){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi loại tiền.");if(this.isDoneFinish&&this.isDoneEfect&&0===this.countFreePlay){if(this.currencySelect===o.CurrencyType.Xu.NAME){this.currencySelect=o.CurrencyType.Ip.NAME,this._addChipBetting(this.gameManager.lstPiBetting),this.btnPi.opacity=255,this.btnXu.opacity=150,this.onUpdateChickenJar();var t=this.btnTuQuay.getComponentInChildren(cc.Label);t.string="TỰ QUAY",this.autoPlay=!1}}else u.openWarningMessage("Đang quay không thể thay đổi loại tiền.")},onClickSwidthMaDuThuong:function(){this.currencyMa===o.CurrencyType.Ip.NAME?this.currencyMa=o.CurrencyType.Xu.NAME:this.currencyMa=o.CurrencyType.Ip.NAME,this.updateMaDuThuong()},onClickMaDuThuong:function(){this.gameManager.sendOpenPopupMaDuThuong()},onClickHistory:function(){var t=cc.instantiate(this.historyTablePrefab);t.getComponent("HistorySanThuong").init(this.gameManager.lstHistory.slice()),cc.director.getScene().addChild(t)},CloseMaDuThuong:function(){this.panelMaDuThuong.active=!1},_getPotSelect:function(){for(var t=[],e=0;e<this.potInfor.length;e+=1){var n=this.potInfor[e].getComponent("PotInforSanThuong");n.isActive&&t.push(e+1)}return t},_addChipBetting:function(t){var e,n,i=0,a=0,s=this;this.listChipBetting=[],this.parentChipBetting.removeAllChildren();for(var o=0;o<t.length;o+=1)e=cc.instantiate(this.chipPrefab),this.listChipBetting.push(e),n=e.getComponent("Chip"),o<12?a=o:o>=12&&o<24?a-=12:o>=24&&o<36&&(a-=24),a>=3&&a<6?i=1:a>=6&&a<9?i=2:a>=9&&a<12&&(i=3),n.init(t[o],m.ChipColor.findById(i).NAME),e.on(cc.Node.EventType.TOUCH_START,function(){s._selectChip(this.node)},n),this.parentChipBetting.addChild(e);this._selectChip(this.listChipBetting[0])},_removeSelectChip:function(){for(var t=0;t<this.listChipBetting.length;t+=1){var e=this.listChipBetting[t].getComponent("Chip");e.activeSelectChip(!1)}},_selectChip:function(t){if(0!==this.countFreePlay)return u.openWarningMessage("Quay miễn phí không thể thay đổi mức cược.");if(!this.isDoneFinish||!this.isDoneEfect)return u.openWarningMessage("Đang quay không thể thay đổi mức cược.");this._removeSelectChip();var e=t.getComponent("Chip");e.activeSelectChip(!0),this.moneyBetSelect=e.money,this._showTotalMoneyBet()}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",CommonConstant:"CommonConstant",DropDown:"DropDown",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",RowInforSanThuong:"RowInforSanThuong",RulePotSanThuong:"RulePotSanThuong",SanThuongConstant:"SanThuongConstant",UiManager:"UiManager",Utils:"Utils"}],GameplaySlotTamQuoc:[function(t,e,n){"use strict";cc._RFpush(e,"ab6359CMudIQr5aHbYJtqWS","GameplaySlotTamQuoc");var i=t("GameplaySlotTayDuKy"),a=t("GameConstant");cc.Class({"extends":i,properties:{gameCmd:{"default":a.TAM_QUOC.CMD,override:!0}},$onLoad:function(){cc.log(this.gameCmd),i.prototype.$onLoad.call(this)}}),cc._RFpop()},{GameConstant:"GameConstant",GameplaySlotTayDuKy:"GameplaySlotTayDuKy"}],GameplaySlotTayDuKy:[function(t,e,n){"use strict";cc._RFpush(e,"c46c8DaglpG+pmxFcuEZZ3k","GameplaySlotTayDuKy");var i=t("RowInforTayDuKy"),a=t("TayDuKyConstant"),s=t("UiManager"),o=t("AuthUser"),r=t("BaseMinigameGameplay"),c=t("GameConstant"),h=t("CommonConstant"),u=t("ToggleCurrency"),l=t("Utils"),d=t("JarInfo"),m=t("EventDispatcher");cc.Class({"extends":r,properties:{potInfor:{"default":[],type:cc.Node},rowInfor:{"default":[],type:i},btnMucCuocList:{"default":[],type:cc.Node},lineResult:{"default":[],type:cc.Node},items:{"default":[],type:cc.Node},awards:{"default":[],type:cc.Label},itemPrefab:cc.Prefab,itemSprite:{"default":[],type:cc.SpriteFrame},btnCurrency:cc.Node,lblQuy:cc.Label,lblNumberPotActive:cc.Label,btnQuay:cc.Button,btnTuQuay:cc.Button,imgDen1:cc.Node,imgDen2:cc.Node,popupChonCua:cc.Node,popupHelp:cc.Node,effectNode:cc.Node,effectNoHuNode:cc.Node,lblJarRatio:cc.Label,lblMoneyExchange:cc.Label,gameCmd:{"default":c.TAY_DU_KY.CMD,visible:!1}},$onLoad:function(){this.quyXuList=[],this.quyPiList=[],this.isDoneFinish=!0,this.isDoneEfect=!0,this.autoPlay=!1,this.moneyPiBetList=[100,1e3,1e4],this.moneyXuBetList=[1e3,1e4,1e5],this.currentMoneyQuy=0,this.numberItemHelp=0,this.padding=165,this.isFirstOpen=!0,this.resetButtonMucCuoc(),this.clearLineFinish(),this.onClickTatCa(),this._setOnClickPot(),this._effectWin(),this._effectNoHu(),this.gameManager.getJar(),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.CLEAR_FINISH,this.onWaitStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.GET_JAR_SUCCESS,this.onGetJarSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.GET_WIN_JAR_LOG,this.onGetTopSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.UPDATE_JAR,this.onUpdateJar,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.SHOW_ITEMS_INFO,this.showItemsInfo,this)},$onFocus:function(){this.gameManager.gameState===a.GameState.EFFECT&&(this.isDoneEfect=!0),this.clearLineFinish()},onEnable:function(){this.isFirstOpen?this.isFirstOpen=!1:(this.reset(),this.autoPlay&&this.gameManager.gameState===a.GameState.NONE&&this.onPlayClick())},reset:function(){this.isDoneEfect=!0,this.isDoneFinish=!0,this.autoPlay?this.btnQuay.getComponent(cc.Button).interactable=!1:this.btnQuay.getComponent(cc.Button).interactable=!0;for(var t=0;t<this.rowInfor.length;t+=1){var e=this.rowInfor[t];e&&(e.node.stopAllActions(),e.node.y=-(e.node.height-this.padding))}},onPlayClick:function(){this.effectNode.active=!1,this.effectNoHuNode.active=!1,this.lblMoneyExchange.string=0,this.lblMoneyExchange.node.active=!1,this.isNoHu=!1,this.ratioJar=0;var t=0===this.currencyIndex||void 0===this.currencyIndex,e=t?h.CurrencyType.Ip.NAME:h.CurrencyType.Xu.NAME,n=this._getMoneySelectIndex(),i=t?this.moneyPiBetList[n]:this.moneyXuBetList[n];if(o.currencies[e].balance<i*this._getPotSelect().length){var a=this.btnTuQuay.getComponentInChildren(cc.Label);a.string="TỰ QUAY",this.btnQuay.getComponent(cc.Button).interactable=!0,this.autoPlay=!1}this._getPotSelect().length>0?this.isDoneEfect&&this.isDoneFinish&&this.gameManager.sendStartGame(this.autoPlay,i,this._getPotSelect(),e):s.openWarningMessage("Bạn phải chọn cửa đặt trước khi quay.")},onClickTuQuay:function(){var t=this.btnTuQuay.getComponentInChildren(cc.Label);this.autoPlay?(t.string="TỰ QUAY",this.autoPlay=!1,this.isDoneEfect&&this.isDoneFinish&&(this.btnQuay.getComponent(cc.Button).interactable=!0)):(t.string="HỦY",this.autoPlay=!0,this.btnQuay.getComponent(cc.Button).interactable=!1,this.isDoneEfect&&this.isDoneFinish&&this.onPlayClick())},onCurrencyClick:function(){this.audioManager.playButtonClick(),this.autoPlay?s.openWarningMessage("Đang quay không thể thay đổi loại cược!",1):this.isDoneFinish&&this.isDoneEfect?(this.btnCurrency.getComponent("ToggleCurrency").click(),this.currencyIndex=this.btnCurrency.getComponent(u).index,this.resetButtonMucCuoc(),this._updateMoneyQuy()):s.openWarningMessage("Đang quay không thể thay đổi loại cược!",1)},onClickMucCuoc:function(t){if(this.audioManager.playButtonClick(),this.autoPlay)s.openWarningMessage("Đang quay không thể thay đổi mức cược!",1);else if(this.isDoneFinish&&this.isDoneEfect){for(var e=t.target.getComponent(cc.Sprite),n=0;n<this.btnMucCuocList.length;n+=1){var i=this.btnMucCuocList[n].getComponent(cc.Sprite);i.enabled=i===e}this._updateMoneyQuy()}else s.openWarningMessage("Đang quay không thể thay đổi mức cược!",1)},onClickDongLe:function(){if(this.autoPlay)s.openWarningMessage("Đang quay không thể thay đổi cửa đặt!",1);else if(this.isDoneFinish&&this.isDoneEfect){this.onClickHuy();for(var t=0;t<this.potInfor.length;t+=2){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!0),e.node.opacity=255}this._showPot()}else s.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickDongChan:function(){if(this.autoPlay)s.openWarningMessage("Đang quay không thể thay đổi cửa đặt!",1);else if(this.isDoneFinish&&this.isDoneEfect){this.onClickHuy();for(var t=1;t<this.potInfor.length;t+=2){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!0),e.node.opacity=255}this._showPot()}else s.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickTatCa:function(){if(this.autoPlay)s.openWarningMessage("Đang quay không thể thay đổi cửa đặt!",1);else if(this.isDoneFinish&&this.isDoneEfect){for(var t=0;t<this.potInfor.length;t+=1){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!0),e.node.opacity=255}this._showPot()}else s.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickHuy:function(){if(this.autoPlay)s.openWarningMessage("Đang quay không thể thay đổi cửa đặt!",1);else if(this.isDoneFinish&&this.isDoneEfect){for(var t=0;t<this.potInfor.length;t+=1){var e=this.potInfor[t].getComponent("PotInforSanThuong");e.activePot(!1),e.node.opacity=128}this._showPot()}else s.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},onClickHelp:function(){this.gameManager.getItemInfo()},onClickHistory:function(){var t=this;s.openModalByName("games/tay_du_ky/HistoryTayDuKy",function(e){e.getComponent("HistoryTableTayDuKy").init(t.gameManager.lstHistory)})},onClickTop:function(){var t=this;s.openModalByName("games/tay_du_ky/TopUserTayDuKy",function(e){var n=e.getComponent("TopUserTayDuKy");n.gameid=t.gameManager.gameId,n.getWinJarLog(t.gameManager.gameId,h.CurrencyType.Ip.NAME,n.contentItemPi,n.historyDataPi)})},onCloseClick:function(){this.node.active=!1},clearAll:function(){this.effectNode.active=!1,this.effectNoHuNode.active=!1,this.lblMoneyExchange.string=0,this.lblMoneyExchange.node.active=!1,this.clearLineFinish()},onWaitStartGame:function(){this.clearAll(),this.isDoneFinish=!0,l.Game.isFocus()&&this.node.active||!this.autoPlay?this._checkDoneFinish():(this.isDoneEfect=!0,this.onPlayClick())},onStartGame:function(t){if(l.Game.isFocus()){var e=this;e.actionFinish&&e.actionFinish.target&&(e.node.stopAction(e.actionFinish),e.actionFinish=null),this.clearAll(),this._checkActiveButton(),e.isDoneFinish=!1,e.isDoneEfect=!1,e._checkActiveButton(),this.imgDen1.opacity=255,this.imgDen2.opacity=0,this.imgDen1.stopAllActions(),this.imgDen2.stopAllActions();var n=cc.repeatForever(cc.sequence(cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2))),i=cc.repeatForever(cc.sequence(cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2)));this.imgDen1.runAction(i),this.imgDen2.runAction(n);var a=cc.sequence(cc.callFunc(function(){e._removeItemFinish(),e._addChipFinish(t);for(var n=0;n<e.rowInfor.length;n+=1)e.rowInfor[n].node.stopAllActions(),e.rowInfor[n].node.y=-e.padding}),cc.delayTime(.3),cc.callFunc(function(){for(var t=0;t<e.rowInfor.length;t+=1){var n=cc.sequence(cc.moveTo(3-.3*t,cc.v2(e.rowInfor[t].node.x,-(e.rowInfor[t].node.height-e.padding)))).easing(cc.easeInOut(2));e.rowInfor[t].node.runAction(n)}}));a.easing(cc.easeQuadraticActionOut()),this.node.runAction(a)}},onFinishGame:function(t){var e=this,n=[];n.push(cc.callFunc(function(){l.Game.isFocus()&&(e._showLineFinish(t.awards),e.effectNode.active=!0,e.lblMoneyExchange.string=(t.player.moneyExchange>0?"+":"")+l.Number.format(t.player.moneyExchange),e.lblMoneyExchange.node.active=!0)})),e.node.runAction(cc.sequence(n)),this.actionFinish=n},showItemsInfo:function(){if(this.popupHelp.active=!0,0===this.numberItemHelp&&this.gameManager.itemsInfo)for(var t=0;t<this.gameManager.itemsInfo.length;t+=1)for(var e=0;e<this.gameManager.itemsInfo[t].awards.length;e+=1){var n=this.gameManager.itemsInfo[t].awards[e];this.items[this.numberItemHelp].removeAllChildren();for(var i=0;i<n.number;i+=1){var s=cc.instantiate(this.itemPrefab);s.getComponent(cc.Sprite).spriteFrame=this.itemSprite[this.gameManager.itemsInfo[t].id-1],this.items[this.numberItemHelp].addChild(s),s.y=0,s.scale=.7}n.awardType===a.AwardType.JAR?this.awards[this.numberItemHelp].string=n.ratio+"% Hũ":this.awards[this.numberItemHelp].string="x"+n.ratio+" lần",this.numberItemHelp+=1}this.numberItemHelp=0},closeHelp:function(){this.popupHelp.active=!1},_showLineFinish:function(t){function e(){return function(){i.isDoneEfect=!0,i._checkDoneFinish()}}function n(t,e,n,a){return function(){a?(i.lineResult[t-1].parent.opacity=255,i.lineResult[t-1].active=!0,i._showItemFinishLine(t)):i.lineResult[t-1].active=!1}}for(var i=this,s=0;s<this.lineResult.length;s+=1)this.lineResult[s].parent.opacity=120;var o=[];if(t.length>0){for(s=0;s<t.length;s+=1)o.push(cc.callFunc(n(t[s].pot,t[s].ratio,t[s].awardType,!0))),t[s].awardType===a.AwardType.JAR&&(this.isNoHu=!0,this.ratioJar=t[s].ratio);this.isNoHu&&(this.lblJarRatio.string=this.ratioJar+"%",this.effectNoHuNode.active=!0),o.push(cc.callFunc(e()))}else o.push(cc.callFunc(e()));var r=cc.sequence(o);r&&i.node.runAction(r)},_checkDoneFinish:function(){for(;this.isDoneEfect&&this.isDoneFinish;){this.actionFinish=null,this.autoPlay?this.onPlayClick():(this.effectNode.active=!1,this.effectNoHuNode.active=!1,this.lblMoneyExchange.string=0,this.lblMoneyExchange.node.active=!1,this._checkActiveButton());break}},_addChipFinish:function(t){var e=t;e.reverse();for(var n=0;n<e.length;n+=1)switch(n){case 0:case 3:case 6:this._initItemFinish(2,t[n]);break;case 1:case 4:case 7:this._initItemFinish(1,t[n]);break;case 2:case 5:case 8:this._initItemFinish(0,t[n])}},_initItemFinish:function(t,e){var n=this.rowInfor[t].getComponent("RowInforTayDuKy");n.initItemFinish(e-1)},_removeItemFinish:function(){for(var t=0;t<this.rowInfor.length;t+=1)this.rowInfor[t].destroyItemTemp()},_updateMoneyQuy:function(){this.effectNode.active=!1,this.effectNoHuNode.active=!1,this.lblMoneyExchange.string=0,this.lblMoneyExchange.node.active=!1,void 0===this.currencyIndex&&(this.currencyIndex=0);var t=0===this.currencyIndex;this.newMoneyQuy=t?this.quyPiList[this._getMoneySelectIndex()]:this.quyXuList[this._getMoneySelectIndex()],this.currentMoneyQuy=this.newMoneyQuy,this.cacheMoneyQuy=this.newMoneyQuy,l.Type.isNumber(this.newMoneyQuy)&&(this.lblQuy.string=l.Number.format(Math.floor(this.newMoneyQuy))),this.clearEffectUpdateMoneyQuy()},_effectUpdateMoneyQuy:function(){this.cacheMoneyQuy=this.newMoneyQuy;var t=100,e=6e3,n=(this.newMoneyQuy-this.currentMoneyQuy)/(e/t);this._stopTimestamp=Date.now()+e,this._countDownIntervalId=setInterval(function(){var t=this._stopTimestamp-Date.now();t>=0?(this.currentMoneyQuy+=n,this.currentMoneyQuy>this.cacheMoneyQuy&&(this.currentMoneyQuy=this.cacheMoneyQuy),this.currentMoneyQuy<0&&(this.currentMoneyQuy=0),l.Type.isNumber(this.currentMoneyQuy)&&(this.lblQuy.string=l.Number.format(Math.floor(this.currentMoneyQuy)))):this.clearEffectUpdateMoneyQuy()}.bind(this),t)},_effectWin:function(){this.effectNode.runAction(cc.repeatForever(cc.rotateBy(5,360))),this.effectNode.active=!1},_effectNoHu:function(){this.effectNoHuNode.runAction(cc.repeat(cc.sequence(cc.scaleTo(.5,.7),cc.scaleTo(.5,1)),10)),this.effectNoHuNode.active=!1},clearEffectUpdateMoneyQuy:function(){this._countDownIntervalId&&(clearInterval(this._countDownIntervalId),this._countDownIntervalId=null,l.Type.isNumber(this.cacheMoneyQuy)&&(this.lblQuy.string=l.Number.format(this.cacheMoneyQuy)),this.currentMoneyQuy=this.cacheMoneyQuy,this.currentMoneyQuy!==this.newMoneyQuy&&this._effectUpdateMoneyQuy())},_getMoneySelectIndex:function(){for(var t=0,e=0;e<this.btnMucCuocList.length;e+=1){var n=this.btnMucCuocList[e].getComponent(cc.Sprite);if(n.enabled){t=e;break}}return e},_getIndexBetting:function(t,e){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},clearLineFinish:function(){for(var t=0;t<this.lineResult.length;t+=1)this.lineResult[t].parent.opacity=255,this.lineResult[t].active=!1},_checkActiveButton:function(){this.isDoneFinish&&this.isDoneEfect?this.autoPlay?this.btnQuay.getComponent(cc.Button).interactable=!1:this.btnQuay.getComponent(cc.Button).interactable=!0:this.btnQuay.getComponent(cc.Button).interactable=!1},onShowChonCua:function(){this.popupChonCua.active=!0},onHideChonCua:function(){this.popupChonCua.active=!1},onGetJarSuccess:function(t){for(var e=0;e<this.moneyXuBetList.length;e+=1){var n=t.data[this.moneyXuBetList[e]].currencies;this.quyXuList.push(n.XU)}for(e=0;e<this.moneyPiBetList.length;e+=1){var i=t.data[this.moneyPiBetList[e]].currencies;this.quyPiList.push(i.IP)}this._updateMoneyQuy()},onUpdateJar:function(t){t.currency===h.CurrencyType.Ip.NAME?(d.data[this.gameManager.gameId].jars[t.extraParams.betting]=t.money,m.dispatchEvent(d.eventName,{gameid:this.gameManager.gameId,money:t.money}),this.quyPiList[this._getIndexBetting(t.extraParams.betting,this.moneyPiBetList)]=t.money,0===this.currencyIndex&&this.moneyPiBetList[this._getMoneySelectIndex()]===t.extraParams.betting&&(this.newMoneyQuy=t.money,this._countDownIntervalId||this._effectUpdateMoneyQuy())):t.currency===h.CurrencyType.Xu.NAME&&(this.quyXuList[this._getIndexBetting(t.extraParams.betting,this.moneyXuBetList)]=t.money,1===this.currencyIndex&&this.moneyXuBetList[this._getMoneySelectIndex()]===t.extraParams.betting&&(this.newMoneyQuy=t.money,this._countDownIntervalId||this._effectUpdateMoneyQuy()))},_showPot:function(){var t=this._getPotSelect().length;t>0&&this.isDoneFinish&&this.isDoneEfect&&(this.btnQuay.getComponent(cc.Button).interactable=!0,this.btnTuQuay.getComponent(cc.Button).interactable=!0),this.lblNumberPotActive.string=t},_getPotSelect:function(){for(var t=[],e=0;e<this.potInfor.length;e+=1){var n=this.potInfor[e].getComponent("PotInforSanThuong");n.isActive&&t.push(e+1)}return t},_setOnClickPot:function(){for(var t,e=this,n=0;n<e.potInfor.length;n+=1)t=e.potInfor[n],t.on(cc.Node.EventType.TOUCH_START,function(t){e._selectPot(t.target)},t)},_selectPot:function(t){if(this.autoPlay)s.openWarningMessage("Đang quay không thể thay đổi cửa đặt!",1);else if(this.isDoneFinish&&this.isDoneEfect){var e=t.getComponent("PotInforSanThuong");e.clickPot(),this._showPot(),e.isActive?t.opacity=255:t.opacity=128}else s.openWarningMessage("Đang quay không thể thay đổi cửa đặt.")},resetButtonMucCuoc:function(){var t;for(t=0;t<this.btnMucCuocList.length;t+=1){var e=this.btnMucCuocList[t].getComponentInChildren(cc.Label),n=0===this.currencyIndex||void 0===this.currencyIndex;e.string=l.Number.abbreviate(n?this.moneyPiBetList[t]:this.moneyXuBetList[t],3);
}for(t=0;t<this.btnMucCuocList.length;t+=1){var i=this.btnMucCuocList[t].getComponent(cc.Sprite);i.enabled=0===t}},_showItemFinishLine:function(t){var e=[];switch(t){case 1:e=[2,2,2];break;case 2:e=[1,1,1];break;case 3:e=[0,0,0];break;case 4:e=[2,0,2];break;case 5:e=[0,2,0];break;case 6:e=[2,1,2];break;case 7:e=[2,1,0];break;case 8:e=[0,1,2];break;case 9:e=[1,0,1];break;case 10:e=[1,2,1];break;case 11:e=[0,1,0];break;case 12:e=[2,2,1];break;case 13:e=[1,1,0];break;case 14:e=[1,1,2];break;case 15:e=[0,0,1];break;case 16:e=[1,2,2];break;case 17:e=[0,1,1];break;case 18:e=[2,1,1];break;case 19:e=[1,0,0];break;case 20:e=[2,0,1]}}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMinigameGameplay:"BaseMinigameGameplay",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",GameConstant:"GameConstant",JarInfo:"JarInfo",RowInforTayDuKy:"RowInforTayDuKy",TayDuKyConstant:"TayDuKyConstant",ToggleCurrency:"ToggleCurrency",UiManager:"UiManager",Utils:"Utils"}],GameplayTLMN:[function(t,e,n){"use strict";cc._RFpush(e,"a799dMf8ZNO8pQfvJ1cFBH1","GameplayTLMN");var i=t("GameConstant"),a=t("TLMNConstant"),s=t("AuthUser"),o=t("BaseMainGameplay"),r=t("UiManager"),c=t("Utils"),h=t("EventDispatcher"),u=t("EventDispatcherConstant");cc.Class({"extends":o,properties:{countDownTimeLabel:cc.Label,gameStateLabel:cc.Label,startButton:cc.Button,boChonButton:cc.Button,boLuotButton:cc.Button,danhButton:cc.Button,portCardTrash:cc.Node,gameCmd:{"default":i.TLMN.CMD,visible:!1}},$onLoad:function(){this.gameManager.eventDispatchers.local.addEventListener(a.Event.FINISH_GAME,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.UPDATE_GAME,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.UPDATE_HAND,this.onUpdateHand,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.WAITING_DEAL_CARD,this.onWaitingDealCard,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.WAITING_FOR_PLAYER,this.onWaitingForPlayer,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN,this.onTurn,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.DISCARD,this.onDiscard,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.REFRESH_GAME,this.onRefreshGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.CHAT_HANG,this.onChatHang,this),h.addEventListener(u.PROFILE.UPDATE_INFO,this.onUpdateUserInfo,this),this.count=0,this.MAX_NUMBER_CARDS=13,this.updatedGame||this.setCurrentPlayerInTurn(!1),this.curPlayerUI().cardHold.on("check_chosen_card",this.showButtonBoChon,this)},$onUpdate:function(){if(this.gameManager)if(this.gameManager.gameState===a.GameStateTLMN.WAITING_FOR_NEW_GAME||this.gameManager.gameState===a.GameState.BAO_SAM||this.gameManager.gameState===a.GameStateTLMN.FINISH||this.gameManager.gameState===a.GameStateTLMN.FINALIZING){var t=Math.floor((this.countDownTime-Date.now())/1e3);t=t>=0?t:0,this.countDownTimeLabel.string=t,0===t&&(this.countDownTimeLabel.node.active=!1,this.gameStateLabel.node.active=!1,this.gameManager.gameState!==a.GameStateTLMN.FINISH&&this.gameManager.gameState!==a.GameStateTLMN.FINALIZING||(this.clearStateGame(),this.gameStateLabel.string="Ván mới sẽ được bắt đầu trong giây lát.",this.gameStateLabel.node.active=!0,this.gameManager.gameState=a.GameStateTLMN.NONE))}else this.startButton.node.active=!1,this.countDownTimeLabel.node.active=!1,this.gameStateLabel.node.active=!1},onButtonStartClick:function(){this.gameManager.sendRequestStartGame(),this.audioManager.playButtonClick()},onButtonBoChonClick:function(){this.audioManager.playButtonClick();for(var t=this.curPlayerUI().getCardTouched(),e=0;e<t.length;e+=1)t[e].onButtonTouch()},onButtonBoLuotClick:function(){var t=this;this.audioManager.playButtonClick(),this.gameManager.sendRequestDiscard([]),this.addTimeout(a.TimeoutId.BOLUOT_ANIMATION,setTimeout(function(){for(var e=t.curPlayerUI().getCardTouched(),n=0;n<e.length;n+=1)e[n].onButtonTouch()},200))},onButtonDanhClick:function(){if(this.audioManager.playButtonClick(),this.curPlayerUI().player.data.state===a.PlayerState.IN_TURN){for(var t=this.curPlayerUI().getCardTouched(),e=[],n=0;n<t.length;n+=1)e.push(t[n].card.getId());if(0===e.length)return void r.openWarningMessage("Bạn cần chọn quân bài để đánh.",1);this.gameManager.sendRequestDiscard(e)}},onWaitingForPlayer:function(){this.gameStateLabel.string="Đợi người chơi khác"},onWaitingDealCard:function(t){var e=0;t.__execInfo__&&(e=t.__execInfo__.dt),this.count+=1,this.gameStateLabel.string="Ván bài sẽ bắt đầu sau :",this.gameStateLabel.node.active=!0,this.countDownTime=Date.now()+t.allData.time-e,this.countDownTimeLabel.string=Math.floor(t.allData.time/1e3),this.countDownTimeLabel.node.active=!0,this.clearStateGame(),t&&(this.playerNodeList[0].player&&this.playerNodeList[0].player.data.isMaster?(this.startButton.node.active=!0,this.startButton.interactable=!0):(this.startButton.node.active=!1,this.startButton.interactable=!1))},onUpdateHand:function(t){this.gameStateLabel.node.active=!1,this.countDownTimeLabel.node.active=!1,this.startButton.interactable=!1,this.startButton.node.active=!1,this.clearTrashCards(),this.audioManager.playBaiChia();for(var e,n=0;n<t.players.length;n+=1)e=t.players[n].username?this.findPlayerNodeByName(t.players[n].username):this.findPlayerNodeByName(t.players[n].userName),e&&(e===this.playerNodeList[0]?e.getComponent("PlayerUITLMN").onUpdateHand(t.hand,t.players[n].handSize,!1):e.getComponent("PlayerUITLMN").onUpdateHand(null,t.players[n].handSize,!1))},onUpdateGame:function(t){t.allData.gameState===a.GameStateTLMN.WAITING_FOR_PLAYER&&(this.gameStateLabel.string="Đợi người chơi khác")},onTurn:function(t){var e=this;if(t.newTurn)for(var n=0;n<this.portCardTrash.childrenCount;n+=1){var i=this.portCardTrash.children[n];i.stopAllActions();var s=cc.sequence(cc.spawn(cc.moveTo(.2,cc.p(-350,0)),cc.scaleTo(.2,.5,1)),cc.callFunc(function(){this.getComponent("CardUIPhom").fold(),this.rotation=0},i),cc.scaleTo(.1,.7));s.easing(cc.easeQuadraticActionOut()),i.runAction(s)}for(var o,r=0;r<this.playerNodeList.length;r+=1)if(o=this.playerNodeList[r].getComponent("PlayerUITLMN"),o.player){if(o.player.data.state!==a.PlayerState.WAITING&&o.clearEffects(),o.player.data.username!==t.userName)o.clearCountDown();else{var c=0;t.__execInfo__&&(c=t.__execInfo__.dt),o.setCountDown(t.timeTurn-c)}o.player.data.isBaoSam&&o.addEffect(a.Effect.BAO_SAM),o.player.data.isBao&&o.addEffect(a.Effect.BAO,!0),o.player.data.state===a.PlayerState.NONE&&o.addEffect(a.Effect.DANG_DOI),o.player.data.state===a.PlayerState.OUT_TURN&&o.addEffect(a.Effect.HET_LUOT),o.onRefresh()}this.updatedGame=!0,this.curPlayerUI().getComponent("PlayerUITLMN").player.data.state===a.PlayerState.IN_TURN?(this.audioManager.playTurnStart(),this.addTimeout(a.TimeoutId.CHANGE_TURN,setTimeout(function(){e.setCurrentPlayerInTurn(!0)},1e3))):this.setCurrentPlayerInTurn(!1)},onDiscard:function(t){var e=this.findPlayerNodeByName(t.userName);if(e){var n=this;e.getComponent("PlayerUITLMN").clearCountDown(),e.getComponent("PlayerUITLMN").onDiscard(t.cards),t.cards&&t.cards.length>0&&(this.audioManager.playBaiBay(),this.addTimeout(a.TimeoutId.DISCARD_MUSIC,setTimeout(function(){n.audioManager&&n.audioManager.playDanhBai()},400)))}},onRefreshGame:function(t){t.data.trash&&this.curPlayerUI().showTrashCard(t.data.trash)},onFinishGame:function(t){var e=0;if(t.__execInfo__&&(e=t.__execInfo__.dt),this.countDownTime=Date.now()+t.data.time-e,t.data.lastPlayer){var n={userName:t.data.lastPlayer.userName,cards:t.data.cards};this.onDiscard(n)}this.setCurrentPlayerInTurn(!1),this.showPlayerWin(t);for(var i=0;i<t.data.result.summary.length;i+=1){var o=t.data.result.summary[i],r=this.findPlayerNodeByName(o.userName);if(r){var c=r.getComponent("PlayerUITLMN");if(c.player.data.state!==a.PlayerState.WAITING){c.backCardNode&&(c.backCardNode.active=!1),o&&o.hand&&c.showAllCards(o.hand);var h=!1;if("Thắng trắng"===t.data.finishType){if(t.data.winners)for(var u=0;u<t.data.winners.length;u+=1)t.data.winners[u]===o.userName&&(this.showPlayerThangTrang(c,t.data.thangTrangType),o.userName===s.username&&(h=!0));t.data.winner&&t.data.winner===o.userName&&(this.showPlayerThangTrang(c,t.data.thangTrangType),o.userName===s.username&&(h=!0))}h?this.audioManager.playThangTrang():o.userName===s.username&&(o.moneyExchange>0?this.audioManager.playWin():this.audioManager.playLose()),this.checkDenLang(t,o,c)}}}},onChatHang:function(t){var e,n=this.findPlayerNodeByName(t.data.targetPlayer);if(n){e=n.getComponent("PlayerUITLMN");var i=t.data.money-Math.floor(t.data.money*this.gameManager.fee);e.showMoneyExchange(i)}var a=this.findPlayerNodeByName(t.data.sourcePlayer);if(a){var s=a.getComponent("PlayerUITLMN");s.showMoneyExchange(-t.data.money)}},showPlayerWin:function(t){for(var e=0,n=0;n<t.data.result.actions.length;n+=1){var i=t.data.result.actions[n],s=this.findPlayerNodeByName(i.sourcePlayer);s&&s.player.data.state!==a.PlayerState.WAITING&&(s.clearEffects(),s.setFinishEffect(-i.moneyExchange)),e+=i.moneyExchange}var o=this.findPlayerNodeByName(t.data.result.actions[0].targetPlayer);o&&(e-=Math.floor(e*this.gameManager.fee),o.setFinishEffect(e))},showButtonBoChon:function(){var t=this.curPlayerUI().getCardTouched();t.length>0?(this.boChonButton.interactable=!0,this.curPlayerUI().getComponent("PlayerUITLMN").player.data.state===a.PlayerState.IN_TURN&&(this.danhButton.interactable=!0)):(this.boChonButton.interactable=!1,this.danhButton.interactable=!1)},showPlayerThangTrang:function(t,e){var n=t._addEffect(t.effectTemplateNodeList[a.Effect.THANG_TRANG]),i=n.getChildByName("LblToiTrang");i&&(i.getComponent(cc.Label).string="Thắng trắng: "+e)},checkDenLang:function(t,e,n){for(var i=t.data.result.actions,s=0;s<i.length;s+=1)i[s].isCong&&n.addEffect(a.Effect.THUA_CONG)},clearTrashCards:function(){c.Node.destroyAllChildrenInNode(this.portCardTrash)},setCurrentPlayerInTurn:function(t){if(this.boChonButton.interactable=t,this.boLuotButton.interactable=t,this.danhButton.interactable=t,t){var e=this.curPlayerUI().getCardTouched();e.length>0?(this.boChonButton.interactable=!0,this.danhButton.interactable=!0):(this.boChonButton.interactable=!1,this.danhButton.interactable=!1)}this.boChonButton.node.setScale(1),this.boLuotButton.node.setScale(1),this.danhButton.node.setScale(1)},curPlayerUI:function(){return this.playerNodeList[0]},clearStateGame:function(){this.clearTrashCards();for(var t,e=0;e<this.playerNodeList.length;e+=1)t=this.playerNodeList[e],t&&t.getComponent("PlayerUITLMN").clearAll()},onPrePlayerRemoved:function(t){t.node.getComponent("PlayerUITLMN").clearAll()},onPostPlayerAdded:function(t){var e=t.node.getComponent("PlayerUITLMN");e.player&&e.player.data.handSize>0&&e.backCardNode&&(e.backCardNode.active=!0,e.numberCardLabel.string=e.player.data.handSize),t.player&&t.player.data.state===a.PlayerState.WAITING&&t.addEffect(a.Effect.DANG_DOI)}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameConstant:"GameConstant",TLMNConstant:"TLMNConstant",UiManager:"UiManager",Utils:"Utils"}],GameplayTaiXiu:[function(t,e,n){"use strict";cc._RFpush(e,"2aa36OdRqdDnqaotsfW+G3U","GameplayTaiXiu");var i=t("BaseMinigameGameplay"),a=t("GameConstant"),s=t("Utils"),o=t("AuthUser"),r=t("CommonConstant"),c=t("GameManagerConstant"),h=t("TaiXiuConstant"),u=t("UiManager");cc.Class({"extends":i,properties:{chipPrefab:cc.Prefab,chipListNode:cc.Node,chipListScrollView:cc.ScrollView,diceNode:{"default":[],type:cc.Node},diceSpriteFrames:{"default":[],type:cc.SpriteFrame},bigPotResultNode:cc.Node,littlePotResultNode:cc.Node,bigPotNumberOfPlayersLabel:cc.Label,littlePotNumberOfPlayersLabel:cc.Label,bigPotTotalBettingLabel:cc.Label,littlePotTotalBettingLabel:cc.Label,bigPotPlayerBettingLabel:cc.Label,littlePotPlayerBettingLabel:cc.Label,bigPotTempPlayerBettingLabel:cc.Label,littlePotTempPlayerBettingLabel:cc.Label,bigPotTempPlayerBettingNode:cc.Node,littlePotTempPlayerBettingNode:cc.Node,bigPotResultHistoryNode:cc.Node,littlePotResultHistoryNode:cc.Node,activePotResultHistoryNode:cc.Node,historyListNode:cc.Node,historyTrayScrollView:cc.ScrollView,toggleCurrencyIconNode:cc.Node,bottomToggleCurrencyIconNode:cc.Node,bottomPanelNode:cc.Node,balanceLabel:cc.Label,timeLeftLabel:cc.Label,gameStateLabel:cc.Label,textMoneyPrefab:cc.Prefab,denNhapNhayAnimation:cc.Animation,denNhapNhaySprite:cc.Sprite,denNhapNhaySpriteFrameFirst:cc.SpriteFrame,gameCmd:{"default":a.TAI_XIU.CMD,visible:!1}},onEnable:function(){var t=this;this.gameManager.enablePing(),this.historyListNode.active=!1,this.addTimeout(h.TimeoutId.SHOW_HISTORY_TRAY,setTimeout(function(){t.historyListNode.opacity=0,t.historyListNode.active=!0,t.historyListNode.width>=t.historyListNode.parent.width?t.historyTrayScrollView.scrollToRight():t.historyTrayScrollView.scrollToLeft(),t.historyListNode.opacity=255},500))},onDisable:function(){this.gameManager.disablePing()},$onUpdate:function(){this.gameManager&&(this.timeLeftLabel.string=this.gameManager.getFormattedCurrentTimeLeft(),this.gameStateLabel.string=this.gameManager.getStateLabel())},$onLoad:function(){var t=this;this.active={pot:-1,currency:null},this.chipListByCurrency={},this._clearPots(),this._clearTempBetting(),this._clearWinningPotActive(),this._setPot(-1),this.gameStateLabel.string=h.GameStateName.BETTING,this._updateTable(),this.gameManager.bettingInfo&&this.switchCurrency(),this.historyTrayScrollView.scrollToLeft(),this.gameManager.eventDispatchers.local.addEventListener(h.Event.UPDATE_POTS,this.onUpdatePots,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.UPDATE_TEMP_BETTING,this.onUpdateTempBetting,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.BETTING_SUCCESS,this.onBettingSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.EFFECT_STATE,this.onChangeStateToEffect,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.PLAYER_BETTING_STATE,this.onChangeStateToPlayerBetting,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.UPDATE_USER_MONEY,this.onUpdateUserMoney,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.NEW_MATCH_LOST_FOCUS,this.onNewMatchLostFocus,this),t.addTimeout(setTimeout(function(){if(t.node.isValid&&!t.bottomPanelNode.active){var e=t.bottomPanelNode.y;t.bottomPanelNode.y=1e4,t.bottomPanelNode.active=!0,t.addTimeout(setTimeout(function(){t.node.isValid&&(t.chipListScrollView.scrollToPercentHorizontal(.5),t.bottomPanelNode.active=!1,t.bottomPanelNode.y=e)},100))}},10))},close:function(){this.node.active=!1},submitTempBetting:function(){this.gameManager.acceptTempBetting()},cancelTempBetting:function(){this.gameManager.cancelTempBetting()},onUpdateTempBetting:function(){var t=this.gameManager.current.tempBettingInfo;s.Object.isEmpty(t)?this._clearTempBetting():this.active.currency===t.currency&&this.active.pot===t.pot&&this._setTempBetting(this.active.pot,t.betting||0)},selectBigPot:function(){this._selectPot(h.Pot.BIG.ID)},selectLittlePot:function(){this._selectPot(h.Pot.LITTLE.ID)},_selectPot:function(t){this.audioManager.playButtonClick(),this.gameManager.gameState===h.GameState.PLAYER_BETTING&&this.active.pot!==t&&(t===h.Pot.BIG.ID?(this._setBettingPotActive(h.Pot.BIG.ID,!0),this._setBettingPotActive(h.Pot.LITTLE.ID,!1)):t===h.Pot.LITTLE.ID&&(this._setBettingPotActive(h.Pot.BIG.ID,!1),this._setBettingPotActive(h.Pot.LITTLE.ID,!0)),this._setPot(t),this.cancelTempBetting())},_setBettingPotActive:function(t,e){t===h.Pot.BIG.ID?this.bigPotTempPlayerBettingNode.active=e:t===h.Pot.LITTLE.ID&&(this.littlePotTempPlayerBettingNode.active=e)},_setWinningPotActive:function(t,e){t===h.Pot.BIG.ID?this.bigPotResultNode.active=e:t===h.Pot.LITTLE.ID&&(this.littlePotResultNode.active=e)},switchCurrency:function(){var t=!1;if(this.audioManager.playButtonClick(),this.active.currency===r.CurrencyType.Ip.NAME?(this.active.currency=r.CurrencyType.Xu.NAME,t=!0):this.active.currency&&this.active.currency!==r.CurrencyType.Xu.NAME||(this.active.currency=r.CurrencyType.Ip.NAME,t=!0),t){var e,n,i,a=this.toggleCurrencyIconNode.getComponent("ToggleCurrency"),o=this.bottomToggleCurrencyIconNode.getComponent("ToggleCurrency"),c=this.gameManager.bettingInfo[this.active.currency]||[],u=s.Array.createCircular(["blue","purple","green","red"]),l=this;for(this.chipListNode.removeAllChildren(),this.chipListNode.opacity=0,i=0;i<c.length;i+=1)n=cc.instantiate(this.chipPrefab),e=n.getComponent("Chip"),e.init(c[i],u.next()),n.on(cc.Node.EventType.TOUCH_END,function(){l.gameManager.gameState===h.GameState.PLAYER_BETTING&&(l.gameManager.addTempBetting(l.active.pot,this.money,l.active.currency),l.onUpdateTempBetting()),l.audioManager.playButtonClick()},e),this.chipListNode.addChild(n);this.addTimeout(h.TimeoutId.SWITCH_CURRENCY,setTimeout(function(){l.node.isValid&&(l.chipListNode.width>=l.chipListScrollView.node.width?l.chipListScrollView.scrollToLeft():l.chipListScrollView.scrollToPercentHorizontal(.5),l.chipListNode.opacity=255)},10)),a.switchTo(this.active.currency),o.switchTo(this.active.currency),this._updateTable(),this.cancelTempBetting()}},_updateTable:function(){this.onUpdatePots(),this.onBettingSuccess(),this.onUpdateTempBetting(),this.onUpdateUserMoney()},onUpdatePots:function(){var t=this.gameManager.pots,e=t&&t[this.active.currency]||{},n=e[h.Pot.BIG.ID]||{},i=e[h.Pot.LITTLE.ID]||{};this._setTotalBetting(h.Pot.BIG.ID,n.money||0),this._setNumberPlayerBetting(h.Pot.BIG.ID,n.size||0),this._setTotalBetting(h.Pot.LITTLE.ID,i.money||0),this._setNumberPlayerBetting(h.Pot.LITTLE.ID,i.size||0),this._clearWinningPotActive()},onBettingSuccess:function(){var t=this.gameManager.current.bettingInfo,e=t[this.active.currency]||{};this._setBetting(h.Pot.BIG.ID,e[h.Pot.BIG.ID]||0),this._setBetting(h.Pot.LITTLE.ID,e[h.Pot.LITTLE.ID]||0)},onChangeStateToEffect:function(t){var e,n=t.dices;if(n){for(e=0;e<n.length;e+=1)this.rotateDice(this.diceNode[e],this.diceSpriteFrames,n[e],e);this.denNhapNhayAnimation.play()}this._setPot(-1)},onChangeStateToPlayerBetting:function(){this.denNhapNhayAnimation.stop(),this.denNhapNhaySprite.spriteFrame=this.denNhapNhaySpriteFrameFirst,this._clearWinningPotActive(),this._clearPots(),this._clearBetting(),this._updateTable()},onFinishGame:function(t){var e=t&&t.potWin&&t.potWin[0];s.Type.isNumber(e)&&(this._clearWinningPotActive(),this._setWinningPotActive(e,!0),this.createNewPotResult(e)),this.gameManager.startGame();var n=t.player[r.CurrencyType.Ip.NAME],i=t.player[r.CurrencyType.Xu.NAME],a=0,o=0;if(n&&(a=n.moneyExchange,0!==a)){var c=cc.instantiate(this.textMoneyPrefab);c.getComponent(cc.Label).string=(a>0?"+":"")+s.Number.format(a)+" "+r.CurrencyType.Ip.DISPLAY_NAME;var h=cc.sequence(cc.moveBy(2,cc.v2(0,200)).easing(cc.easeQuinticActionOut()),cc.delayTime(6),cc.callFunc(function(){c.removeFromParent()}));c.runAction(h),this.node.addChild(c)}if(i&&(o=i.moneyExchange,0!==o)){var u=cc.instantiate(this.textMoneyPrefab);u.getComponent(cc.Label).string=(o>0?"+":"")+s.Number.format(o)+" "+r.CurrencyType.Xu.DISPLAY_NAME,u.getComponent(cc.Label).enabled=!1;var l=cc.sequence(cc.delayTime(n?1:0),cc.callFunc(function(){u.getComponent(cc.Label).enabled=!0}),cc.moveBy(2,cc.v2(0,150)).easing(cc.easeQuinticActionOut()),cc.delayTime(6.5),cc.callFunc(function(){u.removeFromParent()}));u.runAction(l),this.node.addChild(u)}},_setTotalBetting:function(t,e){t===h.Pot.BIG.ID?this.bigPotTotalBettingLabel.string=s.Number.format(e):t===h.Pot.LITTLE.ID&&(this.littlePotTotalBettingLabel.string=s.Number.format(e))},_setNumberPlayerBetting:function(t,e){t===h.Pot.BIG.ID?this.bigPotNumberOfPlayersLabel.string="("+s.Number.format(e)+")":t===h.Pot.LITTLE.ID&&(this.littlePotNumberOfPlayersLabel.string="("+s.Number.format(e)+")")},_setTempBetting:function(t,e){t===h.Pot.BIG.ID?this.bigPotTempPlayerBettingLabel.string=s.Number.format(e):t===h.Pot.LITTLE.ID&&(this.littlePotTempPlayerBettingLabel.string=s.Number.format(e))},_setBetting:function(t,e){t===h.Pot.BIG.ID?this.bigPotPlayerBettingLabel.string=s.Number.format(e):t===h.Pot.LITTLE.ID&&(this.littlePotPlayerBettingLabel.string=s.Number.format(e))},_clearTempBetting:function(){this._setTempBetting(h.Pot.BIG.ID,0),this._setTempBetting(h.Pot.LITTLE.ID,0)},_clearBetting:function(){this._setBetting(h.Pot.BIG.ID,0),this._setBetting(h.Pot.LITTLE.ID,0)},_clearPots:function(){this._setTotalBetting(h.Pot.BIG.ID,0),this._setNumberPlayerBetting(h.Pot.BIG.ID,0),this._setBettingPotActive(h.Pot.BIG.ID,!1),this._setTotalBetting(h.Pot.LITTLE.ID,0),this._setNumberPlayerBetting(h.Pot.LITTLE.ID,0),this._setBettingPotActive(h.Pot.LITTLE.ID,!1)},_clearWinningPotActive:function(){this._setWinningPotActive(h.Pot.BIG.ID,!1),this._setWinningPotActive(h.Pot.LITTLE.ID,!1)},_setPot:function(t){this.active.pot=t,t>=0?this.bottomPanelNode.active=!0:this.bottomPanelNode.active=!1},onUpdateUserMoney:function(){this.active.currency&&(this.balanceLabel.string=s.Number.format(o.currencies[this.active.currency].balance))},onNewMatchLostFocus:function(){this._clearPots(),this._clearTempBetting(),this._clearWinningPotActive(),this._updateTable(),this.gameManager.startGame()},rotateDice:function(t,e,n,i){t.active=!0,t.setScale(1);var a=t.getComponent(cc.Animation),s=t.getComponent(cc.Sprite);a.play("XucXac");var o=1e3*a.currentClip.duration;this.addTimeout(h.TimeoutId.ROTATE_DICE+i,setTimeout(function(){a.stop(),s.spriteFrame=e[n]},o))},createNewPotResult:function(t){var e=cc.instantiate(t===h.Pot.BIG.ID?this.bigPotResultHistoryNode:this.littlePotResultHistoryNode);e.parent=this.historyListNode,e.active=!0,this.activePotResultHistoryNode.parent=e,this.activePotResultHistoryNode.active=!0,this.historyListNode.width+e.width>=this.historyListNode.parent.width&&this.historyTrayScrollView.scrollToRight()},openHistoryTable:function(){var t=this;this.audioManager.playButtonClick(),u.openModalByName("games/tai_xiu/HistoryTaiXiu",function(e){e.getComponent("HistoryTableTaiXiu").init(t.gameManager.history.slice())})},openTopTable:function(){var t=this;this.audioManager.playButtonClick(),u.openModalByName("games/tai_xiu/TopTienTri",function(e){e.getComponent("TopTableTaiXiu").getData(t.active.currency,(new Date).getTime())})},openHelpTable:function(){this.audioManager.playButtonClick(),this.gameManager.openHelpModal()}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMinigameGameplay:"BaseMinigameGameplay",CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",TaiXiuConstant:"TaiXiuConstant",UiManager:"UiManager",Utils:"Utils"}],GameplayVongQuay:[function(t,e,n){"use strict";cc._RFpush(e,"58120ZWoE1OaodmkzBuKtCO","GameplayVongQuay");var i=t("BaseMinigameGameplay"),a=t("VongQuayConstant"),s=t("UiManager"),o=t("Utils"),r=t("VongQuay"),c=t("CommonConstant"),h=t("GameConstant");cc.Class({"extends":i,properties:{vong2:cc.Node,vong1:cc.Node,vong3:cc.Node,autoPlayNode:cc.Node,autoOnLabel:cc.Label,autoOffLabel:cc.Label,txtCurrencyJar:cc.Label,txtMoneyJar:cc.Label,txtBetting:cc.Label,txtFreeCountPlay:cc.Label,btnGetFree:cc.Node,txtGetFree:cc.Label,txtQuestionCapcha:cc.Label,inputResultCapcha:cc.EditBox,capchaBox:cc.Node,denSangNodeList:{"default":[],type:cc.Node},resultNode:cc.Node,awardLabelList:{"default":[],type:cc.Label},gameCmd:{"default":h.VONG_QUAY.CMD,visible:!1}},$onLoad:function(){this.resultNode.active=!1;for(var t=0;t<this.denSangNodeList.length;t+=1)this.denSangNodeList[t].opacity=0;this.paramsResult=0,this.rotateCount=0,this.autoPlay=!1,this.lostForcus=!1,this._showOnOffAutoPlay(),this.txtCurrencyJar.string=c.CurrencyType.Ip.CHIP_NAME,this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_PREPARE,this.onPrepareGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_START,this.onStartGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_UPDATE,this.onUpdateGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_GET_CAPCHA,this.onGetCapcha,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.TURN_RESOLVE_CAPCHA,this.onResolveCapcha,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.GET_JAR_SUCCESS,this.onGetJarSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(a.Event.UPDATE_JAR,this.onUpdateJar,this)},$onLostFocus:function(){this.node.active&&(this.lostForcus=!0)},$onFocus:function(){this.lostForcus=!1,!this.node.active},onEnable:function(){this.gameManager.gameState!==a.GameState.NONE?(this._stopGamePlay(),this._changeFinishState()):(this.gameManager.requestRefreshGame(),this.gameManager.getJar())},$onUpdate:function(t){this.hasCountDownFree&&(this.timeCountDownFree>0?(this.timeCountDownFree-=t,this.txtGetFree.string=""+o.Date.fromSecond(this.timeCountDownFree)):this.txtGetFree.string="Nhận lượt quay miễn phí")},onUpdateJar:function(t){t.currency===c.CurrencyType.Ip.NAME&&(this.txtMoneyJar.string=o.Number.format(t.money))},onGetJarSuccess:function(t){this.txtMoneyJar.string=o.Number.format(t.data.jar.currencies.IP)},onResolveCapcha:function(){},onGetCapcha:function(t){if(t.data.question&&(this.txtQuestionCapcha.string=t.data.question,this.capchaBox.active=!0,this.inputResultCapcha.string=""),void 0!==t.data.isCorrect)if(t.data.isCorrect===!1)s.openWarningMessage("Sai capcha!",1);else{var e=t.allData.freePlayInfo;this._updateFreeTurn(e.count,e.captchaRequired,e.time,t.allData),this.capchaBox.active=!1}},onUpdateGame:function(t){cc.log("onUpdateGame"),this._updateVongQuayData(t),void 0!==t.allData&&void 0!==t.allData.freePlayInfo&&this._updateFreeTurn(t.allData.freePlayInfo.count,t.allData.freePlayInfo.captchaRequired,t.allData.freePlayInfo.time,t.allData),void 0!==t.data&&t.data.gameState===a.GameState.NONE&&(this.node.active&&!this.lostForcus&&this.resultNode.active||this._autoPlay())},onPrepareGame:function(t){t.action===a.Action.UPDATE_FREE_PLAY?this._updateFreeTurn(t.count,t.captchaRequired,t.time,t.allData):t.action===a.Action.CHANGE_STATE&&t.allData.freePlayInfo&&this._updateFreeTurn(t.allData.freePlayInfo.count,t.allData.freePlayInfo.captchaRequired,t.allData.freePlayInfo.time,t.allData)},onStartGame:function(t){this._updateVongQuayData(t),this._rotate(t)},onFinishGame:function(t){this._changeFinishState(),this.paramsResult=t,this.node.active&&!this.lostForcus||(cc.log("node not active => kill turn"),this._stopGamePlay(),this._setFastResult())},onHistoryClick:function(){var t=this;this.audioManager.playButtonClick(),s.openModalByName("games/vong_quay/HistoryVongQuay",function(e){e.getComponent("HistoryTableVongQuay").init(t.gameManager.historyList)})},onCloseClick:function(){this.node.active=!1},onPlayClick:function(){if(!this.resultNode.active){if(this.gameManager.gameState!==a.GameState.NONE)return cc.log("this.gameManager.gameState "+this.gameManager.gameState),void s.openWarningMessage("Xin vui lòng đợi lượt chơi kết thúc!",1);this.resultNode.active=!1,this.gameManager.sendStartGame()}},onAutoPlayClick:function(){this.autoPlay=!this.autoPlay,this._showOnOffAutoPlay()},onGetFreeClick:function(){return this.autoPlay?void s.openWarningMessage("Xin vui lòng tắt chế độ tự quay để nhận lượt quay miễn phí!",1):this.gameManager.gameState!==a.GameState.NONE?void s.openWarningMessage("Xin vui lòng đợi lượt quay kết thúc!",1):void this.gameManager.sendGetNewFree()},onCapchaSubmitClick:function(){return this.inputResultCapcha.string.length<1?void s.openWarningMessage("Xin vui điền câu trả lời!",1):void this.gameManager.sendCapcha(this.inputResultCapcha.string)},onCapchaCloseClick:function(){this.capchaBox.active=!1},setResultVong1:function(t,e){var n=this,i=30*(t-1);e?this.vong1.rotation=2880-i:this.vong1.runAction(cc.sequence(cc.rotateTo(3,2880-i).easing(cc.easeCircleActionOut()),cc.callFunc(function(){n._rotateCount()})))},setResultVong2:function(t,e){var n=this,i=45*(t-1);e?this.vong2.rotation=-2160-i:this.vong2.runAction(cc.sequence(cc.rotateTo(3,-2160-i).easing(cc.easeCircleActionOut()),cc.callFunc(function(){n._rotateCount()})))},setResultVong3:function(t,e){var n=this,i=45*t/2+45*(t-1)/2;e?this.vong3.rotation=2160-i:this.vong3.runAction(cc.sequence(cc.rotateTo(3,2160-i).easing(cc.easeCircleActionOut()),cc.callFunc(function(){n._rotateCount()})))},_showOnOffAutoPlay:function(){this.autoPlayNode.active=this.autoPlay,this.autoOnLabel.node.active=this.autoPlay,this.autoOffLabel.node.active=!this.autoPlay},_updateFreeTurn:function(t,e,n,i){var s=t>0&&e;if(s&&(this.txtGetFree.string="Nhận lượt quay miễn phí"),!e&&t>0&&(this.txtGetFree.string="Bạn đang quay miễn phí"),this.txtFreeCountPlay.string=t,this.btnGetFree.getComponent(cc.Button).enabled=s,this.timeCountDownFree=n,this.hasCountDownFree=t<=0&&e,void 0!==i&&this.gameManager.gameState===a.GameState.NONE){var o=i.isFree,r=i.betting;o===!0?(this.txtBetting.string="0"+c.CurrencyType.Ip.CHIP_NAME,this.gameManager.isFreeTurn=!0):this.txtBetting.string=r+c.CurrencyType.Ip.CHIP_NAME}},_removeEndLineString:function(t){return t.replace(/\n+/g," ")},_updateVongQuayData:function(t){if(t.allData){var e=t.allData.awards;this.vong1.getComponent(r).updateData(e[0]),this.vong2.getComponent(r).updateData(e[1]),this.vong3.getComponent(r).updateData(e[2])}},_changeFinishState:function(){this.gameManager.gameState=this.gameManager.gameState===a.GameState.FINALIZING?a.GameState.FINISH:a.GameState.FINALIZING,this.gameManager.gameState===a.GameState.FINISH&&this._showResult()},_showResult:function(){this._setFastResult();var t,e=this,n=this.paramsResult.data.result;if(n){this.resultNode.active=!0,this.resultNode.opacity=0;var i=0;for(t=0;t<n.length;t+=1)this.awardLabelList[t].string="";for(t=0;t<n.length;t+=1)n[t][0].amount>0&&(this.awardLabelList[i].string=c.CurrencyType.normalize(this._removeEndLineString(n[t][0].description)),i+=1);this.resultNode.runAction(cc.sequence(cc.fadeIn(.3),cc.delayTime(3),cc.fadeOut(.2),cc.callFunc(function(){e.resultNode.active=!1,e.gameManager.gameState=a.GameState.NONE,e._autoPlay()})))}},_autoPlay:function(){this.autoPlay&&(cc.log("==> autoPlay"),this.onPlayClick())},_rotateCount:function(){this.rotateCount+=1,this.rotateCount>=3&&(this.rotateCount=0,this._changeFinishState(),this._stopGamePlay())},_rotate:function(t){this.paramsResult=t,this.rotateCount=0;var e,n=t.data.result,i=n[0][0].id+1,a=n[1][0].id+1,s=n[2][0].id+1,o=this;for(this._stopGamePlay(),this.vong1.runAction(cc.sequence(cc.rotateTo(2,2520).easing(cc.easeQuadraticActionIn()),cc.callFunc(function(){o.setResultVong1(i)}))),this.vong2.runAction(cc.sequence(cc.rotateTo(3,-2520).easing(cc.easeQuadraticActionIn()),cc.callFunc(function(){o.setResultVong2(a)}))),this.vong3.runAction(cc.sequence(cc.rotateTo(2.5,2520).easing(cc.easeQuadraticActionIn()),cc.callFunc(function(){o.setResultVong3(s)}))),e=0;e<this.denSangNodeList.length;e+=1)this.denSangNodeList[e].runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.08),cc.delayTime(.08),cc.fadeOut(.08),cc.delayTime(.08))))},_setFastResult:function(){var t=this.paramsResult.data.result;t.length>0&&(this.setResultVong1(t[0][0].id+1,!0),this.setResultVong2(t[1][0].id+1,!0),this.setResultVong3(t[2][0].id+1,!0))},_stopGamePlay:function(){this.vong1.stopAllActions(),this.vong2.stopAllActions(),this.vong3.stopAllActions();for(var t=0;t<this.denSangNodeList.length;t+=1)this.denSangNodeList[t].stopAllActions()}}),cc._RFpop()},{BaseMinigameGameplay:"BaseMinigameGameplay",CommonConstant:"CommonConstant",GameConstant:"GameConstant",UiManager:"UiManager",Utils:"Utils",VongQuay:"VongQuay",VongQuayConstant:"VongQuayConstant"}],GameplayXiTo:[function(t,e,n){"use strict";cc._RFpush(e,"43da2OLCjBCz5j+iXHgSRFE","GameplayXiTo");var i=t("GameConstant"),a=t("XiToConstant"),s=t("Card"),o=t("GameplayLieng"),r=t("Utils");
cc.Class({"extends":o,properties:{moneyCallLabel:cc.Label,choseCardNoticeLabel:cc.Label,bettingPanel:cc.Node,moneyToLabel:cc.Label,moneyToTatCaLabel:cc.Label,moneyTo12Label:cc.Label,moneyTo14Label:cc.Label,moneyToX2Label:cc.Label,gameCmd:{"default":i.XITO.CMD,visible:!1,override:!0}},$onLoad:function(){o.prototype.$onLoad.call(this),this.canClickToCard=!1},bettingCall:function(){this.gameManager.bet(a.Action.CALL),this.audioManager.playButtonClick()},bettingCheck:function(){this.gameManager.bet(a.Action.CHECK),this.audioManager.playButtonClick()},bettingFold:function(){this.gameManager.bet(a.Action.FOLD),this.audioManager.playButtonClick()},bettingAll:function(){this.gameManager.bet(a.Action.ALL_IN),this.bettingPanel.active=!1,this.audioManager.playButtonClick()},betting12:function(){this.gameManager.bet(a.Action.BET_1_2),this.bettingPanel.active=!1,this.audioManager.playButtonClick()},betting14:function(){this.gameManager.bet(a.Action.BET_1_4),this.bettingPanel.active=!1,this.audioManager.playButtonClick()},bettingX2:function(){this.gameManager.bet(a.Action.BET_X2),this.bettingPanel.active=!1,this.audioManager.playButtonClick()},bettingNormal:function(){this.gameManager.bet(a.Action.BET),this.bettingPanel.active=!1,this.audioManager.playButtonClick()},showBettingPanel:function(){this.bettingPanel.active=!this.bettingPanel.active,this.audioManager.playButtonClick()},onChangeStateGame:function(){for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].player&&this.playerNodeList[t].player.data.state!==a.PlayerState.FOLDED&&this.playerNodeList[t].player.data.state!==a.PlayerState.ALL_IN&&this.playerNodeList[t].player.data.state!==a.PlayerState.NONE&&this.playerNodeList[t].clearEffects();this.bettingPanel.active=!1,this.moneyCallLabel.string=0},onChangeTurn:function(t){o.prototype.onChangeTurn.call(this,t),this.bettingPanel.active=!1},onDrawCard:function(t){if(this.choseCardNoticeLabel.node.active=!1,!this.layoutPlayerXiTo){var e=this.playerNodeList[0].node.getChildByName("Cards");this.layoutPlayerXiTo=e.getComponent(cc.Layout)}1!==this.gameManager.currentRound?this.layoutPlayerXiTo.spacingX=-55:(this.layoutPlayerXiTo.spacingX=45,this.choseCardNoticeLabel.node.active=!0,t&&this.playerNodeList[0].setCountDown(t)),o.prototype.onDrawCard.call(this)},updateInfoGame:function(t){var e="Luật: "+this.gameManager.gameType+" cây";this.topPanelInGameData.optionLabel=e,this.topPanelInGame&&this.topPanelInGame.setOptionLabel(e),this.moneyCallLabel.string=r.Number.format(t.allData.callBetting),o.prototype.updateInfoGame.call(this,t)},initAllBettingButtons:function(){this.allButtonBettings={},this.allButtonBettings[a.Action.BET]=this.bettingButtonsList[0],this.allButtonBettings[a.Action.ALL_IN]=this.bettingButtonsList[1],this.allButtonBettings[a.Action.CALL]=this.bettingButtonsList[2],this.allButtonBettings[a.Action.CHECK]=this.bettingButtonsList[3],this.allButtonBettings[a.Action.FOLD]=this.bettingButtonsList[4],this.allButtonBettings[a.Action.BET_1_2]=this.bettingButtonsList[5],this.allButtonBettings[a.Action.BET_1_4]=this.bettingButtonsList[6],this.allButtonBettings[a.Action.BET_X2]=this.bettingButtonsList[7],this.disableBettingButtons(!0)},choosePublicCard:function(t){if(1===this.gameManager.currentRound){var e=t.target.getComponent("CardUI");this.gameManager.choosePublicCard(e.card.getId()),this.layoutPlayerXiTo.spacingX=-55;var n=e.card.getId(),i=this.playerNodeList[0].node.getComponent("PlayerUIXiTo");if(7===this.gameManager.gameType){if(i.cardsHold[2].node!==t.target.node){var a=i.cardsHold[2].getComponent("CardUI");e.setCard(s.fromId(a.card.getId())),a.setCard(s.fromId(n))}i.cardsHold[0].showTransparentBlackNode(!0),i.cardsHold[1].showTransparentBlackNode(!0)}else{if(i.cardsHold[1].node!==t.target.node){var o=i.cardsHold[1].getComponent("CardUI");e.setCard(s.fromId(o.card.getId())),o.setCard(s.fromId(n))}i.cardsHold[0].showTransparentBlackNode(!0)}}},showOpenCardCurrentPlayer:function(t,e){for(var n=0;n<t.cardsHold.length;n+=1)if(t.cardsHold[n].node.active){e.publicCards.length>0&&t.cardsHold[n].showTransparentBlackNode(!0);for(var i=0;i<e.publicCards.length;i+=1)if(t.cardsHold[n].getComponent("CardUI").card&&e.publicCards[i]===t.cardsHold[n].getComponent("CardUI").card.getId()){t.cardsHold[n].showTransparentBlackNode(!1);break}}},setCurrentPlayerInTurn:function(t,e){var n=0;if(t){for(this.disableBettingButtons(!0),n=0;n<t.length;n+=1)this.allButtonBettings[t[n]].interactable=!0;this.bettingButtonsList[this.bettingButtonsList.length-1].interactable=!0}if(e)for(this.moneyToLabel.string="",this.moneyToX2Label.string="",this.moneyTo14Label.string="",this.moneyTo12Label.string="",this.moneyToTatCaLabel.string="",n=0;n<e.length;n+=1)switch(e[n].action){case a.Action.BET:this.moneyToLabel.string=r.Number.format(e[n].money);break;case a.Action.BET_X2:this.moneyToX2Label.string=r.Number.format(e[n].money);break;case a.Action.BET_1_4:this.moneyTo14Label.string=r.Number.format(e[n].money);break;case a.Action.BET_1_2:this.moneyTo12Label.string=r.Number.format(e[n].money);break;case a.Action.ALL_IN:this.moneyToTatCaLabel.string=r.Number.format(e[n].money)}},initClickEventToCards:function(){for(var t=this.gameManager,e=this,n=this.playerNodeList[0].node.getComponent("PlayerUIXiTo").cardsHold,i=0;i<n.length;i+=1)n[i].addComponent(cc.Button),n[i].on(cc.Node.EventType.TOUCH_START,function(){var n=this.getComponent("CardUI");t.choosePublicCard(n.card.getId()),e.canClickToCard=!1})},reDrawCard:function(t,e,n){var i,o=0;if(0===n){for(o=0;o<t.handSize;o+=1)i=e.cardsHold[o].getComponent("CardUI"),i.card&&i.card.getId()!==t.cards[o]&&i.setCard(s.fromId(t.cards[o]));t.publicCards&&this.showOpenCardCurrentPlayer(e,t)}else for(o=0;o<t.handSize;o+=1)i=e.cardsHold[o].getComponent("CardUI"),t.cards[o]>=0&&i.setCard(s.fromId(t.cards[o]));t.state===a.PlayerState.FOLDED&&(0!==n?e.fold():e.currentPlayerFold())},onShowBetting:function(t,e){o.prototype.onShowBetting.call(this,t,e),this.moneyCallLabel.string=r.Number.format(t.allData.callBetting)},convertTypeBetting:function(t){switch(t){case a.Action.BET:return a.Effect.TO;case a.Action.ALL_IN:return a.Effect.TO_TAT_CA;case a.Action.CALL:return a.Effect.THEO;case a.Action.CHECK:return a.Effect.NHUONG_TO;case a.Action.FOLD:return a.Effect.UP_BO;case a.Action.BET_1_2:return a.Effect.TO_12;case a.Action.BET_1_4:return a.Effect.TO_14;case a.Action.BET_X2:return a.Effect.TO_X2;case a.Action.ALL_HAND:return a.Effect.CHOI_TAT_TAY}},restartGame:function(){this.moneyCallLabel.string="0",o.prototype.restartGame.call(this)}}),cc._RFpop()},{Card:"Card",GameConstant:"GameConstant",GameplayLieng:"GameplayLieng",Utils:"Utils",XiToConstant:"XiToConstant"}],GameplayXoSo:[function(t,e,n){"use strict";cc._RFpush(e,"41c41IZt1FL0avkvy05z+ZP","GameplayXoSo");var i=t("EventDispatcherConstant"),a=t("EventDispatcher"),s=t("NetworkManager"),o=t("CommonConstant"),r=t("ToggleCurrency"),c=t("UiManager"),h=t("AuthUser"),u=t("Utils"),l=t("Url");cc.Class({"extends":cc.Component,properties:{xoSoItemPrefab:cc.Prefab,xoSoItemsContainer:cc.Node,dateLabel:cc.Label,remainTimeLabel:cc.Label,xoSoLogRichText:cc.RichText,xoSoEditBox:cc.EditBox,xoSoTypeInfoLabel:cc.Label,mucCuocPrefab:cc.Prefab,mucCuocContainer:cc.Node,balanceLabel:cc.Label,betAmountLabel:cc.Label,toggleCurrency:r},start:function(){this.node.zIndex=o.ZINDEX.MINIGAME_PREFAB},onLoad:function(){this.fetchXoSoTypes(),this.fetchXoSoLogs(),this.resetTienCuoc(),a.addEventListener(i.PROFILE.UPDATE_MONEY,this.updateUserMoney,this)},onDestroy:function(){a.removeEventListener(i.PROFILE.UPDATE_MONEY,this.updateUserMoney,this)},fetchXoSoTypes:function(){var t=this;s.Http.fetch("GET",l.Http.XOSO_TYPES,{},{cache:1800,delay:500}).success(function(e){var n,i,a,s=e.data.types;t.betValues=e.data.bet_values,a=u.Date.fromString(e.data.expire_time),t.remainSeconds=(a.getTime()-(new Date).getTime())/1e3,t.dateLabel.string="Ngày "+u.Date.format(a,"dd/mm/yyyy"),t.switchCurrency(),t.toggleCurrency.switchTo(t.currentCurrency),t.xoSoItemsContainer.removeAllChildren();for(var o=0;o<s.length;o+=1)n=cc.instantiate(t.xoSoItemPrefab),i=n.getComponent("XoSoItem"),i.updateData(s[o]),n.xoSoType=s[o],t.xoSoItemsContainer.addChild(n),0===o&&t.xoSoItemsContainer.getComponent("MultiSelect").selectItem(n)})},fetchXoSoLogs:function(){var t=this;s.Http.fetch("GET",l.Http.XOSO_BET_LIST,{},{cache:300,delay:500}).success(function(e){for(var n,i=e.data,a=[],s=0;s<i.length;s+=1)n=i[s],a.push(n.username+" <color=#ff5c97>"+u.Number.abbreviate(n.amount)+" "+o.CurrencyType.findByName(n.currency).DISPLAY_NAME+"</color> <color=#ed9459>"+n.bet_name+"</color> <color=#3debf5>"+n.numbers.join(" ")+"</color>");t.xoSoLogRichText.string=a.join("\n")})},betXoSo:function(t){var e=this;this.betAmount>0?s.Http.fetch("POST",l.Http.XOSO_BET,{username:h.username,accesstoken:h.accesstoken,amount:this.betAmount,currency:this.currentCurrency,bet_type:this.currentXoSoType,numbers:this.xoSoEditBox.string}).success(function(t){c.openModal(t.msg),e.resetTienCuoc(),h.currencies[t.data.currency].balance=t.data.balance,a.dispatchEvent(i.PROFILE.UPDATE_MONEY)}).setWaitingButton(t.target):c.openModal("Vui lòng chọn mức tiền cược.")},selectXoSoType:function(t){if(t.length>0){var e,n,i=t[0].xoSoType,a=[];for(this.currentXoSoType=i.id,this.xoSoTypeInfoLabel.string=i.name+" (Đặt 1 ăn "+i.ratio+")",e=new Array(i.number_of_digit+1).join("0"),n=0;n<i.quantity_number;n+=1)a.push(e);this.xoSoEditBox.string=a.join(", ")}},switchCurrency:function(){this.currentCurrency===o.CurrencyType.Ip.NAME?this.currentCurrency=o.CurrencyType.Xu.NAME:this.currentCurrency=o.CurrencyType.Ip.NAME,this.updateUserMoney(),this.resetTienCuoc();var t,e=this,n=e.betValues[e.currentCurrency];e.mucCuocContainer.removeAllChildren();for(var i=0;i<n.length;i+=1)t=cc.instantiate(e.mucCuocPrefab),t.betAmount=n[i],t.getComponentInChildren(cc.Label).string=u.Number.abbreviate(n[i]),e.mucCuocContainer.addChild(t),t.on(cc.Node.EventType.TOUCH_START,function(t){e.themTienCuoc(t.target.betAmount)},t)},updateUserMoney:function(){this.balanceLabel.string=u.Number.format(h.currencies[this.currentCurrency].balance)},themTienCuoc:function(t){this.betAmount+=t,this.betAmountLabel.string=u.Number.format(this.betAmount)},resetTienCuoc:function(){this.betAmount=0,this.betAmountLabel.string=u.Number.format(this.betAmount)},openXoSoResult:function(){this.openXoSoInfoModal("XoSoResult")},openXoSoMyBetHistory:function(){this.openXoSoInfoModal("LichSu")},openXoSoHelp:function(){this.openXoSoInfoModal("Help")},openXoSoInfoModal:function(t){c.openModalByName("games/xo_so/XoSoInfoModal",function(e){e.getComponentInChildren("TabView").activeByName(t)})},update:function(t){var e,n,i;this.remainSeconds>0?(this.remainSeconds-=t,i=this.remainSeconds,i>0&&(n=Math.floor(i/3600),e=u.Number.fillZero(n,2),e+=":"+u.Number.fillZero(Math.floor(i/60-60*n),2),e+=":"+u.Number.fillZero(Math.floor(i%60),2),this.remainTimeLabel.string=e)):this.remainTimeLabel.string="00:00:00"}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",NetworkManager:"NetworkManager",ToggleCurrency:"ToggleCurrency",UiManager:"UiManager",Url:"Url",Utils:"Utils"}],GameplayXocDia:[function(t,e,n){"use strict";cc._RFpush(e,"3ec08zHK0VPFJRoPbXZc2+V","GameplayXocDia");var i=t("GameConstant"),a=t("Utils"),s=t("AuthUser"),o=t("BaseMainGameplay"),r=t("GameManagerConstant"),c=t("XocDiaConstant");cc.Class({"extends":o,properties:{slotInfor:{"default":[],type:cc.Node},banker:cc.Node,chipPrefab:cc.Prefab,moveTo:cc.Node,moveFrom:cc.Node,bowDice:cc.Node,parentChipBetting:cc.Node,nhiKetQuaList:{"default":[],type:cc.Sprite},spriteFrameKetQua:{"default":[],type:cc.SpriteFrame},timeLabel:cc.Label,timeCountDow:cc.Sprite,gridResult:cc.Node,resultXanh:cc.Prefab,resultTrang:cc.Prefab,bow:cc.Node,stateGameLabel:cc.Label,btnX2:cc.Button,btnCancelBet:cc.Button,btnRebet:cc.Button,gameCmd:{"default":i.XOC_DIA.CMD,visible:!1}},$onLoad:function(){this.listChipBetting=[],this._poolChip=new cc.NodePool("Chip"),this.moneyBetSelect=0,this.time=0,this.gameManager.eventDispatchers.local.addEventListener(c.Event.BETTING_SUCCESS,this.onBettingSuccess,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.SHAKE_BOW_DICE,this.onShakeBow,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.ADD_LIST_BETTING,this._addChipBetting,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.PLAYER_BETTING_STATE,this._playerBettingState,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.FINISH,this.onFinishGame,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.CANCEL_BET,this.onCancelBetting,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.SET_RATIO,this.onSetRatio,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.BETTING_UPDATEGAME,this.onBettingUpdate,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.MASTER_CANEL_BET,this.onMasterCencelBet,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.MASTER_CANEL_BET_RECEIVE,this.onMasterCencelBetReceive,this),this.gameManager.eventDispatchers.local.addEventListener(c.Event.CHANGE_STATE,this.onChangeState,this),this.gameManager.eventDispatchers.local.addEventListener(r.Event.NEW_MATCH_LOST_FOCUS,this.onNewMatchLostFocus,this),this._enableNodeWhenLoad(!1),this._disableAllButton()},$onUpdate:function(){if(this._checkOnFocus(),this.gameManager.gameState===c.GameState.PLAYER_BETTING||this.gameManager.gameState===c.GameState.MASTER_CANEL_BET){var t=Math.floor((this.time-Date.now())/1e3);t=t>=0?t:0,this.timeLabel.string=t,t<=0&&(this.timeLabel.node.active=!1,this.timeCountDow.node.active=!1)}},$onDestroy:function(){this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId)},$onFocus:function(){if(this.gameManager.gameState!==c.GameState.FINISH){this.bow.position=cc.v2(0,0);for(var t=0;t<this.slotInfor.length;t+=1){var e=this.slotInfor[t].getComponent("SlotInfor");e.showEfectWin(!1)}}if(this.gameManager.gameState!==c.GameState.EFFECT){var n=this.bowDice.getComponent(cc.Animation);n.stop("Shake"),this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId)}this.gameManager.gameState===c.GameState.EFFECT&&(this.bowDice.position=cc.v2(0,0))},onNewMatchLostFocus:function(){},onChangeState:function(){switch(this.gameManager.gameState){case c.GameState.EFFECT:this.stateGameLabel.string="Nhà cái bắt đầu xóc!",this._disableAllButton();break;case c.GameState.PLAYER_BETTING:if(this.stateGameLabel.string="Hãy chọn cửa để đặt!",this.gameManager.history.length>0&&!this.gameManager.isMaster){for(var t=!1,e=0;e<this.gameManager.history.length;e+=1)if(this.gameManager.history[e]>0){t=!0;break}this.btnRebet.interactable=t}this.audioManager.playTurnStart();break;case c.GameState.MASTER_CANEL_BET:this.stateGameLabel.string="Nhà cái hủy cược!",this._disableAllButton();break;case c.GameState.FINALIZING:this.stateGameLabel.string="Kết quả!",this._disableAllButton()}},_disableAllButton:function(){this.btnRebet.interactable=!1,this.btnX2.interactable=!1,this.btnCancelBet.interactable=!1},_checkOnFocus:function(){if(this.gameManager.gameState!==c.GameState.FINALIZING){this.bow.position=cc.v2(0,0);for(var t=0;t<this.slotInfor.length;t+=1){var e=this.slotInfor[t].getComponent("SlotInfor");e.showEfectWin(!1)}}if(this.gameManager.gameState!==c.GameState.EFFECT){var n=this.bowDice.getComponent(cc.Animation);n.stop("Shake"),this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId)}else this.bowDice.position=cc.v2(0,0)},_showTimeState:function(t){var e=this.bowDice.getComponent(cc.Animation);e.stop("Shake",5),this.xocAudioId&&this.audioManager.stopEffect(this.xocAudioId),this.bowDice.position=cc.v2(0,0),this._enableNodeWhenLoad(!0);var n=cc.rotateBy(5,360);this.timeCountDow.node.runAction(cc.repeatForever(n)),this.time=Date.now()+t},onMasterCencelBetReceive:function(t){var e=this.slotInfor[t].getComponent("SlotInfor");for(var n in e.playerBetList)this._moveChipToPlayer(n,this.slotInfor[t]),e.removeMoneyPot(n)},onMasterCencelBet:function(t){this._showTimeState(t.time),this._activeSellCancelPot(!0)},_activeSellCancelPot:function(t){if(this.gameManager.isMaster&&t)for(var e=0;e<this.slotInfor.length;e+=1){var n=this.slotInfor[e].getComponent("SlotInfor");n.activeCancelPotXocDia(t)}else for(var i=0;i<this.slotInfor.length;i+=1){var a=this.slotInfor[i].getComponent("SlotInfor");a.activeCancelPotXocDia(!1)}},_enableNodeWhenLoad:function(t){this.timeCountDow.node.active=t,this.timeLabel.node.active=t},onBettingUpdate:function(t){this.audioManager.playChipBay();for(var e=0;e<t.info.length;e+=1){var n,i,a,o=this.findPlayerNodeByName(t.info[e].userName),r=0;n=cc.instantiate(this.chipPrefab),o&&(n.parent=o.node.parent,n.position=o.node),i=n.getComponent("Chip"),i.activeSelectChip(!1),i.moneyLabel.node.active=!1,n.scale=cc.v2(.5,.5),i.init(t.info[e].money),i=n.getComponent(cc.Button),i.enabled=!1,n.removeComponent("ButtonScaler"),a=this.slotInfor[t.id].getComponent("SlotInfor"),a.init(),t.info[e].username===s.username&&(r=t.info[e].money),a.setMoneyPot(r,t.info[e].money),a.addPlayerBetToPot(t.info[e].userName,t.info[e].money);var c=cc.moveTo(.5,cc.v2(this.slotInfor[t.id].x,this.slotInfor[t.id].y)).easing(cc.easeOut(2));n.runAction(cc.sequence(c,cc.callFunc(function(){this.destroy()},n)))}},onCancelBetting:function(t){var e=this.slotInfor[t.pot].getComponent("SlotInfor");this._moveChipToPlayer(t.username,this.slotInfor[t.pot]),t.username===s.username&&(this.btnX2.interactable=!1,this.btnCancelBet.interactable=!1),e.removeMoneyPot(t.username)},onSetRatio:function(t){for(var e=0;e<t.length;e+=1){var n=this.slotInfor[t[e].id].getComponent("SlotInfor");n.setRatioPot(t[e].ratio)}},onFinishGame:function(t){var e=this;e.timeCountDow.node.active=!1;var n=cc.sequence(cc.callFunc(function(){e._setKetQua(t.dices)}),cc.callFunc(function(){e._openBow()}),cc.delayTime(1),cc.callFunc(function(){e._showSlostWin(t.potWin)}),cc.callFunc(function(){e._bankerPayChip(t.potWin)}),cc.delayTime(1),cc.callFunc(function(){e._payChipToPlayer(t.potWin)}),cc.delayTime(2),cc.callFunc(function(){e._showMoneyFinish(t.players)}),cc.delayTime(2),cc.callFunc(function(){e._moveChipToBanker()}),cc.callFunc(function(){e._showBankerMoneyFinish(t.banker)}),cc.callFunc(function(){e._addResult(t.dices)}),cc.callFunc(function(){e._clearPlayerInPot()}),cc.delayTime(2),cc.callFunc(function(){e._clearEfectFinish()}));this.node.runAction(n)},_addResult:function(t){for(var e=this,n=0,i=0;i<t.length;i+=1)n+=t[i];var a,s=n%2;a=0===s?cc.instantiate(this.resultTrang):cc.instantiate(this.resultXanh),32===e.gridResult.childrenCount&&e.gridResult.removeAllChildren(),e.gridResult.addChild(a)},_clearEfectFinish:function(){for(var t=0;t<this.playerNodeList.length;t+=1)this.playerNodeList[t].clearEffects()},_moveChipToPlayer:function(t,e,n){var i,s,o;this.audioManager.playChipBay();for(var r=0;r<3;r+=1)if(a.Type.isString(t)?(s=this.findPlayerNodeByName(t),s&&(s=s.node)):s=t,s){i=cc.instantiate(this.chipPrefab),i.parent=s.parent,i.position=e,o=i.getComponent("Chip"),o.activeSelectChip(!1),o.moneyLabel.node.active=!1,i.removeComponent("ButtonScaler"),i.removeComponent(cc.Button),i.scale=cc.v2(.5,.5),o.init(n);var c=cc.moveTo(.8,cc.v2(s.x,s.y)).easing(cc.easeOut(2));i.runAction(cc.sequence(cc.delayTime(r-.95*r),c,cc.callFunc(function(){this.destroy()},i)))}},_bankerPayChip:function(t){for(var e=0;e<t.length;e+=1)Object.keys(this.slotInfor[t[e]].getComponent("SlotInfor").playerBetList).length>0&&this._moveChipToPlayer(this.slotInfor[t[e]],this.banker)},_payChipToPlayer:function(t){for(var e=0;e<t.length;e+=1){var n=this.slotInfor[t[e]].getComponent("SlotInfor");this._findPlayerWinInSlost(n.playerBetList,t[e])}},_moveChipToBanker:function(){for(var t=this,e=0;e<t.slotInfor.length;e+=1){var n=this.slotInfor[e].getComponent("SlotInfor");n.isWin||n.chipFackeList.length>0&&this._moveChipToPlayer(t.banker,t.slotInfor[e])}},_findPlayerWinInSlost:function(t,e){var n=this,i=n.slotInfor[e].getComponent("SlotInfor");i.destroyChipFacke();for(var a=Object.keys(t),s=0;s<a.length;s+=1)n._moveChipToPlayer(a[s],n.slotInfor[e])},_setKetQua:function(t){this._activeSellCancelPot(!1);for(var e=0;e<t.length;e+=1)this.nhiKetQuaList[e].spriteFrame=this.spriteFrameKetQua[t[e]]},_showSlostWin:function(t){for(var e=0;e<t.length;e+=1){var n=this.slotInfor[t[e]].getComponent("SlotInfor");n.showEfectWin(!0),n.isWin=!0}},_disableEfectSlostWin:function(){for(var t=0;t<this.slotInfor.length;t+=1){var e=this.slotInfor[t].getComponent("SlotInfor");e.showEfectWin(!1),e.isWin=!1}},_showMoneyFinish:function(t){for(var e=0;e<t.length;e+=1){var n=this.findPlayerNodeByName(t[e].userName);n&&(n.setFinishEffect(t[e].moneyExchange),t[e].userName===s.username&&(t[e].moneyExchange>0?this.audioManager.playWin():this.audioManager.playLose()))}},_showBankerMoneyFinish:function(t){if(void 0!==t.userName){var e=this.findPlayerNodeByName(t.userName);e&&e.setFinishEffect(t.moneyExchange)}},_clearPlayerInPot:function(){for(var t=this,e=0;e<t.slotInfor.length;e+=1){var n=t.slotInfor[e].getComponent("SlotInfor");n.playerBetList={},n.totallMoneyLong=0,n.myMoneyLong=0,n.potX=0,n.setMoneyPot(0,0),n.destroyChipFacke()}},onBettingSuccess:function(t){var e,n,i=this,a=this._poolChip.get(),o=this.findPlayerNodeByName(t.username),r=!1,h=!1,u=0;a||(a=cc.instantiate(this.chipPrefab)),o&&(a.parent=o.node.parent,a.position=o.node),e=a.getComponent("Chip"),e.activeSelectChip(!1),a.scale=cc.v2(.5,.5);for(var l=0;l<this.gameManager.bettingList.length;l+=1)if(this.gameManager.bettingList[l]===t.money){e.init(t.money,c.ChipColor.findById(l).NAME),r=!0;break}r||(e.moneyLabel.node.active=!1,e.init(t.money)),e=a.getComponent(cc.Button),e.enabled=!1,a.removeComponent("ButtonScaler"),n=this.slotInfor[t.pot].getComponent("SlotInfor"),n.init(),t.username===s.username&&(u=t.money,this.btnX2.interactable=!0,this.btnCancelBet.interactable=!0),n.setMoneyPot(u,t.money),n.addPlayerBetToPot(t.username,t.money);for(var d=0;d<this.gameManager.bettingList.length;d+=1)if(this.gameManager.bettingList[d]===t.money){h=!0;var m=this.slotInfor[t.pot].getChildByName(d.toString()).convertToWorldSpace(cc.v2(0,0)),p=this.node.convertToNodeSpaceAR(m),g=cc.moveTo(.3,p).easing(cc.easeOut(2));a.runAction(cc.sequence(g,cc.callFunc(function(){i._poolChip.put(a),n.caculateChip()},a)))}if(!h){h=!0;var f=this.slotInfor[t.pot].getChildByName("0").convertToWorldSpace(cc.v2(0,0)),_=this.node.convertToNodeSpaceAR(f),y=cc.moveTo(.3,_).easing(cc.easeOut(2));a.runAction(cc.sequence(y,cc.callFunc(function(){i._poolChip.put(a),n.caculateChip()},a)))}this.audioManager.playChipBay()},onShakeBow:function(){this._disableEfectSlostWin();var t=this,e=this.bowDice.getComponent(cc.Animation),n=cc.sequence(cc.callFunc(t._closeBow()),cc.delayTime(1.5),cc.callFunc(function(){t.bow.position.x>0&&(t.bow.position=cc.v2(0,0)),e.play("Shake"),t.xocAudioId=t.audioManager.playXoc(!0)},this));this.bow.runAction(n);for(var i=0;i<this.slotInfor.length;i+=1){var a=this.slotInfor[i].getComponent("SlotInfor");a.showEfectWin(!1)}},clickReBet:function(){this.gameManager.sendReBet()},clickDoubleBet:function(){this.gameManager.sendDoubleBet()},clickCancelBet:function(){this.gameManager.sendCancelBet()},clickRequestBanker:function(){this.gameManager.sendRequestBanker()},_openBow:function(){var t=cc.moveTo(1,cc.p(-90,0)).easing(cc.easeOut(2));this.bow.runAction(t),this.timeCountDow.node.active=!1,this.timeLabel.node.active=!1},_closeBow:function(){var t=cc.moveTo(1,cc.p(0,0));this.bow.runAction(t)},_playerBettingState:function(t){this._showTimeState(t.time)},_showTimeCountDow:function(t){this.timeLabel.string=t},_addChipBetting:function(t){var e,n,i=this;this.audioManager.playChipBay(),this.parentChipBetting.removeAllChildren();for(var a=0;a<t.length;a+=1)e=cc.instantiate(this.chipPrefab),this.listChipBetting.push(e),n=e.getComponent("Chip"),n.init(t[a],c.ChipColor.findById(a).NAME),e.on(cc.Node.EventType.TOUCH_START,function(){this.activeSelectChip(!0),i._selectChip(this.node)},n),this.parentChipBetting.addChild(e);this._selectChip(this.listChipBetting[0])},_removeSelectChip:function(){for(var t=0;t<this.listChipBetting.length;t+=1){var e=this.listChipBetting[t].getComponent("Chip");e.activeSelectChip(!1)}},_selectChip:function(t){this._removeSelectChip();var e=t.getComponent("Chip");e.activeSelectChip(!0),this.moneyBetSelect=e.money}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",GameConstant:"GameConstant",GameManagerConstant:"GameManagerConstant",Utils:"Utils",XocDiaConstant:"XocDiaConstant"}],GiftCode:[function(t,e,n){"use strict";cc._RFpush(e,"acf5blDJupB757lvldHya+3","GiftCode");var i=t("Url"),a=t("AuthUser"),s=t("UiManager"),o=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{infoLabel:cc.Label,giftCodeEditBox:cc.EditBox},onLoad:function(){},getGiftCodeInfo:function(){var t=this;o.Http.fetch("GET",i.Http.GIFT_CODE,{},{cache:1800}).success(function(e){t.infoLabel.string=e.data.note})},confirmGiftCode:function(t){var e=this.giftCodeEditBox.string;return e?void o.Http.fetch("POST",i.Http.GIFT_CODE,{username:a.username,accesstoken:a.accesstoken,pin:e}).setWaitingButton(t.target):s.openModal("Vui lòng nhập mã giftcode")}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],HaiTacConstant:[function(t,e,n){"use strict";cc._RFpush(e,"3d651ehRqxO0IPnrgnR0y4t","HaiTacConstant"),e.exports={GameType:{type:0},BettingList:[],BettingFreeList:[],Action:{ROTATE:0,OPEN_COFFER:2,CHANGE_STATE:5,UPDATE_AWARD_TYPE:9},GameState:{NONE:0,ROTATE:1,FINALIZING:2,FINISH:3,OPEN_COFFER:4},Event:{GET_JAR_SUCCESS:"in_game.HAI_TAC.getjarsuccess",OPEN_COFFER:"in_game.HAI_TAC.opencoffer",UPDATE_JAR:"in_game.HAI_TAC.updatejar",UPDATE_USER_INFO:"in_game.HAI_TAC.updateuserinfo",UPDATE_AWARD_TYPE:"in_game.HAI_TAC.updateAwardType",TURN_PREPARE:"in_game.HAI_TAC.prepare",TURN_START:"in_game.HAI_TAC.start",TURN_UPDATE:"in_game.HAI_TAC.update",TURN_FINISH:"in_game.HAI_TAC.finish"}},cc._RFpop()},{}],HaiTacGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"281f8MtMQFKAb3ioGxnM7+3","HaiTacGameManager");var i,a=t("Utils"),s=t("Url"),o=t("AuthUser"),r=t("CommonConstant"),c=t("BaseGameManager"),h=t("SmartFoxConstant"),u=t("NetworkManager"),l=t("HaiTacConstant");i=a.Class({$$extends:c,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[h.Command.MESSAGE.ID],this.gameState=l.GameState.NONE,this.isFreeTurn=!1,this.eventDispatchers.anyCmd.addEventListener(h.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(h.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(h.Command.UPDATE_USER_INFO.ID,this.onUpdateUser,this),this.eventDispatchers.globalCmd.addEventListener(h.Command.UPDATE_JAR.ID,this.onUpdateGameJar,this),this.eventDispatchers.playCmd.addEventListener(l.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(l.Action.OPEN_COFFER,this.onOpenCoffer,this),this.eventDispatchers.playCmd.addEventListener(l.Action.UPDATE_AWARD_TYPE,this.onUpdateAwardType,this);var n="haitac";this.historyDataKey="data_history_"+n+"_user_"+o.username,l.GameType.type===-1&&(this.historyDataKey="data_history_"+n+"_free_user_"+o.username),this.historyList=[];var i=cc.sys.localStorage.getItem(this.historyDataKey);void 0!==i&&null!==i&&(this.historyList=JSON.parse(i))},onUpdateAwardType:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_AWARD_TYPE,t)},onUpdateUser:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_USER_INFO,t)},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_JAR,t)},onFinishGame:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.TURN_FINISH,t);var e=this.isFreeTurn?"Q.Miễn phí":a.Number.format(this.betting)+" "+(l.GameType.type===-1?r.CurrencyType.Xu.CHIP_NAME:r.CurrencyType.Ip.CHIP_NAME),n={time:a.Date.currentTime(),result:t.player.moneyExchange,betting:this.betting,totalBetting:this.betting*this.potCount,type:e};this.historyList.unshift(n),this.historyList.length>60&&this.historyList.splice(this.historyList.length-1,1),cc.sys.localStorage.setItem(this.historyDataKey,JSON.stringify(this.historyList)),this.isFreeTurn=!1},onOpenCoffer:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.OPEN_COFFER,t)},onChangeStateGame:function(t){var e=t.gameState;void 0!==e&&(this.gameState=e,e===l.GameState.ROTATE?this.eventDispatchers.local.dispatchEvent(l.Event.TURN_START,t):e===l.GameState.NONE&&this.eventDispatchers.local.dispatchEvent(l.Event.TURN_PREPARE,t))},onUpdateGame:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.TURN_UPDATE,t)},sendStartGame:function(t,e,n){this.betting=t,this.potCount=e.length,this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.ROTATE),betting:u.SmartFox.type["long"](t),pots:u.SmartFox.type.byteArray(e),currency:u.SmartFox.type.utfString(n)})},updateAwardType:function(){this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.UPDATE_AWARD_TYPE)})},openLuckyCoffer:function(t){this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.OPEN_COFFER),id:u.SmartFox.type["byte"](t)})},destroy:function(){this.$super.destroy.call(this)},getJar:function(){var t=this;u.Http.fetch("GET",s.Http.GET_JAR,{game_id:t.gameId}).success(function(e){t.eventDispatchers.local.dispatchEvent(l.Event.GET_JAR_SUCCESS,e)},{cache:900})}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",HaiTacConstant:"HaiTacConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Url:"Url",Utils:"Utils"}],Hall:[function(t,e,n){"use strict";cc._RFpush(e,"bd2ef48uEVJG4GgrfA5n4pV","Hall");var i=t("GameItem"),a=t("GameManager"),s=t("GameConstant"),o=t("EventDispatcher"),r=t("EventDispatcherConstant"),c=t("TopPanelOutGameWrapper");cc.Class({"extends":c,properties:{gameItemPrefab:cc.Prefab,gameSlotItemPrefab:cc.Prefab,listGameScrollView:cc.ScrollView,listGameSlotScrollView:cc.ScrollView,showGameListNode:cc.Node,showGameSlotListPrefabNode:cc.Node},onLoad:function(){c.prototype.onLoad.call(this),this.updateGameList(),o.addEventListener(r.GAME.UPDATE_LIST,this.updateGameList,this)},onDestroy:function(){o.removeEventListener(r.GAME.UPDATE_LIST,this.updateGameList,this)},updateGameList:function(){var t,e,n,i,o=[],r=[],c=s.getGamePriorities();for(n=0;n<a.GAME_GROUP_LIST.length;n+=1)if(t=a.GAME_GROUP_LIST[n],t&&t.length>0){if(e=t[0],e&&e.CONFIG&&e.CONFIG.IS_MINIGAME&&a.isSmartFoxGame(e))continue;e&&e.CONFIG&&e.CONFIG.IS_SLOT?r.push(t):o.push(t)}r.length>0&&(i=cc.instantiate(this.showGameSlotListPrefabNode),i.active=!0),this._updateGameList(c,o,this.listGameScrollView,this.gameItemPrefab,i),this._updateGameList(c,r,this.listGameSlotScrollView,this.gameSlotItemPrefab)},_updateGameList:function(t,e,n,a,s){var o,r;for(e.sort(function(e,n){return t[e[0].gameId]-t[n[0].gameId]}),n.content.removeAllChildren(),s&&e.length>0&&n.content.addChild(s),r=0;r<e.length;r+=1)o=cc.instantiate(a),o.getComponent(i).init(e[r]),n.content.addChild(o);n.scrollToTopLeft()},switchGameList:function(){this.listGameScrollView.node.active=!this.listGameScrollView.node.active,this.listGameSlotScrollView.node.active=!this.listGameSlotScrollView.node.active,this.showGameListNode.active=!this.showGameListNode.active}}),cc._RFpop()},{EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameConstant:"GameConstant",GameItem:"GameItem",GameManager:"GameManager",TopPanelOutGameWrapper:"TopPanelOutGameWrapper"}],HelpMiniPoker:[function(t,e,n){"use strict";cc._RFpush(e,"edfbaK3mhlJQbX8ssY2bqXY","HelpMiniPoker");var i=t("Url"),a=t("GameConstant"),s=t("NetworkManager");
cc.Class({"extends":cc.Component,properties:{lblTextHelp:cc.Label,scrollView:cc.ScrollView},onLoad:function(){this.scrollView.node.active=!1,s.Http.fetch("GET",i.Http.GAME_HELP,{game_id:a.MINI_POKER.ID},{cache:900,delay:500}).success(function(t){if(t){if(!this.isValid)return;this.scrollView.node.active=!0,this.lblTextHelp.string=t.data.content}}.bind(this))}}),cc._RFpop()},{GameConstant:"GameConstant",NetworkManager:"NetworkManager",Url:"Url"}],HistorySanThuong:[function(t,e,n){"use strict";cc._RFpush(e,"a7e96aB1itNKroheqFOFWz/","HistorySanThuong");var i=t("Pagination");cc.Class({"extends":cc.Component,properties:{pagination:i,historyItemTemplateNode:cc.Node,historyListNode:cc.Node,historyListScrollView:cc.ScrollView,maxRows:10},onLoad:function(){this.historyListScrollView.node.active=!1,this.historyListNode.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.historyListScrollView.node.active=!0}.bind(this))))},init:function(t){if(t){var e,n=Math.ceil(t.length/10),i=[];for(this.historyList=t,e=1;e<=n;e+=1)i.push(e);this.selectPage({page:1}),this.pagination.init({pageList:i,currentPage:1},this.selectPage.bind(this))}},selectPage:function(t){if(this.historyList&&t){var e,n,i,a,s=t.page-1,o=s*this.maxRows,r=this.historyList.slice(o,o+this.maxRows);for(this.historyListNode.removeAllChildren(),a=0;a<r.length;a+=1)i=cc.instantiate(this.historyItemTemplateNode),i.active=!0,n=r[a],e=i.getComponentsInChildren(cc.Label),e[0].string=n[0]||" ",e[1].string=n[1]||" ",e[2].string=n[2]||" ",e[3].string=n[3]||" ",e[4].string=n[4]||" ",this.historyListNode.addChild(i)}}}),cc._RFpop()},{Pagination:"Pagination"}],HistoryTableMiniPoker:[function(t,e,n){"use strict";cc._RFpush(e,"12301Ua6UZF+qnbcwQspV/e","HistoryTableMiniPoker");var i=t("Utils"),a=t("Pagination"),s=t("CommonConstant"),o=t("MiniPokerConstant");cc.Class({"extends":cc.Component,properties:{itemPrefab:{"default":null,type:cc.Prefab},contentItem:cc.Node,scrollView:cc.ScrollView,pagination:a,maxRow:10},onLoad:function(){this.scrollView.node.active=!1,this.contentItem.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.scrollView.node.active=!0}.bind(this))))},init:function(t){if(t){this.historyList=t;for(var e=Math.ceil(t.length/this.maxRow),n=[],i=0;i<e;i+=1)n.push(i+1);this.selectPage({page:1}),this.pagination.init({pageList:n,currentPage:1},this.selectPage.bind(this))}},selectPage:function(t){if(this.historyList&&t){var e=t.page-1,n=e*this.maxRow,a=this.historyList.slice(n,n+this.maxRow);this.contentItem.removeAllChildren();for(var r=0;r<a.length;r+=1){var c=a[r],h=c.currency===s.CurrencyType.Ip.NAME?s.CurrencyType.Ip.DISPLAY_NAME:s.CurrencyType.Xu.DISPLAY_NAME,u=cc.instantiate(this.itemPrefab);u.getChildByName("1").getComponent(cc.Label).string=r+1,u.getChildByName("2").getComponent(cc.Label).string=c.time,u.getChildByName("3").getComponent(cc.Label).string=i.Number.format(c.moneyBet)+" "+h,u.getChildByName("4").getComponent(cc.Label).string=c.potWin>0?o.getPotName(c.potWin):"Thua",u.getChildByName("5").getComponent(cc.Label).string=i.Number.format(c.moneyExchange)+" "+h,u.enabled=!0,this.contentItem.addChild(u)}}}}),cc._RFpop()},{CommonConstant:"CommonConstant",MiniPokerConstant:"MiniPokerConstant",Pagination:"Pagination",Utils:"Utils"}],HistoryTableTaiXiu:[function(t,e,n){"use strict";cc._RFpush(e,"5235d75aq5J+q1CrvAKfQdX","HistoryTableTaiXiu");var i=t("Pagination"),a=t("CommonConstant"),s=t("TaiXiuConstant");cc.Class({"extends":cc.Component,properties:{pagination:i,historyItemTemplateNode:cc.Node,historyListNode:cc.Node,historyListScrollView:cc.ScrollView,maxRows:10},onLoad:function(){this.historyListScrollView.node.active=!1,this.historyListNode.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.historyListScrollView.node.active=!0}.bind(this))))},init:function(t){if(t){var e,n=Math.ceil(t.length/10),i=[];for(this.historyList=t,e=1;e<=n;e+=1)i.push(e);this.selectPage({page:1}),this.pagination.init({pageList:i,currentPage:1},this.selectPage.bind(this))}},selectPage:function(t){if(this.historyList&&t){var e,n,i,o,r,c,h,u,l,d=t.page-1,m=d*this.maxRows,p=(this.historyList.length,this.historyList.slice(m,m+this.maxRows));for(this.historyListNode.removeAllChildren(),l=0;l<p.length;l+=1){r=cc.instantiate(this.historyItemTemplateNode),r.active=!0,o=p[l],n=a.CurrencyType.findByName(o.currency),i=o.potBettingMap,h="",u="";for(c in i)h+=s.Pot.findById(c).NAME+"\n",u+=i[c]+" "+n.DISPLAY_NAME+"\n";h=h.trim(),u=u.trim(),e=r.getComponentsInChildren(cc.Label),e[0].string=l+1,e[1].string=o.time,e[2].string=h,e[3].string=u,e[4].string=s.Pot.findById(o.potWin).NAME,e[5].string=o.moneyExchange+" "+n.DISPLAY_NAME,this.historyListNode.addChild(r)}}}}),cc._RFpop()},{CommonConstant:"CommonConstant",Pagination:"Pagination",TaiXiuConstant:"TaiXiuConstant"}],HistoryTableTayDuKy:[function(t,e,n){"use strict";cc._RFpush(e,"d1ccdNe4r5H+rr5jOxP1w9D","HistoryTableTayDuKy");var i=t("Pagination");cc.Class({"extends":cc.Component,properties:{pagination:i,historyItemTemplateNode:cc.Node,historyListNode:cc.Node,historyListScrollView:cc.ScrollView,maxRows:10},onLoad:function(){this.historyListScrollView.node.active=!1,this.historyListNode.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.historyListScrollView.node.active=!0}.bind(this))))},init:function(t){if(t){var e,n=Math.ceil(t.length/10),i=[];for(this.historyList=t,e=1;e<=n;e+=1)i.push(e);this.selectPage({page:1}),this.pagination.init({pageList:i,currentPage:1},this.selectPage.bind(this))}},selectPage:function(t){if(this.historyList&&t){var e,n,i,a,s=t.page-1,o=s*this.maxRows,r=this.historyList.slice(o,o+this.maxRows);for(this.historyListNode.removeAllChildren(),a=0;a<r.length;a+=1)i=cc.instantiate(this.historyItemTemplateNode),i.active=!0,n=r[a],e=i.getComponentsInChildren(cc.Label),e[0].string=n[0]||" ",e[1].string=n[1]||" ",e[2].string=n[2]||" ",e[3].string=n[3]||" ",e[4].string=n[4]||" ",this.historyListNode.addChild(i)}}}),cc._RFpop()},{Pagination:"Pagination"}],HistoryTableVongQuay:[function(t,e,n){"use strict";cc._RFpush(e,"2eeccKPV/RIB6mCmE1nr4t9","HistoryTableVongQuay");var i=t("Pagination"),a=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{itemNode:cc.Node,contentItem:cc.Node,scrollView:cc.ScrollView,pagination:i,maxRow:10},onLoad:function(){this.scrollView.node.active=!1,this.contentItem.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.scrollView.node.active=!0}.bind(this))))},init:function(t){if(t){this.historyList=t;for(var e=Math.ceil(t.length/this.maxRow),n=[],i=0;i<e;i+=1)n.push(i+1);this.selectPage({page:1}),this.pagination.init({pageList:n,currentPage:1},this.selectPage.bind(this))}},selectPage:function(t){if(this.historyList&&t){var e=t.page-1,n=e*this.maxRow,i=this.historyList.slice(n,n+this.maxRow);this.contentItem.removeAllChildren();for(var s=0;s<i.length;s+=1){var o=i[s],r=cc.instantiate(this.itemNode);r.getChildByName("1").getComponent(cc.Label).string=s+1,r.getChildByName("2").getComponent(cc.Label).string=o.time,r.getChildByName("3").getComponent(cc.Label).string=a.CurrencyType.normalize(this._removeEndLineString(o.vong1.description)),r.getChildByName("4").getComponent(cc.Label).string=a.CurrencyType.normalize(this._removeEndLineString(o.vong2.description)),r.getChildByName("5").getComponent(cc.Label).string=a.CurrencyType.normalize(this._removeEndLineString(o.vong3.description)),r.getChildByName("6").getComponent(cc.Label).string=o.betting,r.active=!0,this.contentItem.addChild(r)}}},_removeEndLineString:function(t){return t.replace(/\n+/g," ")}}),cc._RFpop()},{CommonConstant:"CommonConstant",Pagination:"Pagination"}],HoaQuaConstant:[function(t,e,n){"use strict";cc._RFpush(e,"a83d32Yb8VGIY+46Qms7a52","HoaQuaConstant"),e.exports={GameType:{type:0},BettingList:[],BettingFreeList:[],Action:{ROTATE:0,OPEN_COFFER:2,CHANGE_STATE:5,UPDATE_AWARD_TYPE:9},GameState:{NONE:0,ROTATE:1,FINALIZING:2,FINISH:3,OPEN_COFFER:4},Event:{GET_JAR_SUCCESS:"in_game.Hoa_qua.getjarsuccess",OPEN_COFFER:"in_game.Hoa_qua.opencoffer",UPDATE_JAR:"in_game.Hoa_qua.updatejar",UPDATE_USER_INFO:"in_game.Hoa_qua.updateuserinfo",UPDATE_AWARD_TYPE:"in_game.Hoa_qua.updateAwardType",TURN_PREPARE:"in_game.Hoa_qua.prepare",TURN_START:"in_game.Hoa_qua.start",TURN_UPDATE:"in_game.Hoa_qua.update",TURN_FINISH:"in_game.Hoa_qua.finish"}},cc._RFpop()},{}],HoaQuaGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"e14afxB+yBDKJOfeX7RXsh6","HoaQuaGameManager");var i,a=t("Utils"),s=t("Url"),o=t("AuthUser"),r=t("CommonConstant"),c=t("BaseGameManager"),h=t("SmartFoxConstant"),u=t("NetworkManager"),l=t("HoaQuaConstant");i=a.Class({$$extends:c,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[h.Command.MESSAGE.ID],this.gameState=l.GameState.NONE,this.isFreeTurn=!1,this.eventDispatchers.anyCmd.addEventListener(h.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(h.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(h.Command.UPDATE_USER_INFO.ID,this.onUpdateUser,this),this.eventDispatchers.globalCmd.addEventListener(h.Command.UPDATE_JAR.ID,this.onUpdateGameJar,this),this.eventDispatchers.playCmd.addEventListener(l.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(l.Action.OPEN_COFFER,this.onOpenCoffer,this),this.eventDispatchers.playCmd.addEventListener(l.Action.UPDATE_AWARD_TYPE,this.onUpdateAwardType,this);var n="slot777";this.historyDataKey="data_history_"+n+"_user_"+o.username,l.GameType.type===-1&&(this.historyDataKey="data_history_"+n+"_free_user_"+o.username),this.historyList=[];var i=cc.sys.localStorage.getItem(this.historyDataKey);void 0!==i&&null!==i&&(this.historyList=JSON.parse(i))},onUpdateAwardType:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_AWARD_TYPE,t)},onUpdateUser:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_USER_INFO,t)},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_JAR,t)},onFinishGame:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.TURN_FINISH,t);var e=this.isFreeTurn?"Q.Miễn phí":a.Number.format(this.betting)+" "+(l.GameType.type===-1?r.CurrencyType.Xu.CHIP_NAME:r.CurrencyType.Ip.CHIP_NAME),n={time:a.Date.currentTime(),result:t.player.moneyExchange,betting:this.betting,totalBetting:this.betting*this.potCount,type:e};this.historyList.unshift(n),this.historyList.length>60&&this.historyList.splice(this.historyList.length-1,1),cc.sys.localStorage.setItem(this.historyDataKey,JSON.stringify(this.historyList)),this.isFreeTurn=!1},onOpenCoffer:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.OPEN_COFFER,t)},onChangeStateGame:function(t){var e=t.gameState;void 0!==e&&(this.gameState=e,e===l.GameState.ROTATE?this.eventDispatchers.local.dispatchEvent(l.Event.TURN_START,t):e===l.GameState.NONE&&this.eventDispatchers.local.dispatchEvent(l.Event.TURN_PREPARE,t))},onUpdateGame:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.TURN_UPDATE,t)},sendStartGame:function(t,e,n){this.betting=t,this.potCount=e.length,this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.ROTATE),betting:u.SmartFox.type["long"](t),pots:u.SmartFox.type.byteArray(e),currency:u.SmartFox.type.utfString(n)})},updateAwardType:function(){this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.UPDATE_AWARD_TYPE)})},openLuckyCoffer:function(t){this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.OPEN_COFFER),id:u.SmartFox.type["byte"](t)})},destroy:function(){this.$super.destroy.call(this)},getJar:function(){var t=this;u.Http.fetch("GET",s.Http.GET_JAR,{game_id:t.gameId}).success(function(e){t.eventDispatchers.local.dispatchEvent(l.Event.GET_JAR_SUCCESS,e)},{cache:900})}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",HoaQuaConstant:"HoaQuaConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Url:"Url",Utils:"Utils"}],HopQuaSlot:[function(t,e,n){"use strict";cc._RFpush(e,"f22788YJl1CboRGoyCZYetQ","HopQuaSlot"),cc.Class({"extends":cc.Component,properties:{txtTitle:cc.Label,hopQuaRow:{"default":[],type:cc.Node}},onLoad:function(){this._initOnce()},show:function(t,e){this._initOnce(),this.callbackShowFinish=e;for(var n=0;n<this.hopQuaRow.length;n+=1)for(var i=this.hopQuaRow[n],a=0;a<i.children.length;a+=1){var s=i.children[a];s.getChildByName("UnLock").active=!1,s.getChildByName("Lock").active=!0}this.node.stopAllActions(),this.node.active=!0,this.countCoffer=0,this.hidding=!1,this.maxCoffer=t,this.txtTitle.string="BẠN CÒN "+(this.maxCoffer-this.countCoffer)+" LẦN MỞ HỘP QUÀ "},setMaxCoffer:function(t){this.countCoffer=0,this.maxCoffer=t},openCoffer:function(t,e){this._initOnce();var n=this.itemList[t],i=n.getChildByName("UnLock");i.active=!0,n.getChildByName("Lock").active=!1,"none"===e.awardType?i.getComponentInChildren(cc.Label).string="Chúc bạn may mắn\nlần sau":"money"===e.awardType&&(i.getComponentInChildren(cc.Label).string=e.ratio+" x "+this.gamePlay.betting),this.countCoffer+=1,this.countCoffer>=this.maxCoffer&&this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.node.stopAllActions(),this.node.active=!1,this.callbackShowFinish&&this.callbackShowFinish()}.bind(this)))),this.txtTitle.string="BẠN CÒN "+(this.maxCoffer-this.countCoffer)+" LẦN MỞ HỘP QUÀ "},_initOnce:function(){if(void 0===this.itemList){this.countCoffer=0,this.maxCoffer=0,this.hidding=!1;var t=this;this.itemList=[];for(var e=0,n=0;n<this.hopQuaRow.length;n+=1)for(var i=this.hopQuaRow[n],a=0;a<i.children.length;a+=1)!function(e){var n=i.children[a];n.addComponent(cc.Button),n.on(cc.Node.EventType.TOUCH_END,function(){return t.countCoffer>=t.maxCoffer&&!t.hidding?(t.hidding=!0,cc.log("Da mo het hop qua"),void t.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){t.hidding=!1,t.node.stopAllActions(),t.node.active=!1,t.callbackShowFinish&&t.callbackShowFinish()})))):void t.gamePlay.gameManager.openLuckyCoffer(e)},n),t.itemList.push(n)}(e),e+=1}}}),cc._RFpop()},{}],HopquaInfor:[function(t,e,n){"use strict";cc._RFpush(e,"3b15ctrIaRGEZTJ2RI3OQWl","HopquaInfor"),cc.Class({"extends":cc.Component,properties:{hopMoSprite:cc.Sprite,efectSprite:cc.Sprite,textPhanThuong:cc.Label},onLoad:function(){},init:function(t){this.id=t},openHopQua:function(t){cc.warn(t+" value "+this.id),this.node.getComponent(cc.Sprite).enabled=!1,this.hopMoSprite.node.active=!0,this.efectSprite.node.active=!0,this.textPhanThuong.node.active=!0,this.textPhanThuong.string=t}}),cc._RFpop()},{}],HotEventTrigger:[function(t,e,n){"use strict";cc._RFpush(e,"dda3cULDWNGsqbL7GqDXEGE","HotEventTrigger");var i=t("Url"),a=t("UiManager"),s=t("NetworkManager"),o=null,r=72e5;cc.Class({"extends":cc.Component,properties:{},onLoad:function(){var t=(new Date).getTime();o+r>t||(o=t,s.Http.fetch("GET",i.Http.BANNER,{},{cache:3600}).success(function(t){t.data&&t.data.length>0&&a.openPopupHotEvent()}))}}),cc._RFpop()},{NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],HotEvent:[function(t,e,n){"use strict";cc._RFpush(e,"3ad9cx0WThJrK1bhY5zBhHj","HotEvent");var i=t("Url"),a=t("UrlImage"),s=t("Carousel"),o=t("UiManager"),r=t("NetworkManager"),c=t("PlatformImplement");cc.Class({"extends":cc.Component,properties:{bannerCarousel:s},onLoad:function(){this.fetchBannerList()},fetchBannerList:function(){var t=this;r.Http.fetch("GET",i.Http.BANNER,{},{cache:3600}).success(function(e){var n,i=e.data;t.bannerCarousel.clearAllTimes();for(var a=0;a<i.length;a+=1)n=t._initBannerNode(i[a]),t.bannerCarousel.addItem(n,!a)})},openEventItem:function(t){var e=t.bannerData.target_url;"h"===e[0]?c.openWebUrl(e):(e=JSON.parse(e),"event"===e.type?o.openPopupEvent(e.id):"webview"===e.type&&o.openWebView(e.url,e.title))},_initBannerNode:function(t){var e,n,i;return e=new cc.Node,n=e.addComponent(cc.Sprite),n.type=cc.Sprite.Type.SIMPLE,n.sizeMode=cc.Sprite.SizeMode.CUSTOM,i=e.addComponent(a),i.url=t.image_url,e.bannerData=t,e}}),cc._RFpop()},{Carousel:"Carousel",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",UiManager:"UiManager",Url:"Url",UrlImage:"UrlImage"}],InviteCode:[function(t,e,n){"use strict";cc._RFpush(e,"7a983PK0fdIv4g/K9WMJWkz","InviteCode");var i=t("Url"),a=t("AuthUser"),s=t("UiManager"),o=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{infoLabel:cc.Label,myInviteCodeLabel:cc.Label,inviteCodeEditBox:cc.EditBox},onLoad:function(){},getInviteCodeInfo:function(){var t=this;o.Http.fetch("GET",i.Http.INVITE_CODE,{username:a.username,accesstoken:a.accesstoken},{cache:1800}).success(function(e){t.infoLabel.string=e.info,t.myInviteCodeLabel.string=e.data})},confirmInviteCode:function(t){var e=this.inviteCodeEditBox.string;return e?void o.Http.fetch("POST",i.Http.INVITE_CODE,{username:a.username,accesstoken:a.accesstoken,invite_code:e}).setWaitingButton(t.target):s.openModal("Vui lòng nhập mã giới thiệu")}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],IplayHttp:[function(t,e,n){"use strict";cc._RFpush(e,"a33afOihq1I6a4Z/t7bnHbv","IplayHttp");var i,a=t("Utils");i=a.Class({setWaitingButton:function(t){return this._buttonComponent=t.getComponent(cc.Button),this._buttonComponent.interactable=!1,this},error:function(t){return t&&(this._error_callback=t),this},onError:function(t){if(this._buttonComponent&&(this._buttonComponent.interactable=!0),this._error_callback)try{this._error_callback(t)}catch(e){}},success:function(t){return t&&(this._success_callback=t),this},onSuccess:function(t){if(this._buttonComponent&&(this._buttonComponent.interactable=!0),this._success_callback)try{this._success_callback(t)}catch(e){}}}),XMLHttpRequest.prototype.sendAsBinary||(XMLHttpRequest.prototype.sendAsBinary=function(t){for(var e=t.length,n=new Uint8Array(e),i=0;i<e;i+=1)n[i]=255&t.charCodeAt(i);this.send(n)}),e.exports={init:function(t,e,n,i,a){this.host=t,this.port=e,this.protocol=n||"http",this.auth_user=i||"",this.auth_pass=a||"",this._cache={}},addInterceptor:function(t){this.interceptors||(this.interceptors=[]),this.interceptors.push(t)},_generateBoundary:function(){return"AJAX-----------------------"+(new Date).getTime()},_hasFileUpload:function(t){for(var e in t)if(a.Type.isObject(t[e]))return!0;return!1},_buildMessage:function(t,e){var n,i="\r\n",s=[];for(var o in t){n=t[o];var r="";a.Type.isObject(n)?(r+="Content-Disposition: form-data; ",r+='name="'+o+'"; ',r+='filename="'+n.fileName+'"'+i,r+="Content-Type: application/octet-stream"+i+i,r+=n.value+i):(r+="Content-Disposition: form-data; ",r+='name="'+o+'"'+i+i,r+=n+i),s.push(r)}var c="--"+e+i;return c+=s.join("--"+e+i),c+="--"+e+"--"+i},_getKeyCache:function(t,e,n){var i=t+e;return Object.keys(n).sort().forEach(function(t){i+="&"+t+"="+n[t]}),i},resetCache:function(){this._cache={}},fetch:function(t,e,n,s){function o(){"GET"===t?(h.open(t,p+"?"+a.String.param(n),!0,u.auth_user,u.auth_pass),h.send()):(h.open(t,p,!0,u.auth_user,u.auth_pass),u._hasFileUpload(n)?(r=u._generateBoundary(),h.setRequestHeader("Content-Type","multipart/form-data; boundary="+r),h.sendAsBinary(u._buildMessage(n,r))):(h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.send(a.String.param(n))))}var r,c,h,u=this,l=(new Date).getTime(),d=new i,m=this._getKeyCache(t,e,n),p=this.protocol+"://"+this.host+":"+this.port+e;if(s=s||{},s.cache>0&&m in this._cache&&this._cache[m].expire>l)return setTimeout(function(){d.onSuccess(u._cache[m].data)},s.delay||0),d;h=new XMLHttpRequest,h.timeout=12e4,h.onreadystatechange=function(){if(4===h.readyState){var t=h.getResponseHeader("content-type");try{t&&t.indexOf("application/json")>-1&&(h.responseJson=JSON.parse(h.responseText));for(c in u.interceptors)u.interceptors[c].response(h);h.status>=200&&h.status<400?h.responseJson?1===h.responseJson.status?(d.onSuccess(h.responseJson),s.cache>0&&(u._cache[m]={data:h.responseJson,expire:l+1e3*s.cache})):d.onError(h):cc.log("Iplay Http [response error]: no response"):d.onError(h)}catch(e){cc.log("Iplay Http [response error]: "+h.responseText),cc.log(e)}}};for(c in u.interceptors)u.interceptors[c].request.apply(null,arguments);return s.delay>0?setTimeout(o,s.delay):o(),d}},cc._RFpop()},{Utils:"Utils"}],ItemDaiLy:[function(t,e,n){"use strict";cc._RFpush(e,"346f4PTE9hD67eitWOwOoUj","ItemDaiLy");var i=t("PlatformImplement");cc.Class({"extends":cc.Component,properties:{facebookNode:cc.Node},chuyenPi:function(){},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.chuyenPi)},updateData:function(t){t.fb_url?this.facebookNode.on(cc.Node.EventType.TOUCH_END,function(){i.openWebUrl(t.fb_url)}):this.facebookNode.removeFromParent()}}),cc._RFpop()},{PlatformImplement:"PlatformImplement"}],ItemEvent:[function(t,e,n){"use strict";cc._RFpush(e,"12b9aLUaapMpauW0iloXyIP","ItemEvent");var i=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{titleLabel:cc.Label,contentLabel:cc.Label,timeLabel:cc.Label,eventTypeNode:cc.Node,fromToLabel:cc.Label},onLoad:function(){},closeDetailMessage:function(){},updateData:function(t){this.item=t,this.titleLabel.string=i.CurrencyType.normalize(t.subject),this.eventTypeNode.active="NEW"===t.event_type,this.contentLabel&&(this.contentLabel.string=i.CurrencyType.normalize(t.content)),this.timeLabel&&(this.timeLabel.string=t.created_time.replace(" ","\n")),this.fromToLabel&&(this.fromToLabel.string="Từ ngày "+t.from_time+" đến ngày "+t.to_time)}}),cc._RFpop()},{CommonConstant:"CommonConstant"}],ItemHaiTac:[function(t,e,n){"use strict";cc._RFpush(e,"e63c2/WmTpKoK1r3HqJ8NJs","ItemHaiTac"),cc.Class({"extends":cc.Component,properties:{hotGirlSpriteFrameList:{type:cc.SpriteFrame,"default":[]},hoaHauSpriteFrameList:{type:cc.SpriteFrame,"default":[]},rauSachSpriteFrameList:{type:cc.SpriteFrame,"default":[]}},onLoad:function(){},setType:function(t,e){switch(this.type=t,this.id=e,t){case-1:case 0:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.rauSachSpriteFrameList[e];break;case 1:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.hotGirlSpriteFrameList[e];break;case 2:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.hoaHauSpriteFrameList[e]}}}),cc._RFpop()},{}],ItemHoaQua:[function(t,e,n){"use strict";cc._RFpush(e,"a5ac4E4VHxKg4YGZKtLqyfy","ItemHoaQua"),cc.Class({"extends":cc.Component,properties:{hotGirlSpriteFrameList:{type:cc.SpriteFrame,"default":[]},hoaHauSpriteFrameList:{type:cc.SpriteFrame,"default":[]},rauSachSpriteFrameList:{type:cc.SpriteFrame,"default":[]}},onLoad:function(){},setType:function(t,e){switch(this.type=t,this.id=e,t){case-1:case 0:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.rauSachSpriteFrameList[e];break;case 1:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.hotGirlSpriteFrameList[e];break;case 2:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.hoaHauSpriteFrameList[e]}}}),cc._RFpop()},{}],ItemInapp:[function(t,e,n){"use strict";cc._RFpush(e,"afbd3WWyHpPGpNxhEZ6hNyG","ItemInapp"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){}}),cc._RFpop()},{}],ItemMessage:[function(t,e,n){"use strict";cc._RFpush(e,"a141bY2Gc1B7Lr8SnmNklgL","ItemMessage");var i=t("MessageBoxCache"),a=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{timeLabel:cc.Label,indexLabel:cc.Label,titleLabel:cc.Label,userLabel:cc.Label,contentLabel:cc.Label,deleteButton:cc.Button},onLoad:function(){},deleteMessage:function(){},replyToUser:function(){},closeDetailMessage:function(){},updateData:function(t,e){var n=e.indexOf("ongoing")>0?"from":"to";this.keyStorage=e,this.messageId=t.msgid,this.titleLabel.string=t.subject,this.userLabel.string=t[n],this.deleteButton&&(this.deleteButton.node.active="to"!==n),this.contentLabel?(this.timeLabel.string=t.created_time,t.body?this.contentLabel.string=a.CurrencyType.normalize(t.body):this.contentLabel.string=""):this.timeLabel.string=t.created_time.replace(" ","\n"),this.indexLabel.string=i.getIndexMessage(e,t.msgid)+1}}),cc._RFpop()},{CommonConstant:"CommonConstant",MessageBoxCache:"MessageBoxCache"}],ItemMyNhan:[function(t,e,n){"use strict";cc._RFpush(e,"4dffaue621BTYYg//VoMVcd","ItemMyNhan"),cc.Class({"extends":cc.Component,properties:{hotGirlSpriteFrameList:{type:cc.SpriteFrame,"default":[]},hoaHauSpriteFrameList:{type:cc.SpriteFrame,"default":[]},rauSachSpriteFrameList:{type:cc.SpriteFrame,"default":[]}},onLoad:function(){},setType:function(t,e){switch(this.type=t,this.id=e,t){case-1:case 0:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.rauSachSpriteFrameList[e];break;case 1:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.hotGirlSpriteFrameList[e];break;case 2:this.node.getComponentInChildren(cc.Sprite).spriteFrame=this.hoaHauSpriteFrameList[e]}}}),cc._RFpop()},{}],ItemTextMiniPoker:[function(t,e,n){"use strict";cc._RFpush(e,"329b0k8IfNPQZSTrH7BsBCH","ItemTextMiniPoker"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){this.node.position=cc.v2(0,0)},setColor:function(t){this.node.color=t},setText:function(t){this.node.getComponent(cc.Label).string=t}}),cc._RFpop()},{}],ItemThe:[function(t,e,n){"use strict";cc._RFpush(e,"7c7efwrEXxPLot50PPbXaWS","ItemThe");var i=t("UrlImage");cc.Class({"extends":cc.Component,properties:{tcaoImage:i},onLoad:function(){},updateData:function(t){this.tcaoImage.loadImage(t.img)}}),cc._RFpop()},{UrlImage:"UrlImage"}],ItemTinNhan:[function(t,e,n){"use strict";cc._RFpush(e,"af09fMhNNNLma5inLf2tsLP","ItemTinNhan");var i=t("PlatformImplement"),a=t("CommonConstant"),s=t("AuthUser"),o=t("Utils");cc.Class({"extends":cc.Component,properties:{vndLabel:cc.Label,ipLabel:cc.Label,sampleLabel:cc.Label},onLoad:function(){},onItemClick:function(){if(this.data){var t=this.data.template.replace("{0}",s.username||"ten_dang_nhap");i.guiTinNhan(this.data.code,t)}},updateData:function(t){this.data=t,this.vndLabel.string=o.Number.format(t.fee)+" VND",this.ipLabel.string=o.Number.format(t.gold_value)+" "+a.CurrencyType.Ip.DISPLAY_NAME,this.sampleLabel.string=t.sms_sample}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",PlatformImplement:"PlatformImplement",Utils:"Utils"}],ItemTopUser:[function(t,e,n){"use strict";cc._RFpush(e,"4ce22fTrLhKOIhg1Jvz/iF/","ItemTopUser");var i=t("UrlImage"),a=t("Utils");cc.Class({"extends":cc.Component,properties:{avatarImage:i,numberLabel:cc.Label,usernameRichText:cc.RichText,scoreLabel:cc.Label},onLoad:function(){},updateData:function(t,e){var n=e.username.split("(");this.numberLabel.string=t,this.avatarImage.loadImage(e.avatar),this.usernameRichText.string="<color=#FFD600>"+n[0].trim()+"</color>",n.length>1&&(n[0].length<26?this.usernameRichText.string+="\n":this.usernameRichText.string+=" ",this.usernameRichText.string+="<size=24>"+n[1].trim().replace(")","")+"</size>"),this.scoreLabel.string=a.Number.format(e.experience||e.score)}}),cc._RFpop()},{UrlImage:"UrlImage",Utils:"Utils"}],ItemTopWinGame:[function(t,e,n){"use strict";cc._RFpush(e,"1afe6CV4dZC3rkHaWQgnHH/","ItemTopWinGame");var i=t("UrlImage"),a=t("Utils");cc.Class({"extends":cc.Component,properties:{avatarImage:i,usernameLabel:cc.Label,scoreLabel:cc.Label},onLoad:function(){},updateData:function(t){var e=t.username.match(/^([^\(]+)\s*(?:\((.*)\)\s*)?$/),n=(e[1]||"").trim(),i=13,s="...";n.length>i&&(n=n.substr(0,i-s.length)+s),this.avatarImage.loadImage(t.avatar),this.shortName=n,this.longName=t.username,this.shortScore=a.Number.abbreviate(t.score),this.longScore=a.Number.format(t.score),this.scoreLabelFontSize=this.scoreLabel.fontSize,this.useShortInfo()},useShortInfo:function(){this.usernameLabel.string=this.shortName,this.scoreLabel.fontSize=.9*this.scoreLabelFontSize,this.scoreLabel.string=this.shortScore},useLongInfo:function(){this.usernameLabel.string=this.longName,this.scoreLabel.fontSize=this.scoreLabelFontSize,this.scoreLabel.string=this.longScore}}),cc._RFpop()},{UrlImage:"UrlImage",Utils:"Utils"}],ItemVatPham:[function(t,e,n){"use strict";cc._RFpush(e,"98941TB8lZOGYuU9Ehcc+WY","ItemVatPham");var i=t("CommonConstant"),a=t("UrlImage"),s=t("Utils");cc.Class({"extends":cc.Component,properties:{imgVatPham:a,nameLabel:cc.Label,moneyLabel:cc.Label},onLoad:function(){},updateData:function(t){this.nameLabel.string=t.name,this.moneyLabel.string=s.Number.format(t.amount)+" "+i.CurrencyType.findByName(t.currency).DISPLAY_NAME,this.imgVatPham&&this.imgVatPham.loadImage(t.url)}}),cc._RFpop()},{CommonConstant:"CommonConstant",UrlImage:"UrlImage",Utils:"Utils"}],JarInfo:[function(t,e,n){"use strict";cc._RFpush(e,"32c1a3JGXBP8pBv3E3UKpQn","JarInfo");var i={data:{},active:!1,eventName:"UPDATE_GAME_JAR_ID"};e.exports=i,cc._RFpop()},{}],JarItem:[function(t,e,n){"use strict";cc._RFpush(e,"adab3TTeElOTr8b2GnCqwyh","JarItem");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{lblBet:cc.Label,lblMoney:cc.Label},onLoad:function(){},_initEffect:function(){this.defaultMoney=1e6,this._countDownIntervalId&&(clearInterval(this._countDownIntervalId),this._countDownIntervalId=null),this.money<this.defaultMoney?this.currMoney=70*this.money/100:this.currMoney=this.money-this.defaultMoney/10,this.otherMoney=(this.money-this.currMoney)/5,this.lblMoney.string=i.Number.format(Math.floor(this.currMoney)),this._effectUpdateMoney()},_effectUpdateMoney:function(){var t=50,e=1e4,n=3e3,a=5e3,s=Math.floor(Math.random()*(a-n))+n,o=500,r=1500,c=Math.floor(Math.random()*(r-o))+o;this.money>this.defaultMoney/10&&(e=2e3),this._stopTimestamp=Date.now()+s,this._countDownIntervalId=setInterval(function(){var t=this._stopTimestamp-Date.now();if(t>=c){var n=Math.random(),a=(n<.5?-n:n)*Math.ceil(this.otherMoney/e);this.currMoney+=a,i.Type.isNumber(this.currMoney)&&null!==this.lblMoney&&(this.lblMoney.string=i.Number.format(Math.floor(this.currMoney)))}else t<=0&&this.clearEffectUpdateMoneyQuy()}.bind(this),t)},clearEffectUpdateMoneyQuy:function(){this._countDownIntervalId&&(clearInterval(this._countDownIntervalId),this._countDownIntervalId=null,this._effectUpdateMoney())},onDestroy:function(){this.clearEffectUpdateMoneyQuy()}}),cc._RFpop()},{Utils:"Utils"}],JarQuickIcon:[function(t,e,n){"use strict";cc._RFpush(e,"8eeb6Bzg+VOwb4NW/yO1xnc","JarQuickIcon");var i=t("CommonConstant"),a=t("NetworkManager"),s=t("Utils"),o=t("GameConstant"),r=t("Url"),c=t("JarInfo"),h=t("EventDispatcher");cc.Class({"extends":cc.Component,properties:{huIcon:cc.Node,content:cc.Node,huListBackground:cc.Node,imgDen1:cc.Node,imgDen2:cc.Node,jarItemPrefab:cc.Prefab,gameJarItem:cc.Prefab},start:function(){cc.sys.isBrowser&&(this.node.zIndex=i.ZINDEX.MINIGAME_QUICK_ICON)},onLoad:function(){var t=this;this.isLoaded=!1,this.isMove=!1,this.huIcon.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.fadeTo(.5,0),cc.scaleTo(.5,1.05)),cc.spawn(cc.fadeTo(1,150),cc.scaleTo(1,1.15))))),this.huIcon.parent.runAction(cc.repeatForever(cc.sequence(cc.skewTo(.1,8,-8),cc.skewTo(.1,-8,8),cc.skewTo(.1,15,-15),cc.skewTo(.1,-15,15),cc.skewTo(.1,0,0),cc.delayTime(.5)))),this.node.on(cc.Node.EventType.TOUCH_START,function(){t.time=Date.now()}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(){t.time-Date.now()<-100&&(t.isMove=!0)}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.onClick()}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.onClick()}),this.getGameJarInfo(),this.initCountDownTimeRequest(),this.effectLight(),this.showContent(),h.addEventListener(c.eventName,this.setJar,this)},initCountDownTimeRequest:function(){var t=9e5;this._countDownTimeRequest=setInterval(function(){this.getGameJarInfo(),this.clearCountDownTimeRequest()}.bind(this),t)},clearCountDownTimeRequest:function(){clearInterval(this._countDownTimeRequest),this._countDownTimeRequest=null,this.initCountDownTimeRequest()},setJar:function(t){t.gameid=0},getGameJarInfo:function(){this._countDownTimeRequest&&(clearInterval(this._countDownTimeRequest),
this._countDownTimeRequest=null);var t=this;a.Http.fetch("GET",r.Http.GET_GAME_JAR_INFO,{},{cache:900,delay:500}).success(function(e){if(e){if(!t.isValid)return;t.content.removeAllChildren();for(var n=0;n<e.data.length;n+=1){var i=e.data[n];c.data[i.gameid]=i;var a=cc.instantiate(t.gameJarItem),r=a.getComponent("GameJarItem");r.lblGameName.string=i.name,r.logo.spriteFrame=o.getIconSpriteFrame(o.findById(i.gameid).ICON);for(var h in i.jars){var u=i.jars[h],l=cc.instantiate(t.jarItemPrefab),d=l.getComponent("JarItem");d.money=u,d.lblBet.string=isNaN(h)?h:s.Number.abbreviate(h),d._initEffect(),r.listJar.addChild(l)}a.enabled=!0,t.content.addChild(a)}}})},onClick:function(){this.isMove===!1&&(c.active=!c.active,this.showContent()),this.isMove=!1},showContent:function(){this.huListBackground.active=c.active,this.huListBackground.active?this.isLoaded?(this.huListBackground.scaleY=0,this.huListBackground.runAction(cc.scaleTo(.2,1,1))):this.isLoaded=!0:(this.huListBackground.scaleY=1,this.huListBackground.runAction(cc.scaleTo(.2,1,0)))},onDestroy:function(){this.node.destroy(),this._countDownTimeRequest&&(clearInterval(this._countDownTimeRequest),this._countDownTimeRequest=null),h.removeEventListener(c.eventName,this.setJar,this)},effectLight:function(){this.imgDen1.opacity=255,this.imgDen2.opacity=0,this.imgDen1.stopAllActions(),this.imgDen2.stopAllActions();var t=cc.repeatForever(cc.sequence(cc.fadeIn(0),cc.delayTime(.2),cc.fadeOut(0),cc.delayTime(.2))),e=cc.repeatForever(cc.sequence(cc.fadeOut(0),cc.delayTime(.2),cc.fadeIn(0),cc.delayTime(.2)));this.imgDen1.runAction(e),this.imgDen2.runAction(t)}}),cc._RFpop()},{CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",GameConstant:"GameConstant",JarInfo:"JarInfo",NetworkManager:"NetworkManager",Url:"Url",Utils:"Utils"}],KimQuay:[function(t,e,n){"use strict";cc._RFpush(e,"ac66aTqHCdFvJSyZXdAnnoN","KimQuay");var i=t("VongQuay");cc.Class({"extends":cc.Component,properties:{vongQuay:i},onLoad:function(){},onEnable:function(){cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDebugDraw=!0},onDisable:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},onCollisionEnter:function(){if(this.vongQuay){var t=this.vongQuay.rotateDelta;t<1&&(t=1);var e=.5/t;this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.rotateTo(e,-20),cc.rotateTo(.07,0)))}}}),cc._RFpop()},{VongQuay:"VongQuay"}],LichSuDoi:[function(t,e,n){"use strict";cc._RFpush(e,"092a9gx3AdO7q2YDLwq9Zee","LichSuDoi");var i=t("Url"),a=t("AuthUser"),s=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{itemLichSuPrefab:cc.Prefab,lichSuTheContainerNode:cc.Node},onLoad:function(){},getLichSuThe:function(){var t=this;s.Http.fetch("GET",i.Http.DOI_THUONG_CARDS_HISTORY,{username:a.username,accesstoken:a.accesstoken}).success(function(e){var n,i,a,s,o,r,c=e.data;for(t.lichSuTheContainerNode.removeAllChildren(),i=0;i<c.length;i+=1)n=cc.instantiate(t.itemLichSuPrefab),a=c[i].created_time.replace(" ","\n"),s=c[i].card_serial,o=c[i].card_pin,r=c[i].card_type+"\n"+c[i].card_amount,n.getComponent("RowTable").updateData(a,s,o,r),t.lichSuTheContainerNode.addChild(n)})}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",Url:"Url"}],LiengConstant:[function(t,e,n){"use strict";cc._RFpush(e,"2018ctzpttCzb5OSQGOdlog","LiengConstant");var i=t("Utils");e.exports={GameType:{FIVE_CARDS:{ID:0,NUMBER_OF_CARDS:5},SEVEN_CARDS:{ID:1,NUMBER_OF_CARDS:7},findById:function(t){return i.Object.findObject(this,"ID",t)}},Action:{BET:1,RAISE:2,ALL_IN:3,ALL_HAND:31,CALL:4,CHECK:5,FOLD:6,CHANGE_STATE:7,CHANGE_TURN:8,BUY_PRIVATE_MONEY:9,BUY_PRIVATE_MONEY_REQUIRED:10,END_TURN:11,BET_1_2:12,CUT_OFF_MONEY_POKER:12,BET_1_4:13,BET_X2:14,CHOOSE_PUBLIC_CARD:15},GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_FOR_NEW_GAME:2,DEALING:3,FINALIZING:6,FINISH:7,ROUND:8},GameStatePoker:{PREFLOP:8,FLOP:9,TURN:10,RIVER:11},PlayerState:{NONE:0,IN_TURN:1,WAITING_FOR_TURN:2,FOLDED:3,ALL_IN:4,OFF_MONEY:5},Event:{START_TIME:"in_game.xito.start_time",USER_BET:"in_game.xito.user_bet",CHANGE_STATE:"in_game.xito.change_state",CHANGE_TURN:"in_game.xito.change_turn",UPDATE_MONEY:"in_game.xito.update_money",SHOW_CARD_OPEN:"in_game.xito.show_card_open",DRAW_CARD:"in_game.xito.draw_card",FINISH_GAME:"in_game.xito.finish_game",UPDATE_GAME:"in_game.xito.update_game",REFRESH_GAME:"in_game.xito.refresh_game",SHOW_BUY_CHIP:"in_game.poker.show_buy_chip",HIDE_BUY_CHIP_BUTTON:"in_game.poker.hide_buy_chip_button"},TimeoutId:{SHOW_COMMUNITY_CARDS:"TIMEOUT_SHOW_COMMUNITY_CARDS"},Effect:{TO:0,THEO:1,NHUONG_TO:2,UP_BO:3,CHOI_TAT_TAY:4,TO_12:5,TO_14:6,TO_X2:7,TO_TAT_CA:8,DANG_DOI:9}},cc._RFpop()},{Utils:"Utils"}],LiengGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"d14fdGdG+FNhaKwWJXL0V0f","LiengGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("LiengConstant"),r=t("NetworkManager"),c=t("Utils");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this._setGameState(o.GameState.NONE),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.WAITING_DEAL_CARD.ID,this.onWaittingDealCard,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.NEW_MATCH.ID,this.restartGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BET,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.ALL_IN,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CALL,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHECK,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.FOLD,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.RAISE,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_TURN,this.onChangeTurn,this)},bet:function(t,e){e?this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](t),money:r.SmartFox.type["long"](e)}):this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](t)})},onUpdateGame:function(t){this.currency=t.data.currency,this.roomBetting=t.data.betting,this._setGameState(t.data.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_GAME,t),this.onUpdateHand()},onUpdateHand:function(){this.eventDispatchers.local.dispatchEvent(o.Event.DRAW_CARD)},onPlayerBetting:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.USER_BET,t)},onWaittingDealCard:function(t){this._setGameState(t.allData.gameState);var e=0;t.__execInfo__&&(e=t.__execInfo__.dt),this.eventDispatchers.local.dispatchEvent(o.Event.START_TIME,t.data.time-e)},onChangeStateGame:function(t){this.currentRound=t.allData.currentRound,this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_STATE,t),this.onUpdateHand()},onChangeTurn:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_TURN,t)},onFinishGame:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.FINISH_GAME,t)},restartGame:function(){this.eventDispatchers.local.dispatchEvent(o.Event.REFRESH_GAME)},_setGameState:function(t){this.gameState!==t&&(this.gameState=t)}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",LiengConstant:"LiengConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],LineCuaAn:[function(t,e,n){"use strict";cc._RFpush(e,"55cf2xD9pRI+4Mj45cOxJJG","LineCuaAn"),cc.Class({"extends":cc.Component,properties:{lineList:{"default":[],type:cc.Node}},onLoad:function(){for(var t=0;t<this.lineList.length;t+=1)this.disableLine(t)},activeLine:function(t,e){var n=this.lineList[t].getChildByName("Active");n.active=!0,n.stopAllActions(),n.opacity=255,n.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.1,190),cc.fadeTo(.1,255)))),n.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){n.stopAllActions(),n.active=!1,void 0!==e&&e()})))},disableLine:function(t){var e=this.lineList[t].getChildByName("Active");e.stopAllActions(),e.active=!1},resetAllLine:function(){for(var t=0;t<this.lineList.length;t+=1)this.disableLine(t)}}),cc._RFpop()},{}],Loading:[function(t,e,n){"use strict";cc._RFpush(e,"0f573VTnJtKYp3ulE7H0BI/","Loading");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},onEnable:function(){this.stopPropagationOnNode=i.Node.stopPropagation(this.node)},onDisable:function(){this.stopPropagationOnNode&&(this.stopPropagationOnNode(),this.stopPropagationOnNode=null)}}),cc._RFpop()},{Utils:"Utils"}],LobbySlotInGame:[function(t,e,n){"use strict";cc._RFpush(e,"b5885u2oGJP7qk2MJKPCtfK","LobbySlotInGame");var i=t("GameManager"),a=t("Utils"),s=t("TopPanelSlot"),o=t("AuthUser"),r=t("HoaQuaConstant"),c=t("MyNhanConstant"),h=t("HaiTacConstant"),u=t("EventDispatcherConstant"),h=t("HaiTacConstant"),l=t("CommonConstant"),d=t("Slot777Constant"),m=t("EventDispatcher"),p=t("GameItemSlotInGame");cc.Class({"extends":cc.Component,properties:{gameItemList:{"default":[],type:p},txtMoney:cc.Label,topPanel:s},onLoad:function(){this.txtMoney.string=a.Number.format(o.currencies[l.CurrencyType.Ip.NAME].balance),this.topPanel.getButtonHistory().active=!1;var t=i.getLobbyGameRuntimeConfigs();t&&(t.isSuspending=!1,this.game=t.game,this.room=t.room,this.topPanel.room=this.room,this.topPanel.setGamePlay(this.game),d.GameJoining=!1,i.getBettingValues(this.game.gameId,function(t){if(this.isValid){var e,n,i,a=t.bettingValues;if(a){for(i=0;i<a.length;i+=1)a[i].currency===l.CurrencyType.Ip.NAME?e=a[i].bettingValues:a[i].currency===l.CurrencyType.Xu.NAME&&(n=a[i].bettingValues);for(c.BettingList=[],c.BettingFreeList=[],r.BettingList=[],r.BettingFreeList=[],h.BettingList=[],h.BettingFreeList=[],i=0;i<this.gameItemList.length;i+=1){var s=this.gameItemList[i],o=e[i];s.setData(this.game,o,i)}for(i=0;i<n.length;i+=1)c.BettingFreeList.push(n[i].value),r.BettingFreeList.push(n[i].value),h.BettingFreeList.push(n[i].value)}}}.bind(this)),m.addEventListener(u.PROFILE.UPDATE_MONEY,this.updateUserMoney,this))},updateUserMoney:function(t){var e=t.money;this.txtMoney&&e&&t.currency===l.CurrencyType.Ip.NAME&&(this.txtMoney.string=a.Number.format(e))}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameItemSlotInGame:"GameItemSlotInGame",GameManager:"GameManager",HaiTacConstant:"HaiTacConstant",HoaQuaConstant:"HoaQuaConstant",MyNhanConstant:"MyNhanConstant",Slot777Constant:"Slot777Constant",TopPanelSlot:"TopPanelSlot",Utils:"Utils"}],LobbySlot:[function(t,e,n){"use strict";cc._RFpush(e,"4d78fRJ2ZFC0pjYIFYnmgal","LobbySlot");var i=t("GameItem");cc.Class({"extends":cc.Component,properties:{txtMoneyMyNhanList:{"default":[],type:cc.Label},txtMoneyHoaQuaList:{"default":[],type:cc.Label},txtMoneyHaiTacList:{"default":[],type:cc.Label},gameItemList:{"default":[],type:i}},onLoad:function(){},onMyNhanClick:function(){},onHaiTacClick:function(){},onHoaQuaClick:function(){},onBackClick:function(){}}),cc._RFpop()},{GameItem:"GameItem"}],Lobby:[function(t,e,n){"use strict";cc._RFpush(e,"eb089qYTdRLk5d/MXZymigt","Lobby");var i=t("GameManager"),a=t("NetworkManager"),s=t("CommonConstant"),o=t("BaseGameOptionModal"),r=t("AudioManager"),c=t("UiManager"),h=t("EventDispatcher"),u=t("GameManagerConstant"),l=t("TopPanelOutGameWrapper"),d=t("PlatformImplement"),m=t("Url"),p=t("Utils"),g="TopWinGamePanel",f="TopWinGamePanelReversed";cc.Class({"extends":l,properties:{gameNameLabel:cc.Label,ipRoomTypeNode:cc.Node,xuRoomTypeNode:cc.Node,bettingSectionNode:cc.Node,bettingItemContainer:cc.Node,bettingItemListScrollView:cc.ScrollView,ipBettingItemTemplateNode:cc.Node,xuBettingItemTemplateNode:cc.Node,fakeBettingSectionNode:cc.Node,fakeCenterInBettingSectionNode:cc.Node,joinRoomLoadingSection:cc.Node,getBettingsLoadingSection:cc.Node,rightPanelNode:cc.Node,topWinGameContainerNode:cc.Node,topWinGameScrollView:cc.ScrollView,itemTopWinGamePrefab:cc.Prefab,chatLogScrollView:cc.ScrollView,chatLogLabel:cc.RichText,chatEditBox:cc.EditBox,inactiveBettingOpacity:100},onLoad:function(){l.prototype.onLoad.call(this);var t=i.getLobbyGameRuntimeConfigs(),e=this;t&&(t.isSuspending=!1,this.game=t.game,this.room=t.room,this.bettingSectionNodePosition=this.bettingSectionNode.position,this.gameNameLabel.string=this.game&&this.game.name||"",this.chatLogLabel.string="",this.activeCurrency=null,this.bettingValuesByCurrencyMap=null,this.bettingItemContainer.removeAllChildren(),i.getBettingValues(this.game.gameId,function(t){if(this.isValid){var e,n,i=t&&t.bettingValues;if(i){for(this.bettingValuesByCurrencyMap={},n=0;n<i.length;n+=1)e=i[n],e&&(this.bettingValuesByCurrencyMap[e.currency]=e.bettingValues);this.getBettingsLoadingSection.active=!1,this.showPiBettings()}}}.bind(this)),this.getTopWinGame(),this.onPublicMessageBinding=this.onPublicMessage.bind(this),a.SmartFox.onPublicMessage(this.onPublicMessageBinding),this.clickedBettingBtn=null,this.cloneClickedBettingBtn=null,this.topWinGameAnimationData={name:f,isPlaying:!1,timeoutId:null,duration:this.node.getComponent(cc.Animation).getClips()[1].duration,touchMove:!1},this.topWinGameScrollView.node.on(cc.Node.EventType.TOUCH_MOVE,function(){e.topWinGameAnimationData.touchMove=!0}),[this.topWinGameScrollView.content.parent,this.rightPanelNode].forEach(function(t){t.on(cc.Node.EventType.MOUSE_ENTER,function(){d.setCursorToHand()}),t.on(cc.Node.EventType.MOUSE_LEAVE,function(){d.setCursorToNormal()})}),h.addEventListener(u.Event.JOIN_GAME,this.onFinishJoinGame,this),cc.game.on(cc.game.EVENT_SHOW,this.$onFocus,this),cc.game.on(cc.game.EVENT_HIDE,this.$onLostFocus,this))},onDestroy:function(){this.clickedBettingBtn&&this.clickedBettingBtn.stopAllActions(),this.cloneClickedBettingBtn&&this.cloneClickedBettingBtn.stopAllActions(),this.bettingSectionNode&&this.bettingSectionNode.stopAllActions(),this.topWinGameAnimationData.timeoutId&&(clearTimeout(this.topWinGameAnimationData.timeoutId),this.topWinGameAnimationData.timeoutId=null),a.SmartFox.offPublicMessage(this.onPublicMessageBinding),h.removeEventListener(u.Event.JOIN_GAME,this.onFinishJoinGame,this),cc.game.off(cc.game.EVENT_SHOW,this.$onFocus,this),cc.game.off(cc.game.EVENT_HIDE,this.$onLostFocus,this)},$onFocus:function(){a.SmartFox.onPublicMessage(this.onPublicMessageBinding)},$onLostFocus:function(){a.SmartFox.offPublicMessage(this.onPublicMessageBinding)},_showBettingsByCurrency:function(t){if(r.instance.playButtonClick(),this.activeCurrency!==t){var e,n,h,u,l=this;if(t===s.CurrencyType.Xu.NAME?(e=this.xuBettingItemTemplateNode,n=this.xuRoomTypeNode,h=this.ipRoomTypeNode):(e=this.ipBettingItemTemplateNode,n=this.ipRoomTypeNode,h=this.xuRoomTypeNode),n&&(u=n.getComponent(cc.Animation),u&&u.play()),h){u=h.getComponent(cc.Animation),u&&u.stop();var d=h.getComponentInChildren(cc.Label);d&&d.node.runAction(cc.scaleTo(.1,1)),h.getComponentsInChildren(cc.Sprite).forEach(function(t){t.node!==h&&(t.node.active=!1)})}this.activeCurrency=t,this._runAnimationHideBettingSection(function(){var n=l.bettingItemContainer.getChildren().length>0;if(l.bettingItemContainer.removeAllChildren(),l.bettingValuesByCurrencyMap){var s,h,u,d=l.bettingValuesByCurrencyMap[t];if(d){for(u=0;u<d.length;u+=1)h=d[u],function(t){s=cc.instantiate(e),s.active=!0,s.getComponentInChildren(cc.Label).string=p.Number.abbreviate(t.value),t.isActive?s.on(cc.Node.EventType.TOUCH_END,function(){var e=this;r.instance.playButtonClick(),l.game&&l.hideTopWinGamePanel(function(){var n=l.game.CONFIG.GAME_OPTION_MODAL_PREFAB,s=l.game.gameId,r={currency:a.SmartFox.type.utfString(l.activeCurrency),isSolo:a.SmartFox.type.bool(l.game.isSolo),betting:a.SmartFox.type["long"](t.value)};n?c.openModalByName(n,function(t){t.getComponent(o).init(s,r,function(t,n){l._runLoadingAnimation(l,e,n)})}):l._runLoadingAnimation(l,e,function(){i.enterGame(s,r)})})},s):(s.opacity=l.inactiveBettingOpacity,s.getComponent(cc.Button).interactable=!1),l.bettingItemContainer.addChild(s)}(h);l.bettingItemListScrollView.scrollToTop(),l._runAnimationShowBettingSection(n)}}})}},_runLoadingAnimation:function(t,e,n){this._stopLoadingAnimation();var a=cc.instantiate(e),s=t.fakeBettingSectionNode.convertToNodeSpaceAR(t.fakeCenterInBettingSectionNode.convertToWorldSpace(cc.v2(0,0))),o=t.fakeBettingSectionNode.convertToNodeSpaceAR(e.convertToWorldSpace(cc.v2(0,0))),r=cc.v2(o.x+a.width/2,o.y+a.height/2),c=!1,h=cc.sequence(cc.callFunc(function(){t.bettingSectionNode.active=!1,t.joinRoomLoadingSection.active=!0,a.scale=1,a.parent=t.fakeBettingSectionNode,a.position=r}),cc.moveTo(.2,s),cc.delayTime(1),cc.callFunc(function(){var e=function(){u.__isStopped||a.runAction(u)};p.Director.preloadScene(t.game.CONFIG.SCENE,function(){c=!0,e()},e)})),u=cc.sequence(cc.callFunc(function(){c&&p.Type.isFunction(n)&&n()}),cc.delayTime(i.JOIN_GAME_TIMEOUT/1e3),cc.callFunc(function(){t.bettingSectionNode.active=!0,t.joinRoomLoadingSection.active=!1,a&&a.destroy(),e.runAction(cc.sequence(cc.fadeOut(.3),cc.fadeIn(.5)))}));a.targetOff(a),a.getComponent("ButtonScaler").destroy(),a.runAction(h),this.clickedBettingBtn=e,this.cloneClickedBettingBtn=a,this.subAnimation=u},_stopLoadingAnimation:function(){this.bettingSectionNode.active=!0,this.joinRoomLoadingSection.active=!1,this.cloneClickedBettingBtn&&(this.cloneClickedBettingBtn.stopAllActions(),this.cloneClickedBettingBtn.destroy(),this.cloneClickedBettingBtn=null),this.clickedBettingBtn&&(this.clickedBettingBtn.runAction(cc.sequence(cc.fadeOut(.3),cc.fadeIn(.5))),this.clickedBettingBtn=null),this.subAnimation&&(this.subAnimation.__isStopped=!0,this.subAnimation=null)},onFinishJoinGame:function(t){t&&t.gameId===this.game.gameId&&!t.isJoining&&this._stopLoadingAnimation()},_runAnimationShowBettingSection:function(t){var e=this,n=e.bettingSectionNode.getChildren(),i=n&&n[0],a=cc.spawn([cc.fadeOut(0)]),s=cc.sequence(cc.fadeIn(.2));e.bettingSectionNode.stopAllActions(),t?e.bettingSectionNode.runAction(cc.sequence(a,s)):(i&&(i.active=!1),e.bettingSectionNode.runAction(cc.sequence(a,cc.callFunc(function(){i&&(i.active=!0)}),s)))},_runAnimationHideBettingSection:function(t){var e=cc.callFunc(function(){p.Type.isFunction(t)&&t()});this.bettingSectionNode.stopAllActions(),this.bettingItemContainer.getChildren().length>0?this.bettingSectionNode.runAction(cc.sequence(cc.spawn([cc.fadeOut(.1)]),e)):this.bettingSectionNode.runAction(cc.sequence(e))},showXuBettings:function(){this._showBettingsByCurrency(s.CurrencyType.Xu.NAME)},showPiBettings:function(){this._showBettingsByCurrency(s.CurrencyType.Ip.NAME)},backToHall:function(){a.SmartFox.leaveRoom(this.room.id),p.Director.loadScene(s.Scene.HALL)},getTopWinGame:function(){var t=this;a.Http.fetch("GET",m.Http.TOP_WIN_GAME,{game_id:t.game.gameId},{cache:1740,delay:800}).success(function(e){if(t.isValid){var n,i,a,s,o=e.data;for(t.topWinGameContainerNode.removeAllChildren(),s=0;s<o.length;s+=1)n=cc.instantiate(t.itemTopWinGamePrefab),i=n.getComponent("ItemTopWinGame"),i.updateData(o[s]),a=n.getComponent(cc.Sprite),a.enabled=s%2===0,t.topWinGameContainerNode.addChild(n);t.topWinGameScrollView.scrollToTop()}})},onPublicMessage:function(t){var e,n=t&&t.room&&t.room.id,i=t&&t.sender&&t.sender.name;this.room.id===n&&i&&(e=t.message,this._addHistoryItem(i,e))},_addHistoryItem:function(t,e){var n=this.chatLogLabel.string?"\n":"",i="<color=#02bbff>"+t+"</color>",a=n+i+": "+e;this.chatLogLabel.string+=a,this.chatLogLabel.node.height<this.chatLogScrollView.node.height-12?this.chatLogScrollView.scrollToTop():this.chatLogScrollView.scrollToBottom()},sendChatMessage:function(){var t=this.chatEditBox.string;this.chatEditBox.string="",a.SmartFox.sendPublicMessageRequest(t,this.room.id)},toggleTopWinGamePanel:function(){this.topWinGameAnimationData.touchMove||this._runTopWinGamePanelAnimation(this.topWinGameAnimationData.name===g?f:g),this.topWinGameAnimationData.touchMove=!1},showTopWinGamePanel:function(t){this._runTopWinGamePanelAnimation(g,t)},hideTopWinGamePanel:function(t){this._runTopWinGamePanelAnimation(f,t)},_runTopWinGamePanelAnimation:function(t,e){if(this.topWinGameAnimationData.isPlaying||this.topWinGameAnimationData.name===t)return void(e&&e());var n=this.node.getComponent(cc.Animation),i=this;n&&(t===f?this.topWinGameContainerNode.getComponentsInChildren("ItemTopWinGame").forEach(function(t){t.useShortInfo()}):this.topWinGameContainerNode.getComponentsInChildren("ItemTopWinGame").forEach(function(t){t.useLongInfo()}),this.topWinGameAnimationData.name=t,this.topWinGameAnimationData.isPlaying=!0,n.play(t),this.topWinGameAnimationData.timeoutId=setTimeout(function(){i.topWinGameAnimationData.isPlaying=!1,e&&e()},this.topWinGameAnimationData.duration))}}),cc._RFpop()},{AudioManager:"AudioManager",BaseGameOptionModal:"BaseGameOptionModal",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",GameManager:"GameManager",GameManagerConstant:"GameManagerConstant",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",TopPanelOutGameWrapper:"TopPanelOutGameWrapper",UiManager:"UiManager",Url:"Url",Utils:"Utils"}],MauBinhConstant:[function(t,e,n){"use strict";cc._RFpush(e,"1fc64H/ndFG9bOyvkPN6VkQ","MauBinhConstant"),e.exports={GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_DEALING:2,DEALING:3,ORDER_CARDS:4,PLAYING:5,FINALIZING:6,FINISH:7,COMPARE_1:8,COMPARE_2:9,COMPARE_3:10},Action:{ORDER_HANDS:2,ORDER_CARDS:4,WAITING_ORDER_CARDS:5,COMPARE_CHI_MOT:6,COMPARE_CHI_HAI:7,COMPARE_CHI_BA:8,NOTIFY_THANG_TRANG:9,NOTIFY_BINH_LUNG:10,FINISH_ORDER_CARDS:11},PlayerState:{WAITING:0,READY:1,IN_TURN:2,OUT_TURN:3,ORDER_CARDS:4,WAITING_FOR_TURN:5,FINISH:6},Event:{GAME_PREPARE:"in_game.mau_binh.prepare",GAME_UPDATE_HAND:"in_game.mau_binh.update_hand",GAME_WATING_PLAYER:"in_game.mau_binh.wating_player",GAME_PLAYER_REMOVE:"in_game.mau_binh.player_remove",GAME_PLAYER_ADD:"in_game.mau_binh.player_add",GAME_USER_FINISH_ORDER:"in_game.mau_binh.finish_order",GAME_ORDER_CARD:"in_game.mau_binh.start",GAME_COMPARE_CHI:"in_game.mau_binh.compare_chi",GAME_UPDATE:"in_game.mau_binh.game_update",GAME_FINISH:"in_game.mau_binh.finish",GAME_NOTIFY_THANG_TRANG:"in_game.mau_binh.thang_trang",GAME_NOTIFY_BINH_LUNG:"in_game.mau_binh.binh_lung"},Chi:{NONE:{ID:-1,NAME:"None"},MAU_THAU:{ID:0,NAME:"Mậu Thầu"},DOI:{ID:1,NAME:"Đôi"},THU:{ID:2,NAME:"Thú"},SAM:{ID:3,NAME:"Sám cô"},SANH:{ID:4,NAME:"Sảnh"},THUNG:{ID:5,NAME:"Thùng"},CU_LU:{ID:6,NAME:"Cù Lũ"},TU_QUY:{ID:7,NAME:"Tứ Quý"},THUNG_PHA_SANH:{ID:8,NAME:"Thùng Phá Sảnh"},LUC_PHE_BON:{ID:9,NAME:"Lục Phé Bôn"},BA_CAI_SANH:{ID:10,NAME:"Ba Sảnh"},BA_CAI_THUNG:{ID:1,NAME:"Ba Thùng"},SANH_RONG:{ID:12,NAME:"Sảnh Rồng"},BINH_LUNG:{ID:13,NAME:"Binh Lủng"}}},cc._RFpop()},{}],MauBinhGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"553dcapKW5GpJ4gVYPt+f3n","MauBinhGameManager");var i,a=t("Utils"),s=t("BaseGameManager"),o=t("SmartFoxConstant"),r=t("MauBinhConstant"),c=t("NetworkManager");i=a.Class({$$extends:s,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[o.Command.MESSAGE.ID,o.Command.PLAY.ID,o.Command.FINISH_GAME.ID,o.Command.DEAL_CARD.ID,o.Command.TURN.ID,o.Command.WAITING_DEAL_CARD.ID],this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAY.ID,this.onPlay,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.REFRESH_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_HAND.ID,this.onUpdateHand,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAYER_REMOVED.ID,this.onPlayerRemove,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAYER_ADDED.ID,this.onPlayerAdd,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.WAITING_DEAL_CARD.ID,this.onWattingDealing,this)},onPlayerRemove:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.GAME_PLAYER_REMOVE,t)},onPlayerAdd:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.GAME_PLAYER_ADD,t)},onWattingDealing:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.GAME_PREPARE,t),this.gameState=r.GameState.WAITING_DEALING},onUpdateHand:function(t){this.gameState=r.GameState.ORDER_CARDS,this.eventDispatchers.local.dispatchEvent(r.Event.GAME_UPDATE_HAND,t)},onPlay:function(t){switch(t.action){case r.Action.ORDER_CARDS:this.gameState=r.GameState.ORDER_CARDS,this.eventDispatchers.local.dispatchEvent(r.Event.GAME_ORDER_CARD,t);break;case r.Action.FINISH_ORDER_CARDS:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_USER_FINISH_ORDER,t);break;case r.Action.COMPARE_CHI_MOT:this.gameState=r.GameState.COMPARE_1,this.eventDispatchers.local.dispatchEvent(r.Event.GAME_COMPARE_CHI,t);break;case r.Action.COMPARE_CHI_HAI:this.gameState=r.GameState.COMPARE_2,this.eventDispatchers.local.dispatchEvent(r.Event.GAME_COMPARE_CHI,t);break;case r.Action.COMPARE_CHI_BA:this.gameState=r.GameState.COMPARE_3,this.eventDispatchers.local.dispatchEvent(r.Event.GAME_COMPARE_CHI,t);break;case r.Action.NOTIFY_THANG_TRANG:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_NOTIFY_THANG_TRANG,t);break;case r.Action.NOTIFY_BINH_LUNG:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_NOTIFY_BINH_LUNG,t);break;case r.Action.WAITING_ORDER_CARDS:}},onUpdateGame:function(t){switch(this.gameState=t.gameState,this.gameState){case r.GameState.WAITING_FOR_PLAYER:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_WATING_PLAYER,t);break;case r.GameState.WAITING_DEALING:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_PREPARE,t);break;case r.GameState.COMPARE_1:case r.GameState.COMPARE_2:case r.GameState.COMPARE_3:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_COMPARE_CHI,t);break;case r.GameState.DEALING:case r.GameState.PLAYING:break;case r.GameState.ORDER_CARDS:this.eventDispatchers.local.dispatchEvent(r.Event.GAME_ORDER_CARD,t)}},onFinishGame:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.GAME_FINISH,t)},sendRequestOrderCard:function(t,e){this.send({command:c.SmartFox.type["byte"](o.Command.PLAY.ID),action:c.SmartFox.type["byte"](r.Action.ORDER_CARDS),cards:c.SmartFox.type.byteArray(t),isFinish:c.SmartFox.type.bool(e)})},sendRequestStartGame:function(){this.send({command:c.SmartFox.type["byte"](o.Command.DEAL_CARD.ID)})}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",MauBinhConstant:"MauBinhConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],MenuSlot:[function(t,e,n){"use strict";cc._RFpush(e,"4c119hFtc5Md7/LHirxVKTF","MenuSlot");var i=t("AuthUser"),a=t("CommonConstant"),s=t("AudioManager");cc.Class({"extends":cc.Component,properties:{txtUserName:cc.Label,historyPrefab:cc.Prefab,xephangPrefab:cc.Prefab,iconSoundOff:cc.Node,iconSoundOn:cc.Node,iconMusicOff:cc.Node,iconMusicOn:cc.Node,btnLichSu:cc.Node},onLoad:function(){this.txtUserName.string=i.username,this.showing=!1,this.hidding=!1,this.iconSoundOn.active=1===s.instance.getEffectsVolume(),this.iconSoundOff.active=0===s.instance.getEffectsVolume(),this.iconMusicOn.active=1===s.instance.getMusicVolume(),this.iconMusicOff.active=0===s.instance.getMusicVolume()},onHistoryClick:function(){this.nodeHistory=cc.instantiate(this.historyPrefab),this.node.addChild(this.nodeHistory),this.nodeHistory.active=!0,s.instance.playButtonClick(),this.gamePlay&&this.nodeHistory.getComponent("TableHistorySlot").init(this.gamePlay.gameManager.historyList)},onNoHuClick:function(){this.nodeHistory=cc.instantiate(this.xephangPrefab),this.node.addChild(this.nodeHistory),this.nodeHistory.active=!0,s.instance.playButtonClick(),this.gamePlay&&this.nodeHistory.getComponent("TableXepHangSlot").init(this.gamePlay.gameId,a.CurrencyType.Ip.NAME)},onSounClick:function(){this.iconSoundOn.active=!this.iconSoundOn.active,this.iconSoundOff.active=!this.iconSoundOn.active;var t=this.iconSoundOn.active?1:0;s.instance.setEffectsVolume(t),s.instance.playButtonClick()},onMusicClick:function(){this.iconMusicOn.active=!this.iconMusicOn.active,this.iconMusicOff.active=!this.iconMusicOff.active;var t=this.iconMusicOn.active?1:0;s.instance.setMusicVolume(t),s.instance.playButtonClick()},show:function(){this.node.active=!0},hide:function(){this.nodeDoiThuong&&this.nodeDoiThuong.active&&cc.isValid(this.nodeDoiThuong)||this.nodeNapXien&&this.nodeNapXien.active&&cc.isValid(this.nodeNapXien)||this.nodeHistory&&this.nodeHistory.active&&cc.isValid(this.nodeHistory)||this.hidding||(this.node.active=!1)}}),cc._RFpop()},{AudioManager:"AudioManager",AuthUser:"AuthUser",CommonConstant:"CommonConstant"}],MessageBoxCache:[function(t,e,n){"use strict";cc._RFpush(e,"5b080Ecq/5JFZT7MpaSbO4h","MessageBoxCache");var i=t("AuthUser"),a={_cache:null,CACHE_KEY_STORAGE:"mess_cache",USER_KEY:"_user",MAX_ITEMS:100,initCache:function(t){this._cache||(this._cache=JSON.parse(cc.sys.localStorage.getItem(this.CACHE_KEY_STORAGE))||{}),this._cache[this.USER_KEY]!==i.username&&(this.resetCache(),this._cache[this.USER_KEY]=i.username),this._cache[t]=this._cache[t]||[]},saveCache:function(){cc.sys.localStorage.setItem(this.CACHE_KEY_STORAGE,JSON.stringify(this._cache))},resetCache:function(){this._cache={},cc.sys.localStorage.removeItem(this.CACHE_KEY_STORAGE)},addMessages:function(t,e){var n,i,a;for(this.initCache(t),i=0;i<e.length;i+=1){for(a=!0,n=0;n<this._cache[t].length;n+=1)if(this._cache[t][n].msgid===e[i].msgid){a=!1;break}a&&this._cache[t].push(e[i])}this._cache[t].sort(function(t,e){return e.created_time.localeCompare(t.created_time)}),this._cache[t]=this._cache[t].slice(0,this.MAX_ITEMS),this.saveCache(t)},getMessages:function(t){return this.initCache(t),this._cache[t]},updateMessage:function(t,e){this.initCache(t);for(var n=0;n<this._cache[t].length;n+=1)if(this._cache[t][n].msgid===e.msgid){cc.js.mixin(this._cache[t][n],e);break}this.saveCache(t)},getIndexMessage:function(t,e){for(var n=0;n<this._cache[t].length;n+=1)if(this._cache[t][n].msgid===e)return n},removeMessage:function(t,e){this.initCache(t);for(var n=0;n<this._cache[t].length;n+=1)if(this._cache[t][n].msgid===e){this._cache[t].splice(n,1);break}this.saveCache(t)}};e.exports=a,cc._RFpop()},{AuthUser:"AuthUser"}],MessageBox:[function(t,e,n){"use strict";cc._RFpush(e,"0ecacsuzFhI1ZZxsQ3kuggz","MessageBox");var i=t("Url"),a=t("TabView"),s=t("AuthUser"),o=t("UiManager"),r=t("NetworkManager"),c=t("MessageBoxCache"),h=t("EventDispatcher"),u=t("EventDispatcherConstant");cc.Class({"extends":cc.Component,properties:{itemMessageDetailPrefab:cc.Prefab,messageTabView:a,itemInboxPrefab:cc.Prefab,ongoingContainerNode:cc.Node,itemSentPrefab:cc.Prefab,outgoingContainerNode:cc.Node,userToEditBox:cc.EditBox,contentEditBox:cc.EditBox,titleEditBox:cc.EditBox},onLoad:function(){this.clearMessageEditor(),this.itemMessageDetailNode=cc.instantiate(this.itemMessageDetailPrefab)},fetchMessages:function(t,e,n){var a=this;r.Http.fetch("GET",i.Http.MESSAGE_BOX,{username:s.username,accesstoken:s.accesstoken,type:t},{delay:500}).success(function(i){var o,r,l="mess_"+t;for(c.addMessages(l,i.data),r=c.getMessages(l),n.removeAllChildren(),o=0;o<r.length;o+=1)a._initMessageNode(e,n,r[o],l);"ongoing"===t&&(s.unread_mess_count=0,h.dispatchEvent(u.PROFILE.UPDATE_UNREAD_MESS_COUNT))})},_initMessageNode:function(t,e,n,a){var h=this,u=cc.instantiate(t);e.addChild(u),u.getComponent("ItemMessage").updateData(n,a),u.on(cc.Node.EventType.TOUCH_END,function(){h.itemMessageDetailNode.parent&&h.itemMessageDetailNode.removeFromParent(!1),
e.parent.addChild(h.itemMessageDetailNode);var t=h.itemMessageDetailNode.getComponent("ItemMessage");n.body?t.updateData(n,a):r.Http.fetch("GET",i.Http.DETAIL_MESSAGE_BOX,{username:s.username,message_id:n.msgid,accesstoken:s.accesstoken}).success(function(e){t.updateData(e.data,a),c.updateMessage(a,e.data)}),t.deleteMessage=function(){o.openConfirmModal("Bạn có chắc muốn xóa tin nhắn này không?",{oke_fn:function(){c.removeMessage(a,n.msgid),u.removeFromParent(),t.closeDetailMessage()}})},t.replyToUser=function(){h.userToEditBox.string=this.userLabel.string,h.messageTabView.activeByName("MessEditor"),this.closeDetailMessage()},t.closeDetailMessage=function(){h.itemMessageDetailNode.runAction(cc.sequence([cc.fadeOut(.1),cc.callFunc(function(){h.itemMessageDetailNode.removeFromParent(!1)})]))},h.itemMessageDetailNode.runAction(cc.fadeIn(.1))},u)},fetchOnGoingMessages:function(){this.fetchMessages("ongoing",this.itemInboxPrefab,this.ongoingContainerNode)},fetchOutGoingMessages:function(){this.fetchMessages("outgoing",this.itemSentPrefab,this.outgoingContainerNode)},sendMessage:function(t){if(""===this.titleEditBox.string||""===this.contentEditBox.string||""===this.userToEditBox.string)o.openModal("Bạn cần nhập đầy đủ thông tin gửi.");else{if(this.userToEditBox.string===s.username)return void o.openModal("Tên người nhận không hợp lệ.");var e=this,n=this.userToEditBox.string,a=this.titleEditBox.string,c=this.contentEditBox.string;r.Http.fetch("POST",i.Http.MESSAGE_BOX,{from_user:s.username,to_user:n,subject:a,body:c,accesstoken:s.accesstoken}).success(function(){e.clearMessageEditor(),e.messageTabView.activeByName("Sent")}).setWaitingButton(t.target)}},clearMessageEditor:function(){this.titleEditBox.string="",this.userToEditBox.string="",this.contentEditBox.string=""}}),cc._RFpop()},{AuthUser:"AuthUser",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",MessageBoxCache:"MessageBoxCache",NetworkManager:"NetworkManager",TabView:"TabView",UiManager:"UiManager",Url:"Url"}],MiniPokerConstant:[function(t,e,n){"use strict";cc._RFpush(e,"f6055esZdhMMJE9Vbt8EcYq","MiniPokerConstant"),e.exports={Action:{ROTATE:0,CHANGE_STATE:5,UPDATE_MINI_POKER_JAR:6},GameState:{NONE:0,ROTATE:1,FINALIZING:2,FINISH:3},PotType:{NONE:0,DOI_J:1,THU:2,SAM:3,SANH:4,THUNG:5,CU_LU:6,TU_QUY:7,THUNG_PHA_SANH:8,THUNG_PHA_SANH_A:9},Event:{TURN_PREPARE:"in_game.mini_poker.prepare",TURN_START:"in_game.mini_poker.start",TURN_UPDATE:"in_game.mini_poker.update",TURN_FINISH:"in_game.mini_poker.finish",GET_JAR_SUCCESS:"in_game.mini_poker.get_jar",UPDATE_JAR:"in_game.mini_poker.update_jar"},getPotName:function(t){var e="";switch(t){case this.PotType.NONE:break;case this.PotType.DOI_J:e="Đôi J+";break;case this.PotType.THU:e="Thú";break;case this.PotType.SAM:e="Sám";break;case this.PotType.SANH:e="Sảnh";break;case this.PotType.THUNG:e="Thùng";break;case this.PotType.CU_LU:e="Cù Lũ";break;case this.PotType.TU_QUY:e="Tứ Quý";break;case this.PotType.THUNG_PHA_SANH:e="Thùng Phá Sảnh";break;case this.PotType.THUNG_PHA_SANH_A:e="Thùng Phá Sảnh A"}return e}},cc._RFpop()},{}],MiniPokerGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"3dfe2MJ3+tHJKYgYW3t+Etb","MiniPokerGameManager");var i,a=t("Utils"),s=t("Url"),o=t("BaseGameManager"),r=t("SmartFoxConstant"),c=t("NetworkManager"),h=t("MiniPokerConstant");i=a.Class({$$extends:o,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[r.Command.MESSAGE.ID],this.gameState=h.GameState.NONE,this.historyList=[],this.lastMoneyBet=0,this.lastPotWin=0,this.lastCurrency="",this.eventDispatchers.anyCmd.addEventListener(r.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(r.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(h.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(h.Action.ROTATE,this.onStartGame,this),this.eventDispatchers.globalCmd.addEventListener(r.Command.UPDATE_GAME.ID,this.onUpdateGameJar,this),this._getMoneyQuy()},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.UPDATE_JAR,t)},sendStartGame:function(t,e){this.send({command:c.SmartFox.type["byte"](r.Command.PLAY.ID),action:c.SmartFox.type["byte"](h.Action.ROTATE),betting:c.SmartFox.type["long"](e),currency:c.SmartFox.type.utfString(t)}),this.lastMoneyBet=e,this.lastCurrency=t},onChangeStateGame:function(t){this.gameState=t.gameState,t.gameState===h.GameState.ROTATE?(this.eventDispatchers.local.dispatchEvent(h.Event.TURN_START,t),this.lastPotWin=t.potWin):t.gameState===h.GameState.NONE&&this.eventDispatchers.local.dispatchEvent(h.Event.TURN_PREPARE,t)},onUpdateGame:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.TURN_UPDATE,t)},onFinishGame:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.TURN_FINISH,t);var e={time:a.Date.currentTime(),potWin:this.lastPotWin,moneyBet:this.lastMoneyBet,moneyExchange:t.player.moneyExchange,currency:this.lastCurrency};this.historyList.unshift(e),this.historyList.length>60&&this.historyList.splice(this.historyList.length-1,1)},_getMoneyQuy:function(){var t=this;c.Http.fetch("GET",s.Http.MINI_POKER_GET_JAR,{}).success(function(e){t.eventDispatchers.local.dispatchEvent(h.Event.GET_JAR_SUCCESS,e)},{cache:900})},destroy:function(){this.$super.destroy.call(this)}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",MiniPokerConstant:"MiniPokerConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Url:"Url",Utils:"Utils"}],MinigamePopup:[function(t,e,n){"use strict";cc._RFpush(e,"5ae81IT9LFJDYTscvXuaQYE","MinigamePopup");var i=t("GameManager"),a=t("GameConstant"),s=t("CommonConstant"),o=t("Utils");cc.Class({"extends":cc.Component,properties:{popupNode:cc.Node,taixiuTimeLeftLabel:cc.Label},start:function(){this.node.zIndex=s.ZINDEX.MINIGAME_POPUP},onLoad:function(){this.popupNode.on(cc.Node.EventType.TOUCH_END,this.hide,this)},onDestroy:function(){},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.hide,this),this.stopPropagationOnPopupNode=o.Node.stopPropagation(this.popupNode)},onDisable:function(){this.stopPropagationOnPopupNode&&(this.stopPropagationOnPopupNode(),this.stopPropagationOnPopupNode=null),this.node.off(cc.Node.EventType.TOUCH_END,this.hide,this)},update:function(){this._updateTaiXiu()},init:function(t){this.minigameQuickIcon=t,this.minigameQuickIconSize={width:t.node.width,height:t.node.height},this.show()},show:function(){this._correctPositionToShow();var t=cc.v2(0,0),e=.2,n=.15,i=cc.sequence(cc.spawn([cc.scaleTo(e,1),cc.rotateBy(e,-720),cc.moveTo(e,t),cc.fadeIn(e)]),cc.spawn([cc.scaleTo(n,.8,1.2),cc.moveBy(n,0,120)]),cc.spawn([cc.scaleTo(n,1.5,.6),cc.moveBy(n/2,0,-120)]),cc.scaleTo(e,1));this.popupNode.runAction(i)},hide:function(){this._correctPositionToHide();var t=this._getMinigameQuickIconPosition(),e=this,n=.2,i=cc.sequence(cc.spawn([cc.scaleTo(n,0),cc.rotateBy(n,720),cc.moveTo(n,t),cc.fadeIn(n),cc.callFunc(function(){e.minigameQuickIcon&&e.minigameQuickIcon.show()})]),cc.callFunc(function(){e.node.destroy()}));this.popupNode.runAction(i)},_correctPositionToShow:function(){this.popupNode.stopAllActions(),this.popupNode.scale=0,this.popupNode.rotation=0,this.popupNode.opacity=0,this.popupNode.position=this._getMinigameQuickIconPosition(),this.node.active=!0},_correctPositionToHide:function(){this.popupNode.stopAllActions(),this.popupNode.scale=1,this.popupNode.rotation=0,this.popupNode.opacity=255,this.popupNode.position=cc.v2(0,0),this.node.active=!0},_getMinigameQuickIconPosition:function(){var t,e=this.popupNode.scale,n=this.popupNode.position;return this.popupNode.active=!1,this.popupNode.scale=1,this.popupNode.position=cc.v2(0,0),t=this.popupNode.convertToNodeSpace(this.minigameQuickIcon.node.convertToWorldSpace(cc.v2(0,0))),t.x=t.x+this.minigameQuickIconSize.width/2-this.popupNode.width/2,t.y=t.y+this.minigameQuickIconSize.height/2-this.popupNode.height/2,this.popupNode.scale=e,this.popupNode.position=n,this.popupNode.active=!0,t},_updateTaiXiu:function(){this._updateTaiXiuTimeLeft()},_updateTaiXiuTimeLeft:function(){var t=i.getGameRuntimeConfigs(a.TAI_XIU.CMD),e=t&&t.gameManager;e&&(this.taixiuTimeLeftLabel.string=e.getFormattedCurrentTimeLeft())}}),cc._RFpop()},{CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManager:"GameManager",Utils:"Utils"}],MinigameQuickIcon:[function(t,e,n){"use strict";cc._RFpush(e,"3b228l5gNBCXa/IiHZRetro","MinigameQuickIcon");var i=t("UiManager"),a=t("GameManager"),s=t("GameConstant"),o=t("EventDispatcher"),r=t("EventDispatcherConstant"),c=t("TinhNangManager"),h=t("CommonConstant"),u=t("Utils"),l="games/minigame/MinigamePopup",d=255,m=191.25,p=2e3,g=50,f=10,_="minigame_icon_pos";cc.Class({"extends":cc.Component,properties:{taixiuTimeLeftNode:cc.Node,taixiuTimeLeftLabel:cc.Label},start:function(){cc.sys.isBrowser&&(this.node.zIndex=h.ZINDEX.MINIGAME_QUICK_ICON)},onLoad:function(){this.MIN_SCALE=100/this.node.width,this.MAX_SCALE=120/this.node.width,this.blinkAnimation=this.node.getComponentInChildren(cc.Animation),this.heartBeatAction=cc.sequence(cc.scaleTo(1,this.MIN_SCALE),cc.scaleTo(1,this.MAX_SCALE)).repeatForever(),this.touchStartTime=Date.now(),this.mouseEnter=!1,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,function(){this.mouseEnter=!0,this._cancelScheduleIdleState()},this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,function(){this.mouseEnter&&this._scheduleIdleState(),this.mouseEnter=!1},this);var t=this._loadPosition();t&&(this.node.position=t),this.node.position=this._correctPosition(this.node.position),this._scheduleIdleState(),this.onTinhNangNew(),o.addEventListener(r.TINH_NANG.NEW,this.onTinhNangNew,this)},onDestroy:function(){this.node.destroy(),i.destroyModalByName(l),o.removeEventListener(r.TINH_NANG.NEW,this.onTinhNangNew,this)},update:function(){this._updateTaiXiu()},onTinhNangNew:function(){this.taixiuTimeLeftNode.active=c.choPhep(s.TAI_XIU.ID)},onTouchStart:function(){this.touchStartTime=Date.now(),this._cancelScheduleIdleState()},onTouchMove:function(t){var e=t.getLocation();this.node.position=e},onTouchEnd:function(t){var e,n=Date.now()-this.touchStartTime,a=t.getStartLocation(),s=t.getLocation(),o=s.x-a.x,r=s.y-a.y,c=Math.max(Math.abs(o),Math.abs(r)),h=c/n,u=cc.winSize,d=0,m=d+u.width,p=0,f=p+u.height,_=.2,y=this;if(h>1.2)switch(c){case o:e=cc.moveTo(_,this._correctPosition(cc.v2(m,this.node.y)));break;case-o:e=cc.moveTo(_,this._correctPosition(cc.v2(d,this.node.y)));break;case r:e=cc.moveTo(_,this._correctPosition(cc.v2(this.node.x,f)));break;case-r:e=cc.moveTo(_,this._correctPosition(cc.v2(this.node.x,p)))}else{var E=s.x-d,C=m-s.x,v=f-s.y,T=s.y-p,S=Math.min(E,C,v,T);switch(S){case E:e=cc.moveTo(_,this._correctPosition(cc.v2(d,this.node.y)));break;case C:e=cc.moveTo(_,this._correctPosition(cc.v2(m,this.node.y)));break;case v:e=cc.moveTo(_,this._correctPosition(cc.v2(this.node.x,f)));break;case T:e=cc.moveTo(_,this._correctPosition(cc.v2(this.node.x,p)))}}e&&(e.easing(cc.easeBounceInOut()),this.node.runAction(cc.sequence(e,cc.callFunc(this._savePosition.bind(this))))),this._scheduleIdleState(),Math.abs(o)<g&&Math.abs(r)<g&&i.openModalByName(l,function(t){var e=t.getComponent("MinigamePopup");e&&(e.init(y),y.hide())},{isPersistent:!0}),this.mouseEnter=!1},show:function(){this._correctPositionToShow();var t=.2,e=cc.spawn([cc.scaleTo(t,1),cc.rotateBy(t,-720),cc.fadeIn(t)]);this.node.runAction(cc.sequence(e,cc.callFunc(this._scheduleIdleState.bind(this))))},hide:function(){this._correctPositionToHide();var t=.2,e=cc.spawn([cc.scaleTo(t,0),cc.rotateBy(t,720),cc.fadeOut(t)]);this.node.runAction(e)},_getShortestBoundaryPosition:function(t,e){var n=cc.winSize,i=0,a=i+n.width,s=0,o=s+n.height,r=e?e.width:this.node.width,c=r/2,h=e?e.height:this.node.height,u=h/2,l=t.x-i,d=a-t.x,m=o-t.y,p=t.y-s,g=Math.min(l,d,m,p),f={x:t.x,y:t.y};switch(g){case l:f.x=i+c;break;case d:f.x=a-c;break;case m:f.y=o-u;break;case p:f.y=s+u}return f},_correctPosition:function(t,e){var n=cc.winSize,i=0,a=i+n.width,s=0,o=s+n.height,r=e?e.width:this.node.width,c=r/2,h=e?e.height:this.node.height,u=h/2,l=t.x-c,d=t.x+c,m=t.y+u,p=t.y-u;return l=l<i?i+c:d>a?a-c:t.x,p=p<s?s+u:m>o?o-u:t.y,cc.v2(l,p)},_correctPositionToShow:function(){this.node.stopAllActions(),this.node.scale=0,this.node.rotation=0,this.node.opacity=0},_correctPositionToHide:function(){this.node.stopAllActions(),this.node.scale=1,this.node.rotation=0,this.node.opacity=255},_changeToIdleState:function(){if(this.node.opacity=m,this.node.scale>=this.MIN_SCALE){var t=this,e=this.node.width,n=this.node.height,i=e*this.MAX_SCALE,a=n*this.MAX_SCALE,s=i/2,o=a/2,r=cc.winSize,c=0,h=c+r.width,u=0,l=u+r.height,d=e-i,p=n-a,g=this.node.x-d/2,_=this.node.x+d/2,y=this.node.y+p/2,E=this.node.y-p/2,C={width:i,height:a},v=this._correctPosition(this.node.position,C);v=this._getShortestBoundaryPosition(v,C),Math.abs(c-(g-s))<f?v.x=g:Math.abs(h-(_+s))<f&&(v.x=_),Math.abs(l-(y+o))<f?v.y=y:Math.abs(u-(E-o))<f&&(v.y=E),this.node.scale=this.MAX_SCALE,this.node.runAction(cc.sequence(cc.moveTo(.3,v),cc.callFunc(function(){t.node.runAction(t.heartBeatAction)})))}this.blinkAnimation&&this.blinkAnimation.isRunning()&&this.blinkAnimation.stop()},_changeToActiveState:function(){try{if(this.node.stopAction(this.heartBeatAction),this.node.scale>=this.MIN_SCALE&&this.node.scale<=this.MAX_SCALE){var t=cc.spawn([cc.scaleTo(.2,1),cc.moveTo(.2,this._correctPosition(this.node.position))]);this.node.runAction(t)}}catch(e){}this.node.opacity=d,this.blinkAnimation&&this.blinkAnimation.play()},_scheduleIdleState:function(){this._cancelScheduleIdleState(),this._idleTimeoutId=setTimeout(this._changeToIdleState.bind(this),p)},_cancelScheduleIdleState:function(){this._idleTimeoutId&&(clearTimeout(this._idleTimeoutId),this._idleTimeoutId=null),this._changeToActiveState()},_updateTaiXiu:function(){this._updateTaiXiuTimeLeft()},_updateTaiXiuTimeLeft:function(){var t=a.getGameRuntimeConfigs(s.TAI_XIU.CMD),e=t&&t.gameManager;e&&(this.taixiuTimeLeftLabel.string=e.getFormattedCurrentTimeLeft())},_savePosition:function(){cc.sys.localStorage.setItem(_,JSON.stringify({x:this.node.x,y:this.node.y}))},_loadPosition:function(){try{var t=JSON.parse(cc.sys.localStorage.getItem(_));if(t&&u.Type.isDefined(t.x)&&u.Type.isDefined(t.y))return t}catch(e){return null}}}),cc._RFpop()},{CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameConstant:"GameConstant",GameManager:"GameManager",TinhNangManager:"TinhNangManager",UiManager:"UiManager",Utils:"Utils"}],Modal:[function(t,e,n){"use strict";cc._RFpush(e,"46a24g7mcRAkqwsne3udd+0","Modal");var i=t("Utils"),a=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{backdrop:cc.Node,content:cc.Label},start:function(){this.node.zIndex=a.ZINDEX.MODAL},onLoad:function(){},onEnable:function(){this.stopPropagationOnBackdrop=i.Node.stopPropagation(this.backdrop),this.node.stopAllActions(),this.node.setScale(.3),this.node.runAction(cc.spawn([cc.scaleTo(.3,1).easing(cc.easeBackOut()),cc.fadeIn(.3)]))},onDisable:function(){this.stopPropagationOnBackdrop&&(this.stopPropagationOnBackdrop(),this.stopPropagationOnBackdrop=null)},closeCallback:function(){},close:function(){function t(){e.destroy()}var e=this.node,n=cc.spawn([cc.scaleTo(.2,.3).easing(cc.easeBackIn()),cc.fadeOut(.2)]);e.stopAllActions(),e.runAction(cc.sequence([n,cc.callFunc(t)])),this.closeCallback()}}),cc._RFpop()},{CommonConstant:"CommonConstant",Utils:"Utils"}],MovableObject:[function(t,e,n){"use strict";cc._RFpush(e,"d344ctcOedL14NYAWxWXlWK","MovableObject"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){t.time=Date.now(),t.curPosTouched=new cc.Vec2(e.getLocation().x-t.node.position.x,e.getLocation().y-t.node.position.y)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(t.time-Date.now()<-100){var n=new cc.Vec2(e.getLocation().x-t.curPosTouched.x,e.getLocation().y-t.curPosTouched.y);t.node.position=n}}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.onEndOrCancelTouch()}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.onEndOrCancelTouch()})},onEndOrCancelTouch:function(){this.time=Date.now()}}),cc._RFpop()},{}],MultiScreen:[function(t,e,n){"use strict";cc._RFpush(e,"77b02udFzRMcbE0T3qHXJjE","MultiScreen"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){var t=cc.winSize,e=cc.Canvas.instance.designResolution.width/cc.Canvas.instance.designResolution.height,n=t.width/t.height;n<=e&&(cc.Canvas.instance.fitHeight=!1,cc.Canvas.instance.fitWidth=!0)}}),cc._RFpop()},{}],MultiSelect:[function(t,e,n){"use strict";cc._RFpush(e,"d1b5a236N1BeIDUrVARo52V","MultiSelect"),cc.Class({"extends":cc.Component,properties:{maxSelect:1,activeSprite:{"default":null,type:cc.SpriteFrame},normalSprite:{"default":null,type:cc.SpriteFrame},selectEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){function t(t){i.selectItem(t.target)}this.selectedItems=[];var e,n,i=this;for(n=0;n<this.node.children.length;n+=1)e=this.node.children[n],e.on(cc.Node.EventType.TOUCH_END,t,e);this.node.on("child-added",function(e){e.detail.on(cc.Node.EventType.TOUCH_END,t,e.detail)})},selectItem:function(t){var e,n=this.selectedItems,i=n.indexOf(t);t.parent===this.node&&(i<0?(n.length>=this.maxSelect&&(e=n.shift(),this.onUnselect(e)),n.push(t),this.onSelect(t)):(n.splice(i,1),this.onUnselect(t)),this.selectEvents.forEach(function(t){t.emit([n])}))},onSelect:function(t){this.activeSprite?t.getComponent(cc.Sprite).spriteFrame=this.activeSprite:(t.stopAllActions(),t.runAction(cc.scaleTo(.1,1.25)))},onUnselect:function(t){this.normalSprite?t.getComponent(cc.Sprite).spriteFrame=this.normalSprite:(t.stopAllActions(),t.runAction(cc.scaleTo(.1,1)))}}),cc._RFpop()},{}],MyNhanConstant:[function(t,e,n){"use strict";cc._RFpush(e,"8a878pTVBBE6o1KcWNuP3Pn","MyNhanConstant"),e.exports={GameType:{type:0},BettingList:[],BettingFreeList:[],Action:{ROTATE:0,OPEN_COFFER:2,CHANGE_STATE:5,UPDATE_AWARD_TYPE:9},GameState:{NONE:0,ROTATE:1,FINALIZING:2,FINISH:3,OPEN_COFFER:4},Event:{GET_JAR_SUCCESS:"in_game.my_nhan.getjarsuccess",OPEN_COFFER:"in_game.my_nhan.opencoffer",UPDATE_JAR:"in_game.my_nhan.updatejar",UPDATE_USER_INFO:"in_game.my_nhan.updateuserinfo",UPDATE_AWARD_TYPE:"in_game.my_nhan.updateAwardType",TURN_PREPARE:"in_game.my_nhan.prepare",TURN_START:"in_game.my_nhan.start",TURN_UPDATE:"in_game.my_nhan.update",TURN_FINISH:"in_game.my_nhan.finish"}},cc._RFpop()},{}],MyNhanGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"ce10eKhWfBDppkhPzPxm685","MyNhanGameManager");var i,a=t("Utils"),s=t("Url"),o=t("AuthUser"),r=t("CommonConstant"),c=t("BaseGameManager"),h=t("SmartFoxConstant"),u=t("NetworkManager"),l=t("MyNhanConstant");i=a.Class({$$extends:c,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[h.Command.MESSAGE.ID],this.gameState=l.GameState.NONE,this.isFreeTurn=!1,this.eventDispatchers.anyCmd.addEventListener(h.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(h.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(h.Command.UPDATE_USER_INFO.ID,this.onUpdateUser,this),this.eventDispatchers.globalCmd.addEventListener(h.Command.UPDATE_JAR.ID,this.onUpdateGameJar,this),this.eventDispatchers.playCmd.addEventListener(l.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(l.Action.OPEN_COFFER,this.onOpenCoffer,this),this.eventDispatchers.playCmd.addEventListener(l.Action.UPDATE_AWARD_TYPE,this.onUpdateAwardType,this);var n="mynhan";this.historyDataKey="data_history_"+n+"_user_"+o.username,l.GameType.type===-1&&(this.historyDataKey="data_history_"+n+"_free_user_"+o.username),this.historyList=[];var i=cc.sys.localStorage.getItem(this.historyDataKey);void 0!==i&&null!==i&&(this.historyList=JSON.parse(i))},onUpdateAwardType:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_AWARD_TYPE,t)},onUpdateUser:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_USER_INFO,t)},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.UPDATE_JAR,t)},onFinishGame:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.TURN_FINISH,t);var e=this.isFreeTurn?"Q.Miễn phí":a.Number.format(this.betting)+" "+(l.GameType.type===-1?r.CurrencyType.Xu.CHIP_NAME:r.CurrencyType.Ip.CHIP_NAME),n={time:a.Date.currentTime(),result:t.player.moneyExchange,betting:this.betting,totalBetting:this.betting*this.potCount,type:e};this.historyList.unshift(n),this.historyList.length>60&&this.historyList.splice(this.historyList.length-1,1),cc.sys.localStorage.setItem(this.historyDataKey,JSON.stringify(this.historyList)),this.isFreeTurn=!1},onOpenCoffer:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.OPEN_COFFER,t)},onChangeStateGame:function(t){var e=t.gameState;void 0!==e&&(this.gameState=e,e===l.GameState.ROTATE?this.eventDispatchers.local.dispatchEvent(l.Event.TURN_START,t):e===l.GameState.NONE&&this.eventDispatchers.local.dispatchEvent(l.Event.TURN_PREPARE,t))},onUpdateGame:function(t){this.eventDispatchers.local.dispatchEvent(l.Event.TURN_UPDATE,t)},sendStartGame:function(t,e,n){this.betting=t,this.potCount=e.length,this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.ROTATE),betting:u.SmartFox.type["long"](t),pots:u.SmartFox.type.byteArray(e),currency:u.SmartFox.type.utfString(n)})},updateAwardType:function(){this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.UPDATE_AWARD_TYPE)})},openLuckyCoffer:function(t){this.send({command:u.SmartFox.type["byte"](h.Command.PLAY.ID),action:u.SmartFox.type["byte"](l.Action.OPEN_COFFER),id:u.SmartFox.type["byte"](t)})},destroy:function(){this.$super.destroy.call(this)},getJar:function(){var t=this;u.Http.fetch("GET",s.Http.GET_JAR,{game_id:t.gameId}).success(function(e){t.eventDispatchers.local.dispatchEvent(l.Event.GET_JAR_SUCCESS,e)},{cache:900})}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",MyNhanConstant:"MyNhanConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Url:"Url",Utils:"Utils"}],NapIap:[function(t,e,n){"use strict";cc._RFpush(e,"54b3ctQ+ShM0Lz8kT6hDRx8","NapIap");var i=t("Url"),a=t("AuthUser"),s=t("SysConfig"),o=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{iapItemPrefab:cc.Prefab,iapScrollView:cc.ScrollView},onEnable:function(){this.fetchIapType()},fetchIapType:function(){var t=this;o.Http.fetch("GET",i.Http.IAP_TYPES,{username:a.username,provider:s.IAP_PROVIDER},{cache:900,delay:500}).success(function(e){var n,i=e.data;t.iapScrollView.content.removeAllChildren();for(var a=0;a<i.length;a+=1)n=cc.instantiate(t.iapItemPrefab),t.iapScrollView.content.addChild(n);t.iapScrollView.scrollToPercentHorizontal(.5)})}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",SysConfig:"SysConfig",Url:"Url"}],NapThe:[function(t,e,n){"use strict";cc._RFpush(e,"ca92azwsylDwr9rzr4cdYQs","NapThe");var i=t("NetworkManager"),a=t("CommonConstant"),s=t("UiManager"),o=t("AuthUser"),r=t("Url");cc.Class({"extends":cc.Component,properties:{tcaoScrollView:cc.ScrollView,tcaoItemPrefab:cc.Prefab,tcaoHintLabel:cc.Label,pinEditBox:cc.EditBox,serialEditBox:cc.EditBox},onEnable:function(){this.fetchTheCaoInfo()},fetchTheCaoInfo:function(){var t=this;i.Http.fetch("GET",r.Http.THE_CAO_TYPES,{username:o.username},{cache:900,delay:500}).success(function(e){var n,i,s=e.data;t.tcaoHintLabel.string=a.CurrencyType.normalize(e.data_hint),t.tcaoScrollView.content.removeAllChildren();for(var o=0;o<s.length;o+=1)n=cc.instantiate(t.tcaoItemPrefab),n.cardType=s[o].name,i=n.getComponent("ItemThe"),i.updateData(s[o]),t.tcaoScrollView.content.addChild(n);t.tcaoScrollView.scrollToLeft()})},napTheCao:function(t){var e,n=this.tcaoScrollView.content.getComponent("MultiSelect");return n.selectedItems.length<1?s.openModal("Xin vui lòng chọn loại thẻ cào."):this.pinEditBox.string.length<1?s.openModal("Xin vui lòng nhập mã pin."):(e=n.selectedItems[0].cardType,void i.Http.fetch("POST",r.Http.NAP_THE_CAO,{username:o.username,accesstoken:o.accesstoken,card_type:e,pin:this.pinEditBox.string,serial:this.serialEditBox.string}).success(function(){s.openModal("Xin chúc mừng, bạn đã nạp thẻ thành công.")}).setWaitingButton(t.target))},selectCard:function(t){if(t.length>0){var e=t[0];"IP"===e.cardType?this.serialEditBox.node.active=!1:this.serialEditBox.node.active=!0}},onLoad:function(){}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],NapTinNhan:[function(t,e,n){"use strict";cc._RFpush(e,"7a131i9Xr9MBY8cTR0nRDbZ","NapTinNhan");var i=t("PlatformImplement"),a=t("NetworkManager"),s=t("AuthUser"),o=t("DropDown"),r=t("Url");cc.Class({"extends":cc.Component,properties:{tongDaiDropDown:o,tnItemPrefab:cc.Prefab,tnScrollView:cc.ScrollView},onLoad:function(){},onEnable:function(){this.fetchTinNhanTypes()},fetchTinNhanTypes:function(){var t=this,e=i.getNhaMang(),n=this.tongDaiDropDown.getSelectedItem();a.Http.fetch("GET",r.Http.TIN_NHAN_TYPES,{username:s.username,telco:n||e},{cache:900,delay:500}).success(function(i){var a,s,o=i.telco,r=i.data;for(t.tnScrollView.content.removeAllChildren(),s=0;s<r.length;s+=1)a=cc.instantiate(t.tnItemPrefab),a.getComponent("ItemTinNhan").updateData(r[s]),t.tnScrollView.content.addChild(a);if(!n)for(t.tongDaiDropDown.clearAllItems(),s=0;s<o.length;s+=1)t.tongDaiDropDown.addItem(o[s],RegExp(o[s],"i").test(e));t.tnScrollView.scrollToPercentHorizontal(.5)})}}),cc._RFpop()},{AuthUser:"AuthUser",DropDown:"DropDown",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",Url:"Url"}],NapXu:[function(t,e,n){"use strict";cc._RFpush(e,"f21f6HkXeRGPab3wThiwH1M","NapXu");var i=t("EventDispatcherConstant"),a=t("EventDispatcher"),s=t("NetworkManager"),o=t("CommonConstant"),r=t("UiManager"),c=t("AuthUser"),h=t("Slider"),u=t("Utils"),l=t("Url");cc.Class({"extends":cc.Component,properties:{ipAmountLabel:cc.Label,ipLabel:cc.Label,ipSlider:h,xuAmountLabel:cc.Label,infoLabel:cc.Label,xuLabel:cc.Label},onLoad:function(){this.ipLabel.string="Số dư "+o.CurrencyType.Ip.DISPLAY_NAME,this.xuLabel.string="Số "+o.CurrencyType.Xu.DISPLAY_NAME+" nhận được",this.ipSlider.setDefaultValue(0,0,0),this.updateUserMoney(),a.addEventListener(i.PROFILE.UPDATE_MONEY,this.updateUserMoney,this)},onEnable:function(){this.fetchNapInfo()},onDestroy:function(){a.removeEventListener(i.PROFILE.UPDATE_MONEY,this.updateUserMoney,this)},updateUserMoney:function(){var t=c.currencies[o.CurrencyType.Ip.NAME].balance;this.ipAmountLabel.string=u.Number.format(t),this.xuAmountLabel.string="",this.ipAmount=0,this.napInfo&&(this.napInfo.min_ip>t?(this.ipSlider.node.active=!1,this.infoLabel.node.active=!0,this.infoLabel.string="Để chuyển được sang "+o.CurrencyType.Xu.DISPLAY_NAME+" thì số dư "+o.CurrencyType.Ip.DISPLAY_NAME+" tối thiểu là "+u.Number.format(this.napInfo.min_ip)):(this.ipSlider.node.active=!0,this.infoLabel.node.active=!1,this.ipSlider.setDefaultValue(this.napInfo.min_ip,t,0)))},fetchNapInfo:function(){var t=this;s.Http.fetch("GET",l.Http.MONEY_EX,{},{cache:1800}).success(function(e){t.napInfo=e.data,t.updateUserMoney()})},updateIPAmount:function(t){this.napInfo&&(this.ipAmount=t.currentValue,this.xuAmountLabel.string=u.Number.format(Math.floor(this.ipAmount*this.napInfo.ip_to_xu)))},confirmNapXu:function(t){this.ipAmount>0&&s.Http.fetch("POST",l.Http.MONEY_EX,{username:c.username,accesstoken:c.accesstoken,amount:this.ipAmount,currency_from:o.CurrencyType.Ip.NAME,currency_to:o.CurrencyType.Xu.NAME}).success(function(){r.openModal("Xin chúc mừng, bạn đã chuyển thành công.")}).setWaitingButton(t.target)}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",NetworkManager:"NetworkManager",Slider:"Slider",UiManager:"UiManager",Url:"Url",Utils:"Utils"}],NetworkManager:[function(t,e,n){"use strict";cc._RFpush(e,"35751alSNxLAYT4BmsbR/Ll","NetworkManager");var i=t("IplayHttp"),a=t("SysConfig"),s=t("UiManager"),o=t("SmartFox"),r=t("EventDispatcher"),c=t("PlatformImplement"),h=t("EventDispatcherConstant"),u=a.IplayHttp;i.init(u.HOST,u.PORT,u.PROTOCOL,u.AUTH_USER,u.AUTH_PASS),i.addInterceptor({request:function(t,e,n){n.cp=a.CP},response:function(t){if(t.status>=200&&t.status<400){var e=t.getResponseHeader("AntiDos");e?s.openModal("Bạn vui lòng xác thực để có thể tiếp tục chơi game!",{close_fn:function(){c.openWebUrl(e)}}):t.responseJson&&(30===t.responseJson.status?s.openConfirmModal("Phiên đăng nhập của bạn đã hết hạn. Bạn có muốn thoát ra để đăng nhập lại không?",{oke_fn:function(){c.returnLoginPage()}}):1!==t.responseJson.status&&s.openModal(t.responseJson.msg))}else s.openModal("Lỗi "+t.status+": "+t.statusText)}}),r.addEventListener(h.AUTH.LOGOUT,function(){i.resetCache()}),e.exports={Http:i,SmartFox:o},cc._RFpop()},{EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",IplayHttp:"IplayHttp",PlatformImplement:"PlatformImplement",SmartFox:"SmartFox",SysConfig:"SysConfig",UiManager:"UiManager"}],NoHu:[function(t,e,n){"use strict";cc._RFpush(e,"12b69Y/vJFAlIInkkgGuWju","NoHu"),cc.Class({"extends":cc.Component,properties:{lightNode:cc.Node,noHuNode:cc.Node,txtMoney:cc.Label},onLoad:function(){this.lightNode.runAction(cc.repeatForever(cc.rotateBy(0,1))),this.noHuNode.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(1,.92).easing(cc.easeBackOut()),cc.scaleTo(1,1).easing(cc.easeBackIn()))))},show:function(t){this.node.stopAllActions(),this.node.active=!0,this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){this.node.active=!1,t&&t()}.bind(this))))}}),cc._RFpop()},{}],Pagination:[function(t,e,n){"use strict";cc._RFpush(e,"aba18CuTRFC2oiIcw6qzgAL","Pagination");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{buttonTemplateNode:cc.Node,normalColor:cc.Color,activeColor:cc.Color,buttonListNode:cc.Node},onLoad:function(){},init:function(t,e){var n,i,a=t.pageList||t.page_list,s=t.jumpFirst||t.jump_first,o=t.jumpLast||t.jump_last,r=t.currentPage||t.current_page||0;for(this.buttonListNode.removeAllChildren(),s&&this._addPageButton(!1,{jumpFirst:s},e),i=0;i<a.length;i+=1)n=a[i],this._addPageButton(n===r,{page:n},e);o&&this._addPageButton(!1,{jumpLast:o},e)},_addPageButton:function(t,e,n){var a=cc.instantiate(this.buttonTemplateNode),s=a.getComponentInChildren(cc.Label),o=e.page,r=this;e.jumpFirst?o="<<":e.jumpLast&&(o=">>"),s.string=o,this._setButtonState(a,t),a.on(cc.Node.EventType.TOUCH_START,function(t){return function(){var e,a,s=r.buttonListNode.getChildren();for(a=0;a<s.length;a+=1)e=s[a],e===this?r._setButtonState(e,!0):r._setButtonState(e,!1);i.Type.isFunction(n)&&n(t)}}(e),a),a.active=!0,this.buttonListNode.addChild(a)},_setButtonState:function(t,e){t.getComponentInChildren(cc.Label).node.color=e?this.activeColor:this.normalColor}}),cc._RFpop()},{Utils:"Utils"}],PhomConstant:[function(t,e,n){"use strict";cc._RFpush(e,"e0e8fgbmsRLbJiVwEx0hsA4","PhomConstant"),e.exports={Action:{DISCARD:0,TAKE_CARD:1,ORDER_HAND:2,PICK_CARD:3,SENT_CARD:4,SHOW_OFF:5,AUTO_SHOW_OFF:6,CHANGE_TURN:7,U_PHOM:8},GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_FOR_NEW_GAME:2,DEALING:3,PLAYING:5,FINALIZING:6,FINISH:7},Finish:{U:0,THUA_TINH_DIEM:1,VE_NHI:2,VE_BA:3,VE_BET:4,MOM:5,AN_1_CAY:6,AN_2_CAY:7,AN_3_CAY:8,AN_CHOT:9,VE_NHAT:10},PlayerState:{WAITING:0,READY:1,IN_TURN:2,OUT_TURN:3,WAITING_FOR_TURN:4,FINISH:5},InTurnState:{PICK_OR_TAKE_CARD:0,
DISCARD:1,SHOW_OFF:2,SEND:3},Event:{START_GAME:"in_game.phom.start_game",ADD_PLAYER:"in_game.phom.add_player",REMOVE_PLAYER:"in_game.phom.remove_player",UPDATE_PLAYER:"in_game.phom.update_player",UPDATE_GAME:"in_game.phom.update_game",UPDATE_MASTER:"in_game.phom.update_master",UPDATE_HAND:"in_game.phom.update_hand",DRAW_CARD:"in_game.phom.draw_card",TIME_START:"in_game.phom.time_start",CHANGE_TURN:"in_game.phom.change_turn",DISCARD:"in_game.phom.discard_response",PICK_CARD:"in_game.phom.pick_card",TAKE_CARD:"in_game.phom.take_card",SHOW_OFF:"in_game.phom.show_off",AUTO_SHOW_OFF:"in_game.phom.auto_show_off",SENT_CARD:"in_game.phom.sent_card",SUBMIT_FAILT:"in_game.phom.sumbit_fail",REFRESH_GAME:"in_game.phom.refresh_game",WAITING_DEAL_CARD:"in_game.phom.waiting_deal_card",FINISH_GAME:"in_game.phom.finish_game"},Effect:{DANG_DANH:0,DANG_HA:1,DANG_BOC:2,DANG_GUI:3,MOM:4,U:5,NHAT:6,NHI:7,BA:8,BET:9,DEN_U:10,TAI_LUOT:11,U_KHONG_CA:12,U_TRON:13,DANG_DOI:14},GetTypeAction:function(t){switch(t){case 0:return"discard";case 1:return"takecard";case 2:return"orderhand";case 3:return"pickcard";case 4:return"sentcard";case 5:return"showoff";case 6:return"autoshowoff";case 7:return"changeturn";default:return t}}},cc._RFpop()},{}],PhomGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"1b1aeykCGtH3KYbjHTsYP74","PhomGameManager");var i,a=t("BaseGameManager"),s=t("NetworkManager"),o=t("SmartFoxConstant"),r=t("PhomConstant"),c=t("Utils");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_HAND.ID,this.onUpdateHand,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.PLAY.ID,this.onPlay,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.WAITING_DEAL_CARD.ID,this.onWaitingDealCard,this),this.gameType=1},onUpdateGame:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.UPDATE_GAME,t)},onFinishGame:function(t){this.gameState=r.GameState.FINISH,this.eventDispatchers.local.dispatchEvent(r.Event.FINISH_GAME,t)},onPlay:function(t){var e=t.action;switch(this.gameState=r.GameState.PLAYING,e){case r.Action.DISCARD:this.eventDispatchers.local.dispatchEvent(r.Event.DISCARD,t);break;case r.Action.TAKE_CARD:this.eventDispatchers.local.dispatchEvent(r.Event.TAKE_CARD,t);break;case r.Action.PICK_CARD:this.eventDispatchers.local.dispatchEvent(r.Event.PICK_CARD,t);break;case r.Action.SENT_CARD:this.eventDispatchers.local.dispatchEvent(r.Event.SENT_CARD,t);break;case r.Action.SHOW_OFF:this.eventDispatchers.local.dispatchEvent(r.Event.SHOW_OFF,t);break;case r.Action.AUTO_SHOW_OFF:this.eventDispatchers.local.dispatchEvent(r.Event.AUTO_SHOW_OFF,t);break;case r.Action.CHANGE_TURN:this.eventDispatchers.local.dispatchEvent(r.Event.CHANGE_TURN,t)}},onUpdateHand:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.UPDATE_HAND,t.allData)},onWaitingDealCard:function(t){this.gameState=r.GameState.WAITING_FOR_NEW_GAME,this.eventDispatchers.local.dispatchEvent(r.Event.WAITING_DEAL_CARD,t)},sendRequestStartGame:function(){this.send({command:s.SmartFox.type["byte"](o.Command.DEAL_CARD.ID)})},requestSentCard:function(t,e){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.SENT_CARD),card:s.SmartFox.type["byte"](t),cards:s.SmartFox.type.byteArray(e)})},requestTakeCard:function(){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.TAKE_CARD)})},requestShowOff:function(t){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.SHOW_OFF),cards:s.SmartFox.type.byteArray(t)})},requestPickCard:function(){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.PICK_CARD)})},requestDicard:function(t){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.DISCARD),card:s.SmartFox.type["byte"](t.getId())})},requestUPhom:function(){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.U_PHOM)})}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",PhomConstant:"PhomConstant",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],PhomOptionModal:[function(t,e,n){"use strict";cc._RFpush(e,"6ad70xnoMVBCoYbOoLRZ6q1","PhomOptionModal");var i=t("BaseGameOptionModal"),a=t("NetworkManager");cc.Class({"extends":i,properties:{},onLoad:function(){},_playUGameType:function(t){this.gameConfigs=this.gameConfigs||{},this.gameConfigs.acceptUTron=a.SmartFox.type.bool(t),this.enterGame()},playUTronGameType:function(){this._playUGameType(!0)},playUThuongGameType:function(){this._playUGameType(!1)}}),cc._RFpop()},{BaseGameOptionModal:"BaseGameOptionModal",NetworkManager:"NetworkManager"}],PhomUtils:[function(t,e,n){"use strict";cc._RFpush(e,"a8cf1Fy/MlLI5fDVaCynoeY","PhomUtils");var i=t("Card"),a=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},s=function(t){for(var e,n,i=0;i<t.length;i+=1)e=t[i],n=a(i,t.length-1),t[i]=t[n],t[n]=e},o=function(){for(var t=[],e=0;e<52;e+=1)t.push(i.fromId(e));return s(t),t.slice(0,12)},r=function(t,e,n,a){e.removeAllChildren();for(var s=0;s<t.length;s+=1){var o;o=cc.instantiate(a);var r=o.getComponent("CardUIPhom");o.parent=e,r.setCard(i.fromId(t[s].getId())),r.interactable=!0,r.canMove=!0,o.position=cc.p(0,0),n&&(o.setScaleX(.1),o.runAction(cc.scaleTo(.3,1)))}},c=function(t,e){return e?h(t):u(t)},h=function(t){var e,n=t.slice(),i=0;if(n=l(n),n=m(n),e=I(n),n=e[0],i+=e[1],i>=n.Count)return n;if(n=d(n,i),n=f(n,i),e=N(n,i),n=e[0],i+=e[1],i>=n.Count)return n;if(e=_(n,i),i+=e[1],n=e[0],i>=n.Count)return n;n=d(n,i),n=p(n,i);var a;return a=T(n,i),a.length>0&&(a=g(a),n=b(n,a)),a=M(a),a.length>0&&y(n,a,i),n},u=function(t){var e=0,n=0,i=t.slice();if(i=l(i),i=g(i),n=N(i),e+=n[1],i=n[0],e>=i.Count)return i;if(i=d(i,e),i=p(i,e),n=I(i,e),e+=n[1],i=n[0],e>=i.Count)return i;i=d(i,e),i=f(i,e);var a=A(i,e);return a&&a.length>0&&(a=m(a),i=b(i,a)),a=T(a,0),a&&a.length>0&&(i=E(i,a,e)),i},l=function(t){for(var e,n=0;n<t.length;n+=1)for(var i=n+1;i<t.length;i+=1)t[n]&&t[i]&&t[n].getId()>t[i].getId()&&(e=t[n],t[n]=t[i],t[i]=e);return t.reverse()},d=function(t,e){var n=t.slice(e,t.length);return n=l(n),b(t,n)},m=function(t){for(var e=t.slice(),n=t.length-1,i=0;n>0;){if(t[n].rank===t[n-1].rank){if(e.splice(n-1+i,2),e.splice(0,0,t[n]),e.splice(0,0,t[n-1]),n-2<0)break;if(t[n].rank===t[n-2].rank){if(e.splice(n+i,1),e.splice(0,0,t[n-2]),n-3<0)break;if(t[n].rank===t[n-3].rank){e.splice(n+i,1),e.splice(0,0,t[n-3]),i+=4,n-=3;continue}i+=3,n-=2;continue}i+=2}n-=1}return e},p=function(t,e){var n=t.slice(e,t.length);return n=m(n),b(t,n)},g=function(t){for(var e=0,n=[];e<t.length-1;){for(var i=e+1;i<t.length;i+=1)if(t[e].suit!==t[i].suit);else if(t[e].rank.ID-1===t[i].rank.ID||t[e].rank.ID-2===t[i].rank.ID){n=P(n,t[e]),n=P(n,t[i]),t=L(t,i,e+1);break}e+=1}return R(t,n)},f=function(t,e){var n=t.slice(e,t.length);return n=g(n),b(t,n)},_=function(t,e){var n=0;if(e<4)return[t,n];var i=t.slice(0,e);i=l(i),i=m(i);var a;if(a=I(i,a),a[1]<4)return[t,n];i=a[0],a=a[1];for(var s=t.slice(e,t.length),o=0,r=[];o<a-1&&!(i.length<o+4);){if(D(i.slice(o,o+4)))for(var c=i.slice(o,o+4),h=0;h<c.length;h+=1)if(r=[],r=C(c[h],s),r.length>2){i.splice(o+1,1),n=r.length-1,i=R(i,r);break}o+=3}return t=R(t,i),[t,n]},y=function(t,e,n){var i=t.slice(n,t.length),a=e.length-1,s=i.length-e.length;if(s<2||e.length<1)return t;for(;a>=0;){for(var o=0;o<s;o+=1)if(B(e[a],i[o])||B(i[o],e[a])){i.splice(o+1,0,e[a]),i.splice(s+a+1,1),s+=1;break}a-=1}return b(t,i)},E=function(t,e,n){var i=t.slice(n,t.length),a=e.length-1,s=i.length-e.length;if(s<2||e.length<1)return t;for(;a>=0;){for(var o=0;o<s;o+=1)if(O(e[a],i[o])){i.splice(o+1,0,e[a]),i.splice(s+a+1,1),a-=1,s+=1;break}a-=1}return b(t,i)},C=function(t,e){var n;return e.push(t),e=d(e,0),e=g(e,0),n=N(e,0),n[1]<3?[]:e=n[0].slice(0,n[1])},v=function(t){if(t.length<2)return t;for(var e=t.length-1;e>0;e-=1)if(t[e].rank===t[e-1].rank&&e+1<t.length)return t.slice(e+1,t.length);return t},T=function(t,e){var n=t.slice(e,t.length);return v(n)},S=function(t){if(t.length)return t;for(var e=t.length-2;e>0;e-=1)if(B(t[e-1],t[e]))return t.slice(e+1,t.length-2);return t},A=function(t,e){var n=t.slice(e,t.length);return S(n)},M=function(t){if(t.length<2)return t;for(var e=t.length-2;e>0;e-=1)if(B(t[e],t[e-1]))return t.slice(e+1,t.length-2);return t},I=function(t){for(var e=t.slice(),n=[],i=t.length-1,a=0;i>1;){if(n.length>0&&(n=[]),i>2){if(n.push(t[i]),n.push(t[i-1]),n.push(t[i-2]),n.push(t[i-3]),D(n)){n.reverse(),e=R(e,n),i-=4,a+=4;continue}n=[]}n.push(t[i]),n.push(t[i-1]),n.push(t[i-2]),D(n)?(n.reverse(),e=R(e,n),i-=3,a+=3):i-=1}return[e,a]},N=function(t,e){var n=t.slice(),i=[],a=t.length-1;for(e=0;a>1;){i.length>0&&(i=[]),i.push(t[a]);for(var s=a;s>0&&t[s].suit.ID===t[s-1].suit.ID&&t[s].rank.ID+1===t[s-1].rank.ID;s-=1)i.push(t[s-1]);G(i)?(n=R(n,i),e+=i.length,a-=i.length):a-=1}return[n,e]},R=function(t,e){t.splice.apply(t,[0,0].concat(e));for(var n=0;n<e.length;n+=1)for(var i=e.length;i<t.length;i+=1)if(e[n].getId()===t[i].getId()){t.splice(i,1);break}return t},b=function(t,e){t.splice.apply(t,[t.length,0].concat(e));for(var n=0;n<e.length;n+=1)for(var i=0;i<t.length-e.length;i+=1)if(e[n].getId()===t[i].getId()){t.splice(i,1);break}return t},L=function(t,e,n){var a=i.fromId(t[e].getId());return t.splice(e,1),t.splice(n,0,a),t},P=function(t,e){for(var n=e,i=0;i<t.length;i+=1)if(t[i].getId()===n.getId()){t.splice(i,1);break}return t.push(n),t},D=function(t){return!(t.length<3||t.length>4)&&(t[0].rank===t[1].rank&&t[0].rank===t[2].rank&&(!(t.length>3)||t[0].rank===t[3].rank))},G=function(t){if(t.length<3)return!1;t=l(t);for(var e=1;e<t.length-1;e+=1){if(t[e-1].suit!==t[e].suit||t[e].suit!==t[e+1].suit)return!1;if(t[e].rank.ID-1!==t[e+1].rank.ID||t[e-1].rank.ID-1!==t[e].rank.ID)return!1}return!0},B=function(t,e){return t.suit===e.suit&&(t.rank.ID-1===e.rank.ID||t.rank.ID-2===e.rank.ID)},O=function(t,e){return t.rank.ID===e.rank.ID};e.exports={MixArray:s,GetRandom:a,GeneratePackCards:o,ArrangeCardsDecrease:l,ArrangePositionCards:r,ArrangeCardsOptimize:c},cc._RFpop()},{Card:"Card"}],PlatformImplement:[function(t,e,n){"use strict";cc._RFpush(e,"1fffe3D7vJCIaNlIIj/4XjB","PlatformImplement");var i,a=t("UiManager");e.exports={uploadFile:function(t,e){var n=document.createElement("input");n.type="file",t=t||{},t.accept&&(n.accept=t.accept),n.addEventListener("change",function(t){var n,i=new FileReader;i.onload=function(t){e({fileName:n.name,fileType:n.type,value:t.target.result})},n=t.target.files[0],i.readAsBinaryString(n)}),n.click()},openWebUrl:function(t){window.open(t,"_blank")},callNumberPhone:function(t){var e=document.createElement("a"),n=window.onbeforeunload;e.href="tel:"+t,window.onbeforeunload=null,e.click(),window.onbeforeunload=n},guiTinNhan:function(t,e){function n(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)]}return[]}var i="?",a=n(),s=window.onbeforeunload,o=document.createElement("a");a[0]>=8?i="&":a[0]>1&&(i="j"),o.href="sms:"+t+i+"body="+encodeURIComponent(e),window.onbeforeunload=null,o.click(),window.onbeforeunload=s},getNhaMang:function(){return"VIETTEL"},returnLoginPage:function(){window.onbeforeunload=null,window.location.href="/login"},displayLogoutMessage:function(t){t&&window.alert(t)},logoutUser:function(){function t(){var t,e,n,i,a=document.cookie.split(";");for(i=0;i<a.length;i+=1)t=a[i],e=t.indexOf("="),n=e>-1?t.substr(0,e):t,document.cookie=n+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;"}t()},openLogoutConfirmationModal:function(){var e=this;a.openConfirmModal("Bạn có chắc muốn thoát khỏi game không?",{oke_fn:function(){e.logoutUser(),i||(i=t("NetworkManager")),i.SmartFox.disconnect()}})},setCursorToNormal:function(){this._changeCursor("auto")},setCursorToHand:function(){this._changeCursor("pointer")},_changeCursor:function(t){var e=document.getElementsByTagName("canvas"),n=e&&e[0];n&&(n.style.cursor=t)}},cc._RFpop()},{NetworkManager:"NetworkManager",UiManager:"UiManager"}],PlayerConstant:[function(t,e,n){"use strict";cc._RFpush(e,"8d2beqTHNRG2Zh+bRrvKcZ+","PlayerConstant"),e.exports={Event:{UPDATE_MONEY:"player.update_money"}},cc._RFpop()},{}],PlayerUIMauBinh:[function(t,e,n){"use strict";cc._RFpush(e,"0f74amSVbFAeLwENc0xXOhp","PlayerUIMauBinh");var i=t("Card"),a=t("Utils"),s=t("CardUI"),o=t("PlayerUI"),r=t("AuthUser"),c=t("MauBinhConstant"),h=t("CardLayoutMauBinh");cc.Class({"extends":cc.Component,properties:{lblMoneyChi:cc.Label,lblChiType:cc.Label,cardLayout:h,xepXongNode:cc.Node,cardPrefab:cc.Prefab},setGamePlay:function(t){this.gamePlay=t},onLoad:function(){this.timeEffectSwap=a.Number.random(2,5),this._resetFirstTime()},update:function(t){if(this.state===c.PlayerState.IN_TURN){if(this.time+=t,this.time>=this.timeEffectSwap){var e=this.node.getComponent(o).player;e&&e.data.username!==r.username&&(this.timeEffectSwap=a.Number.random(2,5),this.time=0,this.cardLayout.createEffectSwapCard())}if(this.runEffectCountDown){this.runEffectCountDown=!1;var n=(new Date).getTime(),i=this.timeOut-(n-this.startTime);i>0&&this.node.getComponent(o).setCountDown(i)}}},showCardLayout:function(t,e){this._resetFirstTime(),this.isSapHam=!1,this.isThangTrang=!1,this.cardAvatar.active=!1,this.cardLayout.layoutCard.active=!1,t&&(e?this.cardAvatar.active=!0:(this.cardAvatar.active=!1,this.cardLayout.showAllLayout()))},reset:function(){this.isActive=!1,this.isSapHam=!1,this.isThangTrang=!1,this.isOpenChi=[!1,!1,!1];var t=this.node.getComponent(o);t.clearCountDown(),t.removeWinEffect(),t.removeLoseEffect(),t.removeDrawEffect(),this.xepXongNode.active=!1,this.cardLayout.reset(),this.lblChiType.string="",this.lblMoneyChi.string="",this.cardAvatar&&(this.cardAvatar.active=!1)},setState:function(t,e,n){this._resetFirstTime(),this.state=t,this.startTime=(new Date).getTime(),this.timeOut=e,this.node.getComponent(o).clearCountDown(),t===c.PlayerState.IN_TURN?(this.isActive=!0,this.runEffectCountDown=!0,this.xepXongNode.active=!1,n&&this.setState(c.PlayerState.FINISH)):t===c.PlayerState.FINISH?(this.isActive=!0,this.runEffectCountDown=!1,this.xepXongNode.active=!0,this.xepXongNode.getComponentInChildren(cc.Label).string="XẾP XONG"):t===c.PlayerState.WAITING&&(this.isActive=!1,this.xepXongNode.active=!0,this.xepXongNode.getComponentInChildren(cc.Label).string="ĐANG ĐỢI")},unfoldChi:function(t,e,n){if(this._resetFirstTime(),!this.isOpenChi[t]){this.isOpenChi[t]=!0;for(var a=this.cardLayout.layoutCardList[t].getComponentsInChildren(s),o=0;o<a.length;o+=1){a[o].setCard(i.fromId(e[o]));var r=a[o].node;r.stopAllActions(),r.scale=1,n?(a[o].foldNode.active=!0,r.runAction(cc.sequence(cc.scaleTo(.2,0,1),cc.callFunc(function(){this.getChildByName("Fold").active=!1}.bind(r)),cc.scaleTo(.2,1,1)))):(a[o].unfoldNode.active=!0,a[o].foldNode.active=!1)}}},setOpenAllCards:function(t){this.isOpenChi=[!1,!1,!1];for(var e=0;e<3;e+=1){var n=t.slice(5*e,5*e+(e>=2?3:5));this.unfoldChi(e,n,!1)}},setOpenAllChiCards:function(t){this.isOpenChi=[!1,!1,!1];for(var e=0;e<t.length;e+=1)this.unfoldChi(e,t[e].hand,!1)},compareChi:function(t,e,n,i,a){var s=a===!0;if(this._resetFirstTime(),this.cardLayout.resetPosition(),this.xepXongNode.active=!1,this.cardAvatar.active=!1,this.isActive=n.isActive,this.state=c.PlayerState.ORDER_CARDS,!n.isThangTrang){var r,h=0;n.isBinhLung&&n.cards&&this.setOpenAllCards(n.cards),this.showCardLayout(this.isActive,!1),t===c.Action.COMPARE_CHI_MOT||e===c.GameState.COMPARE_1?(h=0,this.node.getComponent(o).clearCountDown()):t===c.Action.COMPARE_CHI_HAI||e===c.GameState.COMPARE_2?(h=1,this.isOpenChi[0]||this.unfoldChi(0,n.chiInfo[0].hand,!1)):t!==c.Action.COMPARE_CHI_BA&&e!==c.GameState.COMPARE_3||(h=2,this.isOpenChi[0]||this.unfoldChi(0,n.chiInfo[0].hand,!1),this.isOpenChi[1]||this.unfoldChi(1,n.chiInfo[1].hand,!1)),this.cardLayout.showBinhLung(n.isBinhLung);var u=!(s||n.isBinhLung);if(this.unfoldChi(h,n.chiInfo[h].hand,u),n.isBinhLung?(this.lblChiType.node.scale=1,this.lblChiType.string="Binh Lủng"):(this.lblChiType.node.scale=0,this.lblChiType.node.stopAllActions(),s?this.lblChiType.node.scale=1:this.lblChiType.node.runAction(cc.scaleTo(.8,1)),this.lblChiType.string=n.chiInfo[h].type),!s&&i){var l=0;for(r=0;r<i.length;r+=1){var d=i[r].sourcePlayer,m=i[r].targetPlayer,p=this.node.getComponent(o).player.data.username;p===d&&(l-=i[r].moneyExchange,this.isSapHam=i[r].isSapHam),p===m&&(l+=i[r].moneyExchange)}this.showMoneyEffect(l)}if(!n.isBinhLung&&!n.isThangTrang)for(var g=0;g<3;g+=1){var f=g===h;this.cardLayout.layoutCardList[g].active=f,this.isOpenChi[g]=f}}},showMoneyEffect:function(t){this.lblMoneyChi.node.color=cc.Color.YELLOW,this.lblMoneyChi.string=(t>=0?"+":"")+a.Number.abbreviate(t);var e=this.node.x>0?-90:90,n=30;this.lblMoneyChi.node.position=new cc.Vec2(e,n),this.lblMoneyChi.node.stopAllActions(),this.lblMoneyChi.node.opacity=255;var i=cc.spawn(cc.moveBy(3,cc.p(0,90)),cc.fadeTo(3,0));i.easing(cc.easeQuadraticActionOut()),this.lblMoneyChi.node.runAction(i);var s=this.node.getComponent(o).player;this.gamePlay&&s.data.username===r.username&&(t>=0?this.gamePlay.audioManager.playChickenWin():this.gamePlay.audioManager.playLost())},setThangTrang:function(t){this.isThangTrang=!0,this.cardLayout.showAllLayout(),this.cardLayout.foldAllCard(),this.setOpenAllCards(t.hand),this.cardLayout.imgThangTrang.active=!0,this.cardLayout.imgThangTrang.getComponentInChildren(cc.Label).string=t.type},setResult:function(t,e){if(this._resetFirstTime(),this.isActive=t.isActive,this.xepXongNode.active=!1,t.isActive){this.cardLayout.showAllLayout(),this.cardLayout.foldAllCard(),this.setOpenAllChiCards(t.chiInfo),this.lblChiType.string="",this.lblMoneyChi.string="";var n=t.username===r.username;e>0?(this.node.getComponent(o).setWinEffect(e),this.gamePlay&&n&&this.gamePlay.audioManager.playWin()):0===e?(this.node.getComponent(o).setDrawEffect(e),this.gamePlay&&n&&this.gamePlay.audioManager.playWin()):(this.node.getComponent(o).setLoseEffect(e),this.gamePlay&&n&&this.gamePlay.audioManager.playLose()),t.isBinhLung&&(this.lblChiType.string="Binh Lủng"),this.isSapHam&&(this.cardLayout.imgThuaSapHam.active=!0)}},_resetFirstTime:function(){if(this.time=0,!this.callResetFisrtTime){this.callResetFisrtTime=!0,this.lblMoneyChi.node.active=!0,this.node.x>0?this.lblChiType.node.x=-184:this.lblChiType.node.x=180,this.isOpenChi=[!1,!1,!1];var t=-130;this.node.x<0&&(t=130),this.cardAvatar=cc.instantiate(this.cardPrefab),this.cardAvatar.scale=.5,this.cardAvatar.x=t,this.cardAvatar.active=!1,this.node.addChild(this.cardAvatar),this.reset(),this.runEffectCountDown=!1}}}),cc._RFpop()},{AuthUser:"AuthUser",Card:"Card",CardLayoutMauBinh:"CardLayoutMauBinh",CardUI:"CardUI",MauBinhConstant:"MauBinhConstant",PlayerUI:"PlayerUI",Utils:"Utils"}],PlayerUIPhomCurrent:[function(t,e,n){"use strict";cc._RFpush(e,"2d3a6zla7hKb6GejtMzVxFz","PlayerUIPhomCurrent");var i=t("PlayerUIPhom"),a=t("Card"),s=t("PhomUtils");cc.Class({"extends":i,properties:{},onLoad:function(){i.prototype.onLoad.call(this)},onUpdateHand:function(t){i.prototype.onUpdateHand.call(this,t)},onRefreshGame:function(t){i.prototype.onRefreshGame.call(this,t)},drawOnPortDanh:function(t){i.prototype.drawOnPortDanh.call(this,t)},drawOnPortDeal:function(t){this.portCardDealNode.removeAllChildren();for(var e,n=0;n<t.length;n+=1)e=cc.instantiate(this.cardPrefab),e.parent=this.portCardDealNode,e.getComponent("CardUIPhom")&&(e=e.getComponent("CardUIPhom"),e.setCard(a.fromId(t[n])))},drawOnPortAn:function(t){if(!(t.length<1)){this.portCardAnNode.removeAllChildren();for(var e=this.portCardDealNode.children,n=0;n<t.length;n+=1)for(var i=0;i<e.length;i+=1)if(e[i].getComponent("CardUIPhom")){var a=e[i].getComponent("CardUIPhom");if(t[n]===a.card.getId()){a.hoverAnNode.active=!0;break}}}},drawOnPortShow:function(t){i.prototype.drawOnPortShow.call(this,t)},clearStateAction:function(){i.prototype.clearStateAction.call(this)},onXepLaiBai:function(){this.myCards=this.getMyCards(),this.myCards=s.ArrangeCardsOptimize(this.myCards,!0),s.ArrangePositionCards(this.myCards,this.portCardDealNode)},getMyCards:function(){for(var t=[],e=this.portCardDealNode.children,n=0;n<e.length;n+=1)e[n].getComponent("CardUIPhom")&&t.push(e[n].getComponent("CardUIPhom").card);return t},getCardTouched:function(){for(var t=this.portCardDealNode.children,e=0;e<t.length;e+=1)if(t[e].getComponent("CardUIPhom")&&t[e].getComponent("CardUIPhom").isTouched)return t[e].getComponent("CardUIPhom").card;return null},setStateCardInShowOff:function(t){for(var e=[],n=0;n<t.length;n+=1)for(var i=0;i<t[n].length;i+=1)e.push(t[n][i]);for(var a=this.portCardDealNode.children,s=0;s<e.length;s+=1)for(var o=0;o<a.length;o+=1)if(a[o].getComponent("CardUIPhom")&&a[o].getComponent("CardUIPhom").card.getId()===e[s]){a[o].getComponent("CardUIPhom").setMoveCardUpDown(!0);break}},onSentCard:function(){},onShowOffCard:function(){},onTakeCard:function(){},onDiscard:function(t){for(var e,n=this,i=this.portCardDealNode.children,a=0;a<i.length;a+=1)if(i[a].getComponent("CardUIPhom")&&(e=i[a].getComponent("CardUIPhom"),e.card.getId()===t)){e=i[a];break}if(e){e.node.setSiblingIndex(99);var s=cc.sequence(cc.callFunc(function(){cc.scaleTo(n.TIME_MOVE_CARD,.6)}),cc.moveTo(n.TIME_MOVE_CARD,n.portCardDanhNode),cc.callFunc(function(){e.node.parent=n.portCardDanhNode,e.buttonOnCard.interactable=!1,e.node.scale=1}));e.node.runAction(s)}}}),cc._RFpop()},{Card:"Card",PhomUtils:"PhomUtils",PlayerUIPhom:"PlayerUIPhom"}],PlayerUIPhom:[function(t,e,n){"use strict";cc._RFpush(e,"98b5a4CFE9KypFF/RuZha8m","PlayerUIPhom");var i=t("Card"),a=t("PlayerUITLMN"),s=t("PhomConstant"),o=t("AuthUser"),r=t("Utils"),c=t("PhomUtils");cc.Class({"extends":a,properties:{portCardShowNode:{"default":[],type:cc.Node},portCardAnNode:cc.Node,buttonGuiList:{"default":[],type:cc.Button},pointLabel:cc.Label,KHOANG_CACH_QUAN_BAI:{"default":55,override:!0,visible:!1},CONSTANT_X:{"default":0,override:!0,visible:!1},CONSTANT_Y:{"default":0,override:!0,visible:!1},CONSTANT_ROTATION:{"default":0,override:!0,visible:!1}},onLoad:function(){a.prototype.onLoad.call(this),this.phomList=[],this._isSanhFirst=!1},setStateAction:function(t){switch(this.action=t,t){case s.Action.DISCARD:this.setEffect(s.Effect.DANG_DANH);break;case s.Action.PICK_CARD:this.setEffect(s.Effect.DANG_BOC);break;case s.Action.SHOW_OFF:this.setEffect(s.Effect.DANG_HA);break;case s.Action.SENT:this.setEffect(s.Effect.DANG_GUI)}},setStateInTurn:function(t){switch(t){case s.InTurnState.DISCARD:this.setEffect(s.Effect.DANG_DANH),this.action=s.Action.DISCARD;break;case s.InTurnState.PICK_OR_TAKE_CARD:this.setEffect(s.Effect.DANG_BOC),this.action=s.Action.PICK_CARD;break;case s.InTurnState.SHOW_OFF:this.setEffect(s.Effect.DANG_HA),this.action=s.Action.SHOW_OFF;break;case s.InTurnState.SEND:this.setEffect(s.Effect.DANG_GUI),this.action=s.Action.SENT}},onUpdateGame:function(){this.onRefreshGame(!1)},onRefreshGame:function(t,e){if(this.player){if(this.player.data.handSize>0&&!t)if(this.player.data.username===o.username){if(cc.log("sađâsdaaaaaaaâ"),this.player.data.cards){for(var n=this.cardHold.children,i=!1,a=0;a<n.length;a+=1){var s=n[a].getComponent("CardUIPhom");if(i=!1,s&&s.card)for(var c=0;c<this.player.data.cards.length;c+=1)if(s.card.getId()===this.player.data.cards[c]){i=!0;break}if(!i)break}i&&n.length===this.player.data.cards.length||this.reDrawPort(this.cardHold,this.player.data.cards,!0,!0,!0),e?e.isPlayerTakeCard?this.onXepLaiBai(!1):e.isPickCardPhom&&this.checkRefCard(e.cardId)&&this.onXepLaiBai(!1):this.onXepLaiBai(!1)}}else this.backCardNode.active=!0;this.reDrawPort(this.portCardTrash,this.player.data.trash,!1,!1),t||this.player.data.username!==o.username&&(this.player.data.phomList.length>0?r.Node.destroyAllChildrenInNode(this.portCardAnNode):this.reDrawPort(this.portCardAnNode,this.player.data.takenCards,!1,!0));for(var h=0;h<this.portCardShowNode.length;h+=1)this.reDrawPort(this.portCardShowNode[h],this.player.data.phomList[h],!1,!1)}},clearAll:function(){r.Node.destroyAllChildrenInNode(this.portCardAnNode),r.Node.destroyAllChildrenInNode(this.portCardTrash),r.Node.destroyAllChildrenInNode(this.cardHold);for(var t=0;t<this.portCardShowNode.length;t+=1)r.Node.destroyAllChildrenInNode(this.portCardShowNode[t]);this.backCardNode&&(this.backCardNode.active=!1),this.phomList&&(this.phomList=[]);for(var e=0;e<this.buttonGuiList.length;e+=1)this.buttonGuiList[e].node.active=!1;this.pointLabel.string="",this.clearEffects()},hideGuiButtons:function(){for(var t=0;t<this.buttonGuiList.length;t+=1)this.buttonGuiList[t].node.active=!1},reDrawPort:function(t,e,n,a,s){var r;if(t.getComponent(cc.Layout).enabled=!0,t.removeAllChildren(),e)for(r=0;r<e.length;r+=1){var c=cc.instantiate(this.cardPrefab),h=c.getComponent("CardUIPhom");if(h.setCard(i.fromId(e[r])),c.parent=t,c.position=cc.p(0,0),h.interactable=n,h.canMove=s,a)if(this.player.data.username===o.username){for(var u=0;u<this.player.data.takenCards.length;u+=1)if(e[r]===this.player.data.takenCards[u]){h.hoverAnNode.active=!0;break}}else h.hoverAnNode.active=!0}},onSentCard:function(t,e,n){if(n){for(var i=0;i<e.length;i+=1)for(var a=0;a<this.phomList.length;a+=1)if(e[i]===this.phomList[a].cardId)return void this.initEffectCard([t],this.portCardShowNode[this.phomList[a].index],n.cardHold,n);this.backCardNode&&(this.player.data.handSize<=0?this.backCardNode.active=!1:this.numberCardLabel&&(this.numberCardLabel.string=this.player.data.handSize))}},onShowOffCard:function(t){if(t){var e=0;this.portCardShowNode[0].children.length>0&&(e=1),this.portCardShowNode[1].children.length>0&&(e=2);for(var n=0;n<t.length;n+=1){var i=t[n];if(i){for(var a=!1,s=0;s<this.phomList.length;s+=1)if(i[0]===this.phomList[s].cardId){a=!0;break}if(a)continue;this.initEffectCard(i,this.portCardShowNode[e],this.cardHold,this),this.portCardAnNode!==this.cardHold&&r.Node.destroyAllChildrenInNode(this.portCardAnNode),this.phomList.push({cardId:i[0],index:n}),e+=1}}this.backCardNode&&(this.player.data.handSize<=0?this.backCardNode.active=!1:this.numberCardLabel&&(this.numberCardLabel.string=this.player.data.handSize))}},onPickCard:function(t){var e=this,n=this.player&&this.player.data;if(n){var a=cc.instantiate(this.cardPrefab);a.setScale(.5,.5),a.parent=this.dealerNode;var s=this.node.x,r=this.node.y+20,c=a.parent.convertToWorldSpace(a.position);if(this.player.data.username===o.username){this.cardHold.getComponent(cc.Layout).enabled=!1,a.parent=this.cardHold,a.position=this.cardHold.convertToNodeSpace(c),a.setScale(.7);var h=this.cardHold.childrenCount,u=a.width;r=0,s=h*(u+this.cardHold.getComponent(cc.Layout).spacingX)}else a.parent=this.backCardNode,a.position=this.backCardNode.convertToNodeSpace(c),a.zIndex=2,r=0,s=0;var l=cc.sequence(cc.spawn(cc.moveTo(.5,cc.p(s,r)),cc.rotateTo(.5,135)),cc.callFunc(function(){if(a.rotation=0,this.player.data.username===o.username?this.cardHold.getComponent(cc.Layout).enabled=!0:(a.position=cc.p(0,0),a.parent=this.cardHold),a.setSiblingIndex(this.cardHold.childrenCount),a.getComponent("CardUIPhom")){var e=a.getComponent("CardUIPhom");e.setCard(i.fromId(t)),e.interactable=!0,e.canMove=!0}null===t&&a.destroy()},this),cc.scaleTo(.1,1),cc.callFunc(function(){var i=!1,s=e.findCard(t,e.portCardTrash);if(s&&(i=!0),n.cards){for(var o=0;o<n.cards.length;o+=1)if(t===n.cards[o]){i=!0;break}i||a.destroy()}e.node.emit("refresh_game",{isPickCardPhom:!0,cardId:t})},this));l.easing(cc.easeQuadraticActionOut()),a.runAction(l)}},onTakeCard:function(t){var e=this.findCard(t,this.portCardAnNode);if(e)return e.setCard(i.fromId(t)),this.player.data.username===o.username?e.interactable=!0:e.interactable=!1,void(e.hoverAnNode.active=!0)},setStateCardInShowOff:function(t){if(t)for(var e=0;e<t.length;e+=1){var n=t[e];if(n)for(var i=0;i<n.length;i+=1){var a=this.findCard(n[i],this.cardHold);a&&(a.interactable=!0,a.onButtonTouch())}}},showGuiButtonInPhoms:function(t,e,n){for(var i=this,a=0;a<e.length;a+=1)for(var s=0;s<this.phomList.length;s+=1)if(e[a]===this.phomList[s].cardId)return this.buttonGuiList[s].node.active=!0,void this.buttonGuiList[s].node.on(cc.Node.EventType.TOUCH_START,function(){i.sendPhom(t,e,n)})},sendPhom:function(t,e,n){n.requestSentCard(t,e)},effectTakenCard:function(t,e){this.initEffectCard([e],t.portCardAnNode,this.portCardTrash,this,!0,t)},showRankAndMoneyExchange:function(t,e,n,i){if(this.clearCountDown(),this.clearEffects(),this.showMoneyExchange(t),i)this.addEffect(s.Effect.DEN_U);else if(n)this.setEffect(s.Effect.U);else switch(e){case s.Finish.VE_NHI:this.addEffect(s.Effect.NHI);break;case s.Finish.VE_BA:this.addEffect(s.Effect.BA);break;case s.Finish.VE_BET:this.addEffect(s.Effect.BET);break;case s.Finish.MOM:this.addEffect(s.Effect.MOM);break;case s.Finish.VE_NHAT:this.addEffect(s.Effect.NHAT);break;case s.Finish.U:this.addEffect(s.Effect.BET)}},findAndDeleteCard:function(t,e){if(e)for(var n=e.children,i=0;i<n.length;i+=1){var a=n[i].getComponent("CardUIPhom");if(a&&a.card&&a.card.getId()===t)return a.node.destroy(),!0}return!1},onXepLaiBai:function(){var t=this;this.cardUIPhomList=[],this.myCards=this.getMyCards();var e=c.ArrangeCardsOptimize(this.myCards,this._isSanhFirst),n=this.cardHold.getComponent(cc.Layout);n.enabled=!1;for(var i=this.cardHold.getComponent(cc.Layout).spacingX,a=0;a<e.length;a+=1)for(var s=0;s<this.cardUIPhomList.length;s+=1)if(e[a].getId()===this.cardUIPhomList[s].card.getId()){var o=this.cardUIPhomList[s].node.width,r=o/2;this.cardUIPhomList[s].node.runAction(cc.sequence(cc.moveTo(t.TIME_MOVE_CARD,cc.p(r+a*(i+o),t.cardUIPhomList[s].node.y)),cc.callFunc(function(){n.enabled=!0}))),this.cardUIPhomList[s].node.setSiblingIndex(a)}},getMyCards:function(){for(var t=[],e=this.cardHold.children,n=0;n<e.length;n+=1){var i=e[n].getComponent("CardUIPhom"),a=!1;if(i){for(var s=0;s<this.player.data.cards.length;s+=1)if(i.card.getId()===this.player.data.cards[s]){a=!0;break}a?(t.push(i.card),this.cardUIPhomList.push(i)):i.node.destroy()}}return t},checkRefCard:function(t){for(var e=0;e<this.player.data.cards.length;e+=1)if(t!==this.player.data.cards[e]){var n=Math.floor(t/4),i=Math.floor(this.player.data.cards[e]/4),a=t%4,s=this.player.data.cards[e]%4;if(n===i||a===s&&(1===Math.abs(n-i)||2===Math.abs(n-i)))return!0}return!1},khoangCach2Diem:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}}),cc._RFpop()},{AuthUser:"AuthUser",Card:"Card",PhomConstant:"PhomConstant",PhomUtils:"PhomUtils",PlayerUITLMN:"PlayerUITLMN",Utils:"Utils"}],PlayerUITLMN:[function(t,e,n){"use strict";cc._RFpush(e,"11f6869P89Fj49sHooPfUUt","PlayerUITLMN");var i=t("Card"),a=t("Utils"),s=t("AuthUser"),o=t("PlayerUI");cc.Class({"extends":o,properties:{cardHold:cc.Node,portCardTrash:cc.Node,backCardNode:cc.Node,moneyExchangeLabel:cc.Label,numberCardLabel:cc.Label,cardPrefab:cc.Prefab,dealerNode:cc.Node,TIME_MOVE_CARD:{"default":.3,visible:!1},KHOANG_CACH_QUAN_BAI:{"default":55,visible:!1},CONSTANT_X:{"default":100,visible:!1},CONSTANT_Y:{"default":50,visible:!1},CONSTANT_ROTATION:{"default":0,visible:!1},Hold:cc.Node},onUpdateHand:function(t,e,n){a.Node.destroyAllChildrenInNode(this.cardHold),e>0&&this.drawOnPortDeal(t,e,n)},drawOnPortDeal:function(t,e,n){var i,a=0,s=.5,o=.06,r=0,c=0,h=1;for(this.numberCard=0,c=0;c<e;c+=1){i=cc.instantiate(this.cardPrefab),i.setScale(.4,.4),i.parent=this.dealerNode,a+=1,h+=1;var u;u=t?t[c]:null,this.hieuUngChiaBai(i,s,o*a,r,h,u,e,n)}e>0&&this.backCardNode&&(this.backCardNode.active=!0,this.numberCardLabel&&(this.numberCardLabel.string=0))},hieuUngChiaBai:function(t,e,n,a,s,o,r,c){var h=this;t.stopAllActions();var u=cc.sequence(cc.delayTime(n),cc.spawn(cc.moveTo(e,cc.p(h.Hold.x,h.Hold.y)),cc.rotateTo(e,a)),cc.callFunc(function(){
h.numberCard+=1,h.numberCard>r&&(h.numberCard=r),h.numberCardLabel&&(h.numberCardLabel.string=h.numberCard)},this),cc.delayTime(e/2),cc.callFunc(function(){if(h.player&&this.cardHold.childrenCount>=r)return void t.destroy();if(t.rotation=0,t.position=cc.p(0,0),t.parent=this.cardHold,t.setSiblingIndex(s),t.getComponent("CardUIPhom")){var e=t.getComponent("CardUIPhom");e.canMove=c,e.setCard(i.fromId(o)),e.interactable=!0}(null===o||h.findCard(o,h.portCardTrash))&&t.destroy()},this),cc.scaleTo(.1,1));u.easing(cc.easeQuadraticActionOut()),t.runAction(u)},onDiscard:function(t){t&&(this.initEffectCard(t,this.portCardTrash,this.cardHold,this),this.backCardNode&&(this.player.data.handSize<=0&&(this.backCardNode.active=!1),this.numberCardLabel&&(this.numberCardLabel.string=this.player.data.handSize)))},initEffectCard:function(t,e,n,i,a,s){if(t){var o=Math.random(),r=Math.random();o=(o<.5?-o:o)*this.CONSTANT_X,r=(r<.5?-r:r)*this.CONSTANT_Y;var c=Math.random();if(c*=(c<.5?-c:c)*this.CONSTANT_ROTATION,e&&e.getComponent(cc.Layout)){e.getComponent(cc.Layout).enabled=!1,r=0,c=0;var h=0===e.anchorX?1:-1,u=1===h?e.childrenCount:0,l=cc.instantiate(this.cardPrefab),d=l.width;l.destroy(),o=h*(d/2+u*(d+e.getComponent(cc.Layout).spacingX))}c=0;for(var m=0;m<t.length;m+=1){var p=null,g=t[m],f=this.findCard(g,n),_=!1;f&&(p=f.node,_=!0),p||(p=cc.instantiate(this.cardPrefab),i.backCardNode?(p.parent=i.backCardNode,p.position=cc.p(0,0)):(p.parent=n,p.position=cc.p(0,0)));var y;y=p.parent.convertToWorldSpaceAR(p.position),p.parent=e,e&&(p.position=e.convertToNodeSpaceAR(y),p.setSiblingIndex(e.childrenCount),this.effectCard(p,m,o,r,c,e,_,g,a,s)),p.getComponent("CardUIPhom").interactable=!1}this.numberCardLabel&&(this.numberCardLabel.string=this.player.data.handSize)}},effectCard:function(t,e,n,a,o,r,c,h,u,l){var d=this;t.stopAllActions();var m=cc.sequence(cc.spawn(cc.moveTo(d.TIME_MOVE_CARD,cc.p(n+e*this.KHOANG_CACH_QUAN_BAI,a)),cc.rotateTo(d.TIME_MOVE_CARD,o)),cc.callFunc(function(){t.getComponent("CardUIPhom").setCard(i.fromId(h));var e=!1;u&&(t.getComponent("CardUIPhom").hoverAnNode.active=!0,d.player.data.username===s.username?(t.getComponent("CardUIPhom").interactable=!0,t.getComponent("CardUIPhom").canMove=!0):t.getComponent("CardUIPhom").interactable=!1,l.player.data.username===s.username&&(e=!0)),r.getComponent(cc.Layout)&&(r.getComponent(cc.Layout).enabled=!0),d.node.emit("refresh_game",{isPlayerTakeCard:e})}));m.easing(cc.easeQuadraticActionOut()),t.runAction(m)},onRefreshGame:function(){},findCard:function(t,e){if(e)for(var n=e.children,i=0;i<n.length;i+=1){var a=n[i].getComponent("CardUIPhom");if(a&&a.card&&a.card.getId()===t)return a}return null},getCardTouched:function(){for(var t=this.cardHold.children,e=[],n=0;n<t.length;n+=1){var i=t[n].getComponent("CardUIPhom");i&&i.isTouched&&e.push(i)}return e},clearAll:function(){a.Node.destroyAllChildrenInNode(this.cardHold),this.clearCountDown(),this.backCardNode&&(this.backCardNode.active=!1),this.clearEffects()},showAllCards:function(t){a.Node.destroyAllChildrenInNode(this.cardHold),this.portCardAnNode&&a.Node.destroyAllChildrenInNode(this.portCardAnNode),this.backCardNode&&(this.backCardNode.active=!1);for(var e=0;e<t.length;e+=1){var n=cc.instantiate(this.cardPrefab);n.parent=this.cardHold,n.getComponent("CardUIPhom").setCard(i.fromId(t[e])),n.getComponent("CardUIPhom").interactable=!1,n.setScale(0,1),n.runAction(cc.scaleTo(.3,1))}},showTrashCard:function(t){var e,n=Math.random(),a=Math.random();n=(n<.5?-n:n)*this.CONSTANT_X,a=(a<.5?-a:a)*this.CONSTANT_Y;var s=Math.random();s*=(s<.5?-s:s)*this.CONSTANT_ROTATION;for(var o=0;o<t.length;o+=1){e=cc.instantiate(this.cardPrefab),e.parent=this.portCardTrash;var r=e.getComponent("CardUIPhom");r.setCard(i.fromId(t[o])),r.interactable=!1,e.position=cc.p(n+o*this.KHOANG_CACH_QUAN_BAI,a),e.rotation=s}},showMoneyExchange:function(t){this.moneyExchangeLabel.node.y=30,this.moneyExchangeLabel.node.opacity=255,this.moneyExchangeLabel.node.active=!0,t>0?this.moneyExchangeLabel.string="+"+a.Number.abbreviate(t):this.moneyExchangeLabel.string=a.Number.abbreviate(t),this.moneyExchangeLabel.node.stopAllActions(),this.moneyExchangeLabel.node.runAction(this.moneyExchangeAction)},onRefresh:function(){var t=this.getCardTouched();if(a.Node.destroyAllChildrenInNode(this.cardHold),this.cardHold.getComponent(cc.Layout).enabled=!0,this.player.data.cards)for(var e=this.player.data.cards,n=0,s=0;n<e.length;n+=1){var o=cc.instantiate(this.cardPrefab),r=o.getComponent("CardUIPhom");r.setCard(i.fromId(e[n])),o.parent=this.cardHold,o.position=cc.p(0,0),r.interactable=!0,t&&t[s]&&t[s].card.getId()===e[n]&&(r.isTouched=!0,r.node.setPosition(0,r.posYFirst+r.DELTA_Y_TOUCHED),s+=1)}else this.backCardNode&&this.player.data.handSize&&(this.backCardNode.active=!0,this.numberCardLabel.string=this.player.data.handSize)}}),cc._RFpop()},{AuthUser:"AuthUser",Card:"Card",PlayerUI:"PlayerUI",Utils:"Utils"}],PlayerUIXiTo:[function(t,e,n){"use strict";cc._RFpush(e,"7bd4cN9xFVHU6Y+P7+jwsND","PlayerUIXiTo");var i=t("CardUI"),a=t("GameConstant"),s=t("Card");cc.Class({"extends":cc.Component,properties:{cardsHold:{"default":[],type:i},callMoneyLabel:cc.Label,callMoneyNode:cc.Node,cardsResultLabel:cc.Label,holdNode:cc.Node},onLoad:function(){this.trashCards=[]},getNumberActiveChildren:function(){for(var t=0,e=0;e<this.cardsHold.length;e+=1)this.cardsHold[e].node.active&&(t+=1);return t},fold:function(){for(var t=0;t<this.cardsHold.length;t+=1)this.cardsHold[t].fold(),this.cardsHold[t].node.position=cc.p(this.cardsHold[t].node.x,0)},currentPlayerFold:function(){for(var t=0;t<this.cardsHold.length;t+=1)this.cardsHold[t].node.active&&(this.cardsHold[t].showTransparentBlackNode(!0),this.cardsHold[t].node.position=cc.p(this.cardsHold[t].node.x,0))},hideAllCards:function(t){for(var e=0;e<this.cardsHold.length;e+=1)this.cardsHold[e].showTransparentBlackNode(!1),this.cardsHold[e].node.position=cc.p(this.cardsHold[e].node.x,0),this.cardsHold[e].node.active=!1,t||this.cardsHold[e].fold()},deactiveAllCards:function(){if(this.hideAllCards(!1),this.cardsResultLabel.string="",this.trashCards)for(var t=0;t<this.trashCards.length;t+=1)this.trashCards[t].destroy();this.trashCards=[]},showAllCards:function(t,e,n,i,o){if(i!==a.POKER.CMD){if(t)for(var r=0;r<t.length;r+=1){var c=this.cardsHold[r].getComponent("CardUI");if(c.fold(),this.cardsHold[r].node.stopAllActions(),this.cardsHold[r].node.active=!0,this.cardsHold[r].node.setScale(1),this.cardsHold[r].showTransparentBlackNode(!0),c.setCard(s.fromId(t[r])),e)for(var h=0;h<e.length;h+=1)if(t[r]===e[h]){this.cardsHold[r].showTransparentBlackNode(!1),this.cardsHold[r].node.runAction(cc.moveTo(.1,cc.p(this.cardsHold[r].node.x,30)));break}}n&&(this.cardsResultLabel.string=n.toUpperCase())}else this.showAllCardsPoker(t,e,n,o)},showAllCardsPoker:function(t,e,n,i){for(var a=0;a<this.trashCards.length;a+=1)this.trashCards[a].destroy();if(this.trashCards=[],t)for(var o=0;o<t.length;o+=1){this.cardsHold[o].node.active=!1,this.cardsHold[o].fold();var r=cc.instantiate(this.cardsHold[o].node),c=r.getComponent("CardUI");r.parent=this.cardsHold[o].node.parent.parent,r.x=0===o?-17:17,r.y=10,r.rotation=0,r.setScale(0,.55),c.setCard(s.fromId(t[o])),r.active=!0,r.runAction(cc.sequence(cc.scaleTo(.5,.55),cc.delayTime(i),cc.removeSelf())),this.trashCards.push(r)}n&&(this.cardsResultLabel.string=n.toUpperCase())},findCard:function(t){for(var e=0;e<this.cardsHold.length;e+=1){var n=this.cardsHold[e].getComponent("CardUI");if(n.card&&n.card.getId()===t)return this.cardsHold[e]}}}),cc._RFpop()},{Card:"Card",CardUI:"CardUI",GameConstant:"GameConstant"}],PlayerUI:[function(t,e,n){"use strict";cc._RFpush(e,"15458hBSZhEhY4yBNZfQwrR","PlayerUI");var i=t("UrlImage"),a=t("Utils"),s=t("PlayerConstant");cc.Class({"extends":cc.Component,properties:{emptyNode:cc.Node,nonEmptyNode:cc.Node,defaultEffectTemplatesPrefab:cc.Prefab,effectTemplateNodeList:{"default":[],type:cc.Node},backEffectListNode:cc.Node,frontEffectListNode:cc.Node,countDownContainerNode:cc.Node,countDownSprite:cc.Sprite,avatarImage:i,usernameLabel:cc.Label,balanceLabel:cc.Label,chatCalloutDuration:5e3,normalUsernameColor:cc.Color,mainUsernameColor:cc.Color,normalCountDownColor:new cc.Color(0,255,0,255)},onLoad:function(){this.TIME_EFFECT_MONEY_EXCHANGE=3,this.TIME_EFFECT_MONEY_EXCHANGE_FADE_OUT=.3,this.moneyExchangeAction=cc.spawn(cc.moveBy(this.TIME_EFFECT_MONEY_EXCHANGE,cc.p(0,90)),cc.sequence(cc.delayTime(this.TIME_EFFECT_MONEY_EXCHANGE-this.TIME_EFFECT_MONEY_EXCHANGE_FADE_OUT),cc.fadeTo(this.TIME_EFFECT_MONEY_EXCHANGE_FADE_OUT,0))),this.moneyExchangeAction.easing(cc.easeQuadraticActionOut()),this._initChatCallout()},onDestroy:function(){this.clearCountDown(),this.clearChatMessage()},setPlayer:function(t){if(this.player!==t)if(this.setUpCountdownNode(),this.player=t,this.player&&this.player.data){if(this.emptyNode.active=!1,this.nonEmptyNode.active=!0,this.player.data.avatar){var e=this.avatarImage.node.getComponent(cc.Widget);e.isAlignOnce=!1,this.avatarImage.loadImage(this.player.data.avatar)}this.usernameLabel.node.color=this.player.isMe()?this.mainUsernameColor:this.normalUsernameColor,this.usernameLabel.string=this.player.data.displayName||this.player.data.username,this.onUpdateUserMoney(),this.player.eventDispatcher.addEventListener(s.Event.UPDATE_MONEY,this.onUpdateUserMoney,this)}else this.removePlayer()},removePlayer:function(){this.player&&(this.player.eventDispatcher.removeEventListener(s.Event.UPDATE_MONEY,this.onUpdateUserMoney,this),this.player=null),this.emptyNode.active=!0,this.nonEmptyNode.active=!1,this.clearEffects()},setUpCountdownNode:function(){this.bgTimeCountDownNode=this.countDownContainerNode.getChildByName("BgTimeCountDown"),this.countDownSprite.node.width=163,this.countDownSprite.node.height=163,this.starNode=this.countDownContainerNode.getChildByName("ImgLapLanh"),this.starImage=this.starNode.getChildByName("Img"),this.starImage.setPositionY(80)},setEffect:function(t,e){this.clearEffects(),this.addEffect(t,e)},addEffect:function(t,e){this._addEffect(this.effectTemplateNodeList[t],e)},removeEffect:function(t){var e=this.effectTemplateNodeList[t],n=e&&e.uuid;n&&this._removeEffect(n)},clearEffects:function(){this.backEffectListNode.removeAllChildren(),this.frontEffectListNode.removeAllChildren()},setCountDown:function(t){if(t>0&&this.player){this.clearCountDown(),this.countDownContainerNode.active=!0,this.bgTimeCountDownNode.color=this.normalCountDownColor,this.countDownSprite.node.color=this.normalCountDownColor,this.countDownSprite.fillRange=1,this.starNode.rotation=0,this.starNode.active=!0,this._stopTimestamp=Date.now()+t,this.countTime=0;var e=25;this._countDownIntervalId=setInterval(function(){var e=this._stopTimestamp-Date.now(),n=this.countDownSprite.node.color;e>=0?(n.r<255?(n.r=2*(1-e/t)*255,n.r=n.r>255?255:n.r,this.countDownSprite.node.color=n):(n.g=2*e/t*255,n.g=n.g<0?0:n.g,this.countDownSprite.node.color=n),this.starImage.setScale(1),this.starNode.rotation=360*(1-e/t),this.countTime+=1-e/t,this.countTime>=2&&(this.starImage.runAction(cc.scaleTo(.1,.5)),this.countTime=0),this.countDownSprite.fillRange=e/t):this.clearCountDown()}.bind(this),e)}},clearCountDown:function(){this._countDownIntervalId&&(clearInterval(this._countDownIntervalId),this._countDownIntervalId=null,this.countDownSprite.fillRange=0,this.countDownContainerNode.active=!1)},setChatMessage:function(t){if(this.chatCalloutDuration>0&&this.player){var e=82;t.length>e&&(t=t.substring(0,e)+"..."),this._initChatCallout(),this.clearChatMessage(),this.chatCalloutNode.active=!0,this.chatCalloutNode.getComponentInChildren(cc.Label).string=t,this.chatCalloutNode.getComponent(cc.Layout).resizeMode=cc.Layout.ResizeMode.CONTAINER,this.chatCalloutNode.scale=0,this.chatCalloutNode.runAction(cc.sequence(cc.scaleTo(.1,this.chatCalloutNodeScale.x,this.chatCalloutNodeScale.y),cc.callFunc(function(){this.chatCalloutNode.y=50;var t=cc.winSize,e=this.chatCalloutNode.convertToWorldSpaceAR(cc.v2());e.y>t.height-this.chatCalloutNode.height&&(this.chatCalloutNode.y=5)}.bind(this)))),this._chatIntervalId=setTimeout(function(){this.clearChatMessage()}.bind(this),this.chatCalloutDuration)}},clearChatMessage:function(){this._chatIntervalId&&(clearInterval(this._chatIntervalId),this._chatIntervalId=null,this.chatCalloutNode.active=!1)},onUpdateUserMoney:function(){this.player&&(this.balanceLabel.string=a.Number.abbreviate(this.player.data.money))},setFinishEffect:function(t){t>0?this.setWinEffect(t):t<0?this.setLoseEffect(t):this.setDrawEffect()},setWinEffect:function(t){if(t>0){this.clearEffects();var e,n=this._addEffect(this._getDefaultEffectTemplateByName("Win"),!0);if(n&&(e=n.getComponentInChildren(cc.Label))){e.node.zIndex=10,e.string="+"+a.Number.abbreviate(t);var i=this.node.x>0?-90:90,s=30;e.node.position=new cc.Vec2(i,s),e.node.stopAllActions(),this.moneyExchangeAction&&e.node.runAction(this.moneyExchangeAction)}}},setDrawEffect:function(){this.clearEffects(),this._addEffect(this._getDefaultEffectTemplateByName("Draw"))},setLoseEffect:function(t){if(t<0){this.clearEffects();var e,n=this._addEffect(this._getDefaultEffectTemplateByName("Lose"));if(n&&(e=n.getComponentInChildren(cc.Label))){e.node.zIndex=10,e.string=a.Number.abbreviate(t);var i=this.node.x>0?-90:90,s=30;e.node.position=new cc.Vec2(i,s),e.node.stopAllActions(),this.moneyExchangeAction&&e.node.runAction(this.moneyExchangeAction)}}},removeWinEffect:function(){this._removeDefaultEffectByName("Win")},removeDrawEffect:function(){this._removeDefaultEffectByName("Draw")},removeLoseEffect:function(){this._removeDefaultEffectByName("Lose")},_removeDefaultEffectByName:function(t){var e=this._getDefaultEffectTemplateByName(t),n=e&&e.uuid;n&&this._removeEffect(n)},_getDefaultEffectTemplateByName:function(t){return this.defaultEffectTemplatesNode||(this.defaultEffectTemplatesNode=cc.instantiate(this.defaultEffectTemplatesPrefab)),this.defaultEffectTemplatesNode.getChildByName(t)},_addEffect:function(t,e){if(t){var n=cc.instantiate(t);return n.active=!0,n._effectTemplateUUID=t.uuid,(e?this.frontEffectListNode:this.backEffectListNode).addChild(n),n}return null},_removeEffect:function(t){this._removeEffectFrom(this.backEffectListNode,t),this._removeEffectFrom(this.frontEffectListNode,t)},_removeEffectFrom:function(t,e){var n=t.getChildren();a.Array.forEach(n,function(n){n._effectTemplateUUID===e&&t.removeChild(n)}.bind(this))},_initChatCallout:function(){this.chatCalloutNode||cc.loader.loadRes("games/ui/player/PlayerChat",function(t,e){this.chatCalloutNode=cc.instantiate(e),this.node.addChild(this.chatCalloutNode),this.node.x>0?(this.chatCalloutNode.x=-200,this.chatCalloutNode.scaleX=1,this.chatCalloutNode.getComponentInChildren(cc.Label).node.scaleX=1):(this.chatCalloutNode.x=200,this.chatCalloutNode.scaleX=-1,this.chatCalloutNode.getComponentInChildren(cc.Label).node.scaleX=-1),this.chatCalloutNodeScale={x:this.chatCalloutNode.scaleX,y:this.chatCalloutNode.scaleY},this.chatCalloutNode.scale=0}.bind(this))}}),cc._RFpop()},{PlayerConstant:"PlayerConstant",UrlImage:"UrlImage",Utils:"Utils"}],Player:[function(t,e,n){"use strict";cc._RFpush(e,"fef7daKm5ZE2IwyMesXshNB","Player");var i,a=t("Utils"),s=t("AuthUser"),o=t("EventDispatcher"),r=t("PlayerConstant");i=a.Class({$$constructor:function(t){if(!a.Type.isObject(t))throw"Cannot create a player with non-object data";this.data=t,this.eventDispatcher=o.create()},$$static:{fromAuthUser:function(t){if(s.username&&t){var e={username:s.username,displayName:s.display_name,avatar:s.avatar,currency:t,money:s.currencies[t].balance};return new i(e)}return null}},isMe:function(t){return t?this.data.username===t.username:!!this.data&&this.data.username===s.username},update:function(t){this.isMe(t)&&(this.setMoney(t.money),cc.js.mixin(this.data,t))},setMoney:function(t){this.data.money!==t&&(this.data.money=t,this.eventDispatcher.dispatchEvent(r.Event.UPDATE_MONEY))}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",EventDispatcher:"EventDispatcher",PlayerConstant:"PlayerConstant",Utils:"Utils"}],PokerConstant:[function(t,e,n){"use strict";cc._RFpush(e,"26d60dJjjxOpJsVr/8Itdzz","PokerConstant"),e.exports={Action:{BET:1,RAISE:2,ALL_IN:3,ALL_HAND:31,CALL:4,CHECK:5,FOLD:6,CHANGE_STATE:7,CHANGE_TURN:8,BUY_PRIVATE_MONEY:9,BUY_PRIVATE_MONEY_REQUIRED:10,END_TURN:11,CUT_OFF_MONEY_POKER:12,GET_BUY_PRIVATE_MONEY_INFO:13},GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_FOR_NEW_GAME:2,DEALING:3,FINALIZING:6,FINISH:7,ROUND:8},GameStatePoker:{PREFLOP:8,FLOP:9,TURN:10,RIVER:11},PlayerState:{NONE:0,IN_TURN:1,WAITING_FOR_TURN:2,FOLDED:3,ALL_IN:4,OFF_MONEY:5},Event:{START_TIME:"in_game.xito.start_time",USER_BET:"in_game.xito.user_bet",CHANGE_STATE:"in_game.xito.change_state",CHANGE_TURN:"in_game.xito.change_turn",UPDATE_MONEY:"in_game.xito.update_money",SHOW_CARD_OPEN:"in_game.xito.show_card_open",DRAW_CARD:"in_game.xito.draw_card",FINISH_GAME:"in_game.xito.finish_game",UPDATE_GAME:"in_game.xito.update_game",REFRESH_GAME:"in_game.xito.refresh_game",SHOW_BUY_CHIP:"in_game.poker.show_buy_chip",HIDE_BUY_CHIP_BUTTON:"in_game.poker.hide_buy_chip_button",CUT_OFF_MONEY_POKER:"in_game.poker.cut_off_money"},TimeoutId:{SHOW_COMMUNITY_CARDS:"TIMEOUT_SHOW_COMMUNITY_CARDS"},Effect:{TO:0,THEO:1,NHUONG_TO:2,UP_BO:3,CHOI_TAT_TAY:4,DANG_DOI:9}},cc._RFpop()},{}],PokerGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"24809FqTrRImYlZ5nKDZMsg","PokerGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("PokerConstant"),r=t("NetworkManager"),c=t("Utils");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this._setGameState(o.GameState.NONE),this.eventDispatchers.anyCmd.addEventListener(s.Command.NEW_MATCH.ID,this.restartGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.WAITING_DEAL_CARD.ID,this.onWaittingDealCard,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_HAND.ID,this.onUpdateHand,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_PRIVATE_USER_MONEY.ID,this.onUpdatePrivateUserMoney,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BET,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.ALL_IN,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CALL,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHECK,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.FOLD,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.RAISE,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_TURN,this.onChangeTurn,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BUY_PRIVATE_MONEY_REQUIRED,this.onBuyPrivateMoneyRequired,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CUT_OFF_MONEY_POKER,this.onCutOffMoney,this)},fetchInitialGameData:function(){this.$super.fetchInitialGameData.call(this),this.getBuyMoneyInfo()},bet:function(t,e){e?this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](t),money:r.SmartFox.type["long"](e)}):this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](t)})},buyMoneyJoinTable:function(t){this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.BUY_PRIVATE_MONEY),money:r.SmartFox.type["long"](t)})},getBuyMoneyInfo:function(){this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.GET_BUY_PRIVATE_MONEY_INFO)})},onUpdateGame:function(t){this.currency=t.data.currency,this.roomBetting=t.data.betting,this._setGameState(t.data.gameState,t),this.onUpdateHand(),this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_GAME,t)},onUpdateHand:function(){this.eventDispatchers.local.dispatchEvent(o.Event.DRAW_CARD)},onPlayerBetting:function(t){this._setGameState(t.allData.gameState,t),this.eventDispatchers.local.dispatchEvent(o.Event.USER_BET,t)},onWaittingDealCard:function(t){this._setGameState(t.allData.gameState,t),this.eventDispatchers.local.dispatchEvent(o.Event.START_TIME,t.data.time)},onChangeStateGame:function(t){this.currentRound=t.allData.currentRound,this._setGameState(t.allData.gameState,t)},onChangeTurn:function(t){this._setGameState(t.allData.gameState,t),this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_TURN,t)},onFinishGame:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.FINISH_GAME,t)},onCutOffMoney:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.CUT_OFF_MONEY_POKER,t)},restartGame:function(){this.eventDispatchers.local.dispatchEvent(o.Event.REFRESH_GAME)},_setGameState:function(t,e){this.gameState!==t&&(this.gameState=t,e&&this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_STATE,e))},onBuyPrivateMoneyRequired:function(t){this.current&&this.current.player&&this.current.player.data&&this.current.player.data.username===t.data.userName&&this.eventDispatchers.local.dispatchEvent(o.Event.SHOW_BUY_CHIP,[t.data.minMoney,t.data.maxMoney,t.data.totalMoney])},onUpdatePrivateUserMoney:function(t){this.current&&this.current.player&&this.current.player.data&&this.current.player.data.username===t.username&&this.eventDispatchers.local.dispatchEvent(o.Event.HIDE_BUY_CHIP_BUTTON)}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",PokerConstant:"PokerConstant",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],PotInforSanThuong:[function(t,e,n){"use strict";cc._RFpush(e,"8fbe2UAdEJPl4orb5H1pX6x","PotInforSanThuong"),cc.Class({"extends":cc.Component,properties:{activePotSprite:cc.Sprite},onLoad:function(){this.isActive=!0},clickPot:function(){this.isActive?this.isActive=!1:this.isActive=!0,this.activePotSprite.node.active=this.isActive},activePot:function(t){this.isActive=t,this.activePotSprite.node.active=t}}),cc._RFpop()},{}],Profile:[function(t,e,n){"use strict";cc._RFpush(e,"775a4UUmQBLWajtYFKIDldm","Profile");var i=t("Url"),a=t("Utils"),s=t("AuthUser"),o=t("UrlImage"),r=t("UiManager"),c=t("NetworkManager"),h=t("CommonConstant"),u=t("EventDispatcher"),l=t("PlatformImplement"),d=t("EventDispatcherConstant");cc.Class({"extends":cc.Component,properties:{xuLabel:cc.Label,piLabel:cc.Label,vipLabel:cc.Label,emailLabel:cc.Label,levelLabel:cc.Label,userAvatar:o,numPhoneLabel:cc.Label,displayNameLabel:cc.Label,levelPercentSprite:cc.Sprite},onLoad:function(){u.addEventListener(d.PROFILE.UPDATE_INFO,this.onCompleteChangeInfo,this),u.addEventListener(d.PROFILE.UPDATE_AVATAR,this.onCompleteUpdateAvatar,this),this.xuLabel.string=s.currencies[h.CurrencyType.Xu.NAME].balance,this.xuLabel.string=a.Number.format(this.xuLabel.string),this.piLabel.string=s.currencies[h.CurrencyType.Ip.NAME].balance,this.piLabel.string=a.Number.format(this.piLabel.string),this.levelLabel.string="LV: "+s.level,this.vipLabel.string=s.vip_level||"0",this.levelPercentSprite.fillRange=s.level_percent,this.numPhoneLabel.string=s.mobile||"Chưa có",this.displayNameLabel.string=s.display_name,this.emailLabel.string=s.email,this.userAvatar.loadImage(s.avatar)},onButtonBack:function(){var t=a.Director.getPreviousSceneName()||h.Scene.HALL;t===h.Scene.PROFILE&&(t=h.Scene.HALL),a.Director.loadScene(t)},uploadAvatar:function(t){var e=this;l.uploadFile({accept:"image/*"},function(n){var a=e.node.getComponentInChildren("Loading"),o=a&&a.node;o&&(o.active=!0),c.Http.fetch("POST",i.Http.USER_UPDATE_AVATAR,{username:s.username,accesstoken:s.accesstoken,avatar:n}).success(function(t){o&&(o.active=!1),s.avatar=t.data,u.dispatchEvent(d.PROFILE.UPDATE_AVATAR),r.openModal("Xin chúc mừng, bạn đã cập nhật avatar thành công.")}).error(function(){o&&(o.active=!1)}).setWaitingButton(t.target)})},onCompleteChangeInfo:function(){this.displayNameLabel.string=s.display_name,this.emailLabel.string=s.email},onCompleteUpdateAvatar:function(){this.userAvatar.loadImage(s.avatar)},onDestroy:function(){u.removeEventListener(d.PROFILE.UPDATE_INFO,this.onCompleteChangeInfo,this),u.removeEventListener(d.PROFILE.UPDATE_AVATAR,this.onCompleteUpdateAvatar,this)}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",UiManager:"UiManager",Url:"Url",UrlImage:"UrlImage",Utils:"Utils"}],RemoveObject:[function(t,e,n){"use strict";cc._RFpush(e,"4e8a0Pe5opFwK3NGnelLEcx","RemoveObject"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(e){t.time=Date.now(),t.curPosTouched=new cc.Vec2(e.getLocation().x-t.node.position.x,e.getLocation().y-t.node.position.y)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(t.time-Date.now()<-100){var n=new cc.Vec2(e.getLocation().x-t.curPosTouched.x,e.getLocation().y-t.curPosTouched.y);t.node.position=n}}),this.node.on(cc.Node.EventType.TOUCH_END,function(){t.onEndOrCancelTouch()}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){t.onEndOrCancelTouch()})},onEndOrCancelTouch:function(){this.time=Date.now()}}),cc._RFpop()},{}],RouletteConstant:[function(t,e,n){"use strict";cc._RFpush(e,"e16f035pAlGJJrzHStk4Fre","RouletteConstant");var i=t("Utils");e.exports={Action:{BETTING:1,CANCEL_BET:2,TURN_MASTER:3,MASTER_SELL_POT:4,CHANGE_STATE:5,UPDATE_POTS:9},GameState:{NONE:0,EFFECT:1,PLAYER_BETTING:2,MASTER_CANEL_BET:3,FINISH:4,FINALIZING:5,ROTATE_VONG_QUAY:6},ChipColor:{BLUE:{ID:0,NAME:"blue"},PURPLE:{ID:1,NAME:"purple"},GREEN:{ID:2,NAME:"green"},RED:{ID:3,NAME:"red"},findById:function(t){return t=parseInt(t,10),i.Object.findObject(this,"ID",t)}},Event:{TURN_START:"in_game.roulette.turn_start",BETTING_SUCCESS:"in_game.roulette.betting_success",ROTATE_VONG_QUAY:"in_game.roulette.rotate_vong_quay",FINISH_GAME:"in_game.roulette.finish_game",CHANGE_STATE:"in_game.roulette.change_state",CANCEL_BET:"in_game.roulette.cancel_bet",BETTING_UPDATEGAME:"in_game.roulette.betting_updategame",ADD_LIST_BETTING:"in_game.roulette.add_list_betting"}},cc._RFpop()},{Utils:"Utils"}],RouletteGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"fe3caOBx19CHYwE/LwZL/l1","RouletteGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("NetworkManager"),r=t("Utils"),c=t("AuthUser"),h=t("RouletteConstant"),i=r.Class({$$extends:a,$$constructor:function(t,e,n){this.$super.constructor.call(this,t,e,n,!0),this.currentBet=[],this.history=[],this.isMaster=!1,this.lstRatio=[],this.time=0,this.bettingList=[],this._clearCurrentBet(),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.REFRESH_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(h.Action.BETTING,this.onBettingSuccess,this),this.eventDispatchers.playCmd.addEventListener(h.Action.CHANGE_STATE,this.onChangeState,this),this.eventDispatchers.playCmd.addEventListener(h.Action.CANCEL_BET,this.onCancelBetting,this)},sellBetCancelBet:function(t){this.isMaster&&this.send({command:o.SmartFox.type["byte"](s.Command.PLAY.ID),action:o.SmartFox.type["byte"](h.Action.MASTER_SELL_POT),pot:o.SmartFox.type["byte"](t)})},sendBet:function(t,e){!this.isMaster&&e>0&&this.send({command:o.SmartFox.type["byte"](s.Command.PLAY.ID),action:o.SmartFox.type["byte"](h.Action.BETTING),userName:o.SmartFox.type.utfString(c.username),pot:o.SmartFox.type["byte"](t),money:o.SmartFox.type["long"](e)})},sendReBet:function(){for(var t=0;t<this.history.length;t+=1)this.sendBet(t,this.history[t])},sendDoubleBet:function(){for(var t=0;t<this.currentBet.length;t+=1)this.currentBet[t]>0&&this.sendBet(t,this.currentBet[t])},sendCancelBet:function(){for(var t=0;t<this.currentBet.length;t+=1)this.send({command:o.SmartFox.type["byte"](s.Command.PLAY.ID),action:o.SmartFox.type["byte"](h.Action.CANCEL_BET),userName:o.SmartFox.type.utfString(c.username),pot:o.SmartFox.type["byte"](t)})},_clearCurrentBet:function(){this.currentBet=[];for(var t=0;t<49;t+=1)this.currentBet.push(0)},onFinishGame:function(t){this._setGameState(5),this.eventDispatchers.local.dispatchEvent(h.Event.FINISH_GAME,t),this.history=this.currentBet,this._clearCurrentBet()},onCancelBetting:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.CANCEL_BET,t),this.isCurrentPlayer(t.username)&&this._clearCurrentBet()},onBettingSuccess:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.BETTING_SUCCESS,t),this.isCurrentPlayer(t.username)&&(this.currentBet[t.pot]=this.currentBet[t.pot]+t.money)},onUpdateGame:function(t){this.bettingList=t.bettingValues,this._updateListBetting(t.bettingValues),this._updateRatio(t.potInfo),this.onChangeState(t),this._bettingUpdateGame(t.pots)},_updateRatio:function(t){this.lstRatio=[];for(var e=0;e<t.length;e+=1)this.lstRatio.push(t[t[e].id].ratio)},_bettingUpdateGame:function(t){for(var e=0;e<t.length;e+=1)this.eventDispatchers.local.dispatchEvent(h.Event.BETTING_UPDATEGAME,t[e])},_updateListBetting:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.ADD_LIST_BETTING,t)},onChangeState:function(t){switch(this._setGameState(t.gameState),t.gameState){case h.GameState.EFFECT:this._rotate(t);break;case h.GameState.PLAYER_BETTING:this.time=Date.now()+t.time;break;case h.GameState.MASTER_CANEL_BET:this.eventDispatchers.local.dispatchEvent(h.Event.MASTER_CANEL_BET,t)}},_setGameState:function(t){this.gameState!==t&&(this.gameState=t,this.eventDispatchers.local.dispatchEvent(h.Event.CHANGE_STATE))},_rotate:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.ROTATE_VONG_QUAY,t)}});e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",RouletteConstant:"RouletteConstant",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],RoulettePotInfor:[function(t,e,n){"use strict";cc._RFpush(e,"96d424Xp41Dwq+koiIxBPif","RoulettePotInfor");var i=t("BaseMainGameplay"),a=t("AuthUser"),s=t("RouletteConstant"),o=t("Utils");cc.Class({"extends":cc.Component,properties:{sceneScript:i},onLoad:function(){var t=this;this.caculateChip=o.Scheduler.debounce(function(){t._caculateChip()},30,200),this._poolChip=new cc.NodePool("Chip"),this.chipFackeList||this.init()},init:function(){this.chipFackeList||(this.potX=0,this.playerBetList={},this.chipFackeList=[],this.countChipList=[],this.isWin=!1,this.totallMoneyLong=0,this.myMoneyLong=0)},activeEfectWin:function(t){if(this.node.getChildByName("EfectWin").active=t,t){var e=cc.repeatForever(cc.sequence(cc.fadeIn(.8,0),cc.fadeOut(.8,0)));this.node.getChildByName("EfectWin").runAction(e)}else this.node.getChildByName("EfectWin").stopAllActions()},addPlayerBetToPot:function(t,e){var n=this.playerBetList[t];o.Type.isNumber(n)?this.playerBetList[t]=e+n:this.playerBetList[t]=e},setMoneyPot:function(t,e){this.totallMoneyLong+=e,this.myMoneyLong+=t,e>0&&this.caculateChip()},caculateChip:function(){},_caculateChip:function(){this.destroyChipFacke(!1);var t=this.totallMoneyLong,e=this.sceneScript.gameManager.bettingList;this.tmpCountChipList=this.countChipList;var n=[];this.countChipList=[];for(var i=e.length;i>0;i-=1)if(t>=e[i-1]){var a=Math.floor(t/e[i-1]);n.push(a),t-=a*e[i-1]}else n.push(0);this.countChipList=n.reverse(),this.setFakeChip()},setFakeChip:function(){for(var t=this,e=this.countChipList,n=0;n<e.length;n+=1)if(e[n]>0)for(var i=0;i<e[n];i+=1){var a=this._poolChip.get();a||(a=cc.instantiate(t.sceneScript.chipPrefab));var o=a.getComponent("Chip");switch(a.parent=this.node.getChildByName(n.toString()),
a.scale=cc.v2(.5,.5),a.removeComponent("ButtonScaler"),a.removeComponent(cc.Button),n){case 0:a.position=cc.v2(0,this.potX0),this.potX0+=3;break;case 1:a.position=cc.v2(0,this.potX1),this.potX1+=3;break;case 2:a.position=cc.v2(0,this.potX2),this.potX2+=3;break;case 3:a.position=cc.v2(0,this.potX3),this.potX3+=3}o.activeSelectChip(!1),o.init(this.sceneScript.gameManager.bettingList[n],s.ChipColor.findById(n).NAME),this.chipFackeList.push(a)}},removePlayerBet:function(t){delete this.playerBetList[t]},removeMoneyPot:function(t){var e=this.playerBetList[t];o.Type.isNumber(e)&&(this.totallMoneyLong>e?this.totallMoneyLong-=e:this.totallMoneyLong=0),a.username===t&&(this.myMoneyLong=0),this.totallMoneyLong<=0&&this.destroyChipFacke(!0),this.removePlayerBet(t)},destroyChipFacke:function(t){if(this.chipFackeList){for(var e=0;e<this.chipFackeList.length;e+=1)this._poolChip.put(this.chipFackeList[e]);this.chipFackeList=[]}this.potX=0,t&&(this.chipFackeList=[])}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",RouletteConstant:"RouletteConstant",Utils:"Utils"}],RowInforSanThuong:[function(t,e,n){"use strict";cc._RFpush(e,"e5f1cBMI91PLIsrUNxuT8h9","RowInforSanThuong"),cc.Class({"extends":cc.Component,properties:{gemList:{"default":[],type:cc.Prefab},count:30},onLoad:function(){this.initDefaultGem(),this.gemTemp=[],this.gemHeight=this.node.children[0].height,this.spacingY=this.node.getComponent(cc.Layout).spacingY},initDefaultGem:function(){for(var t=0,e=0;e<this.count;e+=1){7===t&&(t=0);var n=cc.instantiate(this.gemList[t]);this.node.addChild(n),t+=1}},initGemFinish:function(t){var e=cc.instantiate(this.gemList[t]);this.node.addChild(e),e.setSiblingIndex(0),this.gemTemp.push(e)},destroyGemTemp:function(){if(this.gemTemp.length>0){var t=this;this.node.children.slice(-6).forEach(function(t){t.destroy()}),this.gemTemp.reverse().forEach(function(e){t.node.addChild(cc.instantiate(e))}),this.gemTemp=[]}}}),cc._RFpop()},{}],RowInforTayDuKy:[function(t,e,n){"use strict";cc._RFpush(e,"f7007sM8LxDYZyODlN4+1fY","RowInforTayDuKy"),cc.Class({"extends":cc.Component,properties:{itemPrefab:cc.Prefab,itemSprite:{"default":[],type:cc.SpriteFrame},count:30},onLoad:function(){this.initDefaultItem(),this.itemTemp=[],this.itemHeight=this.node.children[0].height,this.spacingY=this.node.getComponent(cc.Layout).spacingY},initDefaultItem:function(){for(var t=0,e=0;e<this.count;e+=1){7===t&&(t=0);var n=cc.instantiate(this.itemPrefab);n.getComponent(cc.Sprite).spriteFrame=this.itemSprite[t],this.node.addChild(n),t+=1}},initItemFinish:function(t){var e=cc.instantiate(this.itemPrefab);e.getComponent(cc.Sprite).spriteFrame=this.itemSprite[t],this.node.addChild(e),e.setSiblingIndex(0),this.itemTemp.push(e)},destroyItemTemp:function(){if(this.itemTemp.length>0){var t=this;this.node.children.slice(-6).forEach(function(t){t.destroy()}),this.itemTemp.reverse().forEach(function(e){t.node.addChild(cc.instantiate(e))}),this.itemTemp=[]}}}),cc._RFpop()},{}],RowTable:[function(t,e,n){"use strict";cc._RFpush(e,"1c33fFDkI1HSLuNeUMMgigE","RowTable"),cc.Class({"extends":cc.Component,properties:{columnLabels:{"default":[],type:cc.Label}},onLoad:function(){},updateData:function(){for(var t=0;t<this.columnLabels.length;t+=1)this.columnLabels[t].string=arguments[t]}}),cc._RFpop()},{}],RulePotSanThuong:[function(t,e,n){"use strict";cc._RFpush(e,"8fcebfhqkxKkqJTPzpGHHql","RulePotSanThuong"),cc.Class({"extends":cc.Component,properties:{lblRatio:{"default":[],type:cc.Label}},onLoad:function(){},setRatio:function(t){for(var e=0;e<t.awards.length;e+=1)e<=this.lblRatio.length&&(this.lblRatio[e].string=t.awards[e].number+" x "+t.awards[e].ratio)}}),cc._RFpop()},{}],RunningMessageStore:[function(t,e,n){"use strict";cc._RFpush(e,"3cc6f9Y/x1NF6YjGPynkFNb","RunningMessageStore");var i,a=t("EventDispatcher"),s=t("CommonConstant"),o=t("EventDispatcherConstant"),r=t("TinhNangManager"),c=t("Utils"),h=25;i={MESSAGES:[],INGAME_MESSAGES:[],_add:function(t,e){t&&(t.isIngame?(c.Array.trimLeft(this.INGAME_MESSAGES,h),this.INGAME_MESSAGES[e](t)):(c.Array.trimLeft(this.MESSAGES,h),this.MESSAGES[e](t)))},push:function(t){this._add(t,"push")},pushTop:function(t){this._add(t,"unshift")},pop:function(){var t=this.MESSAGES.shift();return t||(t=this.INGAME_MESSAGES.shift()),t},clear:function(){this.MESSAGES=[],this.INGAME_MESSAGES=[]}},a.addEventListener(s.PushMessageType.RUNNING.EVENT,function(t){t&&t.content&&r.choPhep("nc")&&i.push({content:t.content,target:t.target,targetId:t.targetId,times:t.times>0?t.times:1,isIngame:t.isIngame,at:Date.now()})}),a.addEventListener(o.TINH_NANG.NEW,function(){r.choPhep("nc")||i.clear()}),e.exports=i,cc._RFpop()},{CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",TinhNangManager:"TinhNangManager",Utils:"Utils"}],RunningMessage:[function(t,e,n){"use strict";cc._RFpush(e,"0a852CTuphMaIy/h6LTroBA","RunningMessage");var i=t("RunningMessageStore"),a=t("PlatformImplement"),s=t("EventDispatcher"),o=t("TinhNangManager"),r=t("EventDispatcherConstant"),c=t("UiManager"),h=t("Utils"),u=3,l=33,d=12e4,m="#02bbff",p="#ffed6b";cc.Class({"extends":cc.Component,properties:{maskNode:cc.Node,runningMessageTemplateNode:cc.Node,minDistance:200},onLoad:function(){this.activeNodes=[],s.addEventListener(r.TINH_NANG.NEW,this.onTinhNangNew,this)},onDestroy:function(){s.removeEventListener(r.TINH_NANG.NEW,this.onTinhNangNew,this)},update:function(){if(0===this.activeNodes.length||this.activeNodes[0].shouldShowMore){var t=i.pop();t&&Date.now()-t.at<=d&&this.displayMessage(t)}},onTinhNangNew:function(){this.node.active=o.choPhep("nc")},displayMessage:function(t){var e,n,s,o,r,d,m,p=cc.instantiate(this.runningMessageTemplateNode),g=this.maskNode.convertToWorldSpace(cc.v2(0,0)),f=this,_=!1;switch(p.parent=this.maskNode,p.active=!0,p.position=cc.v2(0,0),e=p.convertToNodeSpace(g),n=e.x+this.maskNode.width,this.activeNodes.unshift(p),t.target){case"open_web":_=!0,p.on(cc.Node.EventType.TOUCH_START,function(){a.openWebUrl(t.targetId)});break;case"event":_=!0,p.on(cc.Node.EventType.TOUCH_START,function(){c.openPopupEvent(t.targetId)});break;case"webview":_=!0,p.on(cc.Node.EventType.TOUCH_START,function(){try{var e=t.targetId.split("\n");c.openWebView(e[0],e[1])}catch(n){}})}p.getComponent(cc.RichText).string=this._decorateMsg(t.content,_),p.x=n,s=this.maskNode.width+p.width,o=p.width+this.minDistance,d=o/u*l/1e3,r=Math.max(s-o,0),m=r/u*l/1e3,p.runAction(cc.sequence(cc.moveBy(d,cc.v2(-o,0)),cc.callFunc(function(){p.shouldShowMore=!0}),cc.moveBy(m,cc.v2(-r,0)),cc.callFunc(function(){h.Array.removeRef(f.activeNodes,p),p.destroy(),p.shouldShowMore=!0}))),t.times-=1,t.times>0&&i.pushTop(t)},_decorateMsg:function(t,e){return h.Type.isString(t)&&(t=t.replace(/(\b|\-)[\w\-.,:]+\b/g,function(t){return t&&/\d/.test(t)&&(t="<color="+m+"><b>"+t+"</b></color>"),t}),t="<i>"+t+"</i>",e&&(t="<color="+p+">"+t+"</color>")),t}}),cc._RFpop()},{EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",PlatformImplement:"PlatformImplement",RunningMessageStore:"RunningMessageStore",TinhNangManager:"TinhNangManager",UiManager:"UiManager",Utils:"Utils"}],SFS2X:[function(t,e,n){"use strict";function i(t){return s(a(o(t)))}function a(t){return c(h(r(t),8*t.length))}function s(t){try{}catch(e){E=0}for(var n,i=E?"0123456789ABCDEF":"0123456789abcdef",a="",s=0;s<t.length;s++)n=t.charCodeAt(s),a+=i.charAt(n>>>4&15)+i.charAt(15&n);return a}function o(t){for(var e,n,i="",a=-1;++a<t.length;)e=t.charCodeAt(a),n=a+1<t.length?t.charCodeAt(a+1):0,55296<=e&&56319>=e&&56320<=n&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),a++),127>=e?i+=String.fromCharCode(e):2047>=e?i+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function r(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e}function c(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}function h(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,i=-271733879,a=-1732584194,s=271733878,o=0;o<t.length;o+=16)var r=n,c=i,h=a,u=s,n=l(n,i,a,s,t[o+0],7,-680876936),s=l(s,n,i,a,t[o+1],12,-389564586),a=l(a,s,n,i,t[o+2],17,606105819),i=l(i,a,s,n,t[o+3],22,-1044525330),n=l(n,i,a,s,t[o+4],7,-176418897),s=l(s,n,i,a,t[o+5],12,1200080426),a=l(a,s,n,i,t[o+6],17,-1473231341),i=l(i,a,s,n,t[o+7],22,-45705983),n=l(n,i,a,s,t[o+8],7,1770035416),s=l(s,n,i,a,t[o+9],12,-1958414417),a=l(a,s,n,i,t[o+10],17,-42063),i=l(i,a,s,n,t[o+11],22,-1990404162),n=l(n,i,a,s,t[o+12],7,1804603682),s=l(s,n,i,a,t[o+13],12,-40341101),a=l(a,s,n,i,t[o+14],17,-1502002290),i=l(i,a,s,n,t[o+15],22,1236535329),n=d(n,i,a,s,t[o+1],5,-165796510),s=d(s,n,i,a,t[o+6],9,-1069501632),a=d(a,s,n,i,t[o+11],14,643717713),i=d(i,a,s,n,t[o+0],20,-373897302),n=d(n,i,a,s,t[o+5],5,-701558691),s=d(s,n,i,a,t[o+10],9,38016083),a=d(a,s,n,i,t[o+15],14,-660478335),i=d(i,a,s,n,t[o+4],20,-405537848),n=d(n,i,a,s,t[o+9],5,568446438),s=d(s,n,i,a,t[o+14],9,-1019803690),a=d(a,s,n,i,t[o+3],14,-187363961),i=d(i,a,s,n,t[o+8],20,1163531501),n=d(n,i,a,s,t[o+13],5,-1444681467),s=d(s,n,i,a,t[o+2],9,-51403784),a=d(a,s,n,i,t[o+7],14,1735328473),i=d(i,a,s,n,t[o+12],20,-1926607734),n=m(n,i,a,s,t[o+5],4,-378558),s=m(s,n,i,a,t[o+8],11,-2022574463),a=m(a,s,n,i,t[o+11],16,1839030562),i=m(i,a,s,n,t[o+14],23,-35309556),n=m(n,i,a,s,t[o+1],4,-1530992060),s=m(s,n,i,a,t[o+4],11,1272893353),a=m(a,s,n,i,t[o+7],16,-155497632),i=m(i,a,s,n,t[o+10],23,-1094730640),n=m(n,i,a,s,t[o+13],4,681279174),s=m(s,n,i,a,t[o+0],11,-358537222),a=m(a,s,n,i,t[o+3],16,-722521979),i=m(i,a,s,n,t[o+6],23,76029189),n=m(n,i,a,s,t[o+9],4,-640364487),s=m(s,n,i,a,t[o+12],11,-421815835),a=m(a,s,n,i,t[o+15],16,530742520),i=m(i,a,s,n,t[o+2],23,-995338651),n=p(n,i,a,s,t[o+0],6,-198630844),s=p(s,n,i,a,t[o+7],10,1126891415),a=p(a,s,n,i,t[o+14],15,-1416354905),i=p(i,a,s,n,t[o+5],21,-57434055),n=p(n,i,a,s,t[o+12],6,1700485571),s=p(s,n,i,a,t[o+3],10,-1894986606),a=p(a,s,n,i,t[o+10],15,-1051523),i=p(i,a,s,n,t[o+1],21,-2054922799),n=p(n,i,a,s,t[o+8],6,1873313359),s=p(s,n,i,a,t[o+15],10,-30611744),a=p(a,s,n,i,t[o+6],15,-1560198380),i=p(i,a,s,n,t[o+13],21,1309151649),n=p(n,i,a,s,t[o+4],6,-145523070),s=p(s,n,i,a,t[o+11],10,-1120210379),a=p(a,s,n,i,t[o+2],15,718787259),i=p(i,a,s,n,t[o+9],21,-343485551),n=g(n,r),i=g(i,c),a=g(a,h),s=g(s,u);return[n,i,a,s]}function u(t,e,n,i,a,s){return g(f(g(g(e,t),g(i,s)),a),n)}function l(t,e,n,i,a,s,o){return u(e&n|~e&i,t,e,a,s,o)}function d(t,e,n,i,a,s,o){return u(e&i|n&~i,t,e,a,s,o)}function m(t,e,n,i,a,s,o){return u(e^n^i,t,e,a,s,o)}function p(t,e,n,i,a,s,o){return u(n^(e|~i),t,e,a,s,o)}function g(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function f(t,e){return t<<e|t>>>32-e}cc._RFpush(e,"8e923lOK3ZJiZoCgaziN7W5","SFS2X");var _={SmartFox:function(t){this._majVersion=1,this._minVersion=2,this._subVersion=0,this._socketEngine=new _.SocketEngine,this._eventDispatcher=new _.EventDispatcher,this._lagMonitor=null,this._log=_.Logger,this._inited=this._isJoining=!1,this._currentZone=null,this._clientDetails="JavaScript",this.version=this._majVersion+"."+this._minVersion+"."+this._subVersion,this.config=t,this.debug=!1,null!=this.config&&this.config.debug&&(this.debug=!0),this.logger=this._log,this.lastJoinedRoom=this.mySelf=this.buddyManager=this.userManager=this.roomManager=this.sessionToken=null,this._controllers={},this._initialize(),this._log.info("SmartFox instance ready!")}};_.SmartFox;_.SmartFox.prototype.addEventListener=function(t,e,n){this._eventDispatcher.addEventListener(t,e,n)},_.SmartFox.prototype.removeEventListener=function(t,e){this._eventDispatcher.removeEventListener(t,e)},_.SmartFox.prototype.setClientDetails=function(t,e){this.isConnected()?this._log.warn("SetClientDetails must be called before the connection is started"):(this._clientDetails=null!=t?t.replace(":"," "):"",this._clientDetails+=":",this._clientDetails+=null!=e?e.replace(":"," "):"")},_.SmartFox.prototype.connect=function(t,e,n){if(this.isConnected())this._log.warn("Already connected");else if(this._socketEngine.isConnecting)this._log.warn("A connection attempt is already in progress");else{var i=null!=this.config&&null!=this.config.host?this.config.host:null,a=null!=this.config&&null!=this.config.port?this.config.port:null,s=null!=this.config&&this.config.useSSL;null!=t&&(i=t),null!=e&&(a=e),null!=n&&(s=n),null==i||0==i.length?this._log.error("Invalid connection host/address"):"number"!=typeof a||0>a||65535<a?this._log.error("Invalid TCP port"):("boolean"!=typeof s&&(s=!1),this._socketEngine.connect(i,a,s))}},_.SmartFox.prototype.disconnect=function(){this.isConnected()?(0<this._socketEngine.reconnectionSeconds&&this.send(new _.Requests.System.ManualDisconnectionRequest),setTimeout(function(t){t._handleClientDisconnection(_.Utils.ClientDisconnectionReason.MANUAL)},100,this)):this._log.info("You are not connected")},_.SmartFox.prototype.enableLagMonitor=function(t,e,n){null==this.mySelf?this._log.warn("Lag Monitoring requires that you are logged in a Zone; please retry after completing the login process"):(null!=this._lagMonitor&&this._lagMonitor.destroy(),t&&(this._lagMonitor=new _.Utils.LagMonitor(this,e,n),this._lagMonitor.start()))},_.SmartFox.prototype.isConnected=function(){return null!=this._socketEngine&&this._socketEngine.isConnected},_.SmartFox.prototype.getMaxMessageSize=function(){return null!=this._socketEngine?this._socketEngine._maxMessageSize:0},_.SmartFox.prototype.send=function(t){if(this.isConnected()){if(null!=t.validate&&null!=t.execute){try{t.validate(this),t.execute(this)}catch(e){if(!(e instanceof _.Exceptions.SFSValidationError&&null!=e.getMessage))throw e;if(t=e.getMessage(),null!=e.getErrors())for(var t=t+":",n=0;n<e.getErrors().length;n++)1<e.getErrors().length&&(t+=" "+(n+1)+")"),t+=" "+e.getErrors()[n];return this._log.error("Request failed | "+t),!1}return this.debug&&(this._log.info("OUTGOING DATA\n"+_.DebugHelper.getDump(t.getMessage())),this._log.info("OUT > "+_.Requests.getRequestNameFromId(t._id))),this._socketEngine.send(t.getMessage()),!0}this._log.error("An invalid request was passed: "+t),this._log.debug("Object dump:\n"+_.DebugHelper.getDump(t))}else this._log.error("You are not connected. Request cannot be sent: "+_.Requests.getRequestNameFromId(t._id))},_.SmartFox.prototype.getRoomById=function(t){return this.roomManager.getRoomById(t)},_.SmartFox.prototype.getRoomByName=function(t){return this.roomManager.getRoomByName(t)},_.SmartFox.prototype.getRoomList=function(){return this.roomManager.getRoomList()},_.SmartFox.prototype.getRoomListFromGroup=function(t){return this.roomManager.getRoomListFromGroup(t)},_.SmartFox.prototype.getJoinedRooms=function(){return this.roomManager.getJoinedRooms()},_.SmartFox.prototype._initialize=function(){this._inited||(this._socketEngine=new _.SocketEngine(this),this._socketEngine.addEventListener(_.SocketEvent.CONNECT,this._onSocketConnect,this),this._socketEngine.addEventListener(_.SocketEvent.DISCONNECT,this._onSocketDisconnect,this),this._socketEngine.addEventListener(_.SocketEvent.DATA,this._onSocketData,this),this._socketEngine.addEventListener(_.SocketEvent.IOERROR,this._onSocketIOError,this),this._controllers[0]=new _.Controllers.SystemController(this),this._controllers[1]=new _.Controllers.ExtensionController(this),this._inited=!0,this._reset())},_.SmartFox.prototype._reset=function(t){null!=this.buddyManager&&this.buddyManager._clearAll(),this.userManager=new _.Managers.GlobalUserManager(this),this.roomManager=new _.Managers.RoomManager(this),this.buddyManager=new _.Managers.BuddyManager(this),null!=this._lagMonitor&&this._lagMonitor.destroy(),this._isJoining=!1,this.mySelf=this.lastJoinedRoom=this._currentZone=null,t&&(this.sessionToken=null)},_.SmartFox.prototype._dispatchEvent=function(t,e){this._eventDispatcher.dispatchEvent(t,e)},_.SmartFox.prototype._onSocketConnect=function(t){t.success?(t=new _.Requests.System.HandshakeRequest(this.version,this._clientDetails,t.isReconnection?this.sessionToken:null),this.send(t)):this._dispatchEvent(_.SFSEvent.CONNECTION,{success:!1})},_.SmartFox.prototype._onSocketDisconnect=function(t){this._dispatchEvent(_.SFSEvent.CONNECTION_LOST,{reason:t.reason}),this._reset(!0)},_.SmartFox.prototype._onSocketData=function(t){this.debug&&this._log.info("INCOMING DATA\n"+_.DebugHelper.getDump(t));var e=t[_.Controllers.CONTROLLER_ID],n=t[_.Controllers.ACTION_ID],t=t[_.Controllers.PARAM_ID];null==e?this._log.error("Message rejected: Controller ID is missing"):null==e?this._log.error("Message rejected: Action ID missing"):this._controllers[e].handleMessage(t,n)},_.SmartFox.prototype._onSocketIOError=function(t){this._dispatchEvent(_.SFSEvent.SOCKET_ERROR,{message:t})},_.SmartFox.prototype._handleHandShake=function(t){var e=t[_.Controllers.KEY_ERROR_CODE];null==e?(this.sessionToken=t[_.Requests.System.HandshakeRequest.KEY_SESSION_TOKEN],this._socketEngine._maxMessageSize=t[_.Requests.System.HandshakeRequest.KEY_MAX_MESSAGE_SIZE],this._socketEngine._isReconnecting?this._socketEngine._isReconnecting=!1:this._dispatchEvent(_.SFSEvent.CONNECTION,{success:!0})):(t={success:!1,errorMessage:_.ErrorCodes.getErrorMessage(e,t[_.Controllers.KEY_ERROR_PARAMS]),errorCode:e},this._dispatchEvent(_.SFSEvent.CONNECTION,t))},_.SmartFox.prototype._handleLogout=function(){this._reset(!1)},_.SmartFox.prototype._handleClientDisconnection=function(t){this.isConnected()&&this._socketEngine.disconnect(t)};var y=function(){var t=!1,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,n=function(){};return n.extend=function i(n){function a(){!t&&this.init&&this.init.apply(this,arguments)}var s=this.prototype;t=!0;var o=new this;t=!1;for(var r in n)o[r]="function"==typeof n[r]&&"function"==typeof s[r]&&e.test(n[r])?function(t,e){return function(){var n=this._super;this._super=s[t];var i=e.apply(this,arguments);return this._super=n,i}}(r,n[r]):n[r];return a.prototype=o,a.prototype.constructor=a,a.extend=i,a},n}(),E=0,C="";_.Utils={},_.Utils.md5_crypt=function(t,e){"undefined"!=typeof VarType&&(t=VarType.toStr(t),e=VarType.toStr(e));var n=C;C="";var i=chrsz;chrsz=8,"$1$"==e.substr(0,3)&&(e=e.substr(3));var a=e.indexOf("$");(0>a||8<a)&&(a=8);for(var e=e.substr(0,a),s=t+"$1$"+e,o=str_md5(t+e+t),a=t.length;0<a;a-=16)s=16<=a?s+o:s+o.substr(0,a);for(a=t.length;0!=a;a>>=1)s=0!=(1&a)?s+String.fromCharCode(0):s+t.charAt(0);for(var r="$1$"+e+"$",o=str_md5(s),a=0;1e3>a;a++)s="",s=0!=(1&a)?s+t:s+o,0!=a%3&&(s+=e),0!=a%7&&(s+=t),s=0!=(1&a)?s+o:s+t,o=str_md5(s);for(o+=o.charAt(5),a=0;5>a;a++)s=o.charCodeAt(a)<<16|o.charCodeAt(a+6)<<8|o.charCodeAt(a+12),r+=md5_to64(s,4);return s=o.charCodeAt(11),r+=md5_to64(s,2),C=n,chrsz=i,r},_.Utils.ClientDisconnectionReason={IDLE:"idle",KICK:"kick",BAN:"ban",MANUAL:"manual",UNKNOWN:"unknown"},_.Utils.ClientDisconnectionReason.getReason=function(t){switch(t){case 0:return this.IDLE;case 1:return this.KICK;case 2:return this.BAN;case 3:return this.MANUAL;case 4:return this.UNKNOWN}},_.Utils.ArrayUtil={},_.Utils.ArrayUtil.objToArray=function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n},_.Utils.ArrayUtil.removeItem=function(t,e){var n=t.indexOf(e);-1<n&&t.splice(n,1)},_.Utils.HashTable=function(t){this.length=0,this.items={};for(var e in t)t.hasOwnProperty(e)&&(this.items[e]=t[e],this.length++)},_.Utils.HashTable.prototype.setItem=function(t,e){var n=void 0;return this.hasItem(t)?n=this.items[t]:this.length++,this.items[t]=e,n},_.Utils.HashTable.prototype.getItem=function(t){return this.hasItem(t)?this.items[t]:void 0},_.Utils.HashTable.prototype.hasItem=function(t){return this.items.hasOwnProperty(t)},_.Utils.HashTable.prototype.removeItem=function(t){var e;if(this.hasItem(t))return e=this.items[t],this.length--,delete this.items[t],e},_.Utils.HashTable.prototype.keys=function(){var t,e=[];for(t in this.items)this.hasItem(t)&&e.push(t);return e},_.Utils.HashTable.prototype.values=function(){var t,e=[];for(t in this.items)this.hasItem(t)&&e.push(this.items[t]);return e},_.Utils.HashTable.prototype.each=function(t){for(var e in this.items)this.hasItem(e)&&t(e,this.items[e])},_.Utils.HashTable.prototype.clear=function(){this.items={},this.length=0},_.Utils.LagMonitor=function(t,e,n){(null==e||1>e)&&(e=4),(null==n||1>n)&&(n=10),this._sfs=t,this._valueQueue=[],this._interval=e,this._queueSize=n,this._thread=null,this._lastReqTime=-1},_.Utils.LagMonitor.prototype.start=function(){!this.isRunning()&&null!=this._sfs&&(this._thread=setInterval(this._threadRunner,1e3*this._interval,this))},_.Utils.LagMonitor.prototype.stop=function(){this.isRunning()&&(clearInterval(this._thread),this._thread=null,this._valueQueue=[])},_.Utils.LagMonitor.prototype.destroy=function(){this.stop(),this._sfs=null},_.Utils.LagMonitor.prototype.isRunning=function(){return null!=this._thread},_.Utils.LagMonitor.prototype.getLastPingTime=function(){return 0<this._valueQueue.length?this._valueQueue[this._valueQueue.length-1]:0},_.Utils.LagMonitor.prototype._threadRunner=function(t){t._lastReqTime=(new Date).getTime(),t._sfs.send(new _.Requests.System.PingPongRequest)},_.Utils.LagMonitor.prototype._onPingPong=function(){var t=(new Date).getTime()-this._lastReqTime;return this._valueQueue.length>=this._queueSize&&this._valueQueue.shift(),this._valueQueue.push(t),this._getAveragePingTime()},_.Utils.LagMonitor.prototype._getAveragePingTime=function(){if(0==this._valueQueue.length)return 0;for(var t=0,e=0;e<this._valueQueue.length;e++)t+=this._valueQueue[e];return t/this._valueQueue.length},_.Utils.BuddyOnlineState={ONLINE:0,OFFLINE:1,LEFT_THE_SERVER:2},_.Controllers={},_.Controllers.CONTROLLER_ID="c",_.Controllers.ACTION_ID="a",_.Controllers.PARAM_ID="p",_.Controllers.KEY_ERROR_CODE="ec",_.Controllers.KEY_ERROR_PARAMS="ep",_.Controllers.ROOM_PARAM="r",_.Controllers.USER_PARAM="u",_.Controllers.USER_COUNT_PARAM="uc",_.Controllers.SPECT_COUNT_PARAM="sc",_.Controllers.SystemController=function(t){this._sfs=t,this._id=0,this._requestHandlers={},this._initRequestHandlers(),this._log=_.Logger},_.Controllers.SystemController.prototype.getId=function(){return this._id},_.Controllers.SystemController.prototype.handleMessage=function(t,e){this._sfs.debug&&this._log.info("IN < "+this._getEvtName(e));var n=this._requestHandlers[e];null!=n?this[n](t):this._log.warn("Unknown message id: "+t.id)},_.Controllers.SystemController.prototype._initRequestHandlers=function(){this._requestHandlers[_.Requests.Handshake]="_fnHandshake",this._requestHandlers[_.Requests.Login]="_fnLogin",this._requestHandlers[_.Requests.Logout]="_fnLogout",this._requestHandlers[_.Requests.JoinRoom]="_fnJoinRoom",this._requestHandlers[_.Requests.CreateRoom]="_fnCreateRoom",this._requestHandlers[_.Requests.ChangeRoomName]="_fnChangeRoomName",this._requestHandlers[_.Requests.ChangeRoomPassword]="_fnChangeRoomPassword",this._requestHandlers[_.Requests.ChangeRoomCapacity]="_fnChangeRoomCapacity",this._requestHandlers[_.Requests.GenericMessage]="_fnGenericMessage",this._requestHandlers[_.Requests.SetRoomVariables]="_fnSetRoomVariables",this._requestHandlers[_.Requests.SetUserVariables]="_fnSetUserVariables",this._requestHandlers[_.Requests.SubscribeRoomGroup]="_fnSubscribeRoomGroup",this._requestHandlers[_.Requests.UnsubscribeRoomGroup]="_fnUnsubscribeRoomGroup",this._requestHandlers[_.Requests.SpectatorToPlayer]="_fnSpectatorToPlayer",this._requestHandlers[_.Requests.PlayerToSpectator]="_fnPlayerToSpectator",this._requestHandlers[_.Requests.InitBuddyList]="_fnInitBuddyList",this._requestHandlers[_.Requests.AddBuddy]="_fnAddBuddy",this._requestHandlers[_.Requests.RemoveBuddy]="_fnRemoveBuddy",this._requestHandlers[_.Requests.BlockBuddy]="_fnBlockBuddy",this._requestHandlers[_.Requests.GoOnline]="_fnGoOnline",this._requestHandlers[_.Requests.SetBuddyVariables]="_fnSetBuddyVariables",this._requestHandlers[_.Requests.FindRooms]="_fnFindRooms",this._requestHandlers[_.Requests.FindUsers]="_fnFindUsers",this._requestHandlers[_.Requests.InviteUsers]="_fnInviteUsers",this._requestHandlers[_.Requests.InvitationReply]="_fnInvitationReply",this._requestHandlers[_.Requests.QuickJoinGame]="_fnQuickJoinGame",this._requestHandlers[_.Requests.PingPong]="_fnPingPong",this._requestHandlers[_.Requests.SetUserPosition]="_fnSetUserPosition",this._requestHandlers[1e3]="_fnUserEnterRoom",this._requestHandlers[1001]="_fnUserCountChange",this._requestHandlers[1002]="_fnUserLost",this._requestHandlers[1003]="_fnRoomLost",this._requestHandlers[1004]="_fnUserExitRoom",this._requestHandlers[1005]="_fnClientDisconnection",this._requestHandlers[1007]="_fnSetMMOItemVariables"},_.Controllers.SystemController.prototype._getEvtName=function(t){return this._requestHandlers[t].substr(3)},_.Controllers.SystemController.prototype._fnHandshake=function(t){this._sfs._handleHandShake(t)},_.Controllers.SystemController.prototype._fnLogin=function(t){if(null==t[_.Controllers.KEY_ERROR_CODE]){this._populateRoomList(t[_.Requests.System.LoginRequest.KEY_ROOMLIST]),this._sfs.mySelf=new _.Entities.SFSUser(t[_.Requests.System.LoginRequest.KEY_ID],t[_.Requests.System.LoginRequest.KEY_USER_NAME],(!0)),this._sfs.mySelf._setUserManager(this._sfs.userManager),this._sfs.mySelf.privilegeId=t[_.Requests.System.LoginRequest.KEY_PRIVILEGE_ID],this._sfs.userManager._addUser(this._sfs.mySelf),this._sfs._socketEngine.reconnectionSeconds=t[_.Requests.System.LoginRequest.KEY_RECONNECTION_SECONDS];var e={};e.zone=t[_.Requests.System.LoginRequest.KEY_ZONE_NAME],e.user=this._sfs.mySelf,e.data=t[_.Requests.System.LoginRequest.KEY_PARAMS],this._sfs._dispatchEvent(_.SFSEvent.LOGIN,e)}else e=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(e,t[_.Controllers.KEY_ERROR_PARAMS]),this._sfs._dispatchEvent(_.SFSEvent.LOGIN_ERROR,{errorMessage:t,errorCode:e})},_.Controllers.SystemController.prototype._fnLogout=function(t){this._sfs._handleLogout();var e={};e.zone=t[_.Requests.System.LogoutRequest.KEY_ZONE_NAME],this._sfs._dispatchEvent(_.SFSEvent.LOGOUT,e)},_.Controllers.SystemController.prototype._fnJoinRoom=function(t){var e=this._sfs.roomManager,n={};this._sfs._isJoining=!1;var i=t[_.Controllers.KEY_ERROR_CODE];if(null==i){for(i=t[_.Requests.System.JoinRoomRequest.KEY_USER_LIST],t=_.Entities.SFSRoom.fromArray(t[_.Requests.System.JoinRoomRequest.KEY_ROOM]),t._setRoomManager(e),t=e._replaceRoom(t,e.containsGroup(t.groupId)),e=0;e<i.length;e++){var a=i[e],s=this._getOrCreateUser(a,!0,t);s._setPlayerId(a[3],t),t._addUser(s)}t.isJoined=!0,this._sfs.lastJoinedRoom=t,n.room=t,this._sfs._dispatchEvent(_.SFSEvent.ROOM_JOIN,n)}else t=_.ErrorCodes.getErrorMessage(i,t[_.Controllers.KEY_ERROR_PARAMS]),n.errorMessage=t,n.errorCode=i,this._sfs._dispatchEvent(_.SFSEvent.ROOM_JOIN_ERROR,n)},_.Controllers.SystemController.prototype._fnCreateRoom=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=this._sfs.roomManager,t=_.Entities.SFSRoom.fromArray(t[_.Requests.System.CreateRoomRequest.KEY_ROOM]);t._setRoomManager=n,n._addRoom(t),e.room=t,this._sfs._dispatchEvent(_.SFSEvent.ROOM_ADD,e)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_CREATION_ERROR,e)},_.Controllers.SystemController.prototype._fnChangeRoomName=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=this._sfs.roomManager.getRoomById(t[_.Requests.System.ChangeRoomNameRequest.KEY_ROOM]);null!=n?(e.oldName=n.name,this._sfs.roomManager._changeRoomName(n,t[_.Requests.System.ChangeRoomNameRequest.KEY_NAME]),e.room=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_NAME_CHANGE,e)):this._log.warn("RoomNameChange event, unknown Room id: "+rId)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_NAME_CHANGE_ERROR,e)},_.Controllers.SystemController.prototype._fnChangeRoomPassword=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=this._sfs.roomManager.getRoomById(t[_.Requests.System.ChangeRoomNameRequest.KEY_ROOM]);null!=n?(this._sfs.roomManager._changeRoomPasswordState(n,t[_.Requests.System.ChangeRoomPasswordStateRequest.KEY_PASS]),e.room=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_PASSWORD_STATE_CHANGE,e)):this._log.warn("RoomPasswordChange event, unknown Room id: "+rId)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_PASSWORD_STATE_CHANGE_ERROR,e)},_.Controllers.SystemController.prototype._fnChangeRoomCapacity=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=this._sfs.roomManager.getRoomById(t[_.Requests.System.ChangeRoomNameRequest.KEY_ROOM]);null!=n?(this._sfs.roomManager._changeRoomCapacity(n,t[_.Requests.System.ChangeRoomCapacityRequest.KEY_USER_SIZE],t[_.Requests.System.ChangeRoomCapacityRequest.KEY_SPEC_SIZE]),e.room=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_CAPACITY_CHANGE,e)):this._log.warn("RoomPasswordChange event, unknown Room id: "+rId)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_CAPACITY_CHANGE_ERROR,e)},_.Controllers.SystemController.prototype._fnGenericMessage=function(t){switch(t[_.Requests.System.GenericMessageRequest.KEY_MESSAGE_TYPE]){case _.Requests.GenericMessageType.PUBLIC_MSG:this._handlePublicMessage(t);break;case _.Requests.GenericMessageType.PRIVATE_MSG:this._handlePrivateMessage(t);break;case _.Requests.GenericMessageType.BUDDY_MSG:this._handleBuddyMessage(t);break;case _.Requests.GenericMessageType.MODERATOR_MSG:this._handleModMessage(t);break;case _.Requests.GenericMessageType.ADMING_MSG:this._handleAdminMessage(t);break;case _.Requests.GenericMessageType.OBJECT_MSG:this._handleObjectMessage(t)}},_.Controllers.SystemController.prototype._handlePublicMessage=function(t){var e={},n=t[_.Requests.System.GenericMessageRequest.KEY_ROOM_ID],i=this._sfs.roomManager.getRoomById(n);null!=i?(e.room=i,e.sender=this._sfs.userManager.getUserById(t[_.Requests.System.GenericMessageRequest.KEY_USER_ID]),e.message=t[_.Requests.System.GenericMessageRequest.KEY_MESSAGE],e.data=t[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(_.SFSEvent.PUBLIC_MESSAGE,e)):this._log.warn("Unexpected, public message target Room doesn't exist; Room id: "+n)},_.Controllers.SystemController.prototype._handlePrivateMessage=function(t){var e={},n=this._sfs.userManager.getUserById(t[_.Requests.System.GenericMessageRequest.KEY_USER_ID]);if(null==n){if(null==t[_.Requests.System.GenericMessageRequest.KEY_SENDER_DATA])return void this._log.warn("Unexpected, private message has no sender details");n=_.Entities.SFSUser.fromArray(t[_.Requests.System.GenericMessageRequest.KEY_SENDER_DATA])}e.sender=n,e.message=t[_.Requests.System.GenericMessageRequest.KEY_MESSAGE],e.data=t[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(_.SFSEvent.PRIVATE_MESSAGE,e)},_.Controllers.SystemController.prototype._handleBuddyMessage=function(t){var e={},n=t[_.Requests.System.GenericMessageRequest.KEY_USER_ID],i=this._sfs.buddyManager.getBuddyById(n);e.isItMe=this._sfs.mySelf.id==n,e.buddy=i,e.message=t[_.Requests.System.GenericMessageRequest.KEY_MESSAGE],e.data=t[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_MESSAGE,e)},_.Controllers.SystemController.prototype._handleModMessage=function(t){var e={};e.sender=_.Entities.SFSUser.fromArray(t[_.Requests.System.GenericMessageRequest.KEY_SENDER_DATA]),e.message=t[_.Requests.System.GenericMessageRequest.KEY_MESSAGE],e.data=t[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],
this._sfs._dispatchEvent(_.SFSEvent.MODERATOR_MESSAGE,e)},_.Controllers.SystemController.prototype._handleAdminMessage=function(t){var e={};e.sender=_.Entities.SFSUser.fromArray(t[_.Requests.System.GenericMessageRequest.KEY_SENDER_DATA]),e.message=t[_.Requests.System.GenericMessageRequest.KEY_MESSAGE],e.data=t[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(_.SFSEvent.ADMIN_MESSAGE,e)},_.Controllers.SystemController.prototype._handleObjectMessage=function(t){var e={};e.sender=this._sfs.userManager.getUserById(t[_.Requests.System.GenericMessageRequest.KEY_USER_ID]),e.message=t[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS],this._sfs._dispatchEvent(_.SFSEvent.OBJECT_MESSAGE,e)},_.Controllers.SystemController.prototype._fnSetRoomVariables=function(t){var e=t[_.Requests.System.SetRoomVariablesRequest.KEY_VAR_ROOM],n=t[_.Requests.System.SetRoomVariablesRequest.KEY_VAR_LIST],t=this._sfs.roomManager.getRoomById(e),i=[];if(null!=t){for(e=0;e<n.length;e++){var a=_.Entities.Variables.SFSRoomVariable.fromArray(n[e]);t._setVariable(a),i.push(a.name)}n={},n.changedVars=i,n.room=t,this._sfs._dispatchEvent(_.SFSEvent.ROOM_VARIABLES_UPDATE,n)}else this._log.warn("RoomVariablesUpdate event, unknown Room id: "+e)},_.Controllers.SystemController.prototype._fnSetUserVariables=function(t){var e=t[_.Requests.System.SetUserVariablesRequest.KEY_USER],n=t[_.Requests.System.SetUserVariablesRequest.KEY_VAR_LIST],t=this._sfs.userManager.getUserById(e),i=[];if(null!=t){for(e=0;e<n.length;e++){var a=_.Entities.Variables.SFSUserVariable.fromArray(n[e]);t._setVariable(a),i.push(a.name)}n={},n.changedVars=i,n.user=t,this._sfs._dispatchEvent(_.SFSEvent.USER_VARIABLES_UPDATE,n)}else this._log.warn("UserVariablesUpdate event, unknown User id: "+e)},_.Controllers.SystemController.prototype._fnSubscribeRoomGroup=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.System.SubscribeRoomGroupRequest.KEY_GROUP_ID],t=t[_.Requests.System.SubscribeRoomGroupRequest.KEY_ROOM_LIST];this._sfs.roomManager.containsGroup(n)&&this._log.warn("Subscribe Group error: Group '"+n+"' already subscribed"),this._populateRoomList(t),e.groupId=n,e.newRooms=this._sfs.roomManager.getRoomListFromGroup(n),this._sfs._dispatchEvent(_.SFSEvent.ROOM_GROUP_SUBSCRIBE,e)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_GROUP_SUBSCRIBE_ERROR,e)},_.Controllers.SystemController.prototype._fnUnsubscribeRoomGroup=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.System.UnsubscribeRoomGroupRequest.KEY_GROUP_ID];this._sfs.roomManager.containsGroup(n)||this._log.warn("Unsubscribe Group error: Group '"+n+"' not found (maybe never subscribed, or the Room Manager doesn't contain Rooms belonging to that Group)"),this._sfs.roomManager._removeGroup(n),e.groupId=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_GROUP_UNSUBSCRIBE,e)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_GROUP_UNSUBSCRIBE_ERROR,e)},_.Controllers.SystemController.prototype._fnSpectatorToPlayer=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.System.SpectatorToPlayerRequest.KEY_ROOM_ID],i=t[_.Requests.System.SpectatorToPlayerRequest.KEY_USER_ID],t=t[_.Requests.System.SpectatorToPlayerRequest.KEY_PLAYER_ID],a=this._sfs.userManager.getUserById(i),s=this._sfs.roomManager.getRoomById(n);null!=s?null!=a?a.isJoinedInRoom(s)?(a._setPlayerId(t,s),e.room=s,e.user=a,e.playerId=t,this._sfs._dispatchEvent(_.SFSEvent.SPECTATOR_TO_PLAYER,e)):this._log.warn("SpectatorToPlayer event, user "+a+" not joined in Room ",s):this._log.warn("SpectatorToPlayer event, unknown User id: "+i):this._log.warn("SpectatorToPlayer event, unknown Room id: "+n)}else n=t[_.Controllers.KEY_ERROR_CODE],i=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=i,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.SPECTATOR_TO_PLAYER_ERROR,e)},_.Controllers.SystemController.prototype._fnPlayerToSpectator=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.System.PlayerToSpectatorRequest.KEY_ROOM_ID],t=t[_.Requests.System.PlayerToSpectatorRequest.KEY_USER_ID],i=this._sfs.userManager.getUserById(t),a=this._sfs.roomManager.getRoomById(n);null!=a?null!=i?i.isJoinedInRoom(a)?(i._setPlayerId(-1,a),e.room=a,e.user=i,this._sfs._dispatchEvent(_.SFSEvent.PLAYER_TO_SPECTATOR,e)):this._log.warn("PlayerToSpectator event, user "+i+" not joined in Room ",a):this._log.warn("PlayerToSpectator event, unknown User id: "+t):this._log.warn("PlayerToSpectator event, unknown Room id: "+n)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.PLAYER_TO_SPECTATOR_ERROR,e)},_.Controllers.SystemController.prototype._fnFindRooms=function(t){for(var e={},t=t[_.Requests.System.FindRoomsRequest.KEY_FILTERED_ROOMS],n=[],i=0;i<t.length;i++){var a=_.Entities.SFSRoom.fromArray(t[i]),s=this._sfs.roomManager.getRoomById(a.id);null!=s&&(a.isJoined=s.isJoined),n.push(a)}e.rooms=n,this._sfs._dispatchEvent(_.SFSEvent.ROOM_FIND_RESULT,e)},_.Controllers.SystemController.prototype._fnFindUsers=function(t){for(var e={},t=t[_.Requests.System.FindUsersRequest.KEY_FILTERED_USERS],n=[],i=this._sfs.mySelf,a=0;a<t.length;a++){var s=_.Entities.SFSUser.fromArray(t[a]);s.id==i.id&&(s=i),n.push(s)}e.users=n,this._sfs._dispatchEvent(_.SFSEvent.USER_FIND_RESULT,e)},_.Controllers.SystemController.prototype._fnInviteUsers=function(t){var e={},n=null,n=null!=t[_.Requests.Game.InviteUsersRequest.KEY_USER_ID]?this._sfs.userManager.getUserById(t[_.Requests.Game.InviteUsersRequest.KEY_USER_ID]):_.Entities.SFSUser.fromArray(t[_.Requests.Game.InviteUsersRequest.KEY_USER]),i=t[_.Requests.Game.InviteUsersRequest.KEY_INVITATION_ID],t=new _.Entities.Invitation.SFSInvitation(n,this._sfs.mySelf,t[_.Requests.Game.InviteUsersRequest.KEY_TIME],t[_.Requests.Game.InviteUsersRequest.KEY_PARAMS]);t.id=i,e.invitation=t,this._sfs._dispatchEvent(_.SFSEvent.INVITATION,e)},_.Controllers.SystemController.prototype._fnInvitationReply=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=null,n=null!=t[_.Requests.Game.InviteUsersRequest.KEY_USER_ID]?this._sfs.userManager.getUserById(t[_.Requests.Game.InviteUsersRequest.KEY_USER_ID]):_.Entities.SFSUser.fromArray(t[_.Requests.Game.InviteUsersRequest.KEY_USER]),i=t[_.Requests.Game.InviteUsersRequest.KEY_REPLY_ID],t=t[_.Requests.Game.InviteUsersRequest.KEY_PARAMS];e.invitee=n,e.reply=i,e.data=t,this._sfs._dispatchEvent(_.SFSEvent.INVITATION_REPLY,e)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSEvent.INVITATION_REPLY_ERROR,e)},_.Controllers.SystemController.prototype._fnQuickJoinGame=function(t){if(null!=t[_.Controllers.KEY_ERROR_CODE]){var e=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(e,t[_.Controllers.KEY_ERROR_PARAMS]),n={};n.errorMessage=t,n.errorCode=e,this._sfs._dispatchEvent(_.SFSEvent.ROOM_JOIN_ERROR,n)}},_.Controllers.SystemController.prototype._fnPingPong=function(){var t=this._sfs._lagMonitor._onPingPong(),e={};e.lagValue=t,this._sfs._dispatchEvent(_.SFSEvent.PING_PONG,e)},_.Controllers.SystemController.prototype._fnSetUserPosition=function(t){var e={},n=this._sfs.roomManager.getRoomById(t[_.Requests.MMO.SetUserPositionRequest.KEY_ROOM]),i=t[_.Requests.MMO.SetUserPositionRequest.KEY_MINUS_USER_LIST],a=t[_.Requests.MMO.SetUserPositionRequest.KEY_PLUS_USER_LIST],s=t[_.Requests.MMO.SetUserPositionRequest.KEY_MINUS_ITEM_LIST],t=t[_.Requests.MMO.SetUserPositionRequest.KEY_PLUS_ITEM_LIST],o=[],r=[],c=[],h=[],u=0;if(null!=i)for(u=0;u<i.length;u++){var l=n.getUserById(i[u]);null!=l&&(n._removeUser(l),r.push(l))}if(null!=a)for(u=0;u<a.length;u++)l=a[u],i=this._getOrCreateUser(l,!0,n),o.push(i),n._addUser(i),l=l[5],null!=l&&(i.aoiEntryPoint=_.Entities.Data.Vec3D.fromArray(l));if(null!=s)for(u=0;u<s.length;u++)a=n.getMMOItem(s[u]),null!=a&&(n._removeItem(a),h.push(a));if(null!=t)for(u=0;u<t.length;u++)a=t[u],s=_.Entities.MMOItem.fromArray(a),c.push(s),n._addMMOItem(s),a=a[2],null!=a&&(s.aoiEntryPoint=_.Entities.Data.Vec3D.fromArray(a));e.addedItems=c,e.removedItems=h,e.removedUsers=r,e.addedUsers=o,e.room=n,this._sfs._dispatchEvent(_.SFSEvent.PROXIMITY_LIST_UPDATE,e)},_.Controllers.SystemController.prototype._fnSetMMOItemVariables=function(t){var e={},n=this._sfs.roomManager.getRoomById(t[_.Requests.MMO.SetMMOItemVariables.KEY_ROOM_ID]),i=t[_.Requests.MMO.SetMMOItemVariables.KEY_ITEM_ID],t=t[_.Requests.MMO.SetMMOItemVariables.KEY_VAR_LIST],a=[];if(null!=n&&(i=n.getMMOItem(i),null!=i)){for(var s=0;s<t.length;s++){var o=_.Entities.Variables.MMOItemVariable.fromArray(t[s]);i._setVariable(o),a.push(o.name)}e.changedVars=a,e.mmoItem=i,e.room=n,this._sfs._dispatchEvent(_.SFSEvent.MMOITEM_VARIABLES_UPDATE,e)}},_.Controllers.SystemController.prototype._fnUserEnterRoom=function(t){var e=this._sfs.roomManager.getRoomById(t[_.Controllers.ROOM_PARAM]);if(null!=e){t=this._getOrCreateUser(t[_.Controllers.USER_PARAM],!0,e),e._addUser(t);var n={};n.user=t,n.room=e,this._sfs._dispatchEvent(_.SFSEvent.USER_ENTER_ROOM,n)}},_.Controllers.SystemController.prototype._fnUserCountChange=function(t){var e=this._sfs.roomManager.getRoomById(t[_.Controllers.ROOM_PARAM]);if(null!=e){var n=t[_.Controllers.USER_COUNT_PARAM],i=0;null!=t.sc&&(i=t[_.Controllers.SPECT_COUNT_PARAM]),e._userCount=n,e._specCount=i,t={},t.room=e,t.uCount=n,t.sCount=i,this._sfs._dispatchEvent(_.SFSEvent.USER_COUNT_CHANGE,t)}},_.Controllers.SystemController.prototype._fnUserLost=function(t){if(t=this._sfs.userManager.getUserById(t[_.Controllers.USER_PARAM]),null!=t){var e=this._sfs.roomManager.getUserRooms(t);this._sfs.roomManager._removeUser(t),this._sfs.userManager._removeUser(t);for(var n=0;n<e.length;n++){var i={};i.user=t,i.room=e[n],this._sfs._dispatchEvent(_.SFSEvent.USER_EXIT_ROOM,i)}}},_.Controllers.SystemController.prototype._fnRoomLost=function(t){var t=this._sfs.roomManager.getRoomById(t[_.Controllers.ROOM_PARAM]),e=this._sfs.userManager;if(null!=t){this._sfs.roomManager._removeRoom(t);for(var n=t.getUserList(),i=0;i<n.length;i++)e._removeUser(n[i]);e={},e.room=t,this._sfs._dispatchEvent(_.SFSEvent.ROOM_REMOVE,e)}},_.Controllers.SystemController.prototype._fnUserExitRoom=function(t){var e=this._sfs.roomManager.getRoomById(t[_.Controllers.ROOM_PARAM]),t=this._sfs.userManager.getUserById(t[_.Controllers.USER_PARAM]);if(null!=e&&null!=t){e._removeUser(t),this._sfs.userManager._removeUser(t),t.isItMe&&e.isJoined&&(e.isJoined=!1,0==this._sfs.roomManager.getJoinedRooms().length&&(this._sfs.lastJoinedRoom=null),e._isManaged||this._sfs.roomManager._removeRoom(e));var n={};n.user=t,n.room=e,this._sfs._dispatchEvent(_.SFSEvent.USER_EXIT_ROOM,n)}else this._log.debug("Failed to handle UserExit event. Room: "+e+", User: "+t)},_.Controllers.SystemController.prototype._fnClientDisconnection=function(t){this._sfs._handleClientDisconnection(_.Utils.ClientDisconnectionReason.getReason(t.dr))},_.Controllers.SystemController.prototype._fnInitBuddyList=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.BuddyList.InitBuddyListRequest.KEY_BLIST],i=t[_.Requests.BuddyList.InitBuddyListRequest.KEY_MY_VARS],a=t[_.Requests.BuddyList.InitBuddyListRequest.KEY_BUDDY_STATES];for(this._sfs.buddyManager._clearAll(),t=0;t<n.length;t++){var s=_.Entities.SFSBuddy.fromArray(n[t]);this._sfs.buddyManager._addBuddy(s)}for(null!=a&&this._sfs.buddyManager._setBuddyStates(a),n=[],t=0;t<i.length;t++)a=_.Entities.Variables.SFSBuddyVariable.fromArray(i[t]),n.push(a);this._sfs.buddyManager._setMyVariables(n),this._sfs.buddyManager._setInited(),e.buddyList=this._sfs.buddyManager.getBuddyList(),e.myVariables=this._sfs.buddyManager.getMyVariables(),this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_LIST_INIT,e)}else i=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(i,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=i,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ERROR,e)},_.Controllers.SystemController.prototype._fnAddBuddy=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=_.Entities.SFSBuddy.fromArray(t[_.Requests.BuddyList.AddBuddyRequest.KEY_BUDDY_NAME]);this._sfs.buddyManager._addBuddy(n),e.buddy=n,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ADD,e)}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ERROR,e)},_.Controllers.SystemController.prototype._fnRemoveBuddy=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.BuddyList.RemoveBuddyRequest.KEY_BUDDY_NAME],t=this._sfs.buddyManager._removeBuddyByName(n);null!=t?(e.buddy=t,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_REMOVE,e)):this._log.warn("Unexpected: buddy removal failed, can't find "+n+" in local buddy list")}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ERROR,e)},_.Controllers.SystemController.prototype._fnBlockBuddy=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_NAME],i=this._sfs.buddyManager.getBuddyByName(n);null!=i?(i.blocked=t[_.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_BLOCK_STATE],e.buddy=i,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_BLOCK,e)):this._log.warn("Unexpected: buddy blocking/unblocking failed, can't find "+n+" in local buddy list")}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ERROR,e)},_.Controllers.SystemController.prototype._fnGoOnline=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){var n=t[_.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_NAME],i=this._sfs.buddyManager.getBuddyByName(n),a=n==this._sfs.mySelf.name,s=t[_.Requests.BuddyList.GoOnlineRequest.KEY_ONLINE],o=s==_.Utils.BuddyOnlineState.ONLINE,r=!0;if(a)this._sfs.buddyManager.getMyOnlineState()!=o&&(this._log.warn("Unexpected: myOnlineState is not in synch with the server; resynching to: "+o),this._sfs.buddyManager._setMyOnlineState(o));else{if(null==i)return void this._log.warn("Unexpected:  buddy '"+n+"' not found in local Buddy List when trying to set his online state");i.id=t[_.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_ID],i._setVariable(new _.Entities.Variables.SFSBuddyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_ONLINE,o)),s==_.Utils.BuddyOnlineState.LEFT_THE_SERVER&&i._clearVolatileVariables(),r=this._sfs.buddyManager.getMyOnlineState()}r&&(e.buddy=i,e.isItMe=a,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ONLINE_STATE_CHANGE,e))}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ERROR,e)},_.Controllers.SystemController.prototype._fnSetBuddyVariables=function(t){var e={};if(null==t[_.Controllers.KEY_ERROR_CODE]){for(var n=t[_.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_NAME],t=t[_.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_VARS],i=this._sfs.buddyManager.getBuddyByName(n),a=n==this._sfs.mySelf.name,s=[],o=[],r=!0,c=0;c<t.length;c++){var h=_.Entities.Variables.SFSBuddyVariable.fromArray(t[c]);o.push(h),s.push(h.name)}if(a)this._sfs.buddyManager._setMyVariables(o);else{if(null==i)return void this._log.warn("Unexpected:  buddy '"+n+"' not found in local Buddy List when trying to set his Buddy Variables");i._setVariables(o),r=sfs.buddyManager.getMyOnlineState()}r&&(e.buddy=i,e.isItMe=a,e.changedVars=s,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_VARIABLES_UPDATE,e))}else n=t[_.Controllers.KEY_ERROR_CODE],t=_.ErrorCodes.getErrorMessage(n,t[_.Controllers.KEY_ERROR_PARAMS]),e.errorMessage=t,e.errorCode=n,this._sfs._dispatchEvent(_.SFSBuddyEvent.BUDDY_ERROR,e)},_.Controllers.SystemController.prototype._populateRoomList=function(t){for(var e=this._sfs.roomManager,n=0;n<t.length;n++){var i=_.Entities.SFSRoom.fromArray(t[n]);e._replaceRoom(i)}},_.Controllers.SystemController.prototype._getOrCreateUser=function(t,e,n){null==e&&(e=!1);var i=this._sfs.userManager.getUserById(t[0]);if(null==i)i=_.Entities.SFSUser.fromArray(t,n),i._setUserManager(this._sfs.userManager);else if(null!=n)for(i._setPlayerId(t[3],n),t=t[4],n=0;n<t.length;n++)i._setVariable(_.Entities.Variables.SFSUserVariable.fromArray(t[n]));return e&&this._sfs.userManager._addUser(i),i},_.Controllers.ExtensionController=function(t){this.KEY_CMD="c",this.KEY_PARAMS="p",this.KEY_ROOM="r",this._sfs=t,this._id=1,this._log=_.Logger},_.Controllers.ExtensionController.prototype.getId=function(){return this._id},_.Controllers.ExtensionController.prototype.handleMessage=function(t){this._sfs.debug&&this._log.info("IN < ExtensionResponse");var e={};e.cmd=t[this.KEY_CMD],e.params=t[this.KEY_PARAMS],null!=t[this.KEY_ROOM]&&(e.sourceRoom=t[this.KEY_ROOM]),this._sfs._dispatchEvent(_.SFSEvent.EXTENSION_RESPONSE,e)},_.DebugHelper={},_.DebugHelper.getDump=function(t){return void 0==t?"<Null>":t instanceof Object?this._dumpObject(t):"<Not An Object>"},_.DebugHelper._dumpObject=function(t){function e(t,n,i){var a=null;_.DebugHelper._getTabs(i);for(var s in t){var o=t[s];if(null==o)a="Null";else{var r=o.constructor,c=void 0;r===Array||r===Object?(a=null,c=r===Array?"[Array]":"[Object]",e(o,n,i+1)):a=o.constructor===Number?"Num":o.constructor===Boolean?"Bool":o.constructor===String?"Str":"Unsupported"}n.push(_.DebugHelper._getTabs(i)+s+": "+(void 0==c?o:c)+(void 0==a?"":" ("+a+")"))}}var n=[];return e(t,n,0),_.DebugHelper._prettyPrint(n)},_.DebugHelper._getTabs=function(t){if(0>=t)return"";if(1==t)return"\t";for(var e="",n=0;n<t;n++)e+="\t";return e},_.DebugHelper._prettyPrint=function(t){for(var e="",n=t.length-1;-1<n;n--)e+=t[n]+"\n";return e},_.Entities={},_.Entities.Data={},_.Entities.Variables={},_.Entities.Match={},_.Entities.Invitation={},_.Entities.SFSRoom=y.extend({init:function(t,e,n){this.id=t,this.name=e,this.groupId=null!=n?n:"default",this.isPasswordProtected=this.isJoined=this.isHidden=this.isGame=!1,this._specCount=this._userCount=this.maxSpectators=this.maxUsers=0,this._isManaged=!0,this.variables={},this.properties={},this._userManager=new _.Managers.UserManager,this._roomManager=null},toString:function(){return"[Room: "+this.name+", Id: "+this.id+", Group id: "+this.groupId+"]"},getUserCount:function(){return this.isJoined?this.isGame?this.getPlayerList().length:this._userManager.getUserCount():this._userCount},getSpectatorCount:function(){return this.isGame?this.isJoined?this.getSpectatorList().length:this._specCount:0},getCapacity:function(){return this.maxUsers+this.maxSpectators},getUserByName:function(t){return this._userManager.getUserByName(t)},getUserById:function(t){return this._userManager.getUserById(t)},containsUser:function(t){return this._userManager.containsUser(t)},getUserList:function(){return this._userManager.getUserList()},getPlayerList:function(){for(var t=[],e=this._userManager.getUserList(),n=0;n<e.length;n++){var i=e[n];i.isPlayerInRoom(this)&&t.push(i)}return t},getSpectatorList:function(){for(var t=[],e=this._userManager.getUserList(),n=0;n<e.length;n++){var i=e[n];i.isSpectatorInRoom(this)&&t.push(i)}return t},getVariable:function(t){return this.variables[t]},containsVariable:function(t){return null!=this.variables[t]},getVariables:function(){return _.Utils.ArrayUtil.objToArray(this.variables)},getRoomManager:function(){return this._roomManager},_addUser:function(t){this._userManager._addUser(t)},_removeUser:function(t){this._userManager._removeUser(t)},_setVariables:function(t){for(var e=0;e<t.length;e++)this._setVariable(t[e])},_setVariable:function(t){t.isNull()?delete this.variables[t.name]:this.variables[t.name]=t},_setRoomManager:function(t){if(null!=this._roomManager)throw new _.Exceptions.SFSError("Room Manager already assigned to Room "+this.toString());this._roomManager=t},_merge:function(t){this.variables=[];for(var e in t.variables)this.variables[e]=t.variables[e];for(this._userManager._clearAll(),t=t.getUserList(),e=0;e<t.length;e++)this._userManager._addUser(t[e])}}),_.Entities.SFSRoom.fromArray=function(t){var e=14==t.length,n=null,n=e?new _.Entities.MMORoom(t[0],t[1],t[2]):new _.Entities.SFSRoom(t[0],t[1],t[2]);n.isGame=t[3],n.isHidden=t[4],n.isPasswordProtected=t[5],n._userCount=t[6],n.maxUsers=t[7];var i=t[8];if(null!=i)for(var a=0;a<i.length;a++){var s=_.Entities.Variables.SFSRoomVariable.fromArray(i[a]);n._setVariable(s)}return n.isGame&&(n._specCount=t[9],n.maxSpectators=t[10]),e&&(n.defaultAOI=_.Entities.Data.Vec3D.fromArray(t[11]),null!=t[13]&&(n.lowerMapLimit=_.Entities.Data.Vec3D.fromArray(t[12]),n.higherMapLimit=_.Entities.Data.Vec3D.fromArray(t[13]))),n},_.Entities.MMORoom=_.Entities.SFSRoom.extend({init:function(t,e,n){this._super(t,e,n),this.higherMapLimit=this.lowerMapLimit=this.defaultAOI=null,this._itemsById={}},getMMOItem:function(t){return this._itemsById[t]},getMMOItems:function(){return _.Utils.ArrayUtil.objToArray(this._itemsById)},_addMMOItem:function(t){this._itemsById[t.id]=t},_removeItem:function(t){delete this._itemsById[t]}}),_.Entities.SFSUser=function(t,e,n){this.id=t,this.name=e,this.isItMe=null!=n&&n,this.privilegeId=0,this.properties={},this.aoiEntryPoint=null,this.variables={},this._playerIdByRoomId={},this._userManager=null},_.Entities.SFSUser.fromArray=function(t,e){var n=new _.Entities.SFSUser(t[0],t[1]);n.privilegeId=t[2],null!=e&&n._setPlayerId(t[3],e);var i=t[4];if(null!=i)for(var a=0;a<i.length;a++){var s=_.Entities.Variables.SFSUserVariable.fromArray(i[a]);n._setVariable(s)}return n},_.Entities.SFSUser.prototype.toString=function(){return"[User: "+this.name+", Id: "+this.id+", Is me: "+this.isItMe+"]"},_.Entities.SFSUser.prototype.isJoinedInRoom=function(t){return t.containsUser(this)},_.Entities.SFSUser.prototype.isGuest=function(){return this.privilegeId==_.Entities.UserPrivileges.GUEST},_.Entities.SFSUser.prototype.isStandardUser=function(){return this.privilegeId==_.Entities.UserPrivileges.STANDARD},_.Entities.SFSUser.prototype.isModerator=function(){return this.privilegeId==_.Entities.UserPrivileges.MODERATOR},_.Entities.SFSUser.prototype.isAdmin=function(){return this.privilegeId==_.Entities.UserPrivileges.ADMINISTRATOR},_.Entities.SFSUser.prototype.isPlayer=function(){return this.isPlayerInRoom(this._userManager._sfs.lastJoinedRoom)},_.Entities.SFSUser.prototype.isSpectator=function(){return this.isSpectatorInRoom(this._userManager._sfs.lastJoinedRoom)},_.Entities.SFSUser.prototype.getPlayerId=function(t){var e=0;return null!=this._playerIdByRoomId[t.id]&&(e=this._playerIdByRoomId[t.id]),e},_.Entities.SFSUser.prototype.isPlayerInRoom=function(t){return!(null==t||!t.isGame)&&0<this._playerIdByRoomId[t.id]},_.Entities.SFSUser.prototype.isSpectatorInRoom=function(t){return!(null==t||!t.isGame)&&0>this._playerIdByRoomId[t.id]},_.Entities.SFSUser.prototype.getVariable=function(t){return this.variables[t]},_.Entities.SFSUser.prototype.containsVariable=function(t){return null!=this.variables[t]},_.Entities.SFSUser.prototype.getVariables=function(){return _.Utils.ArrayUtil.objToArray(this.variables)},_.Entities.SFSUser.prototype.getUserManager=function(){return this._userManager},_.Entities.SFSUser.prototype._setPlayerId=function(t,e){this._playerIdByRoomId[e.id]=t},_.Entities.SFSUser.prototype._removePlayerId=function(t){delete this._playerIdByRoomId[t.id]},_.Entities.SFSUser.prototype._setVariables=function(t){for(var e=0;e<t.length;e++)this._setVariable(t[e])},_.Entities.SFSUser.prototype._setVariable=function(t){t.isNull()?delete this.variables[t.name]:this.variables[t.name]=t},_.Entities.SFSUser.prototype._setUserManager=function(t){if(null!=this._userManager)throw new _.Exceptions.SFSError("User Manager already assigned to user "+this.toString());this._userManager=t},_.Entities.SFSBuddy=function(t,e,n,i){this.id=t,this.name=e,this.blocked=null!=n&&n,this.temp=null!=i&&i,this.variables={}},_.Entities.SFSBuddy.fromArray=function(t){for(var e=new _.Entities.SFSBuddy(t[0],t[1],t[2],4<t.length&&t[4]),t=t[3],n=0;n<t.length;n++){var i=_.Entities.Variables.SFSBuddyVariable.fromArray(t[n]);e._setVariable(i)}return e},_.Entities.SFSBuddy.prototype.toString=function(){return"[Buddy: "+this.name+", Id: "+this.id+"]"},_.Entities.SFSBuddy.prototype.isBlocked=function(){return this.blocked},_.Entities.SFSBuddy.prototype.isTemp=function(){return this.temp},_.Entities.SFSBuddy.prototype.isOnline=function(){var t=!0,e=_.Entities.Variables.ReservedBuddyVariables.BV_ONLINE;return this.containsVariable(e)&&(t=this.getVariable(e).value),t&&-1<this.id},_.Entities.SFSBuddy.prototype.getState=function(){var t=_.Entities.Variables.ReservedBuddyVariables.BV_STATE;return this.containsVariable(t)?this.getVariable(t).value:null},_.Entities.SFSBuddy.prototype.getNickName=function(){var t=_.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME;return this.containsVariable(t)?this.getVariable(t).value:null},_.Entities.SFSBuddy.prototype.getVariable=function(t){return this.variables[t]},_.Entities.SFSBuddy.prototype.containsVariable=function(t){return null!=this.variables[t]},_.Entities.SFSBuddy.prototype.getVariables=function(){return _.Utils.ArrayUtil.objToArray(this.variables)},_.Entities.SFSBuddy.prototype.getOfflineVariables=function(){var t,e=[];for(t in this.variables){var n=this.variables[t];n.name.charAt(0)==_.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX&&e.push(n)}return e},_.Entities.SFSBuddy.prototype.getOnlineVariables=function(){var t,e=[];for(t in this.variables){var n=this.variables[t];n.name.charAt(0)!=_.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX&&e.push(n)}return e},_.Entities.SFSBuddy.prototype._setVariables=function(t){for(var e=0;e<t.length;e++)this._setVariable(t[e])},_.Entities.SFSBuddy.prototype._setVariable=function(t){t.isNull()?this._removeVariable(t.name):this.variables[t.name]=t},_.Entities.SFSBuddy.prototype._removeVariable=function(t){delete this.variables[t]},_.Entities.SFSBuddy.prototype._clearVolatileVariables=function(){for(var t in this.variables){var e=this.variables[t];e.name.charAt(0)!=_.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX&&this._removeVariable(e.name)}},_.Entities.MMOItem=function(t){this.id=t,this.aoiEntryPoint=null,this.variables={}},_.Entities.MMOItem.fromArray=function(t){var e=new _.Entities.MMOItem(t[0]),t=t[1];if(null!=t)for(var n=0;n<t.length;n++){var i=_.Entities.Variables.MMOItemVariable.fromArray(t[n]);e._setVariable(i)}return e},_.Entities.MMOItem.prototype.toString=function(){return"[Item: "+this.id+"]"},_.Entities.MMOItem.prototype.getVariable=function(t){return this.variables[t]},_.Entities.MMOItem.prototype.containsVariable=function(t){return null!=this.variables[t]},_.Entities.MMOItem.prototype.getVariables=function(){return _.Utils.ArrayUtil.objToArray(this.variables)},_.Entities.MMOItem.prototype._setVariables=function(t){for(var e=0;e<t.length;e++)this._setVariable(t[e])},_.Entities.MMOItem.prototype._setVariable=function(t){null!=t&&(t.isNull()?delete this.variables[t.name]:this.variables[t.name]=t)},_.Entities.Variables.SFSUserVariable=y.extend({init:function(t,e,n){this.name=t,this.value=e,this._setType(n)},toString:function(){return"[UserVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"},toArray:function(){return[this.name,_.Entities.Variables.VariableType.getTypeIdFromName(this.type),this.value]},isNull:function(){return _.Entities.Variables.VariableType.getTypeIdFromName(this.type)==_.Entities.Variables.VariableType.NULL},_setType:function(t){null==t&&(t=-1),-1<t?this.type=this.getTypeName(t):null==this.value?this.type=this.getTypeName(_.Entities.Variables.VariableType.NULL):(t=typeof this.value,"boolean"==t?this.type=this.getTypeName(_.Entities.Variables.VariableType.BOOL):"number"==t?this.type=this.value===+this.value&&this.value===(0|this.value)?this.getTypeName(_.Entities.Variables.VariableType.INT):this.getTypeName(_.Entities.Variables.VariableType.DOUBLE):"string"==t?this.type=this.getTypeName(_.Entities.Variables.VariableType.STRING):"object"==t&&(this.type=this.value instanceof Array?this.getTypeName(_.Entities.Variables.VariableType.ARRAY):this.getTypeName(_.Entities.Variables.VariableType.OBJECT)))},getTypeName:function(t){return _.Entities.Variables.VariableType.getTypeName(t)}}),_.Entities.Variables.SFSUserVariable.fromArray=function(t){return new _.Entities.Variables.SFSUserVariable(t[0],t[2],t[1])},_.Entities.Variables.SFSRoomVariable=_.Entities.Variables.SFSUserVariable.extend({init:function(t,e,n){this._super(t,e,n),this.isPersistent=this.isPrivate=!1},toString:function(){return"[RoomVar: "+this.name+", Type: "+this.type+", Value: "+this.value+", Is private: "+this.isPrivate+"]"},toArray:function(){var t=this._super();return t.push(this.isPrivate),t.push(this.isPersistent),t}}),_.Entities.Variables.SFSRoomVariable.fromArray=function(t){var e=new _.Entities.Variables.SFSRoomVariable(t[0],t[2],t[1]);return e.isPrivate=t[3],e.isPersistent=t[4],e},_.Entities.Variables.SFSBuddyVariable=_.Entities.Variables.SFSUserVariable.extend({init:function(t,e,n){this._super(t,e,n)},toString:function(){return"[BuddyVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"},isOffline:function(){return this.name.charAt(0)==_.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX}}),_.Entities.Variables.SFSBuddyVariable.OFFLINE_PREFIX="$",_.Entities.Variables.SFSBuddyVariable.fromArray=function(t){return new _.Entities.Variables.SFSBuddyVariable(t[0],t[2],t[1])},_.Entities.Variables.MMOItemVariable=_.Entities.Variables.SFSUserVariable.extend({init:function(t,e,n){this._super(t,e,n)},toString:function(){return"[ItemVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"}}),_.Entities.Variables.MMOItemVariable.fromArray=function(t){return new _.Entities.Variables.MMOItemVariable(t[0],t[2],t[1])},_.Entities.Variables.VariableType={_typeStrings:"Null Bool Int Double String Object Array".split(" "),NULL:0,BOOL:1,INT:2,DOUBLE:3,STRING:4,OBJECT:5,ARRAY:6},_.Entities.Variables.VariableType.getTypeName=function(t){return this._typeStrings[t]},_.Entities.Variables.VariableType.getTypeIdFromName=function(t){return this._typeStrings.indexOf(t)},_.Entities.Variables.ReservedBuddyVariables={},_.Entities.Variables.ReservedBuddyVariables.BV_ONLINE="$__BV_ONLINE__",_.Entities.Variables.ReservedBuddyVariables.BV_STATE="$__BV_STATE__",_.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME="$__BV_NICKNAME__",_.Entities.Variables.ReservedRoomVariables={},_.Entities.Variables.ReservedRoomVariables.RV_GAME_STARTED="$GS",_.Entities.UserPrivileges={},_.Entities.UserPrivileges.GUEST=0,_.Entities.UserPrivileges.STANDARD=1,_.Entities.UserPrivileges.MODERATOR=2,_.Entities.UserPrivileges.ADMINISTRATOR=3,_.Entities.Match.MatchExpression=function(t,e,n){this.varName=t,this.condition=e,this.value=n,this._parent=this.next=this.logicOp=null},_.Entities.Match.MatchExpression.chainedMatchExpression=function(t,e,n,i,a){return t=new _.Entities.Match.MatchExpression(t,e,n),t.logicOp=i,t._parent=a,t},_.Entities.Match.MatchExpression.prototype.and=function(t,e,n){return this.next=_.Entities.Match.MatchExpression.chainedMatchExpression(t,e,n,_.Entities.Match.LogicOperator.AND,this)},_.Entities.Match.MatchExpression.prototype.or=function(t,e,n){return this.next=_.Entities.Match.MatchExpression.chainedMatchExpression(t,e,n,_.Entities.Match.LogicOperator.OR,this)},_.Entities.Match.MatchExpression.prototype.hasNext=function(){
return null!=this.next},_.Entities.Match.MatchExpression.prototype.rewind=function(){for(var t=this;null!=t._parent;)t=t._parent;return t},_.Entities.Match.MatchExpression.prototype.toString=function(){for(var t=this.rewind(),e=t._asString();t.hasNext();)t=t.next,e+=t._asString();return e},_.Entities.Match.MatchExpression.prototype._asString=function(){var t="";return null!=this.logicOp&&(t+=" "+this.logicOp.id+" "),t=t+"("+(this.varName+" "+this.condition.symbol+" "+("string"==typeof this.value?"'"+this.value+"'":this.value)),t+")"},_.Entities.Match.MatchExpression.prototype._toArray=function(){var t=this.rewind(),e=[];for(e.push(t._expressionAsArray());t.hasNext();)t=t.next,e.push(t._expressionAsArray());return e},_.Entities.Match.MatchExpression.prototype._expressionAsArray=function(){var t=[];return null!=this.logicOp?t.push(this.logicOp.id):t.push(null),t.push(this.varName),t.push(this.condition.type),t.push(this.condition.symbol),t.push(this.value),t},_.Entities.Match.LogicOperator=function(t){this.id=t},_.Entities.Match.LogicOperator.AND=new _.Entities.Match.LogicOperator("AND"),_.Entities.Match.LogicOperator.OR=new _.Entities.Match.LogicOperator("OR"),_.Entities.Match.BoolMatch=function(t){this.type=0,this.symbol=t},_.Entities.Match.BoolMatch.EQUALS=new _.Entities.Match.BoolMatch("=="),_.Entities.Match.BoolMatch.NOT_EQUALS=new _.Entities.Match.BoolMatch("!="),_.Entities.Match.NumberMatch=function(t){this.type=1,this.symbol=t},_.Entities.Match.NumberMatch.EQUALS=new _.Entities.Match.NumberMatch("=="),_.Entities.Match.NumberMatch.NOT_EQUALS=new _.Entities.Match.NumberMatch("!="),_.Entities.Match.NumberMatch.GREATER_THAN=new _.Entities.Match.NumberMatch(">"),_.Entities.Match.NumberMatch.GREATER_THAN_OR_EQUAL_TO=new _.Entities.Match.NumberMatch(">="),_.Entities.Match.NumberMatch.LESS_THAN=new _.Entities.Match.NumberMatch("<"),_.Entities.Match.NumberMatch.LESS_THAN_OR_EQUAL_TO=new _.Entities.Match.NumberMatch("<="),_.Entities.Match.StringMatch=function(t){this.type=2,this.symbol=t},_.Entities.Match.StringMatch.EQUALS=new _.Entities.Match.StringMatch("=="),_.Entities.Match.StringMatch.NOT_EQUALS=new _.Entities.Match.StringMatch("!="),_.Entities.Match.StringMatch.CONTAINS=new _.Entities.Match.StringMatch("contains"),_.Entities.Match.StringMatch.STARTS_WITH=new _.Entities.Match.StringMatch("startsWith"),_.Entities.Match.StringMatch.ENDS_WITH=new _.Entities.Match.StringMatch("endsWith"),_.Entities.Match.RoomProperties={},_.Entities.Match.RoomProperties.NAME="${N}",_.Entities.Match.RoomProperties.GROUP_ID="${G}",_.Entities.Match.RoomProperties.MAX_USERS="${MXU}",_.Entities.Match.RoomProperties.MAX_SPECTATORS="${MXS}",_.Entities.Match.RoomProperties.USER_COUNT="${UC}",_.Entities.Match.RoomProperties.SPECTATOR_COUNT="${SC}",_.Entities.Match.RoomProperties.IS_GAME="${ISG}",_.Entities.Match.RoomProperties.IS_PRIVATE="${ISP}",_.Entities.Match.RoomProperties.HAS_FREE_PLAYER_SLOTS="${HFP}",_.Entities.Match.RoomProperties.IS_TYPE_SFSGAME="${IST}",_.Entities.Match.UserProperties={},_.Entities.Match.UserProperties.NAME="${N}",_.Entities.Match.UserProperties.IS_PLAYER="${ISP}",_.Entities.Match.UserProperties.IS_SPECTATOR="${ISS}",_.Entities.Match.UserProperties.IS_NPC="${ISN}",_.Entities.Match.UserProperties.PRIVILEGE_ID="${PRID}",_.Entities.Match.UserProperties.IS_IN_ANY_ROOM="${IAR}",_.Entities.Invitation.SFSInvitation=function(t,e,n,i){this.id=-1,this.inviter=t,this.invitee=e,this.secondsForAnswer=null!=n?n:15,this.params=i},_.Entities.Invitation.InvitationReply={},_.Entities.Invitation.InvitationReply.ACCEPT=0,_.Entities.Invitation.InvitationReply.REFUSE=1,_.Entities.Data.Vec3D=function(t,e,n){this.px=null!=t?t:0,this.py=null!=e?e:0,this.pz=null!=n?n:0},_.Entities.Data.Vec3D.fromArray=function(t){return new _.Entities.Data.Vec3D(t[0],t[1],t[2])},_.Entities.Data.Vec3D.prototype.isFloat=function(){return!(this.px===parseInt(this.px)&&this.py===parseInt(this.py)&&this.pz===parseInt(this.pz))},_.Entities.Data.Vec3D.prototype._toString=function(){return"("+this.px+", "+this.py+", "+this.pz+")"},_.Entities.Data.Vec3D.prototype._toArray=function(){return[this.px,this.py,this.pz]},_.ErrorCodes={},_.ErrorCodes._errorsByCode=["Client API version is obsolete: {0}; required version: {1}","Requested Zone {0} does not exist","User name {0} is not recognized","Wrong password for user {0}","User {0} is banned","Zone {0} is full","User {0} is already logged in Zone {1}","The server is full","Zone {0} is currently inactive","User name {0} contains bad words; filtered: {1}","Guest users not allowed in Zone {0}","IP address {0} is banned","A Room with the same name already exists: {0}","Requested Group is not available - Room: {0}; Group: {1}","Bad Room name length -  Min: {0}; max: {1}; passed name length: {2}","Room name contains bad words: {0}","Zone is full; can't add Rooms anymore","You have exceeded the number of Rooms that you can create per session: {0}","Room creation failed, wrong parameter: {0}","User {0} already joined in Room","Room {0} is full","Wrong password for Room {0}","Requested Room does not exist","Room {0} is locked","Group {0} is already subscribed","Group {0} does not exist","Group {0} is not subscribed","Group {0} does not exist","{0}","Room permission error; Room {0} cannot be renamed","Room permission error; Room {0} cannot change password state","Room permission error; Room {0} cannot change capacity","Switch user error; no player slots available in Room {0}","Switch user error; no spectator slots available in Room {0}","Switch user error; Room {0} is not a Game Room","Switch user error; you are not joined in Room {0}","Buddy Manager initialization error, could not load buddy list: {0}","Buddy Manager error, your buddy list is full; size is {0}","Buddy Manager error, was not able to block buddy {0} because offline","Buddy Manager error, you are attempting to set too many Buddy Variables; limit is {0}","Game {0} access denied, user does not match access criteria","QuickJoinGame action failed: no matching Rooms were found","Your previous invitation reply was invalid or arrived too late"],_.ErrorCodes.setErrorMessage=function(t,e){this._errorsByCode[t]=e},_.ErrorCodes.getErrorMessage=function(t,e){return this.stringFormat(this._errorsByCode[t],e)},_.ErrorCodes.stringFormat=function(t,e){if(null==t)return"";if(null!=e)for(var n=0;n<e.length;n++)t=t.replace("{"+n+"}",e[n]);return t},_.EventDispatcher=function(){this.listenersByEvent={}},_.EventDispatcher.prototype.addEventListener=function(t,e,n){null==this.listenersByEvent[t]&&(this.listenersByEvent[t]=[]),this.listenersByEvent[t].push({listener:e,scope:n})},_.EventDispatcher.prototype.removeEventListener=function(t,e){var n=this.listenersByEvent[t];if(null!=n)for(var i=0;i<n.length;i++)if(n[i].listener===e){n.splice(i,1);break}},_.EventDispatcher.prototype.dispatchEvent=function(t,e){var n=this.listenersByEvent[t];if(n&&0<n.length)for(var i=0;i<n.length;i++)n[i].listener.call(n[i].scope,e)},_.EventDispatcher.prototype.getListeners=function(t){return listeners[t]},_.SFSEvent={HANDSHAKE:"handshake",CONNECTION:"connection",CONNECTION_LOST:"connectionLost",CONNECTION_RETRY:"connectionRetry",CONNECTION_RESUME:"connectionResume",LOGIN:"login",LOGIN_ERROR:"loginError",LOGOUT:"logout",ROOM_ADD:"roomAdd",ROOM_CREATION_ERROR:"roomCreationError",ROOM_REMOVE:"roomRemove",ROOM_JOIN:"roomJoin",ROOM_JOIN_ERROR:"roomJoinError",USER_ENTER_ROOM:"userEnterRoom",USER_EXIT_ROOM:"userExitRoom",USER_COUNT_CHANGE:"userCountChange",PROXIMITY_LIST_UPDATE:"proximityListUpdate",PLAYER_TO_SPECTATOR:"playerToSpectator",PLAYER_TO_SPECTATOR_ERROR:"playerToSpectatorError",SPECTATOR_TO_PLAYER:"spectatorToPlayer",SPECTATOR_TO_PLAYER_ERROR:"spectatorToPlayerError",ROOM_NAME_CHANGE:"roomNameChange",ROOM_NAME_CHANGE_ERROR:"roomNameChangeError",ROOM_PASSWORD_STATE_CHANGE:"roomPasswordStateChange",ROOM_PASSWORD_STATE_CHANGE_ERROR:"roomPasswordStateChangeError",ROOM_CAPACITY_CHANGE:"roomCapacityChange",ROOM_CAPACITY_CHANGE_ERROR:"roomCapacityChangeError",PUBLIC_MESSAGE:"publicMessage",PRIVATE_MESSAGE:"privateMessage",OBJECT_MESSAGE:"objectMessage",MODERATOR_MESSAGE:"moderatorMessage",ADMIN_MESSAGE:"adminMessage",EXTENSION_RESPONSE:"extensionResponse",ROOM_VARIABLES_UPDATE:"roomVariablesUpdate",USER_VARIABLES_UPDATE:"userVariablesUpdate",MMOITEM_VARIABLES_UPDATE:"mmoItemVariablesUpdate",ROOM_GROUP_SUBSCRIBE:"roomGroupSubscribe",ROOM_GROUP_SUBSCRIBE_ERROR:"roomGroupSubscribeError",ROOM_GROUP_UNSUBSCRIBE:"roomGroupUnsubscribe",ROOM_GROUP_UNSUBSCRIBE_ERROR:"roomGroupUnsubscribeError",ROOM_FIND_RESULT:"roomFindResult",USER_FIND_RESULT:"userFindResult",INVITATION:"invitation",INVITATION_REPLY:"invitationReply",INVITATION_REPLY_ERROR:"invitationReplyError",PING_PONG:"pingPong",SOCKET_ERROR:"socketError"},_.SFSBuddyEvent={BUDDY_LIST_INIT:"buddyListInit",BUDDY_ADD:"buddyAdd",BUDDY_REMOVE:"buddyRemove",BUDDY_BLOCK:"buddyBlock",BUDDY_ERROR:"buddyError",BUDDY_ONLINE_STATE_CHANGE:"buddyOnlineStateChange",BUDDY_VARIABLES_UPDATE:"buddyVariablesUpdate",BUDDY_MESSAGE:"buddyMessage"},_.Exceptions={},_.Exceptions.SFSError=y.extend({init:function(t){this._messsage=t},getMessage:function(){return this._messsage}}),_.Exceptions.SFSValidationError=_.Exceptions.SFSError.extend({init:function(t,e){this._super(t),this._errrors=e},getErrors:function(){return this._errrors}}),_.LogLevel={DEBUG:0,INFO:1,WARN:2,ERROR:3},_._Logger=function(){this.isAvailable=void 0!=console,this.level=_.LogLevel.INFO},_.Logger=new _._Logger,_._Logger.prototype.setLevel=function(t){t<_.LogLevel.DEBUG||t>_.LogLevel.ERROR||(this.level=t)},_._Logger.prototype.debug=function(t){this.isAvailable&&this.level<=_.LogLevel.DEBUG&&console.log("[DEBUG] "+t)},_._Logger.prototype.info=function(t){this.isAvailable&&this.level<=_.LogLevel.INFO&&console.log("[INFO] "+t)},_._Logger.prototype.warn=function(t){this.isAvailable&&this.level<=_.LogLevel.WARN&&console.log("[WARN] "+t)},_._Logger.prototype.error=function(t){this.isAvailable&&console.log("[ERROR] "+t)},_.Managers={},_.Managers.UserManager=y.extend({init:function(t){this._sfs=t,this._usersById=new _.Utils.HashTable,this._usersByName=new _.Utils.HashTable},containsUserName:function(t){return this._usersByName.hasItem(t)},containsUserId:function(t){return this._usersById.hasItem(t)},containsUser:function(t){return this._usersById.hasItem(t.id)},getUserById:function(t){return this._usersById.getItem(t)},getUserByName:function(t){return this._usersByName.getItem(t)},getUserCount:function(){return this._usersById.length},getUserList:function(){return this._usersById.values()},_addUser:function(t){this._usersById.hasItem(t.id)&&_.Logger.warn("Unexpected, duplicate user in UserManager: "+t.toString()),this.__addUser(t)},__addUser:function(t){this._usersByName.setItem(t.name,t),this._usersById.setItem(t.id,t)},_removeUser:function(t){this.__removeUser(t)},__removeUser:function(t){this._usersById.removeItem(t.id),this._usersByName.removeItem(t.name)},_removeUserById:function(){this._usersById.removeItem(user.id),this._usersByName.removeItem(user.name)},_clearAll:function(){this._usersById.clear(),this._usersByName.clear()}}),_.Managers.GlobalUserManager=_.Managers.UserManager.extend({init:function(t){this._super(t),this._roomRefCount=[]},_addUser:function(t){null==this._roomRefCount[t]?this._roomRefCount[t]=1:this._roomRefCount[t]++,this.__addUser(t)},_removeUser:function(t){null!=this._roomRefCount?1>this._roomRefCount[t]?_.Logger.warn("GlobalUserManager RefCount is already at zero. User: "+t):(this._roomRefCount[t]--,0==this._roomRefCount[t]&&(this.__removeUser(t),delete this._roomRefCount[t])):_.Logger.warn("Can't remove User from GlobalUserManager. RefCount missing. User: "+t)},dumpRefCount:function(){}}),_.Managers.RoomManager=function(t){this._sfs=t,this._ownerZone=null,this._groups=[],this._roomsById=new _.Utils.HashTable,this._roomsByName=new _.Utils.HashTable},_.Managers.RoomManager.prototype.getRoomGroups=function(){return this._groups},_.Managers.RoomManager.prototype.containsGroup=function(t){return-1<this._groups.indexOf(t)},_.Managers.RoomManager.prototype.containsRoom=function(t){return"number"==typeof t?this._roomsById.hasItem(t):this._roomsByName.hasItem(t)},_.Managers.RoomManager.prototype.containsRoomInGroup=function(t,e){var n,i=this.getRoomListFromGroup(e),a=!1,s="number"==typeof t;for(n in i){var o=i[n];if(o instanceof _.Entities.SFSRoom)if(s){if(o.id==t){a=!0;break}}else if(o.name==t){a=!0;break}}return a},_.Managers.RoomManager.prototype.getRoomById=function(t){return this._roomsById.getItem(t)},_.Managers.RoomManager.prototype.getRoomByName=function(t){return this._roomsByName.getItem(t)},_.Managers.RoomManager.prototype.getRoomList=function(){return this._roomsById.values()},_.Managers.RoomManager.prototype.getRoomCount=function(){return this._roomsById.length},_.Managers.RoomManager.prototype.getRoomListFromGroup=function(t){var e,n=[];for(e in this._roomsById.items){var i=this._roomsById.items[e];i instanceof _.Entities.SFSRoom&&i.groupId==t&&n.push(i)}return n},_.Managers.RoomManager.prototype.getJoinedRooms=function(){var t,e=[];for(t in this._roomsById.items){var n=this._roomsById.items[t];n instanceof _.Entities.SFSRoom&&n.isJoined&&e.push(n)}return e},_.Managers.RoomManager.prototype.getUserRooms=function(t){var e,n=[];for(e in this._roomsById.items){var i=this._roomsById.items[e];i instanceof _.Entities.SFSRoom&&i.containsUser(t)&&n.push(i)}return n},_.Managers.RoomManager.prototype._addRoom=function(t,e){null==e&&(e=!0),this._roomsById.setItem(t.id,t),this._roomsByName.setItem(t.name,t),e?this.containsGroup(t.groupId)||this._addGroup(t.groupId):t._isManaged=!1},_.Managers.RoomManager.prototype._replaceRoom=function(t,e){null==e&&(e=!0);var n=this.getRoomById(t.id);return null!=n?(n._merge(t),n):(this._addRoom(t,e),t)},_.Managers.RoomManager.prototype._removeRoom=function(t){this._roomsById.removeItem(t.id),this._roomsByName.removeItem(t.name)},_.Managers.RoomManager.prototype._removeRoomById=function(t){t=this.getRoomById(t),null!=t&&this._removeRoom(t)},_.Managers.RoomManager.prototype._removeRoomByName=function(t){t=this.getRoomByName(t),null!=t&&this._removeRoom(t)},_.Managers.RoomManager.prototype._changeRoomName=function(t,e){var n=t.name;t.name=e,this._roomsByName.setItem(e,t),this._roomsByName.removeItem(n)},_.Managers.RoomManager.prototype._changeRoomPasswordState=function(t,e){t.isPasswordProtected=e},_.Managers.RoomManager.prototype._changeRoomCapacity=function(t,e,n){t.maxUsers=e,t.maxSpectators=n},_.Managers.RoomManager.prototype._addGroup=function(t){this._groups.push(t)},_.Managers.RoomManager.prototype._removeGroup=function(t){_.Utils.ArrayUtil.removeItem(this._groups,t);var e,t=this.getRoomListFromGroup(t);for(e in t){var n=t[e];n instanceof _.Entities.SFSRoom&&(n.isJoined?n._isManaged=!1:this._removeRoom(n))}},_.Managers.RoomManager.prototype._removeUser=function(t){for(var e in this._roomsById.items){var n=this._roomsById.items[e];n instanceof _.Entities.SFSRoom&&n.containsUser(t)&&n._removeUser(t)}},_.Managers.BuddyManager=function(t){this._sfs=t,this._buddiesByName=[],this._myVariables=[],this._inited=!1,this._buddyStates=[]},_.Managers.BuddyManager.prototype.isInited=function(){return this._inited},_.Managers.BuddyManager.prototype.containsBuddy=function(t){return null!=this.getBuddyByName(t)},_.Managers.BuddyManager.prototype.getBuddyById=function(t){if(-1<t)for(var e in this._buddiesByName){var n=this._buddiesByName[e];if(n instanceof _.Entities.SFSBuddy&&n.id==t)return n}return null},_.Managers.BuddyManager.prototype.getBuddyByName=function(t){return this._buddiesByName[t]},_.Managers.BuddyManager.prototype.getBuddyByNickName=function(t){for(var e in this._buddiesByName){var n=this._buddiesByName[e];if(n instanceof _.Entities.SFSBuddy&&n.nickName==t)return n}return null},_.Managers.BuddyManager.prototype.getOfflineBuddies=function(){var t,e=[];for(t in this._buddiesByName){var n=this._buddiesByName[t];n instanceof _.Entities.SFSBuddy&&!n.isOnline()&&e.push(n)}return e},_.Managers.BuddyManager.prototype.getOnlineBuddies=function(){var t,e=[];for(t in this._buddiesByName){var n=this._buddiesByName[t];n instanceof _.Entities.SFSBuddy&&n.isOnline()&&e.push(n)}return e},_.Managers.BuddyManager.prototype.getBuddyList=function(){return _.Utils.ArrayUtil.objToArray(this._buddiesByName)},_.Managers.BuddyManager.prototype.getMyVariable=function(t){return this._myVariables[t]},_.Managers.BuddyManager.prototype.getMyVariables=function(){return _.Utils.ArrayUtil.objToArray(this._myVariables)},_.Managers.BuddyManager.prototype.getMyOnlineState=function(){if(!this._inited)return!1;var t=!0,e=this.getMyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_ONLINE);return null!=e&&(t=e.value),t},_.Managers.BuddyManager.prototype.getMyNickName=function(){var t=this.getMyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME);return null!=t?t.value:null},_.Managers.BuddyManager.prototype.getMyState=function(){var t=this.getMyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_STATE);return null!=t?t.value:null},_.Managers.BuddyManager.prototype.getBuddyStates=function(){return this._buddyStates},_.Managers.BuddyManager.prototype._setInited=function(){this._inited=!0},_.Managers.BuddyManager.prototype._addBuddy=function(t){this._buddiesByName[t.name]=t},_.Managers.BuddyManager.prototype._clearAll=function(){this._buddiesByName=[]},_.Managers.BuddyManager.prototype._removeBuddyById=function(t){return t=this.getBuddyById(t),null!=t&&delete this._buddiesByName[t.name],t},_.Managers.BuddyManager.prototype._removeBuddyByName=function(t){var e=this.getBuddyByName(t);return null!=e&&delete this._buddiesByName[t],e},_.Managers.BuddyManager.prototype._setMyVariables=function(t){for(var e=0;e<t.length;e++)this._setMyVariable(t[e])},_.Managers.BuddyManager.prototype._setMyVariable=function(t){t.isNull()?delete this._myVariables[t.name]:this._myVariables[t.name]=t},_.Managers.BuddyManager.prototype._setMyOnlineState=function(t){t=new _.Entities.Variables.SFSBuddyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_ONLINE,t),this._setMyVariable(t)},_.Managers.BuddyManager.prototype._setMyNickName=function(t){t=new _.Entities.Variables.SFSBuddyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_NICKNAME,t),this._setMyVariable(t)},_.Managers.BuddyManager.prototype._setMyState=function(t){t=new _.Entities.Variables.SFSBuddyVariable(_.Entities.Variables.ReservedBuddyVariables.BV_STATE,t),this._setMyVariable(t)},_.Managers.BuddyManager.prototype._setBuddyStates=function(t){this._buddyStates=t},_.Requests={},_.Requests.System={},_.Requests.MMO={},_.Requests.BuddyList={},_.Requests.Game={},_.Requests._BaseRequest=y.extend({init:function(t){this._reqObj={},this._id=t,this._targetController=0,this._log=_.Logger},getMessage:function(){return{a:this._id,c:this._targetController,p:this._reqObj}},validate:function(){this._log.error("BaseRequest.validate = no child-class implementation found!")},execute:function(){this._log.error("BaseRequest.execute = no child-class implementation found!")}}),_.Requests.System.HandshakeRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.Handshake),this._apiVersion=t,this._clientDetails=e,this._reconnectionToken=n},validate:function(){},execute:function(){this._reqObj[this.constructor.KEY_API]=this._apiVersion,this._reqObj[this.constructor.KEY_CLIENT_TYPE]=this._clientDetails,null!=this._reconnectionToken&&(this.reqObj[this.constructor.KEY_RECONNECTION_TOKEN]=this._reconnectionToken)}}),_.Requests.System.HandshakeRequest.KEY_SESSION_TOKEN="tk",_.Requests.System.HandshakeRequest.KEY_API="api",_.Requests.System.HandshakeRequest.KEY_COMPRESSION_THRESHOLD="ct",_.Requests.System.HandshakeRequest.KEY_RECONNECTION_TOKEN="rt",_.Requests.System.HandshakeRequest.KEY_CLIENT_TYPE="cl",_.Requests.System.HandshakeRequest.KEY_MAX_MESSAGE_SIZE="ms",_.Requests.System.LoginRequest=_.Requests._BaseRequest.extend({init:function(t,e,n,i){this._super(_.Requests.Login),this._userName=t,this._password=e,this._params=n,this._zoneName=i},validate:function(t){if(null!=t.mySelf)throw new _.Exceptions.SFSValidationError("LoginRequest error",["You are already logged in; logout before attempting a new login"]);if(t=null!=t.config&&null!=t.config.zone?t.config.zone:null,null!=this._zoneName&&(t=this._zoneName),null==t||0==t.length)throw new _.Exceptions.SFSValidationError("LoginRequest Error",["Missing Zone name"]);this._zoneName=t,null==this._userName&&(this._userName=""),null==this._password&&(this._password="")},execute:function(t){this._reqObj[this.constructor.KEY_ZONE_NAME]=this._zoneName,this._reqObj[this.constructor.KEY_USER_NAME]=this._userName,this._reqObj[this.constructor.KEY_PASSWORD]=0<this._password.length?i(t.sessionToken+this._password):"",null!=this._params&&(this._reqObj[this.constructor.KEY_PARAMS]=this._params)}}),_.Requests.System.LoginRequest.KEY_ZONE_NAME="zn",_.Requests.System.LoginRequest.KEY_USER_NAME="un",_.Requests.System.LoginRequest.KEY_PASSWORD="pw",_.Requests.System.LoginRequest.KEY_PARAMS="p",_.Requests.System.LoginRequest.KEY_PRIVILEGE_ID="pi",_.Requests.System.LoginRequest.KEY_ID="id",_.Requests.System.LoginRequest.KEY_ROOMLIST="rl",_.Requests.System.LoginRequest.KEY_RECONNECTION_SECONDS="rs",_.Requests.System.LogoutRequest=_.Requests._BaseRequest.extend({init:function(){this._super(_.Requests.Logout)},validate:function(t){if(null==t.mySelf)throw new _.Exceptions.SFSValidationError("LogoutRequest error",["You are not logged in"])},execute:function(){}}),_.Requests.System.LogoutRequest.KEY_ZONE_NAME="zn",_.Requests.System.JoinRoomRequest=_.Requests._BaseRequest.extend({init:function(t,e,n,i){this._super(_.Requests.JoinRoom),"string"==typeof t?this._rName=t:"number"==typeof t?this._rId=t:t instanceof _.Entities.SFSRoom&&(this._rId=t.id,this._rName=t.name),this._password=e,this._roomIdToLeave=n,this._asSpectator="boolean"==typeof i&&i},validate:function(){if(null==this._rId&&null==this._rName)throw new _.Exceptions.SFSValidationError("JoinRoomRequest Error",["Missing Room id or name, please provide one of the two or an existing Room object"])},execute:function(t){t._isJoining=!0,0<=this._rId?this._reqObj[this.constructor.KEY_ROOM_ID]=this._rId:null!=this._rName&&(this._reqObj[this.constructor.KEY_ROOM_NAME]=this._rName),null!=this._password&&(this._reqObj[this.constructor.KEY_PASS]=this._password),null!=this._roomIdToLeave&&(this._reqObj[this.constructor.KEY_ROOM_TO_LEAVE]=this._roomIdToLeave),this._asSpectator&&(this._reqObj[this.constructor.KEY_AS_SPECTATOR]=this._asSpectator)}}),_.Requests.System.JoinRoomRequest.KEY_ROOM="r",_.Requests.System.JoinRoomRequest.KEY_USER_LIST="ul",_.Requests.System.JoinRoomRequest.KEY_ROOM_NAME="n",_.Requests.System.JoinRoomRequest.KEY_ROOM_ID="i",_.Requests.System.JoinRoomRequest.KEY_PASS="p",_.Requests.System.JoinRoomRequest.KEY_ROOM_TO_LEAVE="rl",_.Requests.System.JoinRoomRequest.KEY_AS_SPECTATOR="sp",_.Requests.System.CreateRoomRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.CreateRoom),this._settings=t,this._autoJoin="boolean"==typeof e&&e,this._roomToLeave=n},validate:function(){var t=[];if((null==this._settings.name||0==this._settings.name.length)&&t.push("Missing Room name"),0>=this._settings.maxUsers&&t.push("Max number of users must be > 0"),null!=this._settings.extension&&((null==this._settings.extension.className||0==this._settings.extension.className.length)&&t.push("Missing Extension class name"),(null==this._settings.extension.id||0==this._settings.extension.id.length)&&t.push("Missing Extension id")),this._settings instanceof _.Requests.MMO.MMORoomSettings&&(null==this._settings.defaultAOI&&t.push("Missing default AoI (Area of Interest)"),null!=this._settings.mapLimits&&(null==this._settings.mapLimits.lowerLimit||null==this._settings.mapLimits.higherLimit)&&t.push("Map limits must be both defined")),0<t.length)throw new _.Exceptions.SFSValidationError("CreateRoomRequest Error",t)},execute:function(){if(this._reqObj[this.constructor.KEY_NAME]=this._settings.name,this._reqObj[this.constructor.KEY_GROUP_ID]=this._settings.groupId,this._reqObj[this.constructor.KEY_PASSWORD]=this._settings.password,this._reqObj[this.constructor.KEY_ISGAME]=this._settings.isGame,this._reqObj[this.constructor.KEY_MAXUSERS]=this._settings.maxUsers,this._reqObj[this.constructor.KEY_MAXSPECTATORS]=this._settings.maxSpectators,this._reqObj[this.constructor.KEY_MAXVARS]=this._settings.maxVariables,null!=this._settings.variables&&0<this._settings.variables.length){var t,e=[];for(t in this._settings.variables){var n=this._settings.variables[t];n instanceof _.Entities.Variables.SFSRoomVariable&&e.push(n.toArray())}this._reqObj[this.constructor.KEY_ROOMVARS]=e}null!=this._settings.permissions&&(e=[],e.push(this._settings.permissions.allowNameChange),e.push(this._settings.permissions.allowPasswordStateChange),e.push(this._settings.permissions.allowPublicMessages),e.push(this._settings.permissions.allowResizing),this._reqObj[this.constructor.KEY_PERMISSIONS]=e),null!=this._settings.events&&(e=[],e.push(this._settings.events.allowUserEnter),e.push(this._settings.events.allowUserExit),e.push(this._settings.events.allowUserCountChange),e.push(this._settings.events.allowUserVariablesUpdate),this._reqObj[this.constructor.KEY_EVENTS]=e),null!=this._settings.extension&&(this._reqObj[this.constructor.KEY_EXTID]=this._settings.extension.id,this._reqObj[this.constructor.KEY_EXTCLASS]=this._settings.extension.className,null!=this._settings.extension.propertiesFile&&0<this._settings.extension.propertiesFile.length&&(this._reqObj[this.constructor.KEY_EXTPROP]=this._settings.extension.propertiesFile)),this._settings instanceof _.Requests.MMO.MMORoomSettings&&(this._reqObj[this.constructor.KEY_MMO_DEFAULT_AOI]=this._settings.defaultAOI._toArray(),null!=this._settings.mapLimits&&(this._reqObj[this.constructor.KEY_MMO_MAP_LOW_LIMIT]=this._settings.mapLimits.lowerLimit._toArray(),this._reqObj[this.constructor.KEY_MMO_MAP_HIGH_LIMIT]=this._settings.mapLimits.higherLimit._toArray()),this._reqObj[this.constructor.KEY_MMO_USER_MAX_LIMBO_SECONDS]=this._settings.userMaxLimboSeconds,this._reqObj[this.constructor.KEY_MMO_PROXIMITY_UPDATE_MILLIS]=this._settings.proximityListUpdateMillis,this._reqObj[this.constructor.KEY_MMO_SEND_ENTRY_POINT]=this._settings.sendAOIEntryPoint),this._reqObj[this.constructor.KEY_AUTOJOIN]=this._autoJoin,null!=this._roomToLeave&&(this._reqObj[this.constructor.KEY_ROOM_TO_LEAVE]=this._roomToLeave.id)}}),_.Requests.System.CreateRoomRequest.KEY_ROOM="r",_.Requests.System.CreateRoomRequest.KEY_NAME="n",_.Requests.System.CreateRoomRequest.KEY_PASSWORD="p",_.Requests.System.CreateRoomRequest.KEY_GROUP_ID="g",_.Requests.System.CreateRoomRequest.KEY_ISGAME="ig",_.Requests.System.CreateRoomRequest.KEY_MAXUSERS="mu",_.Requests.System.CreateRoomRequest.KEY_MAXSPECTATORS="ms",_.Requests.System.CreateRoomRequest.KEY_MAXVARS="mv",_.Requests.System.CreateRoomRequest.KEY_ROOMVARS="rv",_.Requests.System.CreateRoomRequest.KEY_PERMISSIONS="pm",_.Requests.System.CreateRoomRequest.KEY_EVENTS="ev",_.Requests.System.CreateRoomRequest.KEY_EXTID="xn",_.Requests.System.CreateRoomRequest.KEY_EXTCLASS="xc",_.Requests.System.CreateRoomRequest.KEY_EXTPROP="xp",_.Requests.System.CreateRoomRequest.KEY_AUTOJOIN="aj",_.Requests.System.CreateRoomRequest.KEY_ROOM_TO_LEAVE="rl",_.Requests.System.CreateRoomRequest.KEY_MMO_DEFAULT_AOI="maoi",_.Requests.System.CreateRoomRequest.KEY_MMO_MAP_LOW_LIMIT="mllm",_.Requests.System.CreateRoomRequest.KEY_MMO_MAP_HIGH_LIMIT="mlhm",_.Requests.System.CreateRoomRequest.KEY_MMO_USER_MAX_LIMBO_SECONDS="muls",_.Requests.System.CreateRoomRequest.KEY_MMO_PROXIMITY_UPDATE_MILLIS="mpum",_.Requests.System.CreateRoomRequest.KEY_MMO_SEND_ENTRY_POINT="msep",_.Requests.System.GenericMessageRequest=_.Requests._BaseRequest.extend({init:function(){this._super(_.Requests.GenericMessage),this._type=-1,this._recipient=this._params=this._message=this._user=this._room=null,this._sendMode=-1},validate:function(t){if(0>this._type)throw new _.Exceptions.SFSValidationError("GenericMessageRequest Error",["Unsupported message type: "+this._type]);var e=[];switch(this._type){case _.Requests.GenericMessageType.PUBLIC_MSG:this._validatePublicMessage(t,e);break;case _.Requests.GenericMessageType.PRIVATE_MSG:this._validatePrivateMessage(t,e);break;case _.Requests.GenericMessageType.OBJECT_MSG:this._validateObjectMessage(t,e);break;case _.Requests.GenericMessageType.BUDDY_MSG:this._validateBuddyMessage(t,e);break;default:this._validateSuperUserMessage(t,e)}if(0<e.length)throw new _.Exceptions.SFSValidationError("GenericMessageRequest Error",e)},execute:function(t){switch(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_MESSAGE_TYPE]=this._type,this._type){case _.Requests.GenericMessageType.PUBLIC_MSG:this._executePublicMessage(t);break;case _.Requests.GenericMessageType.PRIVATE_MSG:this._executePrivateMessage(t);break;case _.Requests.GenericMessageType.OBJECT_MSG:this._executeObjectMessage(t);break;case _.Requests.GenericMessageType.BUDDY_MSG:this._executeBuddyMessage(t);break;default:this._executeSuperUserMessage(t)}},_validatePublicMessage:function(t,e){(null==this._message||0==this._message.length)&&e.push("Public message is empty"),null!=this._room&&!t.mySelf.isJoinedInRoom(this._room)&&e.push("You are not joined in the target Room: "+this._room)},_validatePrivateMessage:function(t,e){(null==this._message||0==this._message.length)&&e.push("Private message is empty"),0>this._recipient&&e.push("Invalid recipient id: "+this._recipient)},_validateObjectMessage:function(t,e){null==this._params&&e.push("Object message is null")},_validateBuddyMessage:function(t,e){t.buddyManager.isInited||e.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0==t.buddyManager.myOnlineState&&e.push("Can't send messages while you are offline in the Buddy List system"),(null==this._message||0==this._message.length)&&e.push("Buddy message is empty"),0>this._recipient&&e.push("Recipient is offline or not in your Buddy List")},_validateSuperUserMessage:function(t,e){switch((null==this._message||0==this._message.length)&&e.push("Moderator message is empty"),this._sendMode){case _.Requests.MessageRecipientMode.TO_USER:this._recipient instanceof _.Entities.SFSUser||e.push("SFSUser object expected as recipient");break;case _.Requests.MessageRecipientMode.TO_ROOM:this._recipient instanceof _.Entities.SFSRoom||e.push("SFSRoom object expected as recipient");break;case _.Requests.MessageRecipientMode.TO_GROUP:"string"!=typeof this._recipient&&e.push("String object (the groupId) expected as recipient")}},_executePublicMessage:function(t){if(null==this._room&&(this._room=t.lastJoinedRoom),null==this._room)throw new _.Exceptions.SFSError("User should be joined in a Room in order to send a public message");this._reqObj[_.Requests.System.GenericMessageRequest.KEY_ROOM_ID]=this._room.id,this._reqObj[_.Requests.System.GenericMessageRequest.KEY_USER_ID]=t.mySelf.id,this._reqObj[_.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params)},_executePrivateMessage:function(){this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient,this._reqObj[_.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params)},_executeBuddyMessage:function(){this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient,this._reqObj[_.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params)},_executeSuperUserMessage:function(){switch(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_MESSAGE]=this._message,null!=this._params&&(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params),
this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT_MODE]=this._sendMode,this._sendMode){case _.Requests.MessageRecipientMode.TO_USER:this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient.id;break;case _.Requests.MessageRecipientMode.TO_ROOM:this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient.id;break;case _.Requests.MessageRecipientMode.TO_GROUP:this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=this._recipient}},_executeObjectMessage:function(t){if(null==this._room&&(this._room=t.lastJoinedRoom),null==this._room)throw new _.Exceptions.SFSError("User should be joined in a Room in order to send an object message");if(t=[],null!=this._recipient&&this._recipient instanceof Array){var e=this._recipient;if(e.length>this._room.capacity)throw new _.Exceptions.SFSError("The number of recipients is bigger than the target Room capacity: "+e.length);for(var n in e){var i=e[n];i instanceof _.Entities.SFSUser?t.push(i.id):this._log.warn("Bad recipient in ObjectMessage recipient list: "+typeof i+"; expected type: SFSUser")}}this._reqObj[_.Requests.System.GenericMessageRequest.KEY_ROOM_ID]=this._room.id,this._reqObj[_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS]=this._params,0<t.length&&(this._reqObj[_.Requests.System.GenericMessageRequest.KEY_RECIPIENT]=t)}}),_.Requests.System.GenericMessageRequest.KEY_ROOM_ID="r",_.Requests.System.GenericMessageRequest.KEY_USER_ID="u",_.Requests.System.GenericMessageRequest.KEY_MESSAGE="m",_.Requests.System.GenericMessageRequest.KEY_MESSAGE_TYPE="t",_.Requests.System.GenericMessageRequest.KEY_RECIPIENT="rc",_.Requests.System.GenericMessageRequest.KEY_RECIPIENT_MODE="rm",_.Requests.System.GenericMessageRequest.KEY_XTRA_PARAMS="p",_.Requests.System.GenericMessageRequest.KEY_SENDER_DATA="sd",_.Requests.System.ChangeRoomNameRequest=_.Requests._BaseRequest.extend({init:function(t,e){this._super(_.Requests.ChangeRoomName),this._room=t,this._newName=e},validate:function(){var t=[];if(null==this._room&&t.push("Provided Room is null"),(null==this._newName||0==this._newName.length)&&t.push("Invalid new room name: it must be a non-null and non-empty string"),0<t.length)throw new _.Exceptions.SFSValidationError("ChangeRoomNameRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_NAME]=this._newName}}),_.Requests.System.ChangeRoomNameRequest.KEY_ROOM="r",_.Requests.System.ChangeRoomNameRequest.KEY_NAME="n",_.Requests.System.ChangeRoomPasswordStateRequest=_.Requests._BaseRequest.extend({init:function(t,e){this._super(_.Requests.ChangeRoomPassword),this._room=t,this._newPass=e},validate:function(){var t=[];if(null==this._room&&t.push("Provided Room is null"),null==this._newPass&&t.push("Invalid new room name: it must be a non-null string"),0<t.length)throw new _.Exceptions.SFSValidationError("ChangeRoomPasswordStateRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_PASS]=this._newPass}}),_.Requests.System.ChangeRoomPasswordStateRequest.KEY_ROOM="r",_.Requests.System.ChangeRoomPasswordStateRequest.KEY_PASS="p",_.Requests.System.ObjectMessageRequest=_.Requests.System.GenericMessageRequest.extend({init:function(t,e,n){this._super(),this._type=_.Requests.GenericMessageType.OBJECT_MSG,this._params=t,this._room=e,this._recipient=n}}),_.Requests.System.SetRoomVariablesRequest=_.Requests._BaseRequest.extend({init:function(t,e){this._super(_.Requests.SetRoomVariables),this._roomVariables=t,this._room=e},validate:function(t){var e=[];if(null!=this._room?this._room.containsUser(t.mySelf)||e.push("You are not joined in the target Room"):null==t.lastJoinedRoom&&e.push("You are not joined in any Room"),(null==this._roomVariables||0==this._roomVariables.length)&&e.push("No variables were specified"),0<e.length)throw new _.Exceptions.SFSValidationError("SetRoomVariablesRequest Error",e)},execute:function(t){var e,n=[];for(e in this._roomVariables){var i=this._roomVariables[e];i instanceof _.Entities.Variables.SFSRoomVariable&&n.push(i.toArray())}null==this._room&&(this._room=t.lastJoinedRoom),this._reqObj[this.constructor.KEY_VAR_LIST]=n,this._reqObj[this.constructor.KEY_VAR_ROOM]=this._room.id}}),_.Requests.System.SetRoomVariablesRequest.KEY_VAR_ROOM="r",_.Requests.System.SetRoomVariablesRequest.KEY_VAR_LIST="vl",_.Requests.System.SetUserVariablesRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.SetUserVariables),this._userVariables=t},validate:function(){var t=[];if((null==this._userVariables||0==this._userVariables.length)&&t.push("No variables were specified"),0<t.length)throw new _.Exceptions.SFSValidationError("SetUserVariablesRequest Error",t)},execute:function(){var t,e=[];for(t in this._userVariables){var n=this._userVariables[t];n instanceof _.Entities.Variables.SFSUserVariable&&e.push(n.toArray())}this._reqObj[this.constructor.KEY_VAR_LIST]=e}}),_.Requests.System.SetUserVariablesRequest.KEY_USER="u",_.Requests.System.SetUserVariablesRequest.KEY_VAR_LIST="vl",_.Requests.System.ExtensionRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.CallExtension),this._targetController=1,this._extCmd=t,this._params=e,this._room=n,null==this._params&&(this._params={})},validate:function(){var t=[];if((null==this._extCmd||0==this._extCmd.length)&&t.push("Missing extension command"),0<t.length)throw new _.Exceptions.SFSValidationError("ExtensionRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_CMD]=this._extCmd,this._reqObj[this.constructor.KEY_ROOM]=null==this._room?-1:this._room.id,this._reqObj[this.constructor.KEY_PARAMS]=this._params}}),_.Requests.System.ExtensionRequest.KEY_CMD="c",_.Requests.System.ExtensionRequest.KEY_PARAMS="p",_.Requests.System.ExtensionRequest.KEY_ROOM="r",_.Requests.System.LeaveRoomRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.LeaveRoom),this._room=t},validate:function(t){if(1>t.getJoinedRooms().length)throw new _.Exceptions.SFSValidationError("LeaveRoomRequest Error",["You are not joined in any room"])},execute:function(){null!=this._room&&(this._reqObj[this.constructor.KEY_ROOM_ID]=this._room.id)}}),_.Requests.System.LeaveRoomRequest.KEY_ROOM_ID="r",_.Requests.System.SubscribeRoomGroupRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.SubscribeRoomGroup),this._groupId=t},validate:function(){var t=[];if((null==this._groupId||0==this._groupId.length)&&t.push("Invalid group id passed; must be a string with at least one character"),0<t.length)throw new _.Exceptions.SFSValidationError("SubscribeGroupRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_GROUP_ID]=this._groupId}}),_.Requests.System.SubscribeRoomGroupRequest.KEY_GROUP_ID="g",_.Requests.System.SubscribeRoomGroupRequest.KEY_ROOM_LIST="rl",_.Requests.System.UnsubscribeRoomGroupRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.UnsubscribeRoomGroup),this._groupId=t},validate:function(){var t=[];if((null==this._groupId||0==this._groupId.length)&&t.push("Invalid group id passed; must be a string with at least one character"),0<t.length)throw new _.Exceptions.SFSValidationError("UnsubscribeGroupRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_GROUP_ID]=this._groupId}}),_.Requests.System.UnsubscribeRoomGroupRequest.KEY_GROUP_ID="g",_.Requests.System.SpectatorToPlayerRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.SpectatorToPlayer),this._room=t},validate:function(t){if(1>t.getJoinedRooms().length)throw new _.Exceptions.SFSValidationError("SpectatorToPlayerRequest Error",["You are not joined in any room"])},execute:function(t){null==this._room&&(this._room=t.lastJoinedRoom),this._reqObj[this.constructor.KEY_ROOM_ID]=this._room.id}}),_.Requests.System.SpectatorToPlayerRequest.KEY_ROOM_ID="r",_.Requests.System.SpectatorToPlayerRequest.KEY_USER_ID="u",_.Requests.System.SpectatorToPlayerRequest.KEY_PLAYER_ID="p",_.Requests.System.PlayerToSpectatorRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.PlayerToSpectator),this._room=t},validate:function(t){if(1>t.getJoinedRooms().length)throw new _.Exceptions.SFSValidationError("PlayerToSpectatorRequest Error",["You are not joined in any room"])},execute:function(t){null==this._room&&(this._room=t.lastJoinedRoom),this._reqObj[this.constructor.KEY_ROOM_ID]=this._room.id}}),_.Requests.System.PlayerToSpectatorRequest.KEY_ROOM_ID="r",_.Requests.System.PlayerToSpectatorRequest.KEY_USER_ID="u",_.Requests.System.ChangeRoomCapacityRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.ChangeRoomCapacity),this._room=t,this._newMaxUsers=e,this._newMaxSpect=n},validate:function(){var t=[];if(null==this._room&&t.push("Provided Room is null"),0<t.length)throw new _.Exceptions.SFSValidationError("ChangeRoomCapacityRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_USER_SIZE]=this._newMaxUsers,this._reqObj[this.constructor.KEY_SPEC_SIZE]=this._newMaxSpect}}),_.Requests.System.ChangeRoomCapacityRequest.KEY_ROOM="r",_.Requests.System.ChangeRoomCapacityRequest.KEY_USER_SIZE="u",_.Requests.System.ChangeRoomCapacityRequest.KEY_SPEC_SIZE="s",_.Requests.System.PublicMessageRequest=_.Requests.System.GenericMessageRequest.extend({init:function(t,e,n){this._super(),this._type=_.Requests.GenericMessageType.PUBLIC_MSG,this._message=t,this._room=n,this._params=e}}),_.Requests.System.PrivateMessageRequest=_.Requests.System.GenericMessageRequest.extend({init:function(t,e,n){this._super(),this._type=_.Requests.GenericMessageType.PRIVATE_MSG,this._message=t,this._recipient=e,this._params=n}}),_.Requests.System.ModeratorMessageRequest=_.Requests.System.GenericMessageRequest.extend({init:function(t,e,n){if(this._super(),null==e)throw new _.Exceptions.SFSError("Recipient mode cannot be null");this._type=_.Requests.GenericMessageType.MODERATOR_MSG,this._message=t,this._params=n,this._recipient=e.target,this._sendMode=e.mode}}),_.Requests.System.AdminMessageRequest=_.Requests.System.GenericMessageRequest.extend({init:function(t,e,n){if(this._super(),null==e)throw new _.Exceptions.SFSError("Recipient mode cannot be null");this._type=_.Requests.GenericMessageType.ADMING_MSG,this._message=t,this._params=n,this._recipient=e.target,this._sendMode=e.mode}}),_.Requests.System.KickUserRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.KickUser),null==n&&(n=5),0>n&&(n=0),this._userId=t,this._message=e,this._delay=n},validate:function(t){var e=[];if(!t.mySelf.isModerator()&&!t.mySelf.isAdmin()&&e.push("You don't have enough permissions to execute this request"),0<e.length)throw new _.Exceptions.SFSValidationError("KickUserRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_USER_ID]=this._userId,this._reqObj[this.constructor.KEY_DELAY]=this._delay,null!=this._message&&0<this._message.length&&(this._reqObj[this.constructor.KEY_MESSAGE]=this._message)}}),_.Requests.System.KickUserRequest.KEY_USER_ID="u",_.Requests.System.KickUserRequest.KEY_MESSAGE="m",_.Requests.System.KickUserRequest.KEY_DELAY="d",_.Requests.System.BanUserRequest=_.Requests._BaseRequest.extend({init:function(t,e,n,i,a){this._super(_.Requests.BanUser),null==n&&(n=1),null==i&&(i=5),null==a&&(a=24),this._userId=t,this._message=e,this._banMode=n,this._delay=i,this._durationHours=a},validate:function(t){var e=[];if(!t.mySelf.isModerator()&&!t.mySelf.isAdmin()&&e.push("You don't have enough permissions to execute this request"),0<e.length)throw new _.Exceptions.SFSValidationError("BanUserRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_USER_ID]=this._userId,this._reqObj[this.constructor.KEY_DELAY]=this._delay,this._reqObj[this.constructor.KEY_BAN_MODE]=this._banMode,this._reqObj[this.constructor.KEY_BAN_DURATION_HOURS]=this._durationHours,null!=this._message&&0<this._message.length&&(this._reqObj[this.constructor.KEY_MESSAGE]=this._message)}}),_.Requests.System.BanUserRequest.KEY_USER_ID="u",_.Requests.System.BanUserRequest.KEY_MESSAGE="m",_.Requests.System.BanUserRequest.KEY_DELAY="d",_.Requests.System.BanUserRequest.KEY_BAN_MODE="b",_.Requests.System.BanUserRequest.KEY_BAN_DURATION_HOURS="dh",_.Requests.System.ManualDisconnectionRequest=_.Requests._BaseRequest.extend({init:function(){this._super(_.Requests.ManualDisconnection)},validate:function(){},execute:function(){}}),_.Requests.System.FindRoomsRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.FindRooms),null==n&&(n=0),this._matchExpr=t,this._groupId=e,this._limit=n},validate:function(){var t=[];if(null==this._matchExpr&&t.push("Missing match expression"),0<t.length)throw new _.Exceptions.SFSValidationError("FindRoomsRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_EXPRESSION]=this._matchExpr._toArray(),null!=this._groupId&&(this._reqObj[this.constructor.KEY_GROUP]=this._groupId),0<this._limit&&(this._reqObj[this.constructor.KEY_LIMIT]=this._limit)}}),_.Requests.System.FindRoomsRequest.KEY_EXPRESSION="e",_.Requests.System.FindRoomsRequest.KEY_GROUP="g",_.Requests.System.FindRoomsRequest.KEY_LIMIT="l",_.Requests.System.FindRoomsRequest.KEY_FILTERED_ROOMS="fr",_.Requests.System.FindUsersRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.FindUsers),null==n&&(n=0),this._matchExpr=t,this._target=e,this._limit=n},validate:function(){var t=[];if(null==this._matchExpr&&t.push("Missing match expression"),0<t.length)throw new _.Exceptions.SFSValidationError("FindUsersRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_EXPRESSION]=this._matchExpr._toArray(),null!=this._target&&(this._target instanceof _.Entities.SFSRoom?this._reqObj[this.constructor.KEY_ROOM]=this._target.id:"string"==typeof this._target?this._reqObj[this.constructor.KEY_GROUP]=this._target:this._log.warn("Unsupport target type for FindUsersRequest: "+this._target)),0<this._limit&&(this._reqObj[this.constructor.KEY_LIMIT]=this._limit)}}),_.Requests.System.FindUsersRequest.KEY_EXPRESSION="e",_.Requests.System.FindUsersRequest.KEY_GROUP="g",_.Requests.System.FindUsersRequest.KEY_ROOM="r",_.Requests.System.FindUsersRequest.KEY_LIMIT="l",_.Requests.System.FindUsersRequest.KEY_FILTERED_USERS="fu",_.Requests.System.PingPongRequest=_.Requests._BaseRequest.extend({init:function(){this._super(_.Requests.PingPong)},validate:function(){},execute:function(){}}),_.Requests.MMO.SetUserPositionRequest=_.Requests._BaseRequest.extend({init:function(t,e){this._super(_.Requests.SetUserPosition),this._pos=t,this._room=e},validate:function(t){var e=[];if(null==this._pos&&e.push("Position must be a Vec3D instance"),null==this._room&&(this._room=t.lastJoinedRoom),this._room instanceof _.Entities.MMORoom||e.push("Passed Room is not an MMORoom"),0<e.length)throw new _.Exceptions.SFSValidationError("SetUserPosition Error",e)},execute:function(){this._reqObj[this.constructor.KEY_ROOM]=this._room.id,this._reqObj[this.constructor.KEY_VEC3D]=this._pos._toArray()}}),_.Requests.MMO.SetUserPositionRequest.KEY_ROOM="r",_.Requests.MMO.SetUserPositionRequest.KEY_VEC3D="v",_.Requests.MMO.SetUserPositionRequest.KEY_PLUS_USER_LIST="p",_.Requests.MMO.SetUserPositionRequest.KEY_MINUS_USER_LIST="m",_.Requests.MMO.SetUserPositionRequest.KEY_PLUS_ITEM_LIST="q",_.Requests.MMO.SetUserPositionRequest.KEY_MINUS_ITEM_LIST="n",_.Requests.MMO.SetMMOItemVariables={},_.Requests.MMO.SetMMOItemVariables.KEY_ROOM_ID="r",_.Requests.MMO.SetMMOItemVariables.KEY_ITEM_ID="i",_.Requests.MMO.SetMMOItemVariables.KEY_VAR_LIST="v",_.Requests.BuddyList.InitBuddyListRequest=_.Requests._BaseRequest.extend({init:function(){this._super(_.Requests.InitBuddyList)},validate:function(t){var e=[];if(t.buddyManager.isInited()&&e.push("Buddy List is already initialized"),0<e.length)throw new _.Exceptions.SFSValidationError("InitBuddyListRequest Error",e)},execute:function(){}}),_.Requests.BuddyList.InitBuddyListRequest.KEY_BLIST="bl",_.Requests.BuddyList.InitBuddyListRequest.KEY_BUDDY_STATES="bs",_.Requests.BuddyList.InitBuddyListRequest.KEY_MY_VARS="mv",_.Requests.BuddyList.AddBuddyRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.AddBuddy),this._name=t},validate:function(t){var e=[];if(t.buddyManager.isInited()||e.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),(null==this._name||1>this._name.length)&&e.push("Invalid buddy name (null or empty string)"),0==t.buddyManager.getMyOnlineState()&&e.push("Can't add a buddy while you are offline in the Buddy List system"),t=t.buddyManager.getBuddyByName(this._name),null!=t&&!t.isTemp()&&e.push("Can't add buddy '"+this._name+"' because it is already in your list"),0<e.length)throw new _.Exceptions.SFSValidationError("AddBuddyRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_BUDDY_NAME]=this._name}}),_.Requests.BuddyList.AddBuddyRequest.KEY_BUDDY_NAME="bn",_.Requests.BuddyList.BlockBuddyRequest=_.Requests._BaseRequest.extend({init:function(t,e){this._super(_.Requests.BlockBuddy),this._name=t,this._blocked=e},validate:function(t){var e=[];if(t.buddyManager.isInited()||e.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),(null==this._name||1>this._name.length)&&e.push("Invalid buddy name (null or empty string)"),0==t.buddyManager.getMyOnlineState()&&e.push("Can't block a buddy while you are offline in the Buddy List system"),t=t.buddyManager.getBuddyByName(this._name),null==t?e.push("Can't block buddy '"+this._name+"' because it isn't in your list"):t.isBlocked()==this._blocked&&e.push("Block flag is already in the requested '"+this._blocked+"' state for buddy "+this._name),0<e.length)throw new _.Exceptions.SFSValidationError("BlockBuddyRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_BUDDY_NAME]=this._name,this._reqObj[this.constructor.KEY_BUDDY_BLOCK_STATE]=this._blocked}}),_.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_NAME="bn",_.Requests.BuddyList.BlockBuddyRequest.KEY_BUDDY_BLOCK_STATE="bs",_.Requests.BuddyList.RemoveBuddyRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.RemoveBuddy),this._name=t},validate:function(t){var e=[];if(t.buddyManager.isInited()||e.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0==t.buddyManager.getMyOnlineState()&&e.push("Can't remove a buddy while you are offline in the Buddy List system"),t.buddyManager.containsBuddy(this._name)||e.push("Can't remove buddy '"+this._name+"' because it isn't in your list"),0<e.length)throw new _.Exceptions.SFSValidationError("RemoveBuddyRequest Error",e)},execute:function(){this._reqObj[this.constructor.KEY_BUDDY_NAME]=this._name}}),_.Requests.BuddyList.RemoveBuddyRequest.KEY_BUDDY_NAME="bn",_.Requests.BuddyList.SetBuddyVariablesRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.SetBuddyVariables),this._buddyVariables=t},validate:function(t){var e=[];if(t.buddyManager.isInited()||e.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0==t.buddyManager.getMyOnlineState()&&e.push("Can't set Buddy Variables while you are offline in the Buddy List system"),(null==this._buddyVariables||0==this._buddyVariables.length)&&e.push("No Buddy Variables to set have been specified"),0<e.length)throw new _.Exceptions.SFSValidationError("SetBuddyVariablesRequest Error",e)},execute:function(){var t,e=[];for(t in this._buddyVariables){var n=this._buddyVariables[t];n instanceof _.Entities.Variables.SFSBuddyVariable&&e.push(n.toArray())}this._reqObj[this.constructor.KEY_BUDDY_VARS]=e}}),_.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_NAME="bn",_.Requests.BuddyList.SetBuddyVariablesRequest.KEY_BUDDY_VARS="bv",_.Requests.BuddyList.GoOnlineRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.GoOnline),this._online=t},validate:function(t){var e=[];if(t.buddyManager.isInited()||e.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),0<e.length)throw new _.Exceptions.SFSValidationError("GoOnlineRequest Error",e)},execute:function(t){t.buddyManager._setMyOnlineState(this._online),this._reqObj[this.constructor.KEY_ONLINE]=this._online}}),_.Requests.BuddyList.GoOnlineRequest.KEY_ONLINE="o",_.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_NAME="bn",_.Requests.BuddyList.GoOnlineRequest.KEY_BUDDY_ID="bi",_.Requests.BuddyList.BuddyMessageRequest=_.Requests.System.GenericMessageRequest.extend({init:function(t,e,n){this._super(),this._type=_.Requests.GenericMessageType.BUDDY_MSG,this._message=t,this._recipient=null!=e?e.id:-1,this._params=n}}),_.Requests.Game.InviteUsersRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.InviteUsers),this._invitedUsers=t,this._secondsForAnswer=e,this._params=n},validate:function(){var t=[];if((null==this._invitedUsers||1>this._invitedUsers.length)&&t.push("No invitation(s) to send"),this._invitedUsers.length>this.constructor.MAX_INVITATIONS_FROM_CLIENT_SIDE&&t.push("Too many invitations; "+this.constructor.MAX_INVITATIONS_FROM_CLIENT_SIDE+" max are allowed from client side"),(this._secondsForAnswer<this.constructor.MIN_EXPIRY_TIME||this._secondsForAnswer>this.constructor.MAX_EXPIRY_TIME)&&t.push("secondsForAnswer value is out of range (min: "+this.constructor.MIN_EXPIRY_TIME+"; max: "+this.constructor.MAX_EXPIRY_TIME+")"),0<t.length)throw new _.Exceptions.SFSValidationError("InviteUsersRequest Error",t)},execute:function(t){var e,n=[];for(e in this._invitedUsers){var i=this._invitedUsers[e];(i instanceof _.Entities.SFSUser||i instanceof _.Entities.SFSBuddy)&&i!=t.mySelf&&n.push(i.id)}this._reqObj[this.constructor.KEY_INVITED_USERS]=n,this._reqObj[this.constructor.KEY_TIME]=this._secondsForAnswer,null!=this._params&&(this._reqObj[this.constructor.KEY_PARAMS]=this._params)}}),_.Requests.Game.InviteUsersRequest.KEY_USER="u",_.Requests.Game.InviteUsersRequest.KEY_USER_ID="ui",_.Requests.Game.InviteUsersRequest.KEY_INVITATION_ID="ii",_.Requests.Game.InviteUsersRequest.KEY_TIME="t",_.Requests.Game.InviteUsersRequest.KEY_PARAMS="p",_.Requests.Game.InviteUsersRequest.KEY_INVITEE_ID="ee",_.Requests.Game.InviteUsersRequest.KEY_INVITED_USERS="iu",_.Requests.Game.InviteUsersRequest.KEY_REPLY_ID="ri",_.Requests.Game.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE=8,_.Requests.Game.InviteUsersRequest.MIN_EXPIRY_TIME=5,_.Requests.Game.InviteUsersRequest.MAX_EXPIRY_TIME=300,_.Requests.Game.InvitationReplyRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.InvitationReply),this._invitation=t,this._reply=e,this._params=n},validate:function(){var t=[];if(null==this._invitation&&t.push("Missing invitation object"),0<t.length)throw new _.Exceptions.SFSValidationError("InvitationReplyRequest Error",t)},execute:function(){this._reqObj[this.constructor.KEY_INVITATION_ID]=this._invitation.id,this._reqObj[this.constructor.KEY_INVITATION_REPLY]=this._reply,null!=this._params&&(this._reqObj[this.constructor.KEY_INVITATION_PARAMS]=this._params)}}),_.Requests.Game.InvitationReplyRequest.KEY_INVITATION_ID="i",_.Requests.Game.InvitationReplyRequest.KEY_INVITATION_REPLY="r",_.Requests.Game.InvitationReplyRequest.KEY_INVITATION_PARAMS="p",_.Requests.Game.CreateSFSGameRequest=_.Requests._BaseRequest.extend({init:function(t){this._super(_.Requests.CreateSFSGame),this._settings=t,this._createRoomRequest=new _.Requests.System.CreateRoomRequest(t,(!1),null)},validate:function(t){var e=[];try{this._createRoomRequest.validate(t)}catch(n){e=n.getErrors()}if(this._settings.minPlayersToStartGame>this._settings.maxUsers&&e.push("Minimum number of players to start the game can't be greater than the Room's maximum number of users"),(this._settings.invitationExpiryTime<_.Requests.Game.InviteUsersRequest.MIN_EXPIRY_TIME||this._settings.invitationExpiryTime>_.Requests.Game.InviteUsersRequest.MAX_EXPIRY_TIME)&&e.push("Invitation expiration time value is out of range (min: "+_.Requests.Game.InviteUsersRequest.MIN_EXPIRY_TIME+"; max: "+_.Requests.Game.InviteUsersRequest.MAX_EXPIRY_TIME+")"),null!=this._settings.invitedPlayers&&this._settings.invitedPlayers.length>_.Requests.Game.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE&&e.push("Can't invite more than "+_.Requests.Game.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE+" players from client side"),0<e.length)throw new _.Exceptions.SFSValidationError("CreateSFSGameRequest Error",e)},execute:function(t){if(this._createRoomRequest.execute(t),this._reqObj=this._createRoomRequest._reqObj,this._reqObj[this.constructor.KEY_IS_PUBLIC]=this._settings.isPublic,this._reqObj[this.constructor.KEY_MIN_PLAYERS]=this._settings.minPlayersToStartGame,this._reqObj[this.constructor.KEY_INVITATION_EXPIRY]=this._settings.invitationExpiryTime,this._reqObj[this.constructor.KEY_LEAVE_ROOM]=this._settings.leaveLastJoinedRoom,this._reqObj[this.constructor.KEY_NOTIFY_GAME_STARTED]=this._settings.notifyGameStarted,null!=this._settings.playerMatchExpression&&(this._reqObj[this.constructor.KEY_PLAYER_MATCH_EXP]=this._settings.playerMatchExpression._toArray()),null!=this._settings.spectatorMatchExpression&&(this._reqObj[this.constructor.KEY_SPECTATOR_MATCH_EXP]=this._settings.spectatorMatchExpression._toArray()),null!=this._settings.invitedPlayers){var e,t=[];for(e in this._settings.invitedPlayers){var n=this._settings.invitedPlayers[e];(n instanceof _.Entities.SFSUser||n instanceof _.Entities.SFSBuddy)&&t.push(n.id)}this._reqObj[this.constructor.KEY_INVITED_PLAYERS]=t}null!=this._settings.searchableRooms&&(this._reqObj[this.constructor.KEY_SEARCHABLE_ROOMS]=this._settings.searchableRooms),null!=this._settings.invitationParams&&(this._reqObj[this.constructor.KEY_INVITATION_PARAMS]=this._settings.invitationParams)}}),_.Requests.Game.CreateSFSGameRequest.KEY_IS_PUBLIC="gip",_.Requests.Game.CreateSFSGameRequest.KEY_MIN_PLAYERS="gmp",_.Requests.Game.CreateSFSGameRequest.KEY_INVITED_PLAYERS="ginp",_.Requests.Game.CreateSFSGameRequest.KEY_SEARCHABLE_ROOMS="gsr",_.Requests.Game.CreateSFSGameRequest.KEY_PLAYER_MATCH_EXP="gpme",_.Requests.Game.CreateSFSGameRequest.KEY_SPECTATOR_MATCH_EXP="gsme",_.Requests.Game.CreateSFSGameRequest.KEY_INVITATION_EXPIRY="gie",_.Requests.Game.CreateSFSGameRequest.KEY_LEAVE_ROOM="glr",_.Requests.Game.CreateSFSGameRequest.KEY_NOTIFY_GAME_STARTED="gns",_.Requests.Game.CreateSFSGameRequest.KEY_INVITATION_PARAMS="ip",_.Requests.Game.QuickJoinGameRequest=_.Requests._BaseRequest.extend({init:function(t,e,n){this._super(_.Requests.QuickJoinGame),this._matchExpression=t,this._whereToSearch=e,this._roomToLeave=n},validate:function(){var t=[];if(null==this._whereToSearch||1>this._whereToSearch.length?t.push("Missing lis of Rooms or Group name where to search the game to join"):this._whereToSearch.length>this.constructor.MAX_ROOMS&&t.push("Too many Rooms specified in list where to search the game to join; client limit is: "+this.constructor.MAX_ROOMS),0<t.length)throw new _.Exceptions.SFSValidationError("CreateSFSGameRequest Error",t)},execute:function(){if("string"==typeof this._whereToSearch[0])this._reqObj[this.constructor.KEY_GROUP_LIST]=this._whereToSearch;else{if(!(this._whereToSearch[0]instanceof _.Entities.SFSRoom))throw new _.Exceptions.SFSError("Invalid type in whereToSearch parameter");for(var t=[],e=0;e<this._whereToSearch.length;e++){var n=this._whereToSearch[e];n instanceof _.Entities.SFSRoom&&t.push(n.id)}this._reqObj[this.constructor.KEY_ROOM_LIST]=t}null!=this._roomToLeave&&(this._reqObj[this.constructor.KEY_ROOM_TO_LEAVE]=this._roomToLeave.id),null!=this._matchExpression&&(this._reqObj[this.constructor.KEY_MATCH_EXPRESSION]=this._matchExpression._toArray())}}),_.Requests.Game.QuickJoinGameRequest.KEY_ROOM_LIST="rl",_.Requests.Game.QuickJoinGameRequest.KEY_GROUP_LIST="gl",_.Requests.Game.QuickJoinGameRequest.KEY_ROOM_TO_LEAVE="tl",_.Requests.Game.QuickJoinGameRequest.KEY_MATCH_EXPRESSION="me",_.Requests.Game.QuickJoinGameRequest.MAX_ROOMS=32,_.Requests.Handshake=0,_.Requests.Login=1,_.Requests.Logout=2,_.Requests.JoinRoom=4,_.Requests.CreateRoom=6,_.Requests.GenericMessage=7,_.Requests.ChangeRoomName=8,_.Requests.ChangeRoomPassword=9,_.Requests.SetRoomVariables=11,_.Requests.SetUserVariables=12,_.Requests.CallExtension=13,_.Requests.LeaveRoom=14,_.Requests.SubscribeRoomGroup=15,_.Requests.UnsubscribeRoomGroup=16,_.Requests.SpectatorToPlayer=17,_.Requests.PlayerToSpectator=18,_.Requests.ChangeRoomCapacity=19,_.Requests.KickUser=24,_.Requests.BanUser=25,_.Requests.ManualDisconnection=26,_.Requests.FindRooms=27,_.Requests.FindUsers=28,_.Requests.PingPong=29,_.Requests.SetUserPosition=30,_.Requests.InitBuddyList=200,_.Requests.AddBuddy=201,_.Requests.BlockBuddy=202,_.Requests.RemoveBuddy=203,_.Requests.SetBuddyVariables=204,_.Requests.GoOnline=205,_.Requests.InviteUsers=300,_.Requests.InvitationReply=301,_.Requests.CreateSFSGame=302,_.Requests.QuickJoinGame=303,_.Requests.getRequestNameFromId=function(t){for(var e in _.Requests)if(_.Requests[e]==t)return e;return null},_.Requests.RoomSettings=y.extend({init:function(t){this.name=t,this.password="",this.groupId="default",this.isGame=!1,this.maxUsers=10,this.maxSpectators=0,this.maxVariables=5,this.variables=[],this.extension=this.events=this.permissions=null}}),_.Requests.Game.SFSGameSettings=_.Requests.RoomSettings.extend({init:function(t){this._super(t),this.isPublic=!0,this.minPlayersToStartGame=2,this.searchableRooms=this.invitedPlayers=null,this.invitationExpiryTime=15,this.leaveLastJoinedRoom=!0,this.notifyGameStarted=!1,this.invitationParams=this.spectatorMatchExpression=this.playerMatchExpression=null}}),_.Requests.MMO.MMORoomSettings=_.Requests.RoomSettings.extend({init:function(t){this._super(t),this.mapLimits=this.defaultAOI=null,this.userMaxLimboSeconds=50,this.proximityListUpdateMillis=250,this.sendAOIEntryPoint=!0}}),_.Requests.RoomPermissions=function(){this.allowPasswordStateChange=this.allowNameChange=!1,this.allowPublicMessages=!0,this.allowResizing=!1},_.Requests.RoomEvents=function(){this.allowUserVariablesUpdate=this.allowUserExit=this.allowUserEnter=this.allowUserCountChange=!1},_.Requests.RoomExtension=function(t,e){this.id=t,this.className=e,this.propertiesFile=""},_.Requests.MMO.MapLimits=function(t,e){if(null==t||null==e)throw new _.Exceptions.SFSError("Map limits arguments must be both non null!");this.lowerLimit=t,this.higherLimit=e},_.Requests.GenericMessageType={},_.Requests.GenericMessageType.PUBLIC_MSG=0,_.Requests.GenericMessageType.PRIVATE_MSG=1,_.Requests.GenericMessageType.MODERATOR_MSG=2,_.Requests.GenericMessageType.ADMING_MSG=3,_.Requests.GenericMessageType.OBJECT_MSG=4,_.Requests.GenericMessageType.BUDDY_MSG=5,_.Requests.MessageRecipientMode=function(t,e){if(t<this.TO_USER||t>this.TO_ZONE)throw new _.Exceptions.SFSError("Illegal recipient mode: "+t);this.mode=t,this.target=e},_.Requests.MessageRecipientMode.TO_USER=0,_.Requests.MessageRecipientMode.TO_ROOM=1,_.Requests.MessageRecipientMode.TO_GROUP=2,_.Requests.MessageRecipientMode.TO_ZONE=3,_.Requests.BanMode={},_.Requests.BanMode.BY_ADDRESS=0,_.Requests.BanMode.BY_NAME=1,_.SocketEngine=function(t){this.isConnecting=this.isConnected=!1,this.reconnectionSeconds=0,this._controllers={},this._log=_.Logger,this._socket=null,this._maxMessageSize=1e4,this._sfs=t,this._lastTcpPort=0,this._reconnectionDelayMillis=1e3,this._attemptingReconnection=this._isReconnecting=!1,this._eventDispatcher=new _.EventDispatcher,this._disconnectionReason=_.Utils.ClientDisconnectionReason.UNKNOWN},_.SocketEngine.prototype.connect=function(t,e,n){this.isConnected?this._log.error("Connection is already active"):this.isConnecting?this._log.error("A connection attempt is already in progress"):(this.isConnecting=!0,this._socket=new WebSocket("ws"+(n?"s":"")+"://"+t+":"+e+"/websocket"),
this._socket._scope=this,this._socket.onopen=this._onSocketConnect,this._socket.onclose=this._onSocketDisconnect,this._socket.onmessage=this._onSocketData,this._socket.onerror=this._onSocketError)},_.SocketEngine.prototype.disconnect=function(t){this._disconnectionReason=t,this._socket.close()},_.SocketEngine.prototype.addEventListener=function(t,e,n){this._eventDispatcher.addEventListener(t,e,n)},_.SocketEngine.prototype.removeEventListener=function(t,e){this._eventDispatcher.removeEventListener(t,e)},_.SocketEngine.prototype.addController=function(t,e){null==this._controllers[t]&&(this._controllers[t]=e)},_.SocketEngine.prototype.removeController=function(t){delete this._controllers[t]},_.SocketEngine.prototype.send=function(t){t=this._encodeMessage(t),this._socket.send(t)},_.SocketEngine.prototype._decodeMessage=function(t){return JSON.parse(t)},_.SocketEngine.prototype._encodeMessage=function(t){return JSON.stringify(t)},_.SocketEngine.prototype._onSocketConnect=function(){this._scope.isConnected=!0,this._scope.isConnecting=!1,this._scope._log.debug("SOCKET CONNECTION OK"),this._scope._eventDispatcher.dispatchEvent(_.SocketEvent.CONNECT,{success:!0,isReconnection:this._scope._attemptingReconnection})},_.SocketEngine.prototype._onSocketDisconnect=function(){if(this._scope.isConnected=!1,this._scope.isConnecting){this._scope.isConnecting=!1;var t={success:!1,isReconnection:this._scope._attemptingReconnection};this._scope._eventDispatcher.dispatchEvent(_.SocketEvent.CONNECT,t)}else t={reason:this._scope._disconnectionReason},this._scope._eventDispatcher.dispatchEvent(_.SocketEvent.DISCONNECT,t),this._scope._disconnectionReason=_.Utils.ClientDisconnectionReason.UNKNOWN},_.SocketEngine.prototype._onSocketData=function(t){this._scope._eventDispatcher.dispatchEvent(_.SocketEvent.DATA,this._scope._decodeMessage(t.data))},_.SocketEngine.prototype._onSocketError=function(t){this._scope._eventDispatcher.dispatchEvent(_.SocketEvent.IOERROR,t.data)},_.SocketEvent={CONNECT:"socketConnect",DISCONNECT:"socketDisconnect",DATA:"data",IOERROR:"socketIOError"},e.exports=_,cc._RFpop()},{}],SamConstant:[function(t,e,n){"use strict";cc._RFpush(e,"35794TQ611JOpMeZnHu/xYx","SamConstant"),e.exports={Action:{DISCARD:0,IGNORE:1,ORDER_HANDS:2,CHAT_HANG:3,BAO_SAM:4,WAITING_BAO_SAM:5,BAO:6,HUY_BAO_SAM:7,DEN_LANG:17},GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_FOR_NEW_GAME:2,DEALING:3,BAO_SAM:4,PLAYING:5,FINALIZING:6,FINISH:7},GameStateTLMN:{NONE:0,WAITING_FOR_PLAYER:"waitingForPlayer",WAITING_FOR_NEW_GAME:"waitingDealing",PLAYING:"playing",FINALIZING:"finalizing",FINISH:"finish"},PlayerState:{WAITING:0,READY:1,IN_TURN:2,OUT_TURN:3,WAITING_FOR_TURN:4,FINISH:5},ActionFinishType:{THANG_TRANG:0,THUA_DEM_LA:13,SAM_THANH_CONG:16,SAM_THAT_BAI:17,DEN_LANG_THOI_HAI:18},Event:{FINISH_GAME:"in_game.sam.finish_game",UPDATE_GAME:"in_game.sam.update_game",UPDATE_HAND:"in_game.sam.update_hand",WAITING_DEAL_CARD:"in_game.sam.waiting_deal_card",WAITING_FOR_PLAYER:"in_game.sam.waiting_for_player",TURN:"in_game.sam.turn",DISCARD:"in_game.sam.discard",REFRESH_GAME:"in_game.sam.refresh_game",CHAT_HANG:"in_game.sam.chag_hang",WAITING_BAO_SAM:"in_game.sam.bao_sam",PLAYER_BAO_SAM:"in_game.sam.player_bao_sam",PLAYER_BAO_MOT:"in_game.sam.player_bao_mot",PLAYER_HUY_BAO_SAM:"in_game.sam.huy_bao_sam"},TimeoutId:{DISCARD_MUSIC:"TIMEOUT_DISCARD_MUSIC",BOLUOT_ANIMATION:"TIMEOUT_BOLUOT_ANIMATION",CHANGE_TURN:"TIMEOUT_CHANGE_TURN"},Effect:{THUA_CONG:0,THANG_TRANG:1,CHAN_SAM:2,BAO_SAM:3,BAO:4,DEN_LANG:5,DEN_TRANG:6,HUY_BAO_SAM:7,SAM_THAT_BAI:8,SAM_THANH_CONG:9,DANG_DOI:10,HET_LUOT:11}},cc._RFpop()},{}],SamGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"3b56dlTZ9JOv5IqqCQHmfNW","SamGameManager");var i,a=t("BaseGameManager"),s=t("Utils"),o=t("SamConstant"),r=t("NetworkManager"),c=t("SmartFoxConstant");i=s.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.eventDispatchers.anyCmd.addEventListener(c.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(c.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(c.Command.UPDATE_HAND.ID,this.onUpdateHand,this),this.eventDispatchers.anyCmd.addEventListener(c.Command.WAITING_DEAL_CARD.ID,this.onWaitingDealCard,this),this.eventDispatchers.anyCmd.addEventListener(c.Command.WAITING_PLAYER_ADDED.ID,this.onWaitingForPlayer,this),this.eventDispatchers.anyCmd.addEventListener(c.Command.TURN.ID,this.onTurn,this),this.eventDispatchers.anyCmd.addEventListener(c.Command.REFRESH_GAME.ID,this.onRefreshGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.WAITING_BAO_SAM,this.onWaitingBaoSam,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHAT_HANG,this.onChatHang,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BAO_SAM,this.onBaoSam,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BAO,this.onBaoMot,this),this.eventDispatchers.playCmd.addEventListener(o.Action.HUY_BAO_SAM,this.onHuyBaoSam,this)},onUpdateGame:function(t){this.onRefreshGame(t)},onWaitingBaoSam:function(t){this.gameState=o.GameState.BAO_SAM,this.eventDispatchers.local.dispatchEvent(o.Event.WAITING_BAO_SAM,t)},onFinishGame:function(t){this.gameState=o.GameState.FINISH,this.eventDispatchers.local.dispatchEvent(o.Event.FINISH_GAME,t)},onUpdateHand:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_HAND,t)},onWaitingForPlayer:function(){this.eventDispatchers.local.dispatchEvent(o.Event.WAITING_FOR_PLAYER)},onWaitingDealCard:function(t){this.gameState=o.GameState.WAITING_FOR_NEW_GAME,this.eventDispatchers.local.dispatchEvent(o.Event.WAITING_DEAL_CARD,t)},onTurn:function(t){this.gameState=o.GameState.PLAYING,t.lastPlayer?(t.cards&&this.eventDispatchers.local.dispatchEvent(o.Event.DISCARD,{cards:t.data.cards,userName:t.data.lastPlayer.userName}),t.toPlayer&&this.eventDispatchers.local.dispatchEvent(o.Event.TURN,{userName:t.data.toPlayer.userName,wait:1,newTurn:t.data.newTurn,timeTurn:t.data.time})):t.toPlayer&&this.eventDispatchers.local.dispatchEvent(o.Event.TURN,{userName:t.data.toPlayer.userName,wait:0,newTurn:t.data.newTurn,timeTurn:t.data.time})},onChatHang:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.CHAT_HANG,t)},onBaoSam:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.PLAYER_BAO_SAM,t.data.userName)},onBaoMot:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.PLAYER_BAO_MOT,t.data.userName)},onHuyBaoSam:function(){this.eventDispatchers.local.dispatchEvent(o.Event.PLAYER_HUY_BAO_SAM)},onRefreshGame:function(t){switch(this.gameState=t.allData.gameState,t.allData.gameState){case o.GameState.WAITING_FOR_PLAYER:this.onWaitingForPlayer();break;case o.GameState.WAITING_FOR_NEW_GAME:this.onWaitingDealCard(t);break;case o.GameState.BAO_SAM:this.onWaitingBaoSam(t),this.onUpdateHand(t);break;case o.GameState.PLAYING:this.onTurn(t),this.onUpdateHand(t),t.data.trash&&this.eventDispatchers.local.dispatchEvent(o.Event.REFRESH_GAME,t);break;case o.GameState.FINALIZING:break;case o.GameState.FINISH:}},sendRequestStartGame:function(){this.send({command:r.SmartFox.type["byte"](c.Command.DEAL_CARD.ID)})},sendRequestDiscard:function(t){this.send({command:r.SmartFox.type["byte"](c.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.DISCARD),cards:r.SmartFox.type.byteArray(t)})},sendRequestBaoSam:function(){this.send({command:r.SmartFox.type["byte"](c.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.BAO_SAM)})},sendRequestBoQuaBaoSam:function(){this.send({command:r.SmartFox.type["byte"](c.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.HUY_BAO_SAM)})}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",SamConstant:"SamConstant",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils"}],SanThuongConstant:[function(t,e,n){"use strict";cc._RFpush(e,"4de15e3dR1MVpCEDYHgcZA7","SanThuongConstant");var i=t("Utils");e.exports={Action:{START_GAME:0,BETTING:1,ONPEN_HOP:2,TURN_MASTER:3,MASTER_SELL_POT:4,TURN_START:5,UPDATE_CHICKEN_JAR:6,UPDATE_POTS:9,PING:10},GameState:{NONE:0,EFFECT:1,OPEN_HOP:4,FINALIZING:5},AwardType:{NONE:0,MONEY:1,FREE_PLAY:2,HOPQUA:3,MA_DU_THUONG:4},ChipColor:{BLUE:{ID:0,NAME:"blue"},PURPLE:{ID:1,NAME:"purple"},GREEN:{ID:2,NAME:"green"},RED:{ID:3,NAME:"red"},findById:function(t){return t=parseInt(t,10),i.Object.findObject(this,"ID",t)}},Event:{TURN_START:"in_game.san_thuong.turn_start",EFFECT_STATE:"in_game.san_thuong.change_state.effect",PLAYER_BETTING_STATE:"in_game.san_thuong.change_state.player_betting",UPDATE_POTS:"in_game.san_thuong.update_pots",FINISH:"in_game.san_thuong.finish",SELECT_CHIP:"in_game.san_thuong.select_chip",ADD_LIST_BETTING:"in_game.san_thuong.add_list_betting",SET_RATIO:"in_game.san_thuong.set_ratio",BETTING_UPDATEGAME:"in_game.san_thuong.betting_updategame",UPDATE_CHICKEN_JAR:"in_game.san_thuong.update_chicken_rar",CLEAR_FINISH:"in_game.san_thuong.clear_finish",SHOW_PANEL_DAPHOP:"in_game.san_thuong.show_panel_daphop",OPEN_HOP:"in_game.san_thuong.open_hop",SET_RULE:"in_game.san_thuong.set_rule",CHICKEN_CODE:"in_game.san_thuong.checken_code"}},cc._RFpop()},{Utils:"Utils"}],SanThuongGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"0d935R2kUxHiYghlzIYL2By","SanThuongGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("NetworkManager"),r=t("Utils"),c=t("AuthUser"),h=t("SanThuongConstant"),u=t("CommonConstant"),l=t("Url");i=r.Class({$$extends:a,$$constructor:function(t,e,n){this.$super.constructor.call(this,t,e,n,!0),this.DELAYED_COMMANDS=[s.Command.MESSAGE.ID,s.Command.DEAL_CARD.ID,s.Command.TURN.ID,s.Command.WAITING_DEAL_CARD.ID],this.lstHistory=[],this.countFreePlay=this.countOpenHopQua=this.countMoney=this.countMaDuThuong=this.countLucky=0,this.stringKetQua="",this.itemHistoryTmp=[],this.isOpenHop=!1,this.autoPlay=!1,this.currency=u.CurrencyType.Ip.DISPLAY_NAME,this.countFreePlay=0,this.lstPiBetting=[],this.lstXuBetting=[],this.moneyChickenXu=0,this.moneyChickenPi=0,this.moneyBet=0,this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.REFRESH_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(h.Action.TURN_START,this.onStartGame,this),this.eventDispatchers.playCmd.addEventListener(h.Action.ONPEN_HOP,this.onOpenHop,this),this.eventDispatchers.globalCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateChickenJar,this)},sendOpenPopupMaDuThuong:function(){for(var t=this,e="",n=new Date,i=0;i<7;i+=1)e.length>0?(n.setDate(n.getDate()-1),e+=","+r.Date.format(n,"yyyy-mm-dd")):(n.setDate(n.getDate()),e+=r.Date.format(n,"yyyy-mm-dd"));o.Http.fetch("GET",l.Http.CHICKEN_CODE,{username:c.username,date_list:e}).success(function(e){t.eventDispatchers.local.dispatchEvent(h.Event.CHICKEN_CODE,e.data)})},sendOpentHop:function(t){this.send({command:o.SmartFox.type["byte"](s.Command.PLAY.ID),action:o.SmartFox.type["byte"](h.Action.ONPEN_HOP),id:o.SmartFox.type["byte"](t)})},sendGetChickenJar:function(){var t=this;o.Http.fetch("GET",l.Http.CHICKENJAR,{},{cache:900}).success(function(e){t.moneyChickenXu=e.data.XU,t.moneyChickenPi=e.data.IP,t.onUpdateChickenJar()})},sendStartGame:function(t,e,n,i){this.send({command:o.SmartFox.type["byte"](s.Command.PLAY.ID),action:o.SmartFox.type["byte"](h.Action.START_GAME),betting:o.SmartFox.type["long"](e),pots:o.SmartFox.type.byteArray(n),currency:o.SmartFox.type.utfString(i)}),this.currency=u.CurrencyType.findByName(i).DISPLAY_NAME,this.moneyBet=n.length*e,this.autoPlay=t},_setHistoryOpenHop:function(){this.isOpenHop&&(this.itemHistoryTmp.push(r.Date.format(Date(),"hh:MM:ss")),this.itemHistoryTmp.push("MỞ HỘP"),this.itemHistoryTmp.push(" "),this.countLucky>0&&(this.stringKetQua+=this.countLucky+" chúc may mắn, "),this.countOpenHopQua>0&&(this.stringKetQua+=this.countOpenHopQua+" hộp quà, "),this.countMoney>0&&(this.stringKetQua+=this.countMoney+" lần tiền cược, "),this.countFreePlay>0&&(this.stringKetQua+=this.countFreePlay+" lần quay miễn phí, "),this.countMaDuThuong>0&&(this.stringKetQua+=this.countMaDuThuong+" mã dự thưởng, "),this.itemHistoryTmp.push(" "),this.itemHistoryTmp.push(this.stringKetQua.substring(0,this.stringKetQua.length-2)),this.stringKetQua="",this.isOpenHop=!1,this.lstHistory.unshift(this.itemHistoryTmp),this.lstHistory.length>100&&this.lstHistory.pop())},onOpenHop:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.OPEN_HOP,t),this.isOpenHop=!0;for(var e=0;e<t.results.length;e+=1)switch(t.results[e].awardType){case h.AwardType.NONE:this.countLucky+=1;break;case h.AwardType.HOPQUA:this.countOpenHopQua+=t.results[e].ratio;break;case h.AwardType.MONEY:this.countMoney+=t.results[e].ratio;break;case h.AwardType.FREE_PLAY:this.countFreePlay+=t.results[e].ratio;break;case h.AwardType.MA_DU_THUONG:this.countMaDuThuong+=t.results[e].ratio}},onUpdateChickenJar:function(t){t&&("IP"===t.currency?this.moneyChickenPi=t.money:this.moneyChickenXu=t.money),this.eventDispatchers.local.dispatchEvent(h.Event.UPDATE_CHICKEN_JAR)},onFinishGame:function(t){var e=0,n=0,i=0,a=0,s="",o=[];this.eventDispatchers.local.dispatchEvent(h.Event.FINISH,t),o.push(r.Date.format(Date(),"hh:MM:ss")),this.autoPlay?this.countFreePlay>0?o.push("QUAY MIỄN PHÍ"):o.push("TỰ QUAY"):this.countFreePlay>0?o.push("QUAY MIỄN PHÍ"):o.push("QUAY"),this.countFreePlay<=0?o.push(r.Number.format(this.moneyBet)+" "+this.currency):(o.push(" "),this.countFreePlay-=1);for(var c=0;c<t.awards.length;c+=1)switch(t.awards[c].awardType){case h.AwardType.NONE:break;case h.AwardType.HOPQUA:n+=t.awards[c].ratio;break;case h.AwardType.MONEY:i+=t.awards[c].ratio;break;case h.AwardType.FREE_PLAY:e+=t.awards[c].ratio;break;case h.AwardType.MA_DU_THUONG:a+=t.awards[c].ratio}n>0&&(s+=n+" hộp quà, "),i>0&&(s+=i+" lần tiền cược, "),e>0&&(s+=e+" lần quay miễn phí, ",this.countFreePlay+=e),a>0&&(s+=a+" mã dự thưởng "),o.push(r.Number.format(t.player.moneyExchange)+" "+this.currency),o.push(s.substring(0,s.length-2)),this.lstHistory.unshift(o),this.lstHistory.length>100&&this.lstHistory.pop()},onStartGame:function(t){switch(this._setGameState(t.gameState),t.gameState){case h.GameState.EFFECT:this.countOpenHopQua=this.countMoney=this.countMaDuThuong=this.countLucky=0,this.stringKetQua="",this.itemHistoryTmp=[],this.eventDispatchers.local.dispatchEvent(h.Event.TURN_START,t.result);break;case h.GameState.NONE:this.eventDispatchers.local.dispatchEvent(h.Event.CLEAR_FINISH),this._setHistoryOpenHop();break;case h.GameState.OPEN_HOP:this.eventDispatchers.local.dispatchEvent(h.Event.SHOW_PANEL_DAPHOP)}},onUpdateGame:function(t){this._updateListBetting(t.bettingValues),this._showRulePot(t.itemsInfo)},_showRulePot:function(t){this.eventDispatchers.local.dispatchEvent(h.Event.SET_RULE,t)},_updateListBetting:function(t){this.lstXuBetting=t.XU,this.lstPiBetting=t.IP,this.eventDispatchers.local.dispatchEvent(h.Event.ADD_LIST_BETTING,this.lstPiBetting)},_setGameState:function(t){this.gameState!==t&&(this.gameState=t,this.eventDispatchers.local.dispatchEvent(h.Event.CHANGE_STATE))}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",NetworkManager:"NetworkManager",SanThuongConstant:"SanThuongConstant",SmartFoxConstant:"SmartFoxConstant",Url:"Url",Utils:"Utils"}],Settings:[function(t,e,n){"use strict";cc._RFpush(e,"96f4fn2L0pOypNhfixqdzjw","Settings");var i=t("Url"),a=t("AudioManager"),s=t("NetworkManager"),o=t("PlatformImplement"),r=t("ToggleButton");cc.Class({"extends":cc.Component,properties:{hotlineLabel:cc.Label,backgroundMusicToggleButton:r,soundEffectToggleButton:r},onLoad:function(){this.fetchContactInfo(),this.backgroundMusicToggleButton.isEnable=1===a.instance.getMusicVolume(),this.soundEffectToggleButton.isEnable=1===a.instance.getEffectsVolume()},toggleBackgroundMusic:function(t){var e=t.isEnable?1:0;a.instance.setMusicVolume(e)},toggleSoundEffect:function(t){var e=t.isEnable?1:0;a.instance.setEffectsVolume(e)},updateMusicVolume:function(t){cc.audioEngine.setMusicVolume(t.currentValue/100)},fetchContactInfo:function(){var t=this;s.Http.fetch("GET",i.Http.CONTACT_INFO,{},{cache:1800}).success(function(e){t.contactInfo=e.data,t.hotlineLabel.string=e.data.mobile})},callHotline:function(){this.contactInfo&&o.callNumberPhone(this.contactInfo.mobile)},logout:function(){o.openLogoutConfirmationModal()}}),cc._RFpop()},{AudioManager:"AudioManager",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",ToggleButton:"ToggleButton",Url:"Url"}],Slider:[function(t,e,n){"use strict";cc._RFpush(e,"96876PXspBPBaUem0ZBQVkv","Slider");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{progressBar:cc.ProgressBar,addButton:cc.Button,subButton:cc.Button,slideNode:cc.Node,backdropNode:cc.Node,minValueLabel:cc.Label,maxValueLabel:cc.Label,currentValueLabel:cc.Label,rounding:1,rate:.01,isVertical:!0,slideEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){var t=this;this.backdropNode&&this.backdropNode.on(cc.Node.EventType.TOUCH_START,function(){t.node.active=!1}),this.addButton.node.on(cc.Node.EventType.TOUCH_START,function(){var e=1-t.progressBar.progress;e>0&&(e=t.rate),t.progressBar.progress+=e,t.slideNode.y+=t.progressBar.node.height*e,t.setCurrentValue()}),this.subButton.node.on(cc.Node.EventType.TOUCH_START,function(){var e=1-t.progressBar.progress;e=e<1?t.rate:t.progressBar.progress,t.progressBar.progress-=e,t.slideNode.y-=t.progressBar.node.height*e,t.setCurrentValue()}),this.slideNode.on(cc.Node.EventType.TOUCH_MOVE,function(e){var n;n=t.isVertical?e.getDelta().y/t.progressBar.node.height:e.getDelta().x/t.progressBar.node.height;var i=t.progressBar.progress;t.progressBar.progress+=n,t.progressBar.progress>1?t.progressBar.progress=1:t.progressBar.progress<0&&(t.progressBar.progress=0),this.y+=t.progressBar.node.height*(t.progressBar.progress-i),t.setCurrentValue()})},setDefaultValue:function(t,e,n,a){this.minValue=t,this.maxValue=e,this.totalValue=e-t,a&&(this.rate=a/this.totalValue,this.rounding=a),this.minValueLabel&&(this.minValueLabel.string=i.Number.format(t)),this.maxValueLabel&&(this.maxValueLabel.string=i.Number.format(e)),this.progressBar.progress=n,this.slideNode.y=this.progressBar.node.y-this.progressBar.node.height/2+this.progressBar.node.height*n,this.setCurrentValue()},setCurrentValue:function(){this.currentValue=Math.floor(this.progressBar.progress*this.totalValue+this.minValue),this.currentValue>this.rounding&&(this.currentValue=Math.ceil(this.currentValue/this.rounding)*this.rounding),this.currentValue>this.maxValue?this.currentValue=this.maxValue:this.currentValue<this.minValue&&(this.currentValue=this.minValue),this.currentValueLabel.string=i.Number.format(this.currentValue);for(var t=0;t<this.slideEvents.length;t+=1)this.slideEvents[t].emit([this])}}),cc._RFpop()},{Utils:"Utils"}],Slot777Constant:[function(t,e,n){"use strict";cc._RFpush(e,"05bccLfuBZCY5nF6UWYv9Wi","Slot777Constant"),e.exports={GameJoining:!1},cc._RFpop()},{}],SlotInfor:[function(t,e,n){"use strict";cc._RFpush(e,"8e1baa70GBPwopzIB903jR5","SlotInfor");var i=t("BaseMainGameplay"),a=t("AuthUser"),s=t("Utils"),o=t("BauCuaConstant"),r=t("XocDiaConstant");cc.Class({"extends":cc.Component,properties:{myMoneyLabel:cc.Label,totallMoneyLabel:cc.Label,ratioLabel:cc.Label,hieuUngThangSprite:cc.Sprite,sceneScript:i,pot:0,btnCancelBet:cc.Sprite},onLoad:function(){var t=this;this.caculateChip=s.Scheduler.debounce(function(){t._caculateChip()},30,200),this._poolChip=new cc.NodePool("Chip"),this.chipFackeList||this.init()},init:function(){if(!this.chipFackeList){this.potX0=this.potX1=this.potX2=this.potX3=0,this.playerBetList={},this.chipFackeList=[],this.tmpCountChipList=[],this.countChipList=[],this.isWin=!1,this.totallMoneyLong=0,this.myMoneyLong=0;var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){this.sceneScript.gameManager.gameState===o.GameState.PLAYER_BETTING||this.sceneScript.gameManager.gameState===r.GameState.PLAYER_BETTING?t.bet():this.sceneScript.gameManager.gameState!==o.GameState.MASTER_CANEL_BET&&this.sceneScript.gameManager.gameState!==r.GameState.MASTER_CANEL_BET||this.sellBetCancelBet()},this),this.setMoneyPot(0,0)}},activeCancelPotXocDia:function(t){this.btnCancelBet&&(this.btnCancelBet.node.active=t)},activeSellPotBauCua:function(t){t?(this.myMoneyLabel.node.color=new cc.color("#FFEB00"),this.myMoneyLabel.string="BÁN"):(this.myMoneyLabel.node.color=new cc.color("#FFFFFF"),this.myMoneyLabel.string=s.Number.abbreviate(this.myMoneyLong))},sellBetCancelBet:function(){this.sceneScript.gameManager.sellBetCancelBet(this.pot)},bet:function(){this.sceneScript.gameManager.sendBet(this.pot,this.sceneScript.moneyBetSelect)},setRatioPot:function(t){this.ratioLabel&&(this.ratioLabel.string="(1x"+t+")")},setMoneyPot:function(t,e){this.totallMoneyLong+=e,this.myMoneyLong+=t,this.myMoneyLabel.string=s.Number.abbreviate(this.myMoneyLong),this.totallMoneyLabel.string=s.Number.abbreviate(this.totallMoneyLong)},addPlayerBetToPot:function(t,e){var n=this.playerBetList[t];s.Type.isNumber(n)?this.playerBetList[t]=e+n:this.playerBetList[t]=e},removePlayerBet:function(t){delete this.playerBetList[t]},removeMoneyPot:function(t){var e=this.playerBetList[t];s.Type.isNumber(e)&&(this.totallMoneyLong>e?this.totallMoneyLong-=e:this.totallMoneyLong=0),a.username===t&&(this.myMoneyLong=0),this.myMoneyLabel.string=s.Number.abbreviate(this.myMoneyLong),this.totallMoneyLong<=0?this.destroyChipFacke(!0):(this.caculateChip(),this.totallMoneyLabel.string=s.Number.abbreviate(this.totallMoneyLong)),this.removePlayerBet(t)},showEfectWin:function(t){if(this.node.color=new cc.color("#FFFFFF"),this.hieuUngThangSprite.node.active=t,t){var e=cc.repeatForever(cc.sequence(cc.fadeIn(.8),cc.fadeOut(.8)));this.hieuUngThangSprite.node.runAction(e)}else this.hieuUngThangSprite.node.stopAllActions()},disablePotEfect:function(){this.node.color=new cc.color("#A07373")},caculateChip:function(){},_caculateChip:function(){this.destroyChipFacke(!1);var t=this.totallMoneyLong,e=this.sceneScript.gameManager.bettingList;this.tmpCountChipList=this.countChipList;var n=[];this.countChipList=[];for(var i=e.length;i>0;i-=1)if(t>=e[i-1]){var a=Math.floor(t/e[i-1]);n.push(a),t-=a*e[i-1]}else n.push(0);this.countChipList=n.reverse(),this.setFakeChip()},setFakeChip:function(){for(var t=this,e=this.countChipList,n=0;n<e.length;n+=1)if(e[n]>0)for(var i=0;i<e[n];i+=1){var a=this._poolChip.get();a||(a=cc.instantiate(t.sceneScript.chipPrefab));var s=a.getComponent("Chip");switch(a.parent=t.node.getChildByName(n.toString()),a.scale=cc.v2(.5,.5),a.removeComponent("ButtonScaler"),a.removeComponent(cc.Button),n){case 0:a.position=cc.v2(0,t.potX0),t.potX0+=3;break;case 1:a.position=cc.v2(0,t.potX1),t.potX1+=3;break;case 2:a.position=cc.v2(0,t.potX2),t.potX2+=3;break;case 3:a.position=cc.v2(0,t.potX3),t.potX3+=3}s.activeSelectChip(!1),s.init(t.sceneScript.gameManager.bettingList[n],o.ChipColor.findById(n).NAME),t.chipFackeList.push(a)}this.tmpChipFacke=this.chipFackeList},destroyChipFacke:function(t){if(this.chipFackeList){for(var e=0;e<this.chipFackeList.length;e+=1)this.chipFackeList[e]&&this._poolChip.put(this.chipFackeList[e]);this.chipFackeList=[]}this.potX0=this.potX1=this.potX2=this.potX3=0,t&&(this.chipFackeList=[],this.myMoneyLabel.string=0,this.totallMoneyLabel.string=0)}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",BauCuaConstant:"BauCuaConstant",Utils:"Utils",XocDiaConstant:"XocDiaConstant"}],SmartFoxConstant:[function(t,e,n){"use strict";cc._RFpush(e,"87edfMiLqVG2aB8vUGTPMBU","SmartFoxConstant");var i=t("Utils");e.exports={PING_INTERVAL:3e4,Command:{EMPTY:{ID:-1,NAME:""},IPLAY:{ID:-1,NAME:"IPLAY"},GLOBAL_ENDPOINT:{ID:-1,NAME:"pluginRequest"},GET_GAME_LIST:{ID:1,NAME:"GET_GAME_LIST"},GET_GAME_ROOM_LIST:{ID:2,NAME:"GET_GAME_ROOM_LIST"},UPDATE_USER_INFO:{ID:6,NAME:"UPDATE_USER_INFO"},MESSAGE:{ID:7,NAME:"MESSAGE"},KICK_PLAYER:{ID:14,NAME:"KICK_PLAYER"},PUSH_MESSAGE:{ID:15,NAME:"PUSH_MESSAGE"},PING:{ID:16,NAME:"PING"},GET_BETTING_VALUES:{ID:19,NAME:"GET_BETTING_VALUES"},UPDATE_PRIVATE_USER_MONEY:{ID:100,NAME:"UPDATE_PRIVATE_USER_MONEY"},DUPLICATE_LOGIN:{ID:101,NAME:"DUPLICATE_LOGIN"},GET_USER_IDLE_TIME:{ID:102,NAME:"GET_USER_IDLE_TIME"},PLAY:{ID:20,NAME:"PLAY"},CREATE_GAME:{ID:21,NAME:"CREATE_GAME"},PLAYER_ADDED:{ID:22,NAME:"PLAYER_ADDED"},PLAYER_REMOVED:{ID:23,NAME:"PLAYER_REMOVED"},UPDATE_HAND:{ID:24,NAME:"UPDATE_HAND"},UPDATE_GAME:{ID:25,NAME:"UPDATE_GAME"},UPDATE_GAME_STATE:{ID:26,NAME:"UPDATE_GAME_STATE"},UPDATE_ROOM_MASTER:{ID:27,NAME:"UPDATE_ROOM_MASTER"},DEAL_CARD:{ID:28,NAME:"DEAL_CARD"},TURN:{ID:29,NAME:"TURN"},FINISH_GAME:{ID:30,NAME:"FINISH_GAME"},WAITING_DEAL_CARD:{ID:33,NAME:"WAITING_DEAL_CARD"},WAITING_PLAYER_ADDED:{ID:34,NAME:"WAITING_PLAYER_ADDED"},WAITING_PLAYER_REMOVED:{ID:35,NAME:"WAITING_PLAYER_ADDED"},REFRESH_GAME:{ID:36,NAME:"REFRESH_GAME"},ENTER_GAME:{ID:37,NAME:"ENTER_GAME"},REG_QUIT_GAME:{ID:38,NAME:"REG_QUIT_GAME"},DEREG_QUIT_GAME:{ID:39,NAME:"DEREG_QUIT_GAME"},NEW_MATCH:{ID:40,NAME:"NEW_MATCH"},REQUEST_BANKER:{ID:41,NAME:"REQUEST_BANKER"},BANKER_RESIGN:{ID:42,NAME:"BANKER_RESIGN"},UPDATE_JAR:{ID:43,NAME:"UPDATE_JAR"},findById:function(t){return i.Object.findObject(this,"ID",t)}},KickReason:{NOT_ENOUGH_MONEY:1,NOT_ENOUGH_MONEY_TOBE_BANKER:5}},cc._RFpop()},{Utils:"Utils"}],SmartFoxWebImplement:[function(t,e,n){"use strict";function i(t){return t}cc._RFpush(e,"2d06fobVGJP1YwZBw2D/aaj","SmartFoxWebImplement");var a,s,o,r=t("SFS2X"),c=t("Utils"),h=t("EventDispatcher");a={init:function(t){this.configData=t,this.sfs=null,this.extensionDispatcher=h.create()},connect:function(t,e){this.isConnected()||(this.sfs=new r.SmartFox(this.configData),this.addEventListener(r.SFSEvent.CONNECTION,t),this.addEventListener(r.SFSEvent.CONNECTION_LOST,e),this.sfs.connect())},disconnect:function(){if(this.isConnected()){var t=this;this.sfs.getJoinedRooms().forEach(function(e){e&&t.leaveRoom(e.id)}),this.sfs.disconnect()}},isConnected:function(){return!(null===this.sfs||!this.sfs.isConnected())},login:function(t,e,n,i,a,s){if(this.isConnected()){var o={accessToken:e};this.addEventListener(r.SFSEvent.LOGIN,i),this.addEventListener(r.SFSEvent.LOGIN_ERROR,a),this.addEventListener(r.SFSEvent.LOGOUT,s),this.addEventListener(r.SFSEvent.EXTENSION_RESPONSE,function(t){this.extensionDispatcher.dispatchEvent(t.cmd,t)}.bind(this)),n=n||this.configData.zone,this.sfs.send(new r.Requests.System.LoginRequest(t,"",o,n))}},connectAndLogin:function(t,e,n,i,a,s,o,c){this.connect(i,a),this.sfs&&this.addEventListener(r.SFSEvent.CONNECTION,function(i){i.success&&this.login(t,e,n,s,o,c)}.bind(this))},sendExtensionRequest:function(t,e,n){if(this.isConnected()){var i=this.sfs.getRoomById(n);this.sfs.send(new r.Requests.System.ExtensionRequest(t,e,i))}},addExtensionHandler:function(t,e){this.extensionDispatcher.addEventListener(t,e)},removeExtensionHandler:function(t,e){this.extensionDispatcher.removeEventListener(t,e)},addEventListener:function(t,e){this.sfs&&c.Type.isFunction(e)&&this.sfs.addEventListener(t,e)},removeEventListener:function(t,e){this.sfs&&c.Type.isFunction(e)&&this.sfs.removeEventListener(t,e)},onJoinRoom:function(t,e){this.addEventListener(r.SFSEvent.ROOM_JOIN,t),this.addEventListener(r.SFSEvent.ROOM_JOIN_ERROR,e)},offJoinRoom:function(t,e){this.removeEventListener(r.SFSEvent.ROOM_JOIN,t),this.removeEventListener(r.SFSEvent.ROOM_JOIN_ERROR,e)},onLeaveRoom:function(t){this.addEventListener(r.SFSEvent.USER_EXIT_ROOM,t)},offLeaveRoom:function(t){this.removeEventListener(r.SFSEvent.USER_EXIT_ROOM,t)},onPublicMessage:function(t){this.addEventListener(r.SFSEvent.PUBLIC_MESSAGE,t)},offPublicMessage:function(t){this.removeEventListener(r.SFSEvent.PUBLIC_MESSAGE,t)},joinRoom:function(t,e){this.isConnected()&&this.sfs.send(new r.Requests.System.JoinRoomRequest(t,e,(-1)))},leaveRoom:function(t){if(this.isConnected()){var e=this.sfs.getRoomById(t);e&&this.sfs.send(new r.Requests.System.LeaveRoomRequest(e))}},sendPublicMessageRequest:function(t,e){if(this.isConnected()){var n=this.sfs.getRoomById(e);n&&this.sfs.send(new r.Requests.System.PublicMessageRequest(t,null,n))}},isJoinedInRoom:function(t){if(this.isConnected()){var e=this.sfs.mySelf,n=this.sfs.getRoomById(t);if(e&&n)return e.isJoinedInRoom(n)}return!1},getJoinedRooms:function(){return this.isConnected()?this.sfs.getJoinedRooms():[]},internalCleanResources:function(){this.sfs=null,this.extensionDispatcher.clear()}},s={parseClientDisconnectionReason:function(t){var e={isManual:t.reason===r.Utils.ClientDisconnectionReason.MANUAL,isKick:t.reason===r.Utils.ClientDisconnectionReason.KICK,isBan:t.reason===r.Utils.ClientDisconnectionReason.BAN,isIdle:t.reason===r.Utils.ClientDisconnectionReason.IDLE,isUnknown:t.reason===r.Utils.ClientDisconnectionReason.UNKNOWN};return e}},o={bool:i,boolArray:i,"byte":i,byteArray:i,"short":i,shortArray:i,"int":i,intArray:i,"long":i,longArray:i,"float":i,floatArray:i,"double":i,doubleArray:i,utfString:i,utfStringArray:i,sfsObject:i,sfsArray:i,getValue:i},e.exports={base:a,misc:s,type:o},cc._RFpop()},{EventDispatcher:"EventDispatcher",SFS2X:"SFS2X",Utils:"Utils"}],SmartFox:[function(t,e,n){"use strict";cc._RFpush(e,"9b0bbEeMkFAxoOczzgQq1sB","SmartFox");var i=t("Utils"),a=t("UiManager"),s=t("AuthUser"),o=t("PlatformImplement"),r=t("EventDispatcher"),c=t("EventDispatcherConstant"),h=t("CommonConstant"),u=t("GameManagerConstant"),l=t("SmartFoxConstant"),d=5e3,m=2e3,p=8;e.exports={init:function(e){e&&e.port&&(e.port=parseInt(e.port,10)),this.implement=t("SmartFoxWebImplement"),this.implement.base.init(e),this.type=this.implement.type,this.pingIntervalId=null,this.duplicateLogin=!1,this._cancelScheduleReconnect(),this.scheduleReconnectTimeoutId=null,this.retries=0,this.isReconnecting=!1,this.defaultEventHandlers={onConnection:function(t){t.success?(this.addExtensionHandler(l.Command.EMPTY.NAME,function(t){var e,n=t&&t.params;n&&n.command===l.Command.PUSH_MESSAGE.ID&&("displayType"in n&&i.Object.replaceProperty(n,"displayType","messageType"),e=h.PushMessageType.findById(n.messageType),e&&(e!==h.PushMessageType.POPUP&&e!==h.PushMessageType.RUNNING||n.content&&(n.content=h.CurrencyType.normalize(n.content)),r.dispatchEvent(e.EVENT,n)))}),this.addExtensionHandler(l.Command.IPLAY.NAME,function(t){var e=t&&t.params;e&&(e.command===l.Command.UPDATE_USER_INFO.ID?r.dispatchEvent(c.PROFILE.UPDATE_MONEY,{username:s.username,currency:e.currency,money:e.money}):e.command===l.Command.DUPLICATE_LOGIN.ID&&(this.duplicateLogin=!0))}.bind(this))):(this._scheduleReconnect()||(this._cancelScheduleReconnect(),s.username?o.displayLogoutMessage("Mất kết nối với máy chủ"):a.openModal("Kết nối với máy chủ thất bại")),this._cleanResources(),r.dispatchEvent(c.AUTH.LOGOUT))}.bind(this),onConnectionLost:function(t){var e=this.implement.misc.parseClientDisconnectionReason(t),n=s.username;n&&e.isUnknown?this.duplicateLogin?o.displayLogoutMessage('Tài khoản "'+n+'" của bạn đã được đăng nhập trên thiết bị khác'):this.retries<=0&&(this.retries=p,this._scheduleReconnect()||(this._cancelScheduleReconnect(),o.displayLogoutMessage("Mất kết nối với máy chủ"))):e.isManual||o.displayLogoutMessage("Mất kết nối với máy chủ"),this._cleanResources(),r.dispatchEvent(c.AUTH.LOGOUT)}.bind(this),onLogin:function(){this._cancelScheduleReconnect(),this._schedulePing(),this.onJoinRoom(function(t){r.dispatchEvent(u.Event.JOIN_ROOM,t.room)},function(t){a.openModal(t.errorMessage),r.dispatchEvent(u.Event.JOIN_ROOM_ERROR,t)}),this.onLeaveRoom(function(t){var e=t.user;e.isItMe&&r.dispatchEvent(u.Event.LEAVE_ROOM,t.room)}),r.dispatchEvent(c.AUTH.LOGIN)}.bind(this),onLoginError:function(t){this._cancelScheduleReconnect(),this._cleanResources(),a.openModal(t.errorMessage),r.dispatchEvent(c.AUTH.LOGOUT)}.bind(this),onLogout:function(){this._cancelScheduleReconnect(),this.disconnect()}.bind(this)
},this.globalEndpointCmdHandlerRegistered={}},connectAndLogin:function(t,e,n){this.implement.base.connectAndLogin(t,e,n,this.defaultEventHandlers.onConnection,this.defaultEventHandlers.onConnectionLost,this.defaultEventHandlers.onLogin,this.defaultEventHandlers.onLoginError,this.defaultEventHandlers.onLogout)},disconnect:function(){this.implement.base.disconnect()},isConnected:function(){return this.implement.base.isConnected()},sendExtensionRequest:function(t,e,n){this.implement.base.sendExtensionRequest(t,this.type.sfsObject(e),n)},addExtensionHandler:function(t,e){this.implement.base.addExtensionHandler(t,e)},removeExtensionHandler:function(t,e){this.implement.base.removeExtensionHandler(t,e)},onJoinRoom:function(t,e){this.implement.base.onJoinRoom(t,e)},offJoinRoom:function(t,e){this.implement.base.offJoinRoom(t,e)},onLeaveRoom:function(t){this.implement.base.onLeaveRoom(t)},offLeaveRoom:function(t){this.implement.base.offLeaveRoom(t)},joinRoom:function(t,e){this.implement.base.joinRoom(t,e)},leaveRoom:function(t){this.implement.base.leaveRoom(t)},sendPublicMessageRequest:function(t,e){i.Type.isString(t)&&(t=t.trim(),t.length>0&&this.implement.base.sendPublicMessageRequest(t,e))},onPublicMessage:function(t){this.implement.base.onPublicMessage(t)},offPublicMessage:function(t){this.implement.base.offPublicMessage(t)},sendGlobalEndpoint:function(t,e){var n,s,o=this.type.getValue(t.command);i.Type.isNumber(o)&&(n=l.Command.findById(o),n&&(this._markGlobalEndpointCmdHandlerRegistered(n.NAME)&&this.addExtensionHandler(n.NAME,function(t){var e=t&&t.params||{};0===e.result&&a.openModal(e.message)}),i.Type.isFunction(e)&&(s=function(t){var i=t&&t.params||{};this.removeExtensionHandler(n.NAME,s),e(i)}.bind(this),this.addExtensionHandler(n.NAME,s)))),this.sendExtensionRequest(l.Command.GLOBAL_ENDPOINT.NAME,t,null)},getUserIdleTime:function(t){this.sendGlobalEndpoint({command:this.type["byte"](l.Command.GET_USER_IDLE_TIME.ID)},t)},isJoinedInRoom:function(t){return this.implement.base.isJoinedInRoom(t)},getJoinedRooms:function(){return this.implement.base.getJoinedRooms()},_markGlobalEndpointCmdHandlerRegistered:function(){var t=[l.Command.PING.NAME];return function(e){var n=!1;return t.indexOf(e)!==-1||this.globalEndpointCmdHandlerRegistered[e]||(this.globalEndpointCmdHandlerRegistered[e]=!0,n=!0),n}}(),_schedulePingByInterval:function(t){this._cancelPing(),this.pingIntervalId=setInterval(function(){this.implement.base.isConnected()?this.sendGlobalEndpoint({command:this.type["byte"](l.Command.PING.ID)}):this._cancelPing()}.bind(this),t)},_schedulePing:function(){var t=this;this.getUserIdleTime(function(e){var n=e&&e.time;n>0&&(n*=1e3,n/=2.1,t._schedulePingByInterval(n))})},_cancelPing:function(){this.pingIntervalId&&(clearInterval(this.pingIntervalId),this.pingIntervalId=null)},_scheduleReconnect:function(){var t=s.username,e=s.accesstoken,n=this;return t&&e&&n.retries>0?(n.retries-=1,n.isReconnecting=!0,a.openWarningMessage("Mất kết nối với máy chủ, đang kết nối lại...",d/1e3,!0),this.scheduleReconnectTimeoutId=setTimeout(function(){n.connectAndLogin(t,e)},m),!0):(n.isReconnecting=!1,!1)},_cancelScheduleReconnect:function(){this.scheduleReconnectTimeoutId&&(clearTimeout(this.scheduleReconnectTimeoutId),this.scheduleReconnectTimeoutId=null),this.retries=0,this.isReconnecting=!1},_cleanResources:function(){this._cancelPing(),this.duplicateLogin=!1,this.implement.base.internalCleanResources()}},cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameManagerConstant:"GameManagerConstant",PlatformImplement:"PlatformImplement",SmartFoxConstant:"SmartFoxConstant",SmartFoxWebImplement:"SmartFoxWebImplement",UiManager:"UiManager",Utils:"Utils"}],SortCardLayoutMauBinh:[function(t,e,n){"use strict";cc._RFpush(e,"79232xlpoNDeJ9kJPy8SAQh","SortCardLayoutMauBinh");var i=t("Card"),a=t("CardUI"),s=t("ChiMauBinh"),o=t("MauBinhConstant"),r=t("BaseGameManager");cc.Class({"extends":cc.Component,properties:{lblChiList:{"default":[],type:cc.Label},cardNodeList:{"default":[],type:cc.Node},frameCardNode:cc.Node,cardPrefab:cc.Prefab,imgTouchingCard:cc.Node,imgCollisionCard:cc.Node,imgBinhLung:cc.Node,imgThangTrang:cc.Node,gameManager:r},setGameParam:function(t,e){this.gamePlay=t,this.gameManager=e},onLoad:function(){this._initFirstTime();var t,e=cc.winSize,n=e.width/2+20,i=e.height/2+20,a=this;a.node.on(cc.Node.EventType.TOUCH_START,function(e){if(a.gameManager.gameState===o.GameState.ORDER_CARDS&&!a.isFinish){a.resetCardPosition();var n=a.cardTouchingIndex,i=e.getCurrentTarget().parent,s=i.convertToNodeSpace(e.getLocation());for(a.cardTouchingIndex=-1,t=0;t<a.cardNodeList.length;t+=1){if(a.cardNodeList[t].getBoundingBox().contains(s)){a.cardTouchingIndex=t,a.cardTouchingPosition=a.cardPositionList[t],a.deltaPosition=a.cardTouchingPosition.sub(s),a.cardNodeList[t].zIndex=1,a.gamePlay.audioManager.playBaiChon();break}a.cardNodeList[t].zIndex=0}if(a.imgTouchingCard.active&&a.cardTouchingIndex!==-1&&n!==-1&&n!==a.cardTouchingIndex){var r=a.cardNodeList[n],c=a.cardNodeList[a.cardTouchingIndex],h=r.position.sub(c.position),u=a._distanceVec2(h)/2300;r.runAction(cc.moveTo(u,a.cardPositionList[a.cardTouchingIndex])),c.runAction(cc.moveTo(u,a.cardPositionList[n])),a._swapCard(a.cardTouchingIndex,n),a.imgTouchingCard.active=!1,a.imgTouchingCard.position=a.cardPositionList[a.cardTouchingIndex],a.cardTouchingIndex=-1,a._onSortCard()}else a.cardTouchingIndex!==-1&&(a.imgTouchingCard.active=!0,a.imgTouchingCard.position=a.cardTouchingPosition)}}),a.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(a.gameManager.gameState===o.GameState.ORDER_CARDS&&!a.isFinish){var e=t.getCurrentTarget().parent,s=e.convertToNodeSpace(t.getLocation());if(a.cardTouchingIndex>=0){var r=a.cardNodeList[a.cardTouchingIndex];r.position=s.add(a.deltaPosition);var c=Math.abs(r.x-a.cardTouchingPosition.x),h=Math.abs(r.y-a.cardTouchingPosition.y);(c>=3||h>=3)&&(a.imgTouchingCard.active=!1),a.cardCollisionIndex=-1,a.imgCollisionCard.active=!1;for(var u=0;u<a.cardNodeList.length;u+=1)r!==a.cardNodeList[u]&&a._isCollision(a.cardNodeList[u],r)&&(a.cardCollisionIndex=u,a.imgCollisionCard.active=!0,a.imgCollisionCard.position=a.cardNodeList[u].position);var l=.72*r.width,d=.72*r.height;(r.x+l/2>=n||r.x-l/2<=-n||r.y+d/2>=i||r.y-d/2<=-i)&&(r.runAction(cc.moveTo(.2,a.cardTouchingPosition)),a.cardTouchingIndex=-1)}}}),a.node.on(cc.Node.EventType.TOUCH_END,function(){if(a.gameManager.gameState===o.GameState.ORDER_CARDS&&!a.isFinish){if(a.cardTouchingIndex>=0){var t=a.cardNodeList[a.cardTouchingIndex].position.sub(a.cardTouchingPosition),e=a._distanceVec2(t)/3e3;if(a.cardCollisionIndex>=0){a.cardNodeList[a.cardCollisionIndex].zIndex=1;var n=a.cardNodeList[a.cardCollisionIndex].position;a.cardNodeList[a.cardTouchingIndex].runAction(cc.moveTo(.1,n)),a.cardNodeList[a.cardCollisionIndex].runAction(cc.moveTo(e,a.cardTouchingPosition));var i=a.cardNodeList[a.cardTouchingIndex];a.cardNodeList[a.cardTouchingIndex]=a.cardNodeList[a.cardCollisionIndex],a.cardNodeList[a.cardCollisionIndex]=i,a._onSortCard(),a.gamePlay.audioManager.playBaiBay()}else a.cardNodeList[a.cardTouchingIndex].runAction(cc.moveTo(e,a.cardTouchingPosition));a.cardNodeList[a.cardTouchingIndex].zIndex=0,a.imgCollisionCard.active=!1}for(var s=0;s<a.cardNodeList.length;s+=1)a.cardNodeList[s].opacity=255;a.cardCollisionIndex=-1,a.imgTouchingCard.active||(a.cardTouchingIndex=-1)}})},setCards:function(t){this._initFirstTime();for(var e=0;e<t.length;e+=1){this.cardNodeList[e].getComponent(a).setCard(i.fromId(t[e]));var n=this.cardNodeList[e],s=n.getChildByName("Fold"),o=.72;s.active=!0,n.runAction(cc.sequence(cc.delayTime(.02*e),cc.scaleTo(.05,0,o),cc.callFunc(function(){this.getChildByName("Fold").active=!1}.bind(n)),cc.scaleTo(.15,o,o)))}this._calculateChi()},getCards:function(){for(var t=[],e=0;e<this.cardNodeList.length;e+=1)t.push(this.cardNodeList[e].getComponent(a).getCardId());return t},reset:function(){this._initFirstTime();for(var t=0;t<this.cardNodeList.length;t+=1)this.cardNodeList[t].stopAllActions();this.isFinish=!1,this.node.active=!1,this.imgCollisionCard.active=!1,this.imgTouchingCard.active=!1,this.imgBinhLung.active=!1,this.imgThangTrang.active=!1,this.resetCardPosition()},resetCardPosition:function(){for(var t=0;t<this.cardNodeList.length;t+=1)this.cardNodeList[t].opacity=255,this.cardNodeList[t].position=this.cardPositionList[t]},setFinishOrder:function(){this._initFirstTime(),this.isFinish=!0,this.node.active=!1,this.reset()},swapChi:function(){if(!this.swapping){this.swapping=!0;var t;for(t=0;t<5;t+=1)this.cardNodeList[t].runAction(cc.moveTo(.3,this.cardPositionList[t+5]));for(t=5;t<10;t+=1)this.cardNodeList[t].runAction(cc.sequence(cc.moveTo(.3,this.cardPositionList[t-5]),cc.callFunc(function(){this._onSortCard(),this.swapping=!1}.bind(this))));for(t=0;t<5;t+=1)this._swapCard(t,t+5)}},_swapCard:function(t,e){var n=this.cardNodeList[t];this.cardNodeList[t]=this.cardNodeList[e],this.cardNodeList[e]=n},_isCollision:function(t,e){var n=Math.abs(t.position.x-e.position.x),i=Math.abs(t.position.y-e.position.y);return!!(t.getBoundingBox().intersects(e.getBoundingBox())&&n<=60&&i<=80)},_calculateChi:function(){var t,e=new s(this.getCards()),n=e.getResult();for(this.imgBinhLung.active=e.isBinhLung(),this.imgThangTrang.active=e.isThangTrang(),this.imgThangTrang.getComponentInChildren(cc.Label).string=n[0].NAME,t=0;t<this.lblChiList.length;t+=1)this.lblChiList[t].string=n[t].NAME,this.lblChiList[t].node.active=!e.isThangTrang();for(t=0;t<this.cardNodeList.length;t+=1){var i=!1,o=this.cardNodeList[t].getComponent("CardUI").card.getId();i=this._isCardInChi(o,e.cardsInChi),!i&&o<4&&(o+=52,i=this._isCardInChi(o,e.cardsInChi)),this.cardNodeList[t].getComponent(a).showTransparentBlackNode(!i)}},_isCardInChi:function(t,e){for(var n=0;n<3;n+=1)for(var i=0;i<e[n].length;i+=1)if(t===e[n][i])return!0;return!1},_onSortCard:function(){this.gameManager.sendRequestOrderCard(this.getCards(),!1),this._calculateChi()},_distanceVec2:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},_initFirstTime:function(){if(!this.isInitFirstTime){this.isInitFirstTime=!0,this.isFinish=!1,this.deltaPosition=cc.v2(),this.cardTouchingIndex=-1,this.cardCollisionIndex=-1,this.cardTouchingPosition=cc.v2(),this.cardPositionList=[],this.imgTouchingCard.active=!1,this.imgCollisionCard.active=!1,this.imgBinhLung.active=!1,this.imgThangTrang.active=!1;var t,e=this.cardNodeList.length;for(t=0;t<e;t+=1)this.cardPositionList.push(this.cardNodeList[t].position);for(this.frameCardNode.removeAllChildren(),t=0;t<e;t+=1){var n=cc.instantiate(this.cardPrefab);n.position=this.cardPositionList[t],n.scale=.72,this.frameCardNode.addChild(n);var i=n.getComponent(a);i.foldNode.active=!1,i.unfoldNode.active=!0,this.cardNodeList[t]=n}}}}),cc._RFpop()},{BaseGameManager:"BaseGameManager",Card:"Card",CardUI:"CardUI",ChiMauBinh:"ChiMauBinh",MauBinhConstant:"MauBinhConstant"}],SpecificGameItemList:[function(t,e,n){"use strict";cc._RFpush(e,"aeda3hH76ZE76J/4f4cFrPS","SpecificGameItemList");var i=t("GameManager"),a=t("GameItem"),s=cc.Class({name:"GameItemNode",properties:{node:{"default":null,type:a},id:{"default":""}}});cc.Class({"extends":cc.Component,properties:{gameItemNodes:{"default":[],type:s}},onLoad:function(){this._initGames()},_initGames:function(){var t=this;this.gameItemNodes.forEach(function(e){t._initGame(e.node,parseInt(e.id))})},_initGame:function(t,e){var n,a,s;for(s=0;s<i.GAME_GROUP_LIST.length;s+=1)if(n=i.GAME_GROUP_LIST[s],n&&n.length>0&&(a=n[0],a&&a.CONFIG&&a.CONFIG.ID===e)){t.init(n);break}}}),cc._RFpop()},{GameItem:"GameItem",GameManager:"GameManager"}],Splash:[function(t,e,n){"use strict";cc._RFpush(e,"cd1d177/2VL4rLVLTSNlb3r","Splash");var i=t("PlatformImplement"),a=t("NetworkManager"),s=t("GameConstant"),o=t("SysConfig"),r=t("AuthUser"),c=t("Utils"),h=t("Url");cc.Class({"extends":cc.Component,properties:{loadingProgressBar:cc.ProgressBar},onLoad:function(){function t(){u+=1,e.loadingProgressBar.progress=u/n}var e=this,n=4,u=0,l=c.Cookie.get(o.CookieName.USERNAME),d=c.Cookie.get(o.CookieName.ACCESSTOKEN);return l&&d?void s.loadIconsAtlas(function(){t(),a.Http.fetch("GET",h.Http.RT_SV_IP,{username:l,accesstoken:d}).success(function(e){var n=e.data;t(),a.Http.fetch("GET",h.Http.CHECK_VER,{version_code:o.VERSION_CODE,platform:o.PLATFORM}).success(function(e){s.updateIconsServer(e.data.game_icons),s.updateGamePriorities(e.data.game_priorities),t(),a.Http.fetch("GET",h.Http.GAME_ACCOUNT,{username:l,accesstoken:d}).success(function(e){var i=n.realtime&&n.realtime[0],s=null,o=null,c=null,h=!1;t(),r.updateInfo(e.data),i&&(c=i.zone,"http:"===location.protocol?(s=i.ws_host,o=i.ws_port):"https:"===location.protocol&&(s=i.wss_host,o=i.wss_port,h=!0),s&&o&&c&&(a.SmartFox.init({host:s,port:o,useSSL:h,zone:c}),a.SmartFox.connectAndLogin(l,d),window.onbeforeunload=function(){return"Bạn có chắc chắn muốn thoát khỏi game không ?"}))})})})}):i.returnLoginPage()}}),cc._RFpop()},{AuthUser:"AuthUser",GameConstant:"GameConstant",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",SysConfig:"SysConfig",Url:"Url",Utils:"Utils"}],SysConfig:[function(t,e,n){"use strict";cc._RFpush(e,"2803dPdVpdDKIId2D7Sv/CP","SysConfig");var i={VERSION_CODE:1,CP:"VBH00000",GAME:"IPLAY",PLATFORM:"WEB",IplayHttp:{HOST:"vuabai.club",PORT:"443",PROTOCOL:"https",AUTH_USER:"",AUTH_PASS:""},CookieName:{USERNAME:"i_username",ACCESSTOKEN:"i_accesstoken"}};e.exports=i,cc._RFpop()},{}],TLMNConstant:[function(t,e,n){"use strict";cc._RFpush(e,"665a6EW1alMp4cY0ui/2Oul","TLMNConstant"),e.exports={Action:{DISCARD:0,IGNORE:1,ORDER_HANDS:2,CHAT_HANG:3,BAO_SAM:4,WAITING_BAO_SAM:5,BAO:6,HUY_BAO_SAM:7,DEN_LANG:17},GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_FOR_NEW_GAME:2,DEALING:3,BAO_SAM:4,PLAYING:5,FINALIZING:6,FINISH:7},GameStateTLMN:{NONE:0,WAITING_FOR_PLAYER:"waitingForPlayer",WAITING_FOR_NEW_GAME:"waitingDealing",PLAYING:"playing",FINALIZING:"finalizing",FINISH:"finish"},PlayerState:{WAITING:0,READY:1,IN_TURN:2,OUT_TURN:3,WAITING_FOR_TURN:4,FINISH:5},ActionFinishType:{THANG_TRANG:0,THUA_DEM_LA:13,SAM_THANH_CONG:16,SAM_THAT_BAI:17,DEN_LANG_THOI_HAI:18},Event:{FINISH_GAME:"in_game.sam.finish_game",UPDATE_GAME:"in_game.sam.update_game",UPDATE_HAND:"in_game.sam.update_hand",WAITING_DEAL_CARD:"in_game.sam.waiting_deal_card",WAITING_FOR_PLAYER:"in_game.sam.waiting_for_player",TURN:"in_game.sam.turn",DISCARD:"in_game.sam.discard",REFRESH_GAME:"in_game.sam.refresh_game",CHAT_HANG:"in_game.sam.chag_hang",WAITING_BAO_SAM:"in_game.sam.bao_sam",PLAYER_BAO_SAM:"in_game.sam.player_bao_sam",PLAYER_BAO_MOT:"in_game.sam.player_bao_mot",PLAYER_HUY_BAO_SAM:"in_game.sam.huy_bao_sam"},TimeoutId:{DISCARD_MUSIC:"TIMEOUT_DISCARD_MUSIC",BOLUOT_ANIMATION:"TIMEOUT_BOLUOT_ANIMATION",CHANGE_TURN:"TIMEOUT_CHANGE_TURN"},Effect:{THUA_CONG:0,THANG_TRANG:1,CHAN_SAM:2,BAO_SAM:3,BAO:4,DEN_LANG:5,DEN_TRANG:6,HUY_BAO_SAM:7,SAM_THAT_BAI:8,SAM_THANH_CONG:9,DANG_DOI:10,HET_LUOT:11}},cc._RFpop()},{}],TLMNGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"87fafqOsvNAL4Ceb8muYxMX","TLMNGameManager");var i,a=t("BaseGameManager"),s=t("NetworkManager"),o=t("SmartFoxConstant"),r=t("TLMNConstant"),c=t("Utils");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.UPDATE_HAND.ID,this.onUpdateHand,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.WAITING_DEAL_CARD.ID,this.onWaitingDealCard,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.WAITING_PLAYER_ADDED.ID,this.onWaitingForPlayer,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.TURN.ID,this.onTurn,this),this.eventDispatchers.anyCmd.addEventListener(o.Command.REFRESH_GAME.ID,this.onRefreshGame,this),this.eventDispatchers.playCmd.addEventListener(r.Action.CHAT_HANG,this.onChatHang,this)},onUpdateGame:function(t){this.onRefreshGame(t)},onFinishGame:function(t){this.gameState=r.GameStateTLMN.FINISH,this.eventDispatchers.local.dispatchEvent(r.Event.FINISH_GAME,t)},onUpdateHand:function(t){this.eventDispatchers.local.dispatchEvent(r.Event.UPDATE_HAND,t)},onWaitingForPlayer:function(){this.eventDispatchers.local.dispatchEvent(r.Event.WAITING_FOR_PLAYER)},onWaitingDealCard:function(t){this.gameState=r.GameStateTLMN.WAITING_FOR_NEW_GAME,this.eventDispatchers.local.dispatchEvent(r.Event.WAITING_DEAL_CARD,t)},onTurn:function(t){this.gameState=r.GameStateTLMN.PLAYING,t.lastPlayer?(t.cards&&this.eventDispatchers.local.dispatchEvent(r.Event.DISCARD,{cards:t.cards,userName:t.lastPlayer.userName}),t.toPlayer&&this.eventDispatchers.local.dispatchEvent(r.Event.TURN,{userName:t.toPlayer.userName,wait:1,newTurn:t.newTurn,timeTurn:t.time})):t.toPlayer&&this.eventDispatchers.local.dispatchEvent(r.Event.TURN,{userName:t.toPlayer.userName,wait:0,newTurn:t.newTurn,timeTurn:t.time})},onRefreshGame:function(t){switch(this.gameState=t.allData.gameState,t.allData.gameState){case r.GameStateTLMN.WAITING_FOR_PLAYER:this.onWaitingForPlayer();break;case r.GameStateTLMN.WAITING_FOR_NEW_GAME:this.onWaitingDealCard(t);break;case r.GameStateTLMN.PLAYING:this.onTurn(t),this.onUpdateHand(t),t.data.trash&&this.eventDispatchers.local.dispatchEvent(r.Event.REFRESH_GAME,t);break;case r.GameStateTLMN.FINALIZING:break;case r.GameStateTLMN.FINISH:}},onChatHang:function(t){t.data.action===r.Action.CHAT_HANG&&this.eventDispatchers.local.dispatchEvent(r.Event.CHAT_HANG,t)},sendRequestStartGame:function(){this.send({command:s.SmartFox.type["byte"](o.Command.DEAL_CARD.ID)})},sendRequestDiscard:function(t){this.send({command:s.SmartFox.type["byte"](o.Command.PLAY.ID),action:s.SmartFox.type["byte"](r.Action.DISCARD),cards:s.SmartFox.type.byteArray(t)})}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",TLMNConstant:"TLMNConstant",Utils:"Utils"}],TabActivateAccount:[function(t,e,n){"use strict";cc._RFpush(e,"beda3ByUHdLnrfqcZz5xqGt","TabActivateAccount");var i=t("Url"),a=t("AuthUser"),s=t("UiManager"),o=t("NetworkManager"),r=t("PlatformImplement");cc.Class({"extends":cc.Component,properties:{statusEmailLabel:cc.Label,statusSmsLabel:cc.Label,activeEmailButton:cc.Button,activeSmsButton:cc.Button,emailLabel:cc.Label,SmsLabel:cc.Label},onLoad:function(){},onEnable:function(){this.SmsLabel.string=a.username,this.emailLabel.string=a.email,a.email_active?(this.statusEmailLabel.string="Đã kích hoạt email",this.activeEmailButton.interactable=!1):(this.statusEmailLabel.string="Chưa kích hoạt email",this.activeEmailButton.interactable=!0),a.mobile_active_time?(this.statusSmsLabel.string="Đã kích hoạt SMS",this.activeSmsButton.interactable=!1):(this.statusSmsLabel.string="Chưa kích hoạt SMS",this.activeSmsButton.interactable=!0)},activeEmail:function(t){o.Http.fetch("POST",i.Http.USER_ACTIVE_EMAIL,{username:a.username,accesstoken:a.accesstoken}).success(function(){s.openModal("Đã gửi thư kích hoạt đến email của bạn, hãy kiểm tra ở hòm thư!")}).setWaitingButton(t.target)},activeSms:function(t){o.Http.fetch("GET",i.Http.USER_ACTIVE_PHONE,{username:a.username,accesstoken:a.accesstoken}).success(function(t){var e=t.data;s.openConfirmModal(e.note,{oke_fn:function(){r.guiTinNhan(e.number,e.syntax)}})}).setWaitingButton(t.target)}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",UiManager:"UiManager",Url:"Url"}],TabChangePassword:[function(t,e,n){"use strict";cc._RFpush(e,"7e2abgleVxNA4bbKKCnyJTI","TabChangePassword");var i=t("Url"),a=t("AuthUser"),s=t("UiManager"),o=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{oldPassEditBox:cc.EditBox,newPassEditBox:cc.EditBox,rePassEditBox:cc.EditBox},onLoad:function(){this.clearInput()},onButtonChangePass:function(t){var e=this;return""===this.rePassEditBox.string||""===this.newPassEditBox.string?s.openModal("Bạn cần nhập đầy đủ thông tin để đổi."):this.rePassEditBox.string!==this.newPassEditBox.string?s.openModal("Mật khẩu mới nhập không khớp."):this.oldPassEditBox.string===this.newPassEditBox.string?s.openModal("Mật khẩu cũ và mới trùng nhau."):void o.Http.fetch("POST",i.Http.USER_CHANGE_PASSWORD,{username:a.username,old_pass:this.oldPassEditBox.string,new_pass:this.newPassEditBox.string}).success(function(){e.clearInput(),s.openModal("Bạn đã thay đổi mật khẩu thành công.")}).setWaitingButton(t.target)},clearInput:function(){this.oldPassEditBox.string="",this.newPassEditBox.string="",this.rePassEditBox.string=""}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],TabInformation:[function(t,e,n){"use strict";cc._RFpush(e,"c5cc0qSoXFPpKnZc38eXbK8","TabInformation");var i=t("Url"),a=t("AuthUser"),s=t("UiManager"),o=t("NetworkManager"),r=t("EventDispatcher"),c=t("EventDispatcherConstant");cc.Class({"extends":cc.Component,properties:{emailEditBox:cc.EditBox,userNameLabel:cc.Label,fullNameEditBox:cc.EditBox},onLoad:function(){this.userNameLabel.string=a.username,this.emailEditBox.string=a.email||"",this.fullNameEditBox.string=a.display_name},onButtonChangeInfo:function(t){var e="",n="",h="",u="";""===this.emailEditBox.string||""===this.fullNameEditBox.string?s.openModal("Bạn cần nhập đầy đủ thông tin để đổi."):(n=this.fullNameEditBox.string.split(" "),h=n[0],u=n[1]||"",n=this.fullNameEditBox.string,e=this.emailEditBox.string,o.Http.fetch("POST",i.Http.USER_UPDATE_INFO,{username:a.username,email:e,firstname:h,lastname:u,accesstoken:a.accesstoken}).success(function(t){a.updateInfo(t.data),r.dispatchEvent(c.PROFILE.UPDATE_INFO),s.openModal("Bạn đã thay đổi thông tin thành công.")}).setWaitingButton(t.target))}}),cc._RFpop()},{AuthUser:"AuthUser",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",NetworkManager:"NetworkManager",UiManager:"UiManager",Url:"Url"}],TabSupport:[function(t,e,n){"use strict";cc._RFpush(e,"82c28LctCtG26l4XaWMs/St","TabSupport");var i=t("PlatformImplement"),a=t("NetworkManager"),s=t("UiManager"),o=t("AuthUser"),r=t("Url");cc.Class({"extends":cc.Component,properties:{mobileLabel:cc.Label,fbPageLabel:cc.Label,titleEditBox:cc.EditBox,contentEditBox:cc.EditBox},fetchContactInfo:function(){var t=this;a.Http.fetch("GET",r.Http.CONTACT_INFO,{},{cache:1800}).success(function(e){t.contactInfo=e.data,t.mobileLabel.string=e.data.mobile,t.fbPageLabel.string=e.data.fb_page})},callHotline:function(){this.contactInfo&&i.callNumberPhone(this.contactInfo.mobile)},openFacebookPage:function(){this.contactInfo&&i.openWebUrl(this.contactInfo.fb_page)},sendFeedback:function(t){var e=this,n=this.titleEditBox.string,i=this.contentEditBox.string;""===this.titleEditBox.string||""===this.contentEditBox.string?s.openModal("Bạn cần nhập đầy đủ thông tin gửi."):a.Http.fetch("POST",r.Http.FEEDBACK,{accesstoken:o.accesstoken,username:o.username,subject:n,content:i}).success(function(){e.clearInputFeedback(),s.openModal("Bạn đã gửi phản hồi thành công.")}).setWaitingButton(t.target)},clearInputFeedback:function(){this.contentEditBox.string="",this.titleEditBox.string=""},onLoad:function(){this.clearInputFeedback()}}),cc._RFpop()},{AuthUser:"AuthUser",NetworkManager:"NetworkManager",PlatformImplement:"PlatformImplement",UiManager:"UiManager",Url:"Url"}],TabVatPham:[function(t,e,n){"use strict";cc._RFpush(e,"8b43cEpHHZFHaDJfq3EjFxY","TabVatPham");var i=t("NetworkManager"),a=t("Url");cc.Class({"extends":cc.Component,properties:{itemVatPhamPrefab:cc.Prefab,contentNode:cc.Node},onLoad:function(){},onEnable:function(){this.loadDataItems()},loadDataItems:function(){var t=this;t.contentNode.removeAllChildren(),i.Http.fetch("GET",a.Http.DOI_THUONG_GET_ITEMS_INFO,{},{cache:1800}).success(function(e){for(var n,i=0;i<e.data.length;i+=1)n=cc.instantiate(t.itemVatPhamPrefab),n.getComponent("ItemVatPham").updateData(e.data[i]),t.contentNode.addChild(n)})}}),cc._RFpop()},{NetworkManager:"NetworkManager",Url:"Url"}],TabView:[function(t,e,n){"use strict";cc._RFpush(e,"0c3f6P5cAlLjKotwwKYbxJx","TabView"),cc.Class({"extends":cc.Component,properties:{activeSprite:{"default":null,type:cc.SpriteFrame},normalSprite:{"default":null,type:cc.SpriteFrame},activeColor:{"default":new cc.Color(255,255,255)},normalColor:{"default":new cc.Color(255,0,0)},selectEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){for(var t=this.node.getChildByName("Tabs"),e=t.children,n=this,i=0;i<e.length;i+=1)e[i].on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this);t.on("child-removed",function(t){var e=n.node.getChildByName("Contents");e.getChildByName(t.detail.name).removeFromParent()})},onEnable:function(){var t=this.node.getChildByName("Tabs").children;t.length>0&&!this.activeTabName&&this.activeByName(t[0].name)},addTab:function(t,e){var n=this.node.getChildByName("Tabs"),i=this.node.getChildByName("Contents"),a="Tab"+n.children.length;e.name=t.name=a,n.addChild(t),t.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),i.addChild(e)},removeAllTabs:function(){this.node.getChildByName("Tabs").removeAllChildren(),this.node.getChildByName("Contents").removeAllChildren()},_onTouchBegan:function(t){this._activeByName(t.target.name),t.stopPropagation()},_activeByName:function(t){var e,n,i,a,s=this.node.getChildByName("Tabs").children,o=this.node.getChildByName("Contents"),r=this;if(this.activeTabName!==t)for(e=0;e<s.length;e+=1)i=o.getChildByName(s[e].name),a=s[e].getComponentInChildren(cc.Label).node,n=s[e].getComponent(cc.Sprite),s[e].name===t?(this.activeTabName=t,i.active=!0,a.color=this.activeColor,n.spriteFrame=this.activeSprite,r.selectEvents.forEach(function(t){t.emit([s[e],i])})):(i.active=!1,a.color=this.normalColor,n.spriteFrame=this.normalSprite)},activeByName:function(t){var e,n=this.node.getChildByName("Tabs").getChildByName(t),i=n.getComponent(cc.Button);if(this._activeByName(t),i)for(e=0;e<i.clickEvents.length;e+=1)i.clickEvents[e].emit(n)}}),cc._RFpop()},{}],TableBangThuongHaiTac:[function(t,e,n){"use strict";cc._RFpush(e,"e5111uezPlG74qZEh2E7PsG","TableBangThuongHaiTac");var i=t("ItemHaiTac");cc.Class({"extends":cc.Component,properties:{greenLayoutText:{"default":[],type:cc.Node},whiteLayoutText:{"default":[],type:cc.Node},ItemHaiTacList:{"default":[],type:i}},onExitClick:function(){this.node.active=!1},setData:function(t,e){for(var n=0;n<t.length;n+=1)for(var i=t[n].awards,a=0;a<i.length;a+=1){var s=this.greenLayoutText[n].getChildByName(""+(a+1)),o=this.whiteLayoutText[n].getChildByName(""+(a+1));void 0!==o&&void 0!==o&&(s.getComponent(cc.Label).string=i[a].number,o.getComponent(cc.Label).string=" x "+i[a].ratio,"jar"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+"% Hũ"),"lucky_coffer"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+" Hộp quà"),"free_turn"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+" Lượt quay"))}for(n=0;n<this.ItemHaiTacList.length;n+=1)this.ItemHaiTacList[n].setType(e,n)}}),cc._RFpop()},{ItemHaiTac:"ItemHaiTac"}],TableBangThuongHoaQua:[function(t,e,n){"use strict";cc._RFpush(e,"bf5b60CaB5LD77Nih/k0Kk3","TableBangThuongHoaQua");var i=t("ItemHoaQua");cc.Class({"extends":cc.Component,properties:{greenLayoutText:{"default":[],type:cc.Node},whiteLayoutText:{"default":[],type:cc.Node},ItemHoaQuaList:{"default":[],type:i}},onExitClick:function(){this.node.active=!1},setData:function(t,e){for(var n=0;n<t.length;n+=1)for(var i=t[n].awards,a=0;a<i.length;a+=1){var s=this.greenLayoutText[n].getChildByName(""+(a+1)),o=this.whiteLayoutText[n].getChildByName(""+(a+1));void 0!==o&&void 0!==o&&(s.getComponent(cc.Label).string=i[a].number,o.getComponent(cc.Label).string=" x "+i[a].ratio,"jar"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+"% Hũ"),"lucky_coffer"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+" Hộp quà"),"free_turn"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+" Lượt quay"))}for(n=0;n<this.ItemHoaQuaList.length;n+=1)this.ItemHoaQuaList[n].setType(e,n)}}),cc._RFpop()},{ItemHoaQua:"ItemHoaQua"}],TableBangThuongMyNhan:[function(t,e,n){"use strict";cc._RFpush(e,"2d1e0wMQ8dMuYE5jRpXV80/","TableBangThuongMyNhan");var i=t("ItemMyNhan");cc.Class({"extends":cc.Component,properties:{greenLayoutText:{"default":[],type:cc.Node},whiteLayoutText:{"default":[],type:cc.Node},itemMyNhanList:{"default":[],type:i}},onExitClick:function(){this.node.active=!1},setData:function(t,e){for(var n=0;n<t.length;n+=1)for(var i=t[n].awards,a=0;a<i.length;a+=1){var s=this.greenLayoutText[n].getChildByName(""+(a+1)),o=this.whiteLayoutText[n].getChildByName(""+(a+1));void 0!==o&&void 0!==o&&(s.getComponent(cc.Label).string=i[a].number,o.getComponent(cc.Label).string=" x "+i[a].ratio,"jar"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+"% Hũ"),"lucky_coffer"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+" Hộp quà"),"free_turn"===i[a].awardType&&(o.getComponent(cc.Label).string=" x "+i[a].ratio+" Lượt quay"))}for(n=0;n<this.itemMyNhanList.length;n+=1)this.itemMyNhanList[n].setType(e,n)}}),cc._RFpop()},{ItemMyNhan:"ItemMyNhan"}],TableChonDong:[function(t,e,n){"use strict";cc._RFpush(e,"625296/kLRLppGT1dUKSn9o","TableChonDong");var i=t("TextJumping");cc.Class({"extends":cc.Component,properties:{cuaDatNode:cc.Node,txtDong:cc.Label,txtDatCuoc:cc.Label},onLoad:function(){this.pots=this.getPots()},getPots:function(){if(this._initOnce(),void 0===this.pots){this.pots=[];for(var t=0;t<this.cuadatList.length;t+=1)this.pots.push(t+1)}return this.pots},updateMoneyBetting:function(t){this.betting=t;var e=this.getPots().length*t;this.txtDatCuoc.node.getComponent(i).updateText(e)},onDatCuaClick:function(t){var e=parseInt(t.currentTarget.name)-1,n=this.cuadatList[e].getComponent(cc.Sprite);n.enabled=!n.enabled},onDongChanClick:function(){for(var t=0;t<this.cuadatList.length;t+=1)this.cuadatList[t].getComponent(cc.Sprite).enabled=(t+1)%2===0},onDongLeClick:function(){for(var t=0;t<this.cuadatList.length;t+=1)this.cuadatList[t].getComponent(cc.Sprite).enabled=t%2===0},onBoChonClick:function(){for(var t=0;t<this.cuadatList.length;t+=1)this.cuadatList[t].getComponent(cc.Sprite).enabled=!1},onTatCaClick:function(){for(var t=0;t<this.cuadatList.length;t+=1)this.cuadatList[t].getComponent(cc.Sprite).enabled=!0},onExitClick:function(){this.node.active=!1,this.pots=[];for(var t=0,e=0;e<this.cuadatList.length;e+=1)this.cuadatList[e].getComponent(cc.Sprite).enabled&&(t+=1,this.pots.push(e+1));this.txtDong.node.getComponent(i).updateText(t),this.updateMoneyBetting(this.betting)},_initOnce:function(){if(void 0===this.cuadatList){this.cuadatList=this.cuaDatNode.children;var t;for(t=0;t<this.cuadatList.length;t+=1){var e=this.cuadatList[t];e.addComponent(cc.Button);var n=new cc.Component.EventHandler;n.target=this.node,n.component="TableChonDong",n.handler="onDatCuaClick",e.getComponent(cc.Button).clickEvents.push(n)}for(t=0;t<this.cuadatList.length;t+=1)this.cuadatList[t].getComponent(cc.Sprite).enabled=!0}}}),cc._RFpop()},{TextJumping:"TextJumping"}],TableHistorySlot:[function(t,e,n){"use strict";cc._RFpush(e,"4c61fC/3FZH6bgCwKMiDqcY","TableHistorySlot");var i=t("Pagination"),a=t("Utils");cc.Class({"extends":cc.Component,properties:{pagination:i,historyItemTemplateNode:cc.Node,historyListNode:cc.Node,historyListScrollView:cc.ScrollView,maxRows:10},onLoad:function(){this.historyListScrollView.node.active=!1,this.historyListNode.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.historyListScrollView.node.active=!0}.bind(this))))},init:function(t){if(t){var e,n=Math.ceil(t.length/10),i=[];for(this.historyList=t,e=1;e<=n;e+=1)i.push(e);this.selectPage({page:1}),this.pagination.init({pageList:i,currentPage:1},this.selectPage.bind(this));
}},selectPage:function(t){if(this.historyList&&t){var e,n,i,s,o=t.page-1,r=o*this.maxRows,c=this.historyList.slice(r,r+this.maxRows);for(this.historyListNode.removeAllChildren(),s=0;s<c.length;s+=1)i=cc.instantiate(this.historyItemTemplateNode),i.active=!0,n=c[s],e=i.getComponentsInChildren(cc.Label),e[0].string=n.time||" ",e[1].string=n.type||" ",e[2].string=a.Number.format(n.betting)||" ",e[3].string=a.Number.format(n.totalBetting)||" ",e[4].string=(n.result>0?"+":"")+a.Number.format(n.result)||" ",this.historyListNode.addChild(i)}}}),cc._RFpop()},{Pagination:"Pagination",Utils:"Utils"}],TableXepHangSlot:[function(t,e,n){"use strict";cc._RFpush(e,"34d86pNeTdN34FTQ/Y+CgKj","TableXepHangSlot");var i=t("Url"),a=t("NetworkManager"),s=t("Utils");cc.Class({"extends":cc.Component,properties:{historyItemTemplateNode:cc.Node,historyListNode:cc.Node,historyListScrollView:cc.ScrollView,images:{"default":[],type:cc.Sprite},imageColor:cc.Color,maxRows:10},onLoad:function(){this.historyListScrollView.node.active=!1,this.historyListNode.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){this.historyListScrollView.node.active=!0}.bind(this))))},init:function(t,e){var n=this;a.Http.fetch("GET",i.Http.GET_WIN_JAR_LOG,{game_id:t,currency:e},{cache:900,delay:500}).success(function(t){if(t){if(!n.isValid)return;n.historyListNode.removeAllChildren();for(var e=0;e<t.data.length;e+=1){var i=t.data[e],a=cc.instantiate(n.historyItemTemplateNode);a.getChildByName("1").getComponent(cc.Label).string=i.created_time,a.getChildByName("2").getComponent(cc.Label).string=i.username,a.getChildByName("3").getComponent(cc.Label).string=s.Number.abbreviate(i.extra_params.betting,3),a.getChildByName("4").getComponent(cc.Label).string=s.Number.format(i.amount),a.getChildByName("5").getComponent(cc.Label).string=i.type+" "+100*i.percent+"%",a.active=!0,n.historyListNode.addChild(a)}}})}}),cc._RFpop()},{NetworkManager:"NetworkManager",Url:"Url",Utils:"Utils"}],TaiXiuConstant:[function(t,e,n){"use strict";cc._RFpush(e,"9ac4egzr6RO9bsrOPuuKq0v","TaiXiuConstant");var i=t("Utils");e.exports={Action:{BETTING:1,CHANGE_STATE:5,UPDATE_POTS:9,PING:10},GameState:{NONE:0,EFFECT:1,PLAYER_BETTING:2,FINISH:4,FINALIZING:5},GameStateName:{BETTING:"Người chơi đặt cửa!",FINISH:"Tính tiền!"},Pot:{BIG:{ID:0,NAME:"Tài"},LITTLE:{ID:1,NAME:"Xỉu"},findById:function(t){return t=parseInt(t,10),i.Object.findObject(this,"ID",t)}},Event:{CHANGE_STATE:"in_game.tai_xiu.change_state",EFFECT_STATE:"in_game.tai_xiu.change_state.effect",PLAYER_BETTING_STATE:"in_game.tai_xiu.change_state.player_betting",UPDATE_POTS:"in_game.tai_xiu.update_pots",BETTING_SUCCESS:"in_game.tai_xiu.betting_success",UPDATE_TEMP_BETTING:"in_game.tai_xiu.update_temp_betting",FINISH:"in_game.tai_xiu.finish"},TimeoutId:{SWITCH_CURRENCY:"SWITCH_CURRENCY",ROTATE_DICE:"ROTATE_DICE",SHOW_HISTORY_TRAY:"SHOW_HISTORY_TRAY"}},cc._RFpop()},{Utils:"Utils"}],TaiXiuGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"4ca13QfmglIArJ0xJoN4weZ","TaiXiuGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("TaiXiuConstant"),r=t("NetworkManager"),c=t("Utils");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[s.Command.MESSAGE.ID],this.idleTime=-1,this.pingIntervalTime=-1,this.pingIntervalId=null,this.pingEnabled=!1,this.lastPingTime=-1,this.history=[],this._setGameState(o.GameState.NONE),this._reinitDataEachRound(),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BETTING,this.onBettingSuccess,this),this.eventDispatchers.playCmd.addEventListener(o.Action.UPDATE_POTS,this.onUpdatePots,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_STATE,this.onChangeState,this)},startGame:function(){this._reinitDataEachRound()},destroy:function(){this.$super.destroy.call(this),this._cancelPing()},_reinitDataEachRound:function(){this.bettingTimeLeft=0,this.pots={},this.current.bettingInfo={},this.current.tempBettingInfo={}},bet:function(t,e,n){this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.BETTING),pot:r.SmartFox.type["byte"](t),money:r.SmartFox.type["long"](e),currency:r.SmartFox.type.utfString(n)})},enablePing:function(){this.pingEnabled=!0,this._schedulePing()},disablePing:function(){this.pingEnabled=!1,this._cancelPing()},_isEagerToPing:function(){return this.lastPingTime<0||Date.now()-this.lastPingTime>=this.pingIntervalTime},_ping:function(){this.lastPingTime=Date.now(),this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.PING)})},_schedulePing:function(){!this.pingIntervalId&&this.pingIntervalTime>0&&this.pingEnabled&&(this.pingIntervalId=c.Scheduler.setInterval(this._ping.bind(this),this.pingIntervalTime,this._isEagerToPing()))},_cancelPing:function(){this.pingIntervalId&&(clearInterval(this.pingIntervalId),this.pingIntervalId=null)},onUpdateGame:function(t){this.idleTime=t.idleTime,this.idleTime>0&&(this.pingIntervalTime=this.idleTime/2.5,this._schedulePing()),t.potsList&&(this.pots=t.potsList),t.gameState===o.GameState.PLAYER_BETTING&&t.time>=0?this.bettingTimeLeft=Math.max(Date.now()+t.time-(t.__execInfo__&&t.__execInfo__.dt||0),0):t.gameState===o.GameState.FINISH&&t.time>=0&&(this.waitingForNewGameTimeLeft=Math.max(Date.now()+t.time-(t.__execInfo__&&t.__execInfo__.dt||0),0)),this._setGameState(t.gameState)},onBettingSuccess:function(t){this.isCurrentPlayer(t.username)&&(this.current.bettingInfo[t.currency]=this.current.bettingInfo[t.currency]||{},this.current.bettingInfo[t.currency][t.pot]=this.current.bettingInfo[t.currency][t.pot]||0,this.current.bettingInfo[t.currency][t.pot]+=t.money,this.eventDispatchers.local.dispatchEvent(o.Event.BETTING_SUCCESS))},onUpdatePots:function(t){this.bettingTimeLeft=Math.max(Date.now()+t.time-(t.__execInfo__&&t.__execInfo__.dt||0),0),cc.js.mixin(this.pots,t.potsList),this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_POTS)},onChangeState:function(t){switch(cc.js.mixin(this.pots,t.potsList),this._setGameState(t.gameState),this.gameState){case o.GameState.EFFECT:this.eventDispatchers.local.dispatchEvent(o.Event.EFFECT_STATE,t);break;case o.GameState.PLAYER_BETTING:this.bettingTimeLeft=Math.max(Date.now()+t.time-(t.__execInfo__&&t.__execInfo__.dt||0),0),this.eventDispatchers.local.dispatchEvent(o.Event.PLAYER_BETTING_STATE)}},onFinishGame:function(t){if(this._setGameState(o.GameState.FINISH),this.isCurrentPlayer(t.player)&&!c.Object.isEmpty(this.current.bettingInfo)){var e,n,i,a=t.potWin&&t.potWin[0];if(c.Type.isNumber(a))for(e in this.current.bettingInfo)n=this.current.bettingInfo[e],i={time:c.Date.currentTime(),potWin:a,potBettingMap:n,currency:e,moneyExchange:t.player[e].moneyExchange},this.history.unshift(i)}this.waitingForNewGameTimeLeft=Math.max(Date.now()+t.time-(t.__execInfo__&&t.__execInfo__.dt||0),0),this.eventDispatchers.local.dispatchEvent(o.Event.FINISH,t)},_setGameState:function(t){this.gameState!==t&&(this.gameState=t,this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_STATE))},addTempBetting:function(t,e,n){this.current.tempBettingInfo.pot===t&&this.current.tempBettingInfo.currency===n||(this.current.tempBettingInfo={pot:t,currency:n,betting:0}),this.current.tempBettingInfo.betting+=e,this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_TEMP_BETTING)},cancelTempBetting:function(){this.current.tempBettingInfo={},this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_TEMP_BETTING)},acceptTempBetting:function(){this.current.tempBettingInfo.currency&&this.current.tempBettingInfo.betting>0&&this.current.tempBettingInfo.pot>=0&&this.bet(this.current.tempBettingInfo.pot,this.current.tempBettingInfo.betting,this.current.tempBettingInfo.currency),this.current.tempBettingInfo={},this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_TEMP_BETTING)},getFormattedBettingTimeLeft:function(){return this._formatTime((this.bettingTimeLeft-Date.now())/1e3)},getFormattedWaitingForNewGameTimeLeft:function(){return this._formatTime((this.waitingForNewGameTimeLeft-Date.now())/1e3)},getFormattedCurrentTimeLeft:function(){var t="00:00";return this.gameState===o.GameState.PLAYER_BETTING?t=this.getFormattedBettingTimeLeft():this.gameState===o.GameState.FINISH&&(t=this.getFormattedWaitingForNewGameTimeLeft()),t},_formatTime:function(t){if(t>=0){t=Math.floor(t);var e=Math.floor(t/60),n=t%60;return c.Number.fillZero(e,2)+":"+c.Number.fillZero(n,2)}return"00:00"},getStateLabel:function(){var t="";return this.gameState===o.GameState.PLAYER_BETTING?t=o.GameStateName.BETTING:this.gameState===o.GameState.FINISH&&(t=o.GameStateName.FINISH),t}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",TaiXiuConstant:"TaiXiuConstant",Utils:"Utils"}],TamQuocGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"2cd7cPv2kdHRLILzBss22UR","TamQuocGameManager");var i,a=t("Utils"),s=t("Url"),o=t("AuthUser"),r=t("BaseGameManager"),c=t("SmartFoxConstant"),h=t("NetworkManager"),u=t("TayDuKyConstant"),l=t("CommonConstant");i=a.Class({$$extends:r,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[c.Command.MESSAGE.ID],this.gameState=u.GameState.NONE,this.itemsInfo=null,this.lstHistory=[],this.itemHistoryTmp=[],this.lastMoneyBet=0,this.lastPotWin=0,this.lastCurrency="",this.autoPlay=!1,this.eventDispatchers.anyCmd.addEventListener(c.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(u.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(u.Action.START_GAME,this.onStartGame,this),this.eventDispatchers.playCmd.addEventListener(u.Action.GET_ITEMS_INFO,this.onShowItemsInfo,this),this.eventDispatchers.globalCmd.addEventListener(c.Command.UPDATE_JAR.ID,this.onUpdateGameJar,this),this.historyDataKey="data_history_"+t.CONFIG.CMD+"_user_"+o.username;var n=cc.sys.localStorage.getItem(this.historyDataKey);void 0!==n&&null!==n&&(this.lstHistory=JSON.parse(n))},sendStartGame:function(t,e,n,i){this.send({command:h.SmartFox.type["byte"](c.Command.PLAY.ID),action:h.SmartFox.type["byte"](u.Action.START_GAME),betting:h.SmartFox.type["long"](e),pots:h.SmartFox.type.byteArray(n),currency:h.SmartFox.type.utfString(i)}),this.currency=l.CurrencyType.findByName(i).CHIP_NAME,this.autoPlay=t},getItemInfo:function(){this.send({command:h.SmartFox.type["byte"](c.Command.PLAY.ID),action:h.SmartFox.type["byte"](u.Action.GET_ITEMS_INFO)})},getTop:function(t){var e=this;h.Http.fetch("GET",s.Http.GET_WIN_JAR_LOG,{game_id:e.gameId,currency:t},{cache:900}).success(function(t){e.eventDispatchers.local.dispatchEvent(u.Event.GET_WIN_JAR_LOG,t)})},getJar:function(){var t=this;h.Http.fetch("GET",s.Http.GET_JAR,{game_id:t.gameId},{cache:900}).success(function(e){t.eventDispatchers.local.dispatchEvent(u.Event.GET_JAR_SUCCESS,e)})},onStartGame:function(t){this.moneyBet=t.pots.length*t.betting},onChangeStateGame:function(t){switch(this._setGameState(t.gameState),t.gameState){case u.GameState.EFFECT:this.eventDispatchers.local.dispatchEvent(u.Event.TURN_START,t.result);break;case u.GameState.NONE:this.eventDispatchers.local.dispatchEvent(u.Event.CLEAR_FINISH)}},onFinishGame:function(t){var e=[],n="",i=0,s="";e.push(a.Date.format(Date(),"hh:MM:ss")),this.autoPlay?e.push("TỰ QUAY"):e.push("QUAY");for(var o=0;o<t.awards.length;o+=1)switch(t.awards[o].awardType){case u.AwardType.MONEY:i+=t.awards[o].ratio;break;case u.AwardType.JAR:s=t.awards[o].ratio+"% Hũ"}e.push(a.Number.format(this.moneyBet)+" "+this.currency),e.push(a.Number.format(t.player.moneyExchange)+" "+this.currency),n=""!==s?"x"+i+" mức cược + "+s:"x"+i+" mức cược",e.push(n.substring(0,n.length)),this.lstHistory.unshift(e),this.lstHistory.length>100&&this.lstHistory.pop(),cc.sys.localStorage.setItem(this.historyDataKey,JSON.stringify(this.lstHistory)),this.eventDispatchers.local.dispatchEvent(u.Event.FINISH,t)},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(u.Event.UPDATE_JAR,t)},onShowItemsInfo:function(t){this.itemsInfo=t.itemsInfo,this.eventDispatchers.local.dispatchEvent(u.Event.SHOW_ITEMS_INFO,t)},_setGameState:function(t){this.gameState!==t&&(this.gameState=t)},destroy:function(){this.$super.destroy.call(this)}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",TayDuKyConstant:"TayDuKyConstant",Url:"Url",Utils:"Utils"}],TayDuKyConstant:[function(t,e,n){"use strict";cc._RFpush(e,"053917YNO9GBrLim2HkIoS+","TayDuKyConstant"),e.exports={GameState:{NONE:0,EFFECT:1,FINALIZING:5},Action:{START_GAME:0,CHANGE_STATE:5,UPDATE_MINI_POKER_JAR:6,GET_ITEMS_INFO:9},AwardType:{MONEY:"money",JAR:"jar"},Event:{TURN_START:"in_game.tayduky.turn_start",CLEAR_FINISH:"in_game.tayduky.clear_finish",FINISH:"in_game.tayduky.finish",GET_JAR_SUCCESS:"in_game.tayduky.get_jar",UPDATE_JAR:"in_game.tayduky.update_jar",SHOW_ITEMS_INFO:"in_game.tayduky.show_items_info",GET_WIN_JAR_LOG:"in_game.tayduky.get_win_jar_log"}},cc._RFpop()},{}],TayDuKyGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"7833dVIFjFJ06nOsSlSLKv7","TayDuKyGameManager");var i,a=t("Utils"),s=t("Url"),o=t("AuthUser"),r=t("BaseGameManager"),c=t("SmartFoxConstant"),h=t("NetworkManager"),u=t("TayDuKyConstant"),l=t("CommonConstant");i=a.Class({$$extends:r,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[c.Command.MESSAGE.ID],this.gameState=u.GameState.NONE,this.itemsInfo=null,this.lstHistory=[],this.itemHistoryTmp=[],this.lastMoneyBet=0,this.lastPotWin=0,this.lastCurrency="",this.autoPlay=!1,this.eventDispatchers.anyCmd.addEventListener(c.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(u.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(u.Action.START_GAME,this.onStartGame,this),this.eventDispatchers.playCmd.addEventListener(u.Action.GET_ITEMS_INFO,this.onShowItemsInfo,this),this.eventDispatchers.globalCmd.addEventListener(c.Command.UPDATE_JAR.ID,this.onUpdateGameJar,this),this.historyDataKey="data_history_"+t.CONFIG.CMD+"_user_"+o.username;var n=cc.sys.localStorage.getItem(this.historyDataKey);void 0!==n&&null!==n&&(this.lstHistory=JSON.parse(n))},sendStartGame:function(t,e,n,i){this.send({command:h.SmartFox.type["byte"](c.Command.PLAY.ID),action:h.SmartFox.type["byte"](u.Action.START_GAME),betting:h.SmartFox.type["long"](e),pots:h.SmartFox.type.byteArray(n),currency:h.SmartFox.type.utfString(i)}),this.currency=l.CurrencyType.findByName(i).CHIP_NAME,this.autoPlay=t},getItemInfo:function(){this.send({command:h.SmartFox.type["byte"](c.Command.PLAY.ID),action:h.SmartFox.type["byte"](u.Action.GET_ITEMS_INFO)})},getTop:function(t){var e=this;h.Http.fetch("GET",s.Http.GET_WIN_JAR_LOG,{game_id:e.gameId,currency:t},{cache:900}).success(function(t){e.eventDispatchers.local.dispatchEvent(u.Event.GET_WIN_JAR_LOG,t)})},getJar:function(){var t=this;h.Http.fetch("GET",s.Http.GET_JAR,{game_id:t.gameId},{cache:900}).success(function(e){t.eventDispatchers.local.dispatchEvent(u.Event.GET_JAR_SUCCESS,e)})},onStartGame:function(t){this.moneyBet=t.pots.length*t.betting},onChangeStateGame:function(t){switch(this._setGameState(t.gameState),t.gameState){case u.GameState.EFFECT:this.eventDispatchers.local.dispatchEvent(u.Event.TURN_START,t.result);break;case u.GameState.NONE:this.eventDispatchers.local.dispatchEvent(u.Event.CLEAR_FINISH)}},onFinishGame:function(t){var e=[],n="",i=0,s="";e.push(a.Date.format(Date(),"hh:MM:ss")),this.autoPlay?e.push("TỰ QUAY"):e.push("QUAY");for(var o=0;o<t.awards.length;o+=1)switch(t.awards[o].awardType){case u.AwardType.MONEY:i+=t.awards[o].ratio;break;case u.AwardType.JAR:s=t.awards[o].ratio+"% Hũ"}e.push(a.Number.format(this.moneyBet)+" "+this.currency),e.push(a.Number.format(t.player.moneyExchange)+" "+this.currency),n=""!==s?"x"+i+" mức cược + "+s:"x"+i+" mức cược",e.push(n.substring(0,n.length)),this.lstHistory.unshift(e),this.lstHistory.length>100&&this.lstHistory.pop(),cc.sys.localStorage.setItem(this.historyDataKey,JSON.stringify(this.lstHistory)),this.eventDispatchers.local.dispatchEvent(u.Event.FINISH,t)},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(u.Event.UPDATE_JAR,t)},onShowItemsInfo:function(t){this.itemsInfo=t.itemsInfo,this.eventDispatchers.local.dispatchEvent(u.Event.SHOW_ITEMS_INFO,t)},_setGameState:function(t){this.gameState!==t&&(this.gameState=t)},destroy:function(){this.$super.destroy.call(this)}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",TayDuKyConstant:"TayDuKyConstant",Url:"Url",Utils:"Utils"}],TextJumping:[function(t,e,n){"use strict";cc._RFpush(e,"84bb0mxymlO9Jxe2gipjtn+","TextJumping");var i=t("Utils");cc.Class({"extends":cc.Component,properties:{maxScale:1.5},onLoad:function(){this._initOnce()},updateText:function(t){this._initOnce();var e=this.label.string.replace(/\./g,"");this.current=parseInt(e),this.max=Math.floor(t);var n=this.max-this.current;this.step=n/50,n<100&&n>0?this.step=2:n>-100&&n<0&&(this.step=-2),0!==n?(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.25,this.maxScale),cc.scaleTo(.15,1)))):this.node.scale=1},update:function(){var t=this.max!==this.current&&0!==this.step;t&&(this.current+=this.step,this.step>0?this.current>this.max&&(this.current=this.max,this.step=0):this.step<0&&this.current<this.max&&(this.current=this.max,this.step=0),this.label.string=i.Number.format(Math.floor(this.current)))},_initOnce:function(){void 0===this.label&&(this.label=this.node.getComponent(cc.Label),this.step=0,this.max=0)},replaceAll:function(t,e,n){return t.replace(new RegExp(e,"g"),n)}}),cc._RFpop()},{Utils:"Utils"}],TinhNangManager:[function(t,e,n){"use strict";cc._RFpush(e,"3eb06XEuWZEOoZsHffrvkaY","TinhNangManager");var i=t("EventDispatcherConstant"),a=t("EventDispatcher"),s=t("CommonConstant"),o=t("Utils"),r={tn:[],ex_tn:["ni"],choPhep:function(t){var e=parseInt(t);return t=e>0?e:t,!(this.tn&&this.tn.indexOf(t)<0)&&!(this.ex_tn.indexOf(t)>=0)}};a.addEventListener(s.PushMessageType.TAT_TN.EVENT,function(t){if(t&&t.content){var e,n,s,c=JSON.parse(t.content);if(c&&c.tn){for(r.tn=[],e=0;e<c.tn.length;e+=2)n=c.tn.substr(e,2),s=parseInt(n),r.tn.push(s>0?s:n);r.tn.indexOf("hi")<0&&(o.Array.remove(r.tn,"ns"),o.Array.remove(r.tn,"nr"),o.Array.remove(r.tn,"ix")),a.dispatchEvent(i.TINH_NANG.NEW)}}}),e.exports=r,cc._RFpop()},{CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",Utils:"Utils"}],TinhNang:[function(t,e,n){"use strict";cc._RFpush(e,"1a236AwPxpFVKwaEuyA3M4Z","TinhNang");var i=t("TinhNangManager"),a=t("EventDispatcher"),s=t("EventDispatcherConstant"),o=cc.Class({name:"TinhNangNode",properties:{target:{"default":null,type:cc.Node},tinhNang:{"default":""}},init:function(){this.targetParent=this.target.parent,this.targetIndex=this.target.getSiblingIndex()},remove:function(){this.target.parent&&this.target.removeFromParent(!1)},add:function(){this.target.parent||(this.targetParent.addChild(this.target),this.target.setSiblingIndex(this.targetIndex))}});cc.Class({"extends":cc.Component,properties:{tinhNangNodes:{"default":[],type:o}},onLoad:function(){this.tinhNangNodes.forEach(function(t){t.init()}),this.kiemTraTinhNang(),a.addEventListener(s.TINH_NANG.NEW,this.kiemTraTinhNang,this)},onDestroy:function(){a.removeEventListener(s.TINH_NANG.NEW,this.kiemTraTinhNang,this)},kiemTraTinhNang:function(){this.tinhNangNodes.forEach(function(t){i.choPhep(t.tinhNang)?t.add():t.remove()})}}),cc._RFpop()},{EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",TinhNangManager:"TinhNangManager"}],ToggleButton:[function(t,e,n){"use strict";cc._RFpush(e,"7f9011RBSJDs5SWIvKKzV57","ToggleButton"),cc.Class({"extends":cc.Component,properties:{enableSprite:cc.SpriteFrame,disableSprite:cc.SpriteFrame,isEnable:!1,toggleEvents:{"default":[],type:cc.Component.EventHandler}},onLoad:function(){this.toogleNode=this.node.getChildByName("ToogleNode"),this.node.on(cc.Node.EventType.TOUCH_START,this.toggleState,this),this.updateState()},setEnable:function(){var t=this,e=(this.node.width-this.toogleNode.width)/2;this.isEnable=!0,this.toogleNode.runAction(cc.moveTo(.1,cc.p(e,0))),this.node.getComponent(cc.Sprite).spriteFrame=this.enableSprite,t.toggleEvents.forEach(function(e){e.emit([t])})},setDisable:function(){var t=this,e=(this.toogleNode.width-this.node.width)/2;this.isEnable=!1,this.toogleNode.runAction(cc.moveTo(.1,cc.p(e,0))),this.node.getComponent(cc.Sprite).spriteFrame=this.disableSprite,t.toggleEvents.forEach(function(e){e.emit([t])})},updateState:function(){this.isEnable?this.setEnable():this.setDisable()},toggleState:function(){this.isEnable?this.setDisable():this.setEnable()}}),cc._RFpop()},{}],ToggleCurrency:[function(t,e,n){"use strict";cc._RFpush(e,"01ae6xN/hFGwLO3WDtJy4VN","ToggleCurrency");var i=t("Utils"),a=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{currencySpriteFrames:{"default":[],type:cc.SpriteFrame},clickable:!0},onLoad:function(){this.index=0,this.switchTo(this.index)},switchTo:function(t){var e,n;if(i.Type.isNumber(t)){if(n=t,e=a.CurrencyType.findById(t),!e)return}else if(i.Type.isString(t)){if(e=a.CurrencyType.findByName(t),!e)return;n=e.ID}else{if(!i.Type.isObject(e))return;n=t.ID,e=e}var s=this.node.getComponent(cc.Sprite),o=this.node.getComponentInChildren(cc.Label);s&&this.index>=0&&this.index<this.currencySpriteFrames.length&&(this.index=n,s.spriteFrame=this.currencySpriteFrames[this.index],o.string=e.CHIP_NAME,o.node.color=e.CHIP_COLOR)},next:function(){this._incrIndex(),this.switchTo(this.index)},back:function(){this._incrIndex(),this.switchTo(this.index)},click:function(){this.clickable&&this.next()},_incrIndex:function(){this.index+=1,this.index>=this.currencySpriteFrames.length&&(this.index=0)},_decrIndex:function(){this.index-=1,this.index<=0&&(this.index=this.currencySpriteFrames.length-1)}}),cc._RFpop()},{CommonConstant:"CommonConstant",Utils:"Utils"}],TopPanelInGame:[function(t,e,n){"use strict";cc._RFpush(e,"af2a0JqofRONrQCT8xE88VK","TopPanelInGame");var i=t("NetworkManager"),a=t("BaseMainGameplay"),s=t("Utils"),o=t("AuthUser"),r=t("UiManager"),c=t("CommonConstant"),h=t("GameManagerConstant"),u={CHAT_CACHE:{KEY:"top_panel_in_game.chat",MAX_ITEMS:8,DEFAULT_MESSAGES:["Nhanh đi anh","Nghĩ gì mà lâu vậy?","Where are you now?","Câu giờ max level","Sao lâu vậy má?","Khi nào nghĩ xong thì phone em nha","Lót dép hóng","Lêu lêu"]}};cc.Class({"extends":cc.Component,properties:{bettingLabel:cc.Label,optionLabel:cc.Label,backdropNode:cc.Node,menuDropDownNode:cc.Node,toggleChatButton:cc.Button,chatHistoryLabel:cc.RichText,chatPanelNode:cc.Node,chatControlPanelNode:cc.Node,chatEditBox:cc.EditBox,chatScrollView:cc.ScrollView,quickChatNode:cc.Node,quickChatTemplateButtonNode:cc.Node,mainUsernameColor:cc.Color,normalUsernameColor:cc.Color,checkboxQuitGameNode:cc.Node,registerQuitGameNode:cc.Node},onLoad:function(){var t=this;t.chatPanelNode&&(t.chatEditBox.enabled=!1,t.chatPanelNode.opacity=0,t.chatPanelNode.active=!0),t.menuDropDownNode.opacity=0,t.menuDropDownNode.active=!0,t.backdropNode.active=!0,t._timeoutId=setTimeout(function(){t.isValid&&(t.menuDropDownNode.active=!1,t.menuDropDownNode.opacity=255,t.backdropNode.active=!1,t.chatPanelNode&&(t.chatControlPanelNodePosition=t.chatControlPanelNode.position,t.chatControlPanelNodeHidePosition=cc.v2(t.chatControlPanelNode.position.x,t.chatControlPanelNode.position.y-t.chatControlPanelNode.height),t.chatScrollViewPosition=t.chatScrollView.node.position,t.chatScrollViewHidePosition=cc.v2(t.chatScrollView.node.position.x,t.chatScrollView.node.position.y+t.chatScrollView.node.height),t.chatScrollView.node.getComponent(cc.Widget).enabled=!1,t.chatControlPanelNode.getComponent(cc.Widget).enabled=!1,t.chatPanelNode.active=!1,t.chatPanelNode.opacity=255,t.chatEditBox.enabled=!0))},500)},onDestroy:function(){this.gameManager&&(this.gameManager.eventDispatchers.local.removeEventListener(h.Event.UPDATE_REGISTER_QUIT_GAME_STATUS,this.onUpdateRegisterQuitGameStatus,this),this.gameManager.eventDispatchers.local.removeEventListener(h.Event.UPDATE_BETTING_VALUES,this.onUpdateBettingValues,this),i.SmartFox.offPublicMessage(this.onPublicMessage)),this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},init:function(t){if(!(t instanceof a.constructor))throw'sceneScript must be an instance of "BaseMainGameplay"';var e=this;this.sceneScript=t,this.gameRuntimeConfigs=this.sceneScript.gameRuntimeConfigs,this.gameManager=this.sceneScript.gameManager,this.game=this.gameRuntimeConfigs.game;var n=this.game&&this.game.CONFIG&&this.game.CONFIG.TOP_PANEL_IN_GAME;n&&(n.CHAT||(this.toggleChatButton.node.active=!1,this.toggleChatButton=null,this.chatPanelNode.active=!1,this.chatPanelNode=null),n.REGISTER_QUIT_GAME||(this.registerQuitGameNode.active=!1,this.registerQuitGameNode=null)),this.chatHistoryLabel.string="",this._createAllQuickChatButtonsFromCache(),this.setBettingLabel(""),this.setOptionLabel(""),this.toggleChatButton&&(this.onPublicMessage=function(t){var e,n,i=t&&t.room&&t.room.id,a=t&&t.sender&&t.sender.name,s=a;this.gameManager&&this.gameManager.roomId===i&&a&&(n=this.sceneScript.findPlayerNodeByName(a),e=t.message,n&&(s=n.player&&n.player.data&&n.player.data.displayName||s,n.setChatMessage(e)),this._addHistoryItem(s,e))}.bind(this),i.SmartFox.onPublicMessage(this.onPublicMessage)),this.checkboxQuitGameNode&&this.gameManager.eventDispatchers.local.addEventListener(h.Event.UPDATE_REGISTER_QUIT_GAME_STATUS,this.onUpdateRegisterQuitGameStatus,this),this.gameManager.eventDispatchers.local.addEventListener(h.Event.UPDATE_BETTING_VALUES,this.onUpdateBettingValues,this),s.EventManager.onKeyReleased(cc.KEY.enter,this.chatEditBox.node,function(){e.sendChatMessage()}),this.onUpdateBettingValues(),this.onUpdateOption()},openPopupNapXien:function(){r.openNapXienModal()},openSettings:function(){this.hideMenu(),r.openPopupSettings()},openHelp:function(){this.hideMenu(),this.gameManager.openHelpModal()},openChatPanel:function(){var t=this;t.chatScrollViewPosition&&(t.chatScrollView.node.stopAllActions(),t.chatControlPanelNode.stopAllActions(),t.chatScrollView.node.position=t.chatScrollViewHidePosition,t.chatControlPanelNode.position=t.chatControlPanelNodeHidePosition,this.chatPanelNode.active=!0,t.chatScrollView.node.runAction(cc.sequence(cc.moveTo(.2,t.chatScrollViewPosition).easing(cc.easeIn(3)))),t.chatControlPanelNode.runAction(cc.sequence(cc.moveTo(.2,t.chatControlPanelNodePosition).easing(cc.easeIn(3)))))},closeChatPanel:function(){var t=this;t.chatScrollViewPosition&&(t.chatScrollView.node.stopAllActions(),t.chatControlPanelNode.stopAllActions(),t.chatScrollView.node.position=t.chatScrollViewPosition,t.chatScrollView.node.runAction(cc.sequence(cc.moveTo(.2,t.chatScrollViewHidePosition).easing(cc.easeIn(3)))),t.chatControlPanelNode.position=t.chatControlPanelNodePosition,t.chatControlPanelNode.runAction(cc.sequence(cc.moveTo(.2,t.chatControlPanelNodeHidePosition).easing(cc.easeIn(3)),cc.callFunc(function(){t.chatPanelNode.active=!1}))))},toggleMenu:function(){this.menuDropDownNode.active=!this.menuDropDownNode.active,this.backdropNode.active=this.menuDropDownNode.active},hideMenu:function(){this.menuDropDownNode.active=!1,this.backdropNode.active=!1},openLeaveRoomConfirmModal:function(){this.hideMenu(),r.openConfirmModal("Khi thoát khỏi phòng, bạn sẽ bị tính như thua cuộc và bị trừ tiền. Bạn có chắc vẫn muốn thoát không?",{oke_fn:function(){this.gameManager.leaveRoom()}.bind(this)})},toggleRegisterQuitGame:function(){var t=this.gameManager.current.player;t&&(t.data.isRegisteredToQuitGame?this.gameManager.deregisterQuitGame():this.gameManager.registerQuitGame()),this.hideMenu()},onUpdateRegisterQuitGameStatus:function(){var t=this.gameManager.current.player;t&&(this.checkboxQuitGameNode.active=t.data.isRegisteredToQuitGame)},onUpdateBettingValues:function(){if(this.gameManager.bettingInfo.currency){var t=this.gameRuntimeConfigs&&this.gameRuntimeConfigs.game&&this.gameRuntimeConfigs.game.CONFIG&&this.gameRuntimeConfigs.game.CONFIG.NAME,e=(t||"Mức cược")+": ";this.setBettingLabel(e+s.Number.abbreviate(this.gameManager.bettingInfo.betting)+" "+c.CurrencyType.findByName(this.gameManager.bettingInfo.currency).DISPLAY_NAME)}},onUpdateOption:function(){if(this.sceneScript){var t=this.sceneScript.topPanelInGameData;if(t){var e=t.optionLabel||"";this.setOptionLabel(e)}}},setBettingLabel:function(t){this.bettingLabel.string=t},setOptionLabel:function(t){this.optionLabel.string=t},sendChatMessage:function(){var t=this.chatEditBox.string;this.chatEditBox.string="",this._sendChatMessage(t)},_sendChatMessage:function(t){this.closeChatPanel(),t&&(this.gameManager.sendChatMessage(t),this._saveNewMessage(t))},_addHistoryItem:function(t,e){var n=this.chatHistoryLabel.string?"\n":"",i="";i=t===o.username?n+"<color=#FFDE00>"+t+":</color> "+e:n+"<color=#02bbff>"+t+":</color> "+e,this.chatHistoryLabel.string+=i,this.chatHistoryLabel.node.height<this.chatScrollView.node.height-12?this.chatScrollView.scrollToTop():this.chatScrollView.scrollToBottom()},_createQuickChatButton:function(t){var e=cc.instantiate(this.quickChatTemplateButtonNode);return e.getComponentInChildren(cc.Label).string=t,e.on(cc.Node.EventType.TOUCH_END,function(e){e.stopPropagation(),this._sendChatMessage(t)},this),e},_createAllQuickChatButtons:function(t){var e;for(this.quickChatNode.removeAllChildren(),e=0;e<t.length;e+=1)this.quickChatNode.addChild(this._createQuickChatButton(t[e]))},_createAllQuickChatButtonsFromCache:function(){var t=this._getCacheMessages();this._createAllQuickChatButtons(t)},_saveNewMessage:function(t){var e=this._getCacheMessages();e.unshift(t),e=this._truncateAndSaveCacheMessages(e),this._createAllQuickChatButtons(e)},_getCacheMessages:function(){var t,e,n=cc.sys.localStorage.getItem(u.CHAT_CACHE.KEY);try{n=n?JSON.parse(n):[],n.length>u.CHAT_CACHE.MAX_ITEMS&&(n=this._truncateAndSaveCacheMessages(n))}catch(i){n=[]}if(t=u.CHAT_CACHE.MAX_ITEMS-n.length){for(e=0;e<t;e+=1)n.unshift(u.CHAT_CACHE.DEFAULT_MESSAGES[e]);n=this._truncateAndSaveCacheMessages(n)}return n},_truncateAndSaveCacheMessages:function(t){return t=s.Array.unique(t),s.Array.trimRight(t,u.CHAT_CACHE.MAX_ITEMS),cc.sys.localStorage.setItem(u.CHAT_CACHE.KEY,JSON.stringify(t)),t}}),cc._RFpop()},{AuthUser:"AuthUser",BaseMainGameplay:"BaseMainGameplay",CommonConstant:"CommonConstant",GameManagerConstant:"GameManagerConstant",NetworkManager:"NetworkManager",UiManager:"UiManager",Utils:"Utils"}],TopPanelOutGameWrapper:[function(t,e,n){"use strict";cc._RFpush(e,"f51a5sD8CRM4r/97RWKCEoz","TopPanelOutGameWrapper"),cc.Class({"extends":cc.Component,properties:{topPanelOutGamePlaceHolder:cc.Node},onLoad:function(){var t=this;cc.loader.loadRes("TopPanelOutGame",function(e,n){var i=cc.instantiate(n);t.node.addChild(i),t.topPanelOutGamePlaceHolder&&i.setSiblingIndex(t.topPanelOutGamePlaceHolder.getSiblingIndex())})}}),cc._RFpop()},{}],TopPanelOutGame:[function(t,e,n){"use strict";cc._RFpush(e,"59354R5YL9D+LvDhtClRnLf","TopPanelOutGame");var i=t("Utils"),a=t("UrlImage"),s=t("AuthUser"),o=t("UiManager"),r=t("GameManager"),c=t("CommonConstant"),h=t("EventDispatcher"),u=t("EventDispatcherConstant");cc.Class({"extends":cc.Component,properties:{usernameLabel:cc.Label,ipLabelList:{"default":[],type:cc.Label},xuLabelList:{"default":[],type:cc.Label},expLabel:cc.Label,vipLabel:cc.Label,userAvatar:a,eventCountNode:cc.Node,messageCountNode:cc.Node,effectAvatar:cc.Prefab},onLoad:function(){
if(this.usernameLabel.string=s.username,this.userAvatar.loadImage(s.avatar),this.updateUserMoney(),this.updateUserExp(),this.updateUserVip(),this.updateEventCount(),this.updateMessageCount(),this.effectAvatar){var t=cc.instantiate(this.effectAvatar);t.position=cc.v2(0,0),this.userAvatar.node.parent.parent.addChild(t)}h.addEventListener(u.PROFILE.UPDATE_MONEY,this.updateUserMoney,this),h.addEventListener(u.PROFILE.UPDATE_EXP,this.updateUserExp,this),h.addEventListener(u.PROFILE.UPDATE_UNREAD_MESS_COUNT,this.updateMessageCount,this)},onDestroy:function(){h.removeEventListener(u.PROFILE.UPDATE_MONEY,this.updateUserMoney,this),h.removeEventListener(u.PROFILE.UPDATE_EXP,this.updateUserExp,this),h.removeEventListener(u.PROFILE.UPDATE_UNREAD_MESS_COUNT,this.updateMessageCount,this)},openProfile:function(){var t=r.getLobbyGameRuntimeConfigs();t&&(t.isSuspending=!0),i.Director.loadScene(c.Scene.PROFILE)},openMessageBox:function(){o.openPopupMessageBox()},openEvent:function(){o.openPopupEvent(),s.event_count=0,this.updateEventCount()},openNapXien:function(){o.openNapXienModal()},updateEventCount:function(){var t=this.eventCountNode.getComponentInChildren(cc.Label);s.event_count>0?(this.eventCountNode.active=!0,t.string=s.event_count):(this.eventCountNode.active=!1,t.string="")},updateMessageCount:function(){var t=this.messageCountNode.getComponentInChildren(cc.Label);s.unread_mess_count>0?(this.messageCountNode.active=!0,t.string=s.unread_mess_count):(this.messageCountNode.active=!1,t.string="")},updateUserMoney:function(){this.xuLabelList.forEach(function(t){t.string=s.currencies[c.CurrencyType.Xu.NAME].balance,t.string=i.Number.format(t.string)}),this.ipLabelList.forEach(function(t){t.string=s.currencies[c.CurrencyType.Ip.NAME].balance,t.string=i.Number.format(t.string)})},updateUserExp:function(){this.expLabel.string=s.experience,this.expLabel.string=i.Number.format(this.expLabel.string)},updateUserVip:function(){this.vipLabel.string=s.vip_level||0,this.vipLabel.string=i.Number.format(this.vipLabel.string)}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher",EventDispatcherConstant:"EventDispatcherConstant",GameManager:"GameManager",UiManager:"UiManager",UrlImage:"UrlImage",Utils:"Utils"}],TopPanelSlot:[function(t,e,n){"use strict";cc._RFpush(e,"96eecl2jFdDBYNDMaJaTmXX","TopPanelSlot");var i=t("TextJumping"),a=t("Utils"),s=t("AuthUser"),o=t("AudioManager"),r=t("GameConstant"),c=t("MyNhanConstant"),h=t("HaiTacConstant"),u=t("HoaQuaConstant"),l=t("UiManager"),d=t("GameManager"),s=t("AuthUser"),m=t("CommonConstant"),p=t("NetworkManager"),g=t("BaseGameOptionModal"),c=t("MyNhanConstant");cc.Class({"extends":cc.Component,properties:{txtMoneyHoaHau:cc.Label,txtMoneyHotgirl:cc.Label,txtMoneyRauSach:cc.Label,txtUserName:cc.Label,menuNode:cc.Node},onLoad:function(){this.txtUserName&&(this.txtUserName.string=s.username)},onMenuClick:function(){this.menuNode.getComponent("MenuSlot").show(),this.gamePlay&&this.gamePlay.audioManager&&this.gamePlay.audioManager.playButtonClick()},onCloseClick:function(){this.menuNode.active=!1,this.gamePlay&&this.gamePlay.audioManager&&this.gamePlay.audioManager.playButtonClick(),this.gamePlay.gameManager.gameState===c.GameState.ROTATE?this.openConfirmModal("Khi thoát khỏi phòng, bạn sẽ bị tính như thua cuộc và bị trừ tiền. Bạn có chắc vẫn muốn thoát không?",{oke_fn:function(){this.gamePlay.gameManager.leaveRoom()}.bind(this)}):this.gamePlay.gameManager.leaveRoom()},openConfirmModal:function(t,e){if(t){var n="ConfirmModalSlot2",i=this.gamePlay.gameCmd;i===r.MY_NHAN.CMD&&(n="ConfirmModalSlot"),e=e||{},cc.loader.loadRes(n,function(n,i){var a=cc.instantiate(i);a.zIndex=m.ZINDEX.MODAL;var s=a.getComponent("Modal"),o=a.getComponent("ConfirmModal");s.content.string=t,e.oke_fn&&(o.okeCallback=e.oke_fn),e.cancel_fn&&(o.cancelCallback=e.cancel_fn),e.isPersistent?cc.game.addPersistRootNode(a):cc.director.getScene().addChild(a)})}},onBackClick:function(){p.SmartFox.leaveRoom(this.room.id),a.Director.loadScene(m.Scene.HALL)},onTryPlayClick:function(){c.GameType.type=-1,h.GameType.type=-1,u.GameType.type=-1,o.instance.playButtonClick();var t=d.getLobbyGameRuntimeConfigs();if(t&&(t.isSuspending=!1,this.game=t.game,this.game)){var e=this.game.CONFIG.GAME_OPTION_MODAL_PREFAB,n=this.game.gameId,i={currency:p.SmartFox.type.utfString(m.CurrencyType.Xu.NAME),isSolo:p.SmartFox.type.bool(this.game.isSolo),betting:p.SmartFox.type["long"](c.BettingFreeList[0])};e?l.openModalByName(e,function(t){t.getComponent(g).init(n,i,function(){})}):d.enterGame(n,i)}},getButtonHistory:function(){return this.menuNode.getComponent("MenuSlot").btnLichSu},setGamePlay:function(t){this.gamePlay=t,this.menuNode.getComponent("MenuSlot").gamePlay=t},setMoney:function(t,e){switch(t){case 0:this.txtMoneyRauSach.node.getComponent(i).updateText(e);break;case 1:this.txtMoneyHotgirl.node.getComponent(i).updateText(e);break;case 2:this.txtMoneyHoaHau.node.getComponent(i).updateText(e)}}}),cc._RFpop()},{AudioManager:"AudioManager",AuthUser:"AuthUser",BaseGameOptionModal:"BaseGameOptionModal",CommonConstant:"CommonConstant",GameConstant:"GameConstant",GameManager:"GameManager",HaiTacConstant:"HaiTacConstant",HoaQuaConstant:"HoaQuaConstant",MyNhanConstant:"MyNhanConstant",NetworkManager:"NetworkManager",TextJumping:"TextJumping",UiManager:"UiManager",Utils:"Utils"}],TopTableMiniPoker:[function(t,e,n){"use strict";cc._RFpush(e,"2c3f9yJLTNPSpssygWG9ufV","TopTableMiniPoker");var i=t("Utils"),a=t("Url"),s=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{itemPrefab:{"default":null,type:cc.Prefab},contentItem:{"default":null,type:cc.Node}},onLoad:function(){var t=this;s.Http.fetch("GET",a.Http.MINI_POKER_GET_TOP,{},{cache:900,delay:500}).success(function(e){if(e){if(!t.isValid)return;t.contentItem.removeAllChildren();for(var n=0;n<e.data.length;n+=1){var a=e.data[n],s=cc.instantiate(t.itemPrefab);s.getChildByName("1").getComponent(cc.Label).string=a.created_time,s.getChildByName("2").getComponent(cc.Label).string=a.username,s.getChildByName("3").getComponent(cc.Label).string=i.Number.format(a.bet),s.getChildByName("4").getComponent(cc.Label).string=i.Number.format(a.win_amount),s.getChildByName("5").getComponent(cc.Label).string=a.win_type,s.enabled=!0,t.contentItem.addChild(s)}}})}}),cc._RFpop()},{NetworkManager:"NetworkManager",Url:"Url",Utils:"Utils"}],TopTableTaiXiu:[function(t,e,n){"use strict";cc._RFpush(e,"edf54l7Q+NKrqjKAe2CgX5s","TopTableTaiXiu");var i=t("Url"),a=t("Utils"),s=t("CommonConstant"),o=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{itemPrefab:cc.Prefab,contentTopWin:cc.Node,contentTopLose:cc.Node,topWinScrollview:cc.ScrollView,topLostScrollview:cc.ScrollView,lblTime:cc.Label},onLoad:function(){},getData:function(t,e){this.currency=t,this.currentTime=e,this.reset();var n=this;this.lblTime.string="Ngày "+a.Date.format(this.currentTime,"dd/mm/yyyy");var r=t===s.CurrencyType.Ip.NAME;o.Http.fetch("GET",i.Http.TAI_XIU_GET_DAILY_TOP,{date:a.Date.format(this.currentTime,"yyyy-mm-dd")},{cache:900,delay:500}).success(function(t){if(n.isValid&&(n.reset(),t)){var e,i=t.data[r?s.CurrencyType.Ip.NAME:s.CurrencyType.Xu.NAME];if(!i)return;var a,o,c=i.top_win_users,h=i.top_lost_users;for(e=0;e<c.length;e+=1)a=cc.instantiate(n.itemPrefab),o=a.getComponentsInChildren(cc.Label),o[0].string=e+1,o[1].string=c[e].username,o[2].string=c[e].max_consecutive_win,n.contentTopWin.addChild(a);for(e=0;e<h.length;e+=1)a=cc.instantiate(n.itemPrefab),o=a.getComponentsInChildren(cc.Label),o[0].string=e+1,o[1].string=h[e].username,o[2].string=h[e].max_consecutive_lost,n.contentTopLose.addChild(a)}})},reset:function(){this.contentTopWin.removeAllChildren(),this.topWinScrollview.scrollToTop(),this.contentTopLose.removeAllChildren(),this.topLostScrollview.scrollToTop()},onClickLeft:function(){this.currentTime=this.currentTime-864e5,this.getData(this.currency,this.currentTime)},onClickRight:function(){this.currentTime=this.currentTime+864e5,this.getData(this.currency,this.currentTime)}}),cc._RFpop()},{CommonConstant:"CommonConstant",NetworkManager:"NetworkManager",Url:"Url",Utils:"Utils"}],TopUserTayDuKy:[function(t,e,n){"use strict";cc._RFpush(e,"a7fa6l5OqdDPbr9m0HBmbh6","TopUserTayDuKy");var i=t("Utils"),a=t("Url"),s=t("CommonConstant"),o=t("ToggleCurrency"),r=t("NetworkManager");cc.Class({"extends":cc.Component,properties:{itemPrefab:{"default":null,type:cc.Prefab},contentItemPi:{"default":null,type:cc.Node},contentItemXu:{"default":null,type:cc.Node},scrollView:cc.ScrollView,btnCurrency:cc.Node,gameid:0},onLoad:function(){},getWinJarLog:function(t,e,n,s){var o=this;r.Http.fetch("GET",a.Http.GET_WIN_JAR_LOG,{game_id:t,currency:e},{cache:900,delay:500}).success(function(t){if(t){if(!o.isValid)return;n.removeAllChildren();for(var e=0;e<t.data.length;e+=1){s=t.data[e];var a=cc.instantiate(o.itemPrefab);a.getChildByName("1").getComponent(cc.Label).string=s.created_time,a.getChildByName("2").getComponent(cc.Label).string=s.username,a.getChildByName("3").getComponent(cc.Label).string=i.Number.abbreviate(s.extra_params.betting,3),a.getChildByName("4").getComponent(cc.Label).string=i.Number.format(s.amount),a.getChildByName("5").getComponent(cc.Label).string=s.type+" "+100*s.percent+"%",a.enabled=!0,n.addChild(a)}}})},onCurrencyClick:function(){this.btnCurrency.getComponent("ToggleCurrency").click(),this.currencyIndex=this.btnCurrency.getComponent(o).index,0===this.currencyIndex?(this.contentItemPi.active=!0,this.contentItemXu.active=!1,this.historyDataPi||this.getWinJarLog(this.gameid,s.CurrencyType.Ip.NAME,this.contentItemPi,this.historyDataPi),this.scrollView.content=this.contentItemPi):(this.contentItemPi.active=!1,this.contentItemXu.active=!0,this.historyDataXu||this.getWinJarLog(this.gameid,s.CurrencyType.Xu.NAME,this.contentItemXu,this.historyDataXu),this.scrollView.content=this.contentItemXu)}}),cc._RFpop()},{CommonConstant:"CommonConstant",NetworkManager:"NetworkManager",ToggleCurrency:"ToggleCurrency",Url:"Url",Utils:"Utils"}],TopUsers:[function(t,e,n){"use strict";cc._RFpush(e,"9b1a2zeJgxO/JXs/XIocpg7","TopUsers");var i=t("NetworkManager"),a=t("TabView"),s=t("Url");cc.Class({"extends":cc.Component,properties:{topTabView:a,itemTopPrefab:cc.Prefab,tabTopPrefab:cc.Prefab,contentTopPrefab:cc.Prefab,subTabTopPrefab:cc.Prefab,subContentTopPrefab:cc.Prefab},onLoad:function(){var t=this;i.Http.fetch("GET",s.Http.TOP_TYPES,{},{cache:900}).success(function(e){var n=e.data;t.topTabView.removeAllTabs();for(var i=0;i<n.length;i+=1)t._initTopTabView(n[i],!i)})},_initTopTabView:function(t,e){var n,i=this,s=new cc.Component.EventHandler,o=cc.instantiate(this.tabTopPrefab),r=cc.instantiate(this.contentTopPrefab);o.getComponentInChildren(cc.Label).string=t.name,o.getComponentInChildren("UrlImage").loadImage(t.icon),n=r.getComponent(a),t.sub_types.forEach(function(t){i._initSubTopTabView(n,t)}),s.target=this.node,s.component="TopUsers",s.handler="getTopUsers",n.selectEvents.push(s),e||(r.active=!1),this.topTabView.addTab(o,r),e&&this.topTabView.activeByName(o.name)},_initSubTopTabView:function(t,e){var n=cc.instantiate(this.subTabTopPrefab),i=cc.instantiate(this.subContentTopPrefab);n.getComponentInChildren(cc.Label).string=e.name,i.topData=e,t.addTab(n,i)},getTopUsers:function(t,e){var n=this,a=e.getComponent(cc.ScrollView).content;i.Http.fetch("GET",e.topData.url,{},{cache:900,delay:500}).success(function(t){var e,i,s=t.data;a.removeAllChildren();for(var o=0;o<s.length;o+=1)e=cc.instantiate(n.itemTopPrefab),i=e.getComponent("ItemTopUser"),i.updateData(o+1,s[o]),a.addChild(e)})}}),cc._RFpop()},{NetworkManager:"NetworkManager",TabView:"TabView",Url:"Url"}],UiManager:[function(t,e,n){"use strict";cc._RFpush(e,"3887abLoURCv5UL5XoPD5LA","UiManager");var i,a=t("EventDispatcher"),s=t("CommonConstant"),o=t("AuthUser"),r=t("AudioManager");i={_CONFIRM_MODALS:{},openModal:function(t,e){t&&cc.loader.loadRes("Modal",function(n,i){var a=cc.instantiate(i);a.zIndex=s.ZINDEX.MODAL;var o=a.getComponent("Modal");o.content.string=t,cc.game.addPersistRootNode(a),e=e||{},e.close_fn&&(o.closeCallback=e.close_fn)})},openConfirmModal:function(t,e){if(t){e=e||{};var n=this._CONFIRM_MODALS&&this._CONFIRM_MODALS[t],i=this;if(n&&n.isValid)return;i._CONFIRM_MODALS[t]={isValid:!0},cc.loader.loadRes("ConfirmModal",function(n,a){var o=cc.instantiate(a);o.zIndex=s.ZINDEX.MODAL;var r=o.getComponent("Modal"),c=o.getComponent("ConfirmModal");r.content.string=t,e.oke_fn&&(c.okeCallback=e.oke_fn),e.cancel_fn&&(c.cancelCallback=e.cancel_fn),e.isPersistent?cc.game.addPersistRootNode(o):cc.director.getScene().addChild(o),i._CONFIRM_MODALS[t]=o})}},openModalByName:function(t,e,n){var i=this,a=this._generateModalName(t),s=this[a];if(s&&s.isValid){if(e)try{e(s)}catch(o){}}else this[a]={isValid:!0},cc.loader.loadRes(t,function(t,s){var o=cc.instantiate(s);if(n=n||{},n.isPersistent?cc.game.addPersistRootNode(o):cc.director.getScene().addChild(o),i[a]=o,e)try{e(o)}catch(r){}})},destroyModalByName:function(t){var e=this._generateModalName(t),n=this[e];n&&n.destroy(),delete this[e]},openWebView:function(t,e,n){this.openModalByName("WebView",function(i){var a="username="+o.username+"&accesstoken="+o.accesstoken;if(t+=(t.indexOf("?")>0?"&":"?")+a,i.getComponentInChildren(cc.WebView).url=t,i.getComponentInChildren(cc.Label).string=e||"WebView",n)try{n()}catch(s){}})},openNapXienModal:function(){this.openModalByName("NapXien")},openTopUsersModal:function(){this.openModalByName("TopUsers")},openPopupMessageBox:function(){this.openModalByName("MessageBox")},openPopupDoiThuong:function(){this.openModalByName("DoiThuong")},openPopupEvent:function(t){this.openModalByName("Event",function(e){e.getComponent("Event").openEventId=t})},openPopupHotEvent:function(){this.openModalByName("HotEvent",{isPersistent:!0})},openPopupDaiLy:function(){this.openModalByName("DaiLy")},openPopupKiemXu:function(){this.openModalByName("KiemXu")},openPopupSettings:function(){this.openModalByName("Settings")},openHelpModal:function(t,e){t&&(e=e||{},cc.loader.loadRes("HelpModal",function(n,i){var a=cc.instantiate(i);setTimeout(function(){var e=a.getComponent("Modal"),n=a.getComponentInChildren(cc.ScrollView);n&&n.scrollToTop(),e.content.string=t},e.delay||0),cc.director.getScene().addChild(a)}))},openWarningMessage:function(){function t(t,i,a){if(n||(n=!0,cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH,function(){if(e){var t=e.getComponent("WarningMessage");t.closeImmediately()}})),e){var s=e.getComponent("WarningMessage"),o=cc.director.getScene();s.open(t,i,a),e.isChildOf(o)||o.addChild(e),r.instance.playError()}}var e,n=!1;return function(n,i,a){n&&(e?t(n,i,a):cc.loader.loadRes("WarningMessage",function(s,o){e||(e=cc.instantiate(o),cc.game.addPersistRootNode(e)),t(n,i,a)}))}}(),_generateModalName:function(t){return"$_modal_"+t}},a.addEventListener(s.PushMessageType.POPUP.EVENT,function(t){i.openModal(t&&t.content)}),e.exports=i,cc._RFpop()},{AudioManager:"AudioManager",AuthUser:"AuthUser",CommonConstant:"CommonConstant",EventDispatcher:"EventDispatcher"}],UrlImage:[function(t,e,n){"use strict";cc._RFpush(e,"f4b5avmip5A0LpfsyMb9/0s","UrlImage"),cc.Class({"extends":cc.Component,properties:{url:null},onLoad:function(){this.url&&this.loadImage(this.url)},loadImage:function(t){var e=this;cc.loader.load({id:t,type:"png"},function(t,n){if(t)cc.error(t);else if(e.node){var i=e.node.getComponent(cc.Sprite);i.spriteFrame=new cc.SpriteFrame(n),e.node.runAction(cc.fadeIn(.5))}})}}),cc._RFpop()},{}],Url:[function(t,e,n){"use strict";cc._RFpush(e,"42ba75zMcpO0525HerN/QUv","Url"),e.exports={Http:{RT_SV_IP:"/gamecore/v1/game_rt_server_ip",CHECK_VER:"/gamecore/v1/check_ver",GAME_ACCOUNT:"/gamecore/v1/account",TIN_NHAN_TYPES:"/gamecore/v1/pm/kieu_tn",THE_CAO_TYPES:"/gamecore/v1/pm/kieusc",NAP_THE_CAO:"/gamecore/v1/pm/scrc",IAP_TYPES:"/gamecore/v1/payment/iap/products",TOP_TYPES:"/gamecore/v1/top/types",USER_LOGIN:"/user/v1/login",USER_CHANGE_PASSWORD:"/user/v1/change_pass",USER_UPDATE_INFO:"/user/v1/update_info",USER_UPDATE_AVATAR:"/user/v1/upload_avatar",USER_ACTIVE_PHONE:"/user/v1/active_mobile_syntax",USER_ACTIVE_EMAIL:"/user/v1/active_email",BANNER:"/gcore/v1/vb/banner",GAME_HELP:"/gcore/v1/vb/help_game",FEEDBACK:"/gcore/v1/vb/feedback",CONTACT_INFO:"/gcore/v1/vb/contact_info",MESSAGE_BOX:"/gamecore/v1/account/msg",DETAIL_MESSAGE_BOX:"/gamecore/v1/account/msg/",DOI_THUONG_GET_CARD_INFO:"/gamecore/v1/doithe/cards_info",DOI_THUONG_GET_CARD:"/gamecore/v1/doithe/get_card",DOI_THUONG_GET_ITEMS_INFO:"/gamecore/v1/doithe/items_info",DOI_THUONG_CARDS_HISTORY:"/gamecore/v1/doithe/user_bill_list",MINI_POKER_GET_JAR:"/gamecore/v1/mini_poker/jar",MINI_POKER_GET_TOP:"/gamecore/v1/mini_poker/top",GET_JAR:"/gamecore/v1/game_jar",GET_GAME_JAR_INFO:"/gamecore/v1/game_jars_info",CHICKENJAR:"/gamecore/v1/chicken_fund/jar",CHICKEN_CODE:"/gamecore/v1/chicken_fund/codelist",TAYDUKY_GET_JAR:"/gamecore/v1/tayduky/jar",GET_WIN_JAR_LOG:"/gamecore/v1/win_jar_logs",TAI_XIU_GET_DAILY_TOP:"/gamecore/v1/tai_xiu/daily_top",TRANSFER:"/gamecore/v1/transfer",TRANSFER_LOG:"/gamecore/v1/transfer_log",MONEY_EX:"/gamecore/v1/money/exchange",EVENT_LIST:"/gamecore/v1/event_list",DAILY_LIST:"/gamecore/v1/transfer_partner/list",INVITE_CODE:"/gamecore/v1/friend/invitecode",GIFT_CODE:"/gamecore/v1/giftcode",SHARE_FACEBOOK:"/gamecore/v1/facebook/share",INVITE_FACEBOOK:"/gamecore/v1/friend/invitefb",XOSO_BET:"/gamecore/v1/xoso/bet",XOSO_TYPES:"/gamecore/v1/xoso/types",XOSO_RESULT:"/gamecore/v1/xoso/result",XOSO_BET_LIST:"/gamecore/v1/xoso/bet_list",XOSO_USER_BET_LIST:"/gamecore/v1/xoso/user_bet_list",TOP_WIN_GAME:"/gamecore/v1/top/win_game"}},cc._RFpop()},{}],Utils:[function(t,e,n){"use strict";cc._RFpush(e,"81e08iMOOdNnJkrQb09toT+","Utils");var i={String:{CaseType:cc.Enum({NONE:0,UPPER:1,LOWER:2,CAMEL:3}),changeCase:function(t,e){switch(e){case this.CaseType.NONE:return t;case this.CaseType.UPPER:return t.toUpperCase();case this.CaseType.LOWER:return t.toLowerCase();case this.CaseType.CAMEL:return t.substr(0,1).toUpperCase()+t.substr(1).toLowerCase()}},param:function(t){var e=[],n=/\[\]$/,i=function(t){return Array.isArray(t)},a=function(t,n){n="function"==typeof n?n():null===n?"":void 0===n?"":n,e[e.length]=encodeURIComponent(t)+"="+encodeURIComponent(n)},s=function o(t,s){var r,c,h;if(t)if(i(s))for(r=0,c=s.length;r<c;r+=1)n.test(t)?a(t,s[r]):o(t+"["+("object"==typeof s[r]?r:"")+"]",s[r]);else if(s&&"[object Object]"===String(s))for(h in s)o(t+"["+h+"]",s[h]);else a(t,s);else if(i(s))for(r=0,c=s.length;r<c;r+=1)a(s[r].name,s[r].value);else for(h in s)o(h,s[h]);return e};return s("",t).join("&").replace(/%20/g,"+")},deparam:function(t){for(var e,n={},i=t.split("̃&"),a=0;a<i.length;a+=1)if(e=i[a].split("="),e[0]=decodeURIComponent(e[0]),e[1]=decodeURIComponent(e[1]),"undefined"==typeof n[e[0]])n[e[0]]=e[1];else if("string"==typeof n[e[0]]){var s=[n[e[0]],e[1]];n[e[0]]=s}else n[e[0]].push(e[1]);return n},removeRichText:function(){var t=[/<i>(.*)<\/i>/i,/<b>(.*)<\/b>/i,/<color(?:=[^>]*)*>(.+)<\/color>/i];return function(e){var n;for(n=0;n<t.length;n+=1)e=e.replace(t[n],"$1");return e}}()},Array:{removeRef:function(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},remove:function(t,e){var n=i.Array.indexOf(t,e);n>-1&&t.splice(n,1)},forEach:function(t,e){t.slice().forEach(e)},trimLeft:function(t,e){for(;t.length>e;)t.shift()},trimRight:function(t,e){for(;t.length>e;)t.pop()},indexOf:function(t,e){var n;for(n=0;n<t.length;n+=1)if(i.Object.isEqual(t[n],e))return n;return-1},unique:function(t){var e,n,i=[];for(n=0;n<t.length;n+=1)e=t[n],i.indexOf(e)===-1&&i.push(e);return i},pushUnique:function(t,e){return i.Array.indexOf(t,e)===-1&&(t.push(e),!0)},createCircular:function(){function t(t){this._array=t,this._index=-1}return t.prototype.next=function(){return this._index+=1,this._index>=this._array.length&&(this._index=0),this._array[this._index]},t.prototype.prev=function(){return this._index-=1,this._index<0&&(this._index=this._array.length-1),this._array[this._index]},function(e){return new t(e)}}()},Set:{compare:function(t,e){var n=[],a=[],s=[];if(t===e)n=t.slice();else{var o,r,c,h;for(a=t.slice(),s=e.slice(),o=0;o<t.length;o+=1)for(c=t[o],r=0;r<e.length;r+=1)if(h=e[r],i.Object.isEqual(c,h)){n.push(c),i.Array.remove(a,c),i.Array.remove(s,c);break}}return{same:n,diff12:a,diff21:s}}},Object:{isEqual:function(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(void 0===t||null===t||"number"==typeof t&&isNaN(t)&&isNaN(e))return!0;var n=i.Type.isDate(t),a=i.Type.isDate(e);if(n&&!a||!n&&a)return!1;if(n&&a)return t.getTime()===e.getTime();var s=i.Type.isRegExp(t),o=i.Type.isRegExp(e);if(s&&!o||!s&&o)return!1;if(s&&o)return t.toString()===e.toString();if(i.Type.isObject(t)&&i.Type.isObject(e)){var r,c=Object.getOwnPropertyNames(t),h=Object.getOwnPropertyNames(e);if(c.length!==h.length)return!1;for(r=0;r<c.length;r+=1)if(!i.Object.isEqual(t[c[r]],e[h[r]]))return!1;return!0}return t===e},findObject:function(t,e,n){var a;for(a in t)if(t.hasOwnProperty(a)){var s=t[a];if(i.Type.isObject(s)&&s[e]===n)return s}return null},replaceProperty:function(t,e,n){var i=t[e];delete t[e],t[n]=i},isEmpty:function(t){return 0===Object.getOwnPropertyNames(t).length},toConstant:function(t){var e,n={};for(e in t)if(t.hasOwnProperty(e)){var a=t[e];i.Type.isObject(a)&&(a=i.Object.toConstant(a)),Object.defineProperty(n,e,{value:a,writable:!1,enumerable:!0,configurable:!0})}return n},values:function a(t){if(i.Type.isFunction(Object.values))return Object.values(t);var e,a=[];for(e in t)t.hasOwnProperty(e)&&a.push(t[e]);return a}},Type:{isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t&&!isNaN(t)},isObject:function(t){return"object"==typeof t&&null!==t},isFunction:function(t){return"function"==typeof t},isUndefined:function(t){return"undefined"==typeof t},isDefined:function(t){return!this.isUndefined(t)&&null!==t},isArray:function(t){return Array.isArray(t)},isDate:function(t){return t instanceof Date},isRegExp:function(t){return t instanceof RegExp}},Number:{format:function(t){var e,n,i,a,s,o=Math.abs(t).toString(),r="";for(o=o.replace(".",","),e=o.split(","),n=e[0],i=e[1],a=n.length-1,s=1;a>=0;a-=1,s+=1)r=n[a]+r,s%3===0&&0!==a&&(r="."+r);return(t<0?"-":"")+r+(i?","+i:"")},abbreviate:function(t,e){e=Math.pow(10,e||2);var n,i=["K","M","B","T"],a=t<0?"-":"";t=Math.abs(t);for(var s=i.length-1;s>=0;s-=1)if(n=Math.pow(10,3*(s+1)),n<=t){t=Math.floor(t*e/n)/e,1e3===t&&s<i.length-1&&(t=1,s+=1),t+=i[s];break}return a+t},fillZero:function(t,e){for(var n=""+t;n.length<e;)n="0"+n;return n},random:function(t,e){var n=0===t||0===e?1:0;return Math.floor(Math.random()*(e+n)+t)}},Date:{currentTime:function(){var t=new Date;return i.Number.fillZero(t.getHours(),2)+":"+i.Number.fillZero(t.getMinutes(),2)+":"+i.Number.fillZero(t.getSeconds(),2)},fromString:function(t){var e=t.slice(0,4),n=t.slice(5,7)-1,i=t.slice(8,10),a=t.slice(11,13),s=t.slice(14,16),o=t.slice(17,19);return new Date(e,n,i,a,s,o)},fromSecond:function(t){var e=Math.floor(t/24/60/60),n=24*e*60*60,i=Math.floor((t-n)/60/60),a=60*i*60,s=Math.floor((t-n-a)/60),o=Math.floor(t-60*s-n-a),r=(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)+":"+(o<10?"0"+o:o);return e>0&&(r=e+" ngày, "+r),r},format:function(){function t(t){var e=t.getDay();return 0===e&&(e=7),e}function e(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.setDate(e.getDate()-(e.getDay()+6)%7+3);var n=new Date(e.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var i=e.getTimezoneOffset()-n.getTimezoneOffset();e.setHours(e.getHours()-i);var a=(e-n)/6048e5;return 1+Math.floor(a)}var n=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|'[^']*'|'[^']*'/g,a=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,s=/[^-+\dA-Z]/g,o=function r(o,c,h,u){if(1!==arguments.length||"string"==typeof o!=="string"||/\d/.test(o)||(c=o,o=void 0),o=o||new Date,o instanceof Date||(o=new Date(o)),isNaN(o))throw TypeError("Invalid date");c=String(r.masks[c]||c||r.masks["default"]);var l=c.slice(0,4);"UTC:"!==l&&"GMT:"!==l||(c=c.slice(4),h=!0,"GMT:"===l&&(u=!0));var d=i.Number.fillZero,m=h?"getUTC":"get",p=o[m+"Date"](),g=o[m+"Day"](),f=o[m+"Month"](),_=o[m+"FullYear"](),y=o[m+"Hours"](),E=o[m+"Minutes"](),C=o[m+"Seconds"](),v=o[m+"Milliseconds"](),T=h?0:o.getTimezoneOffset(),S=e(o),A=t(o),M={d:p,dd:d(p,2),ddd:r.i18n.dayNames[g],dddd:r.i18n.dayNames[g+7],m:f+1,mm:d(f+1,2),mmm:r.i18n.monthNames[f],mmmm:r.i18n.monthNames[f+12],yy:String(_).slice(2),yyyy:_,h:y%12||12,hh:d(y%12||12,2),H:y,HH:d(y,2),M:E,MM:d(E,2),s:C,ss:d(C,2),l:d(v,3),L:d(Math.round(v/10),2),t:y<12?"a":"p",tt:y<12?"am":"pm",T:y<12?"A":"P",TT:y<12?"AM":"PM",Z:u?"GMT":h?"UTC":(String(o).match(a)||[""]).pop().replace(s,""),o:(T>0?"-":"+")+d(100*Math.floor(Math.abs(T)/60)+Math.abs(T)%60,4),S:["th","st","nd","rd"][p%10>3?0:(p%100-p%10!==10)*p%10],W:S,N:A};return c.replace(n,function(t){return t in M?M[t]:t.slice(1,t.length-1)})};return o.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},o.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},o}()},Cookie:{get:function(t){var e,n,i;n=document.cookie.split("; ");for(var a=0;a<n.length;a+=1)i=n[a].split("="),i[0]===t&&(e=i[1]);return e},set:function(t,e,n,i,a,s){var o=t+"="+e+"; ";n&&(n=this._setExpiration(n),o+="expires="+n+"; "),i&&(o+="path="+i+"; "),a&&(o+="domain="+a+"; "),s&&(o+="secure; "),document.cookie=o},_setExpiration:function(t){var e=new Date,n=new Date(e.getTime()+24*t*60*60*1e3);return n.toGMTString()}},Class:function(){var t=["$$constructor","$$extends","$$static"];return function(e){var n,i,a,s=e.$$constructor||function(){};for(n in e)if(e.hasOwnProperty(n))if(i=e[n],"$$static"===n)for(a in i)i.hasOwnProperty(a)&&(s[a]=i[a]);else"$$extends"===n?(s.prototype=Object.create(i.prototype),s.prototype.$super=Object.create(i.prototype),s.prototype.constructor=s):t.indexOf(n)===-1&&(s.prototype[n]=i);return s}}(),Node:{getChild:function(t,e){var n,i=e.split("."),a=t;for(n=0;n<i.length&&null!==a;n+=1)a=a.getChildByName(i[n]);return a},stopPropagation:function(t){function e(t){t.stopPropagation()}return t.on(cc.Node.EventType.TOUCH_START,e),t.on(cc.Node.EventType.TOUCH_END,e),t.on(cc.Node.EventType.TOUCH_MOVE,e),t.on(cc.Node.EventType.MOUSE_DOWN,e),t.on(cc.Node.EventType.MOUSE_UP,e),t.on(cc.Node.EventType.MOUSE_MOVE,e),function(){t.off(cc.Node.EventType.TOUCH_START,e),t.off(cc.Node.EventType.TOUCH_END,e),t.off(cc.Node.EventType.TOUCH_MOVE,e),t.off(cc.Node.EventType.MOUSE_DOWN,e),t.off(cc.Node.EventType.MOUSE_UP,e),t.off(cc.Node.EventType.MOUSE_MOVE,e)}},destroyAllChildrenInNode:function(t){for(var e=t.childrenCount-1;e>=0;e-=1)t.children[e].destroy()}},Director:function(){var t,e,n=[];return{loadScene:function(a,s,o){t&&(e=t),t=a;var r=i.Array.pushUnique(n,{sceneName:a,onLaunched:s,onError:o});r&&1===n.length&&this._loadScene(a,s,o)},getCurrentSceneName:function(){return t},getPreviousSceneName:function(){return e},preloadScene:function(t,e,n){cc.director.preloadScene(t,function(t){var a=!t;a&&i.Type.isFunction(e)&&e(),!a&&i.Type.isFunction(n)&&n()})},_loadScene:function(t,e,n){var i=this;i.preloadScene(t,function(){var a=cc.director.loadScene(t,function(a){i._loadNextSceneFrom(t,e,n,!a)});a||i._loadNextSceneFrom(t,e,n,!1)},function(){i._loadNextSceneFrom(t,e,n,!1)})},_loadNextSceneFrom:function(t,e,a,s){if(i.Array.remove(n,{sceneName:t,onLaunched:e,onError:a}),s&&i.Type.isFunction(e)&&e(),!s&&i.Type.isFunction(a)&&a(),n.length>0){var o=n[0];this._loadScene(o.sceneName,o.onLaunched,o.onError)}}}}(),Scheduler:{setInterval:function(t){function e(e,n,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e,n){return e>0&&i.Type.isFunction(t)?(n&&t(),setInterval(t,e)):null}),debounce:function(t,e,n){var i,a=0;return function(){if(i&&clearTimeout(i),n>e){a=a||Date.now();var s=Date.now()-a;s>=n&&(t(),a=Date.now())}i=setTimeout(function(){t(),a=0,i=null},e)}}},Module:{get:function(e){if(i.Type.isString(e))try{return t(e)}catch(n){return null}return null}},Game:function(){function t(){n=!0}function e(){n=!1}var n=!0;return cc.game.on(cc.game.EVENT_SHOW,t,this),cc.game.on(cc.game.EVENT_HIDE,e,this),{isFocus:function(){return n}}}(),EventManager:{onKeyReleased:function(t,e,n){cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(e){switch(e){case t:n&&n()}}},e)}}};e.exports=i,cc._RFpop()},{}],VienBi:[function(t,e,n){"use strict";cc._RFpush(e,"5d08dmRTCdAQLQ8Dc32D9X6","VienBi");var i=t("BaseMainGameplay");cc.Class({"extends":cc.Component,properties:{sceneScript:i},onEnable:function(){cc.director.getCollisionManager().enabled=!0},onDisable:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},onCollisionEnter:function(t,e){this.sceneScript.stopVienBi()}}),cc._RFpop()},{BaseMainGameplay:"BaseMainGameplay"}],VongQuayConstant:[function(t,e,n){"use strict";cc._RFpush(e,"39831EivzxF9bBYxf/B4izF","VongQuayConstant"),e.exports={Action:{ROTATE:0,CHANGE_STATE:5,UPDATE_FREE_PLAY:9,UPDATE_WINNER:10,GET_CAPTCHA:12,RENEW_CAPTCHA:13,RESOLVE_CAPTCHA:14},GameState:{NONE:0,ROTATE:1,FINALIZING:2,FINISH:3},Event:{GET_JAR_SUCCESS:"in_game.vong_quay.getjarsuccess",UPDATE_JAR:"in_game.vong_quay.updatejar",TURN_GET_CAPCHA:"in_game.vong_quay.getcapcha",TURN_RESOLVE_CAPCHA:"in_game.vong_quay.resolve",TURN_PREPARE:"in_game.vong_quay.prepare",TURN_START:"in_game.vong_quay.start",TURN_UPDATE:"in_game.vong_quay.update",TURN_FINISH:"in_game.vong_quay.finish"}},cc._RFpop()},{}],VongQuayGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"37db7utYKZGMYN2PnOzFaqA","VongQuayGameManager");var i,a=t("Utils"),s=t("Url"),o=t("AuthUser"),r=t("BaseGameManager"),c=t("GameConstant"),h=t("CommonConstant"),u=t("SmartFoxConstant"),l=t("NetworkManager"),d=t("VongQuayConstant");i=a.Class({$$extends:r,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.DELAYED_COMMANDS=[u.Command.MESSAGE.ID],this.gameState=d.GameState.NONE,this.isFreeTurn=!1,this.eventDispatchers.anyCmd.addEventListener(u.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(u.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.globalCmd.addEventListener(u.Command.UPDATE_JAR.ID,this.onUpdateGameJar,this),this.eventDispatchers.playCmd.addEventListener(d.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(d.Action.UPDATE_FREE_PLAY,this.onUpdateFreePlay,this),this.eventDispatchers.playCmd.addEventListener(d.Action.UPDATE_WINNER,this.onUpdateWinner,this),this.eventDispatchers.playCmd.addEventListener(d.Action.GET_CAPTCHA,this.onGetCapcha,this),this.eventDispatchers.playCmd.addEventListener(d.Action.RENEW_CAPTCHA,this.onRenewCapcha,this),this.eventDispatchers.playCmd.addEventListener(d.Action.RESOLVE_CAPTCHA,this.onResolveCapcha,this),this.historyDataKey="data_history_vongquay_user_"+o.username,this.historyList=[];var n=cc.sys.localStorage.getItem(this.historyDataKey);void 0!==n&&null!==n&&(this.historyList=JSON.parse(n))},onUpdateGameJar:function(t){this.eventDispatchers.local.dispatchEvent(d.Event.UPDATE_JAR,t)},onResolveCapcha:function(t){this.eventDispatchers.local.dispatchEvent(d.Event.TURN_GET_CAPCHA,t)},onRenewCapcha:function(){},onGetCapcha:function(t){this.eventDispatchers.local.dispatchEvent(d.Event.TURN_GET_CAPCHA,t);
},onUpdateWinner:function(){},onUpdateFreePlay:function(t){this.eventDispatchers.local.dispatchEvent(d.Event.TURN_PREPARE,t)},onChangeStateGame:function(t){this.gameState=t.data.gameState,this.gameState===d.GameState.ROTATE?this.eventDispatchers.local.dispatchEvent(d.Event.TURN_START,t):this.gameState===d.GameState.NONE&&this.eventDispatchers.local.dispatchEvent(d.Event.TURN_PREPARE,t),t.action===d.Action.CHANGE_STATE&&this.onUpdateGame(t)},onUpdateGame:function(t){this.eventDispatchers.local.dispatchEvent(d.Event.TURN_UPDATE,t)},onFinishGame:function(t){this.eventDispatchers.local.dispatchEvent(d.Event.TURN_FINISH,t);var e=t.data.result,n={time:a.Date.currentTime(),vong1:e[0][0],vong2:e[1][0],vong3:e[2][0],betting:this.isFreeTurn?"Q.Miễn phí":a.Number.format(t.allData.betting)+" "+h.CurrencyType.Ip.CHIP_NAME};this.historyList.unshift(n),this.historyList.length>60&&this.historyList.splice(this.historyList.length-1,1),cc.sys.localStorage.setItem(this.historyDataKey,JSON.stringify(this.historyList)),this.isFreeTurn=!1},sendCapcha:function(t){this.send({command:l.SmartFox.type["byte"](u.Command.PLAY.ID),action:l.SmartFox.type["byte"](d.Action.RESOLVE_CAPTCHA),answer:l.SmartFox.type.utfString(t)})},sendStartGame:function(){this.send({command:l.SmartFox.type["byte"](u.Command.PLAY.ID),action:l.SmartFox.type["byte"](d.Action.ROTATE)})},sendGetNewFree:function(){this.send({command:l.SmartFox.type["byte"](u.Command.PLAY.ID),action:l.SmartFox.type["byte"](d.Action.GET_CAPTCHA)})},destroy:function(){this.$super.destroy.call(this)},getJar:function(){var t=this;l.Http.fetch("GET",s.Http.GET_JAR,{game_id:c.VONG_QUAY.ID},{cache:900}).success(function(e){t.eventDispatchers.local.dispatchEvent(d.Event.GET_JAR_SUCCESS,e)})}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",CommonConstant:"CommonConstant",GameConstant:"GameConstant",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Url:"Url",Utils:"Utils",VongQuayConstant:"VongQuayConstant"}],VongQuay:[function(t,e,n){"use strict";cc._RFpush(e,"0a563hXsv1P9r/IZYPVI1tG","VongQuay");var i=t("UrlImage"),a=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{itemLabelList:{"default":[],type:cc.Label},itemImageList:{"default":[],type:i}},onLoad:function(){this.rotateOld=0,this.rotateDelta=0;for(var t=0;t<this.itemImageList.length;t+=1)this.itemImageList[t].node.getComponent(cc.Sprite).spriteFrame=null},updateData:function(t){this.imageUrlList||(this.imageUrlList=[]);for(var e=0;e<this.itemLabelList.length;e+=1){var n=t[e].image;this.itemLabelList[e].string=a.CurrencyType.normalize(t[e].description),this.itemImageList.length>0&&n&&n.length>0&&(this.imageUrlList.length<this.itemLabelList.length?(this.imageUrlList.push(n),this.itemImageList[e].loadImage(n)):(this.imageUrlList[e]!==n&&this.itemImageList[e].loadImage(n),this.imageUrlList[e]=n))}},update:function(){this.rotateDelta=this.node.rotation-this.rotateOld,this.rotateOld=this.node.rotation}}),cc._RFpop()},{CommonConstant:"CommonConstant",UrlImage:"UrlImage"}],WarningMessage:[function(t,e,n){"use strict";cc._RFpush(e,"16c0d0Drd5Ezpv9B97mc6gF","WarningMessage");var i=t("Utils"),a=t("CommonConstant");cc.Class({"extends":cc.Component,properties:{contentLabel:cc.RichText,duration:3},start:function(){this.node.zIndex=a.ZINDEX.WARNING_MESSAGE},onLoad:function(){},open:function(t,e,n){this.closeImmediately(),(!i.Type.isNumber(e)||e<=0)&&(e=Math.max(this.duration,1)),this._closeTimeoutId=setTimeout(this.close.bind(this),1e3*e);var a=this.node;a&&a.isValid&&(this.contentLabel.string="<b>"+t+"</b>",this.node.getComponent("Modal").backdrop.active=!!n,a.stopAllActions(),a.active=!0,a.scale=.3,a.runAction(cc.spawn([cc.scaleTo(.1,1),cc.fadeIn(.1)])))},close:function(){var t=this.node,e=cc.spawn([cc.scaleTo(.1,.3),cc.fadeOut(.1)]);t&&t.isValid&&(t.stopAllActions(),t.runAction(cc.sequence([e,cc.callFunc(this._hide.bind(this))])))},closeImmediately:function(){this._closeTimeoutId&&(clearTimeout(this._closeTimeoutId),this._closeTimeoutId=null),this._hide()},_show:function(){this.node&&this.node.isValid&&(this.node.active=!0)},_hide:function(){this.node&&this.node.isValid&&(this.node.active=!1)}}),cc._RFpop()},{CommonConstant:"CommonConstant",Utils:"Utils"}],XiToConstant:[function(t,e,n){"use strict";cc._RFpush(e,"82b01qldCtB25+cEi83pkDR","XiToConstant");var i=t("Utils");e.exports={GameType:{FIVE_CARDS:{ID:0,NUMBER_OF_CARDS:5},SEVEN_CARDS:{ID:1,NUMBER_OF_CARDS:7},findById:function(t){return i.Object.findObject(this,"ID",t)}},Action:{BET:1,RAISE:2,ALL_IN:3,ALL_HAND:31,CALL:4,CHECK:5,FOLD:6,CHANGE_STATE:7,CHANGE_TURN:8,BUY_PRIVATE_MONEY:9,BUY_PRIVATE_MONEY_REQUIRED:10,END_TURN:11,BET_1_2:12,BET_1_4:13,BET_X2:14,CHOOSE_PUBLIC_CARD:15},GameState:{NONE:0,WAITING_FOR_PLAYER:1,WAITING_FOR_NEW_GAME:2,DEALING:3,FINALIZING:6,FINISH:7,ROUND:8},GameStatePoker:{PREFLOP:8,FLOP:9,TURN:10,RIVER:11},PlayerState:{NONE:0,IN_TURN:1,WAITING_FOR_TURN:2,FOLDED:3,ALL_IN:4,OFF_MONEY:5},Event:{START_TIME:"in_game.xito.start_time",USER_BET:"in_game.xito.user_bet",CHANGE_STATE:"in_game.xito.change_state",CHANGE_TURN:"in_game.xito.change_turn",UPDATE_MONEY:"in_game.xito.update_money",SHOW_CARD_OPEN:"in_game.xito.show_card_open",DRAW_CARD:"in_game.xito.draw_card",FINISH_GAME:"in_game.xito.finish_game",UPDATE_GAME:"in_game.xito.update_game",REFRESH_GAME:"in_game.xito.refresh_game",SHOW_BUY_CHIP:"in_game.poker.show_buy_chip",HIDE_BUY_CHIP_BUTTON:"in_game.poker.hide_buy_chip_button"},TimeoutId:{SHOW_COMMUNITY_CARDS:"TIMEOUT_SHOW_COMMUNITY_CARDS"},Effect:{TO:0,THEO:1,NHUONG_TO:2,UP_BO:3,CHOI_TAT_TAY:4,TO_12:5,TO_14:6,TO_X2:7,TO_TAT_CA:8,DANG_DOI:9}},cc._RFpop()},{Utils:"Utils"}],XiToGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"b69d8NNQt9NmJap/m07pSpB","XiToGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("XiToConstant"),r=t("NetworkManager"),c=t("Utils");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this._setGameState(o.GameState.NONE),this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.WAITING_DEAL_CARD.ID,this.onWaittingDealCard,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.NEW_MATCH.ID,this.restartGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BET,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.ALL_IN,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CALL,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHECK,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.FOLD,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BET_1_2,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BET_1_4,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BET_X2,this.onPlayerBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_STATE,this.onChangeStateGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_TURN,this.onChangeTurn,this),this.gameType=7},bet:function(t){this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](t)})},choosePublicCard:function(t){this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.CHOOSE_PUBLIC_CARD),card:r.SmartFox.type["byte"](t)})},onUpdateGame:function(t){this.gameType=0===t.data.gameType?5:7,this.currency=t.data.currency,this.roomBetting=t.data.betting,this._setGameState(t.data.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.UPDATE_GAME,t);var e=t.data.time;if(e){var n=0;t.__execInfo__&&(n=t.__execInfo__.dt),e-=n}this.onUpdateHand(e)},onUpdateHand:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.DRAW_CARD,t)},onPlayerBetting:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.USER_BET,t)},onWaittingDealCard:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.START_TIME,t.data.time)},onChangeStateGame:function(t){this.currentRound=t.allData.currentRound,this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_STATE,t);var e=t.data.time;if(e){var n=0;t.__execInfo__&&(n=t.__execInfo__.dt),e-=n}this.onUpdateHand(e)},onChangeTurn:function(t){this._setGameState(t.allData.gameState);var e={data:{userName:t.data.userName,time:t.data.time,allowedActions:t.data.allowedActions,minBetting:t.data.actionMoneyList,maxBetting:null}};this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_TURN,e)},onFinishGame:function(t){this._setGameState(t.allData.gameState),this.eventDispatchers.local.dispatchEvent(o.Event.FINISH_GAME,t)},restartGame:function(){this.eventDispatchers.local.dispatchEvent(o.Event.REFRESH_GAME)},_setGameState:function(t){this.gameState!==t&&(this.gameState=t)}}),e.exports=i,cc._RFpop()},{BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils",XiToConstant:"XiToConstant"}],XiToOptionModal:[function(t,e,n){"use strict";cc._RFpush(e,"85a28sWso9Eg4/wVJrypnnw","XiToOptionModal");var i=t("BaseGameOptionModal"),a=t("XiToConstant"),s=t("NetworkManager");cc.Class({"extends":i,properties:{},onLoad:function(){},_playXCardsGameType:function(t){this.gameConfigs=this.gameConfigs||{},this.gameConfigs.gameType=s.SmartFox.type["byte"](t),this.enterGame()},playFiveCardsGameType:function(){this._playXCardsGameType(a.GameType.FIVE_CARDS.ID)},playSevenCardsGameType:function(){this._playXCardsGameType(a.GameType.SEVEN_CARDS.ID)}}),cc._RFpop()},{BaseGameOptionModal:"BaseGameOptionModal",NetworkManager:"NetworkManager",XiToConstant:"XiToConstant"}],XoSoInfoModal:[function(t,e,n){"use strict";cc._RFpush(e,"bd956jpHHpJpJ0Z0rvFxPxv","XoSoInfoModal");var i=t("NetworkManager"),a=t("CommonConstant"),s=t("GameConstant"),o=t("AuthUser"),r=t("Utils"),c=t("Url");cc.Class({"extends":cc.Component,properties:{dateLabel:cc.Label,xoSoResultContainer:cc.Node,xoSoBetLogPrefab:cc.Prefab,xoSoBetLogsContainer:cc.Node,helpLabel:cc.Label},onLoad:function(){this.currentDate=new Date,this.currentAction=this.fetchXoSoResult,this.updateDate()},setNextDay:function(){this.currentDate.setDate(this.currentDate.getDate()+1),this.updateDate()},setPreviousDay:function(){this.currentDate.setDate(this.currentDate.getDate()-1),this.updateDate()},updateDate:function(){this.dateLabel.string="Ngày "+r.Date.format(this.currentDate,"dd/mm/yyyy"),this.currentAction()},onTabClick:function(t){this.currentAction=this["fetch"+t.name],this.currentAction()},fetchXoSoResult:function(){var t=this;i.Http.fetch("GET",c.Http.XOSO_RESULT,{date:r.Date.format(this.currentDate,"yyyy-mm-dd")},{cache:300}).success(function(e){for(var n=e.data,i=t.xoSoResultContainer.children,a=0;a<i.length;a+=1)i[a].getChildByName("lblResult").getComponent(cc.Label).string=(n[a]||[]).join(" - ")})},fetchLichSu:function(){var t=this;i.Http.fetch("GET",c.Http.XOSO_USER_BET_LIST,{username:o.username,accesstoken:o.accesstoken,date:r.Date.format(this.currentDate,"yyyy-mm-dd")},{}).success(function(e){var n,i,s,o,c=e.data;t.xoSoBetLogsContainer.removeAllChildren();for(var h=0;h<c.length;h+=1)n=cc.instantiate(t.xoSoBetLogPrefab),i=n.getComponent("RowTable"),s=a.CurrencyType.findByName(c[h].currency).DISPLAY_NAME,o=c[h].win_amount>0?r.Number.format(c[h].win_amount)+" "+s:" ",i.updateData(c[h].created_time.replace(" ","\n"),c[h].bet_name,c[h].numbers.join(" - "),r.Number.format(c[h].amount)+" "+s,o),t.xoSoBetLogsContainer.addChild(n)})},fetchHelp:function(){var t=this;i.Http.fetch("GET",c.Http.GAME_HELP,{game_id:s.XO_SO.ID},{cache:3e3}).success(function(e){e.data&&(t.helpLabel.string=e.data.content)})}}),cc._RFpop()},{AuthUser:"AuthUser",CommonConstant:"CommonConstant",GameConstant:"GameConstant",NetworkManager:"NetworkManager",Url:"Url",Utils:"Utils"}],XoSoItem:[function(t,e,n){"use strict";cc._RFpush(e,"6a5bf00aRpGGLRZhqSL0Sa3","XoSoItem"),cc.Class({"extends":cc.Component,properties:{nameLabel:cc.Label,ratioLabel:cc.Label},onLoad:function(){},updateData:function(t){this.nameLabel.string=t.name,this.ratioLabel.string=t.ratio}}),cc._RFpop()},{}],XocDiaConstant:[function(t,e,n){"use strict";cc._RFpush(e,"36b0d4YeYVFo6mZ10ZXllzt","XocDiaConstant");var i=t("Utils");e.exports={Action:{BETTING:1,CANCEL_BET:2,TURN_MASTER:3,MASTER_SELL_POT:4,CHANGE_STATE:5,UPDATE_POTS:9,PING:10},GameState:{NONE:0,EFFECT:1,PLAYER_BETTING:2,MASTER_CANEL_BET:3,FINISH:4,FINALIZING:5},ChipColor:{BLUE:{ID:0,NAME:"blue"},PURPLE:{ID:1,NAME:"purple"},GREEN:{ID:2,NAME:"green"},RED:{ID:3,NAME:"red"},findById:function(t){return t=parseInt(t,10),i.Object.findObject(this,"ID",t)}},Event:{CHANGE_STATE:"in_game.tai_xiu.change_state",EFFECT_STATE:"in_game.tai_xiu.change_state.effect",PLAYER_BETTING_STATE:"in_game.xoc_dia.change_state.player_betting",UPDATE_POTS:"in_game.tai_xiu.update_pots",BETTING_SUCCESS:"in_game.xoc_dia.betting_success",SHAKE_BOW_DICE:"in_game.xoc_dia.shake",CANCEL_BET:"in_game.xoc_dia.cancel_bet",FINISH:"in_game.xoc_dia.finish",SELECT_CHIP:"in_game.xoc_dia.select_chip",ADD_LIST_BETTING:"in_game.xoc_dia.add_list_betting",ADD_BANKER:"in_game.xoc_dia.add_banker",SET_RATIO:"in_game.xoc_dia.set_ratio",BETTING_UPDATEGAME:"in_game.xoc_dia.betting_updategame",MASTER_CANEL_BET:"in_game.xoc_dia.master_cancel_bet",MASTER_CANEL_BET_RECEIVE:"in_game.xoc_dia.master_cancel_bet_receive"}},cc._RFpop()},{Utils:"Utils"}],XocDiaGameManager:[function(t,e,n){"use strict";cc._RFpush(e,"4d8260kbFFCR7f0pbILt1fD","XocDiaGameManager");var i,a=t("BaseGameManager"),s=t("SmartFoxConstant"),o=t("XocDiaConstant"),r=t("NetworkManager"),c=t("Utils"),h=t("AuthUser");i=c.Class({$$extends:a,$$constructor:function(t,e){this.$super.constructor.call(this,t,e),this.currentBet=[0,0,0,0,0,0],this.history=[],this.isMaster=!1,this.bettingList=[],this.eventDispatchers.anyCmd.addEventListener(s.Command.UPDATE_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.REFRESH_GAME.ID,this.onUpdateGame,this),this.eventDispatchers.anyCmd.addEventListener(s.Command.FINISH_GAME.ID,this.onFinishGame,this),this.eventDispatchers.playCmd.addEventListener(o.Action.BETTING,this.onBettingSuccess,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CHANGE_STATE,this.onChangeState,this),this.eventDispatchers.playCmd.addEventListener(o.Action.CANCEL_BET,this.onCancelBetting,this),this.eventDispatchers.playCmd.addEventListener(o.Action.MASTER_SELL_POT,this.onMasterCancelBet,this)},sellBetCancelBet:function(t){this.isMaster&&this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.MASTER_SELL_POT),pot:r.SmartFox.type["byte"](t)})},sendBet:function(t,e){!this.isMaster&&e>0&&this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.BETTING),userName:r.SmartFox.type.utfString(h.username),pot:r.SmartFox.type["byte"](t),money:r.SmartFox.type["long"](e)})},sendReBet:function(){for(var t=0;t<this.history.length;t+=1)this.sendBet(t,this.history[t])},sendDoubleBet:function(){for(var t=0;t<this.currentBet.length;t+=1)this.currentBet[t]>0&&this.sendBet(t,this.currentBet[t])},sendCancelBet:function(){for(var t=0;t<this.currentBet.length;t+=1)this.send({command:r.SmartFox.type["byte"](s.Command.PLAY.ID),action:r.SmartFox.type["byte"](o.Action.CANCEL_BET),userName:r.SmartFox.type.utfString(h.username),pot:r.SmartFox.type["byte"](t)})},onMasterCancelBet:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.MASTER_CANEL_BET_RECEIVE,t.pot)},countDowTime:function(t){return this._formatTime((t-Date.now())/1e3)},onFinishGame:function(t){this._setGameState(o.GameState.FINALIZING),this.eventDispatchers.local.dispatchEvent(o.Event.FINISH,t),this.history=this.currentBet,this.currentBet=[0,0,0,0,0,0]},onUpdateGame:function(t){this.bettingList=t.bettingValues,this._updateListBetting(t.bettingValues),this._updateRatio(t.potInfo),this.onChangeState(t),this.gameState!==o.GameState.FINISH&&this._bettingUpdateGame(t.pots)},_bettingUpdateGame:function(t){for(var e=0;e<t.length;e+=1)this.eventDispatchers.local.dispatchEvent(o.Event.BETTING_UPDATEGAME,t[e])},onBettingSuccess:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.BETTING_SUCCESS,t),this.isCurrentPlayer(t.username)&&(this.currentBet[t.pot]=this.currentBet[t.pot]+t.money)},onCancelBetting:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.CANCEL_BET,t),this.isCurrentPlayer(t.username)&&(this.currentBet=[0,0,0,0,0,0])},onChangeState:function(t){switch(this._setGameState(t.gameState),t.gameState){case o.GameState.EFFECT:this.onEfectShake(t);break;case o.GameState.PLAYER_BETTING:this.onPlayerBetting(t);break;case o.GameState.MASTER_CANEL_BET:this.eventDispatchers.local.dispatchEvent(o.Event.MASTER_CANEL_BET,t)}},_setGameState:function(t){this.gameState!==t&&(this.gameState=t,this.eventDispatchers.local.dispatchEvent(o.Event.CHANGE_STATE))},onPlayerBetting:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.PLAYER_BETTING_STATE,t)},onEfectShake:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.SHAKE_BOW_DICE,t)},_updateRatio:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.SET_RATIO,t)},_updateListBetting:function(t){this.eventDispatchers.local.dispatchEvent(o.Event.ADD_LIST_BETTING,t)},_formatTime:function(t){if(t>=0){t=Math.floor(t);var e=Math.floor(t/60),n=t%60;return c.Number.fillZero(e,2)+":"+c.Number.fillZero(n,2)}return"00:00"}}),e.exports=i,cc._RFpop()},{AuthUser:"AuthUser",BaseGameManager:"BaseGameManager",NetworkManager:"NetworkManager",SmartFoxConstant:"SmartFoxConstant",Utils:"Utils",XocDiaConstant:"XocDiaConstant"}]},{},["ToggleCurrency","FacebookInteract","TayDuKyConstant","Slot777Constant","AnimationManager","VongQuay","RunningMessage","LichSuDoi","BottomPanelOutGame","SanThuongGameManager","TabView","EffectThangTrang","MessageBox","Loading","PlayerUIMauBinh","PlayerUITLMN","HistoryTableMiniPoker","NoHu","ItemEvent","PlayerUI","WarningMessage","TinhNang","ColumnInfoMiniPoker","ItemTopWinGame","PhomGameManager","RowTable","Collapse","LiengConstant","CardRank","CurrencyChanger","MauBinhConstant","PlatformImplement","PokerGameManager","Event","PokerConstant","SysConfig","HaiTacGameManager","ButtonMaterial","BauCuaBuyPot","GameplayTaiXiu","TopTableMiniPoker","Boot","TamQuocGameManager","SmartFoxWebImplement","CardLayoutMauBinh","TableBangThuongMyNhan","PlayerUIPhomCurrent","HistoryTableVongQuay","BaseGameManager","ItemTextMiniPoker","JarInfo","ItemDaiLy","TableXepHangSlot","NetworkManager","SamConstant","GameplayHoaQua","XocDiaConstant","BaseGameplay","VongQuayGameManager","DoiThe","GameItemSlot","UiManager","VongQuayConstant","GameConstant","HotEvent","HopquaInfor","MinigameQuickIcon","SamGameManager","RunningMessageStore","HaiTacConstant","MiniPokerGameManager","TinhNangManager","GameplayXocDia","GameManagerConstant","GameplayXoSo","ConfirmModal","Url","ColumnHaiTac","GameplayXiTo","Modal","GameplayPoker","Chip","GameManager","MenuSlot","TableHistorySlot","TaiXiuGameManager","ItemTopUser","RemoveObject","AuthUser","LobbySlot","XocDiaGameManager","SanThuongConstant","ItemMyNhan","HistoryTableTaiXiu","EventDispatcher","NapIap","GameItem","GameplayRoulette","MauBinhGameManager","LineCuaAn","GameplayVongQuay","EventDispatcherConstant","TopPanelOutGame","MinigamePopup","MessageBoxCache","VienBi","GameplayHaiTac","TableChonDong","GameItemDataWrapper","CardSuit","AudioList","TLMNConstant","CommonConstant","CurrencyChip","XoSoItem","PhomOptionModal","Profile","MultiScreen","TayDuKyGameManager","GameJarItem","NapTinNhan","InviteCode","SortCardLayoutMauBinh","ColumnMyNhan","ItemThe","PlayerUIXiTo","TabChangePassword","ToggleButton","EffectAvatar","Utils","XiToConstant","TabSupport","GameplaySanThuong","XiToOptionModal","GameplaySam","SmartFoxConstant","TLMNGameManager","DropDown","AudioManager","MyNhanConstant","TabVatPham","PlayerConstant","Carousel","SlotInfor","SFS2X","BaseGameOptionModal","JarQuickIcon","PotInforSanThuong","RulePotSanThuong","TextJumping","Slider","RoulettePotInfor","TopPanelSlot","Settings","ItemVatPham","PlayerUIPhom","TaiXiuConstant","SmartFox","TopUsers","GameHelpModal","ItemMessage","IplayHttp","ItemHoaQua","GameplayTLMN","HistorySanThuong","TopUserTayDuKy","HoaQuaConstant","PhomUtils","BauCuaGameManager","GameplaySlotTamQuoc","Pagination","KimQuay","GiftCode","JarItem","ItemTinNhan","TopPanelInGame","ItemInapp","GameplayBauCua","LobbySlotInGame","XiToGameManager","ColumnHoaQua","SpecificGameItemList","CardUI","Hall","XoSoInfoModal","TabActivateAccount","TableBangThuongHoaQua","TabInformation","GameplayMauBinh","GameplaySlotTayDuKy","NapThe","MyNhanGameManager","DaiLy","ChangeSpriteAnimation","LiengGameManager","MultiSelect","GameplayMyNhan","HistoryTableTayDuKy","ColumnInfoSlotTayDuKy","MovableObject","Splash","BaseMainGameplay","BauCuaConstant","CardUIPhom","HotEventTrigger","PhomConstant","HoaQuaGameManager","RouletteConstant","Card","FacebookLike","TableBangThuongHaiTac","RowInforSanThuong","ItemHaiTac","GameplayMiniPoker","ChiMauBinh","Lobby","TopTableTaiXiu","HelpMiniPoker","ButtonScaler","NapXu","HopQuaSlot","UrlImage","TopPanelOutGameWrapper","MiniPokerConstant","RowInforTayDuKy","BaseMinigameGameplay","GameplayLieng","GameItemSlotInGame","RouletteGameManager","Player","GameplayPhom"]);